ARM GAS  /tmp/ccDKg7Fp.s 			page 1


   1              		.syntax unified
   2              		.cpu cortex-m3
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 4
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.thumb
  14              		.file	"bluetooth_rxtx.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.section	.text.reverse8,"ax",%progbits
  19              		.align	1
  20              		.thumb
  21              		.thumb_func
  23              	reverse8:
  24              	.LFB16:
  25              		.file 1 "bluetooth_rxtx.c"
   1:bluetooth_rxtx.c **** /*
   2:bluetooth_rxtx.c ****  * Copyright 2010-2013 Michael Ossmann
   3:bluetooth_rxtx.c ****  * Copyright 2011-2013 Dominic Spill
   4:bluetooth_rxtx.c ****  *
   5:bluetooth_rxtx.c ****  * This file is part of Project Ubertooth.
   6:bluetooth_rxtx.c ****  *
   7:bluetooth_rxtx.c ****  * This program is free software; you can redistribute it and/or modify
   8:bluetooth_rxtx.c ****  * it under the terms of the GNU General Public License as published by
   9:bluetooth_rxtx.c ****  * the Free Software Foundation; either version 2, or (at your option)
  10:bluetooth_rxtx.c ****  * any later version.
  11:bluetooth_rxtx.c ****  *
  12:bluetooth_rxtx.c ****  * This program is distributed in the hope that it will be useful,
  13:bluetooth_rxtx.c ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  14:bluetooth_rxtx.c ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  15:bluetooth_rxtx.c ****  * GNU General Public License for more details.
  16:bluetooth_rxtx.c ****  *
  17:bluetooth_rxtx.c ****  * You should have received a copy of the GNU General Public License
  18:bluetooth_rxtx.c ****  * along with this program; see the file COPYING.  If not, write to
  19:bluetooth_rxtx.c ****  * the Free Software Foundation, Inc., 51 Franklin Street,
  20:bluetooth_rxtx.c ****  * Boston, MA 02110-1301, USA.
  21:bluetooth_rxtx.c ****  */
  22:bluetooth_rxtx.c **** 
  23:bluetooth_rxtx.c **** #include <string.h>
  24:bluetooth_rxtx.c **** 
  25:bluetooth_rxtx.c **** #include "ubertooth.h"
  26:bluetooth_rxtx.c **** #include "ubertooth_usb.h"
  27:bluetooth_rxtx.c **** #include "ubertooth_interface.h"
  28:bluetooth_rxtx.c **** #include "ubertooth_rssi.h"
  29:bluetooth_rxtx.c **** #include "ubertooth_cs.h"
  30:bluetooth_rxtx.c **** #include "ubertooth_dma.h"
  31:bluetooth_rxtx.c **** #include "ubertooth_clock.h"
  32:bluetooth_rxtx.c **** #include "bluetooth.h"
  33:bluetooth_rxtx.c **** #include "bluetooth_le.h"
ARM GAS  /tmp/ccDKg7Fp.s 			page 2


  34:bluetooth_rxtx.c **** #include "cc2400_rangetest.h"
  35:bluetooth_rxtx.c **** #include "ego.h"
  36:bluetooth_rxtx.c **** #include "debug_uart.h"
  37:bluetooth_rxtx.c **** 
  38:bluetooth_rxtx.c **** #define MIN(x,y)	((x)<(y)?(x):(y))
  39:bluetooth_rxtx.c **** #define MAX(x,y)	((x)>(y)?(x):(y))
  40:bluetooth_rxtx.c **** #define TX_ENABLE 1
  41:bluetooth_rxtx.c **** #define UBERTOOTH_ONE 1
  42:bluetooth_rxtx.c **** 
  43:bluetooth_rxtx.c **** /* build info */
  44:bluetooth_rxtx.c **** const char compile_info[] =
  45:bluetooth_rxtx.c **** 	"ubertooth " GIT_REVISION " (" COMPILE_BY "@" COMPILE_HOST ") " TIMESTAMP;
  46:bluetooth_rxtx.c **** 
  47:bluetooth_rxtx.c **** /* hopping stuff */
  48:bluetooth_rxtx.c **** volatile uint8_t  hop_mode = HOP_NONE;
  49:bluetooth_rxtx.c **** volatile uint8_t  do_hop = 0;                  // set by timer interrupt
  50:bluetooth_rxtx.c **** volatile uint16_t channel = 2441;
  51:bluetooth_rxtx.c **** volatile uint16_t hop_direct_channel = 0;      // for hopping directly to a channel
  52:bluetooth_rxtx.c **** volatile uint16_t hop_timeout = 158;
  53:bluetooth_rxtx.c **** volatile uint16_t requested_channel = 0;
  54:bluetooth_rxtx.c **** volatile uint16_t le_adv_channel = 2402;
  55:bluetooth_rxtx.c **** volatile int      cancel_follow = 0;
  56:bluetooth_rxtx.c **** 
  57:bluetooth_rxtx.c **** /* bulk USB stuff */
  58:bluetooth_rxtx.c **** volatile uint8_t  idle_buf_clkn_high = 0;
  59:bluetooth_rxtx.c **** volatile uint32_t idle_buf_clk100ns = 0;
  60:bluetooth_rxtx.c **** volatile uint16_t idle_buf_channel = 0;
  61:bluetooth_rxtx.c **** volatile uint8_t  dma_discard = 0;
  62:bluetooth_rxtx.c **** volatile uint8_t  status = 0;
  63:bluetooth_rxtx.c **** 
  64:bluetooth_rxtx.c **** /* operation mode */
  65:bluetooth_rxtx.c **** volatile uint8_t mode = MODE_IDLE;
  66:bluetooth_rxtx.c **** volatile uint8_t requested_mode = MODE_IDLE;
  67:bluetooth_rxtx.c **** volatile uint8_t jam_mode = JAM_NONE;
  68:bluetooth_rxtx.c **** volatile uint8_t ego_mode = EGO_FOLLOW;
  69:bluetooth_rxtx.c **** 
  70:bluetooth_rxtx.c **** volatile uint8_t modulation = MOD_BT_BASIC_RATE;
  71:bluetooth_rxtx.c **** 
  72:bluetooth_rxtx.c **** /* specan stuff */
  73:bluetooth_rxtx.c **** volatile uint16_t low_freq = 2400;
  74:bluetooth_rxtx.c **** volatile uint16_t high_freq = 2483;
  75:bluetooth_rxtx.c **** volatile int8_t rssi_threshold = -30;  // -54dBm - 30 = -84dBm
  76:bluetooth_rxtx.c **** 
  77:bluetooth_rxtx.c **** /* Generic TX stuff */
  78:bluetooth_rxtx.c **** generic_tx_packet tx_pkt;
  79:bluetooth_rxtx.c **** 
  80:bluetooth_rxtx.c **** /* le stuff */
  81:bluetooth_rxtx.c **** uint8_t slave_mac_address[6] = { 0, };
  82:bluetooth_rxtx.c **** 
  83:bluetooth_rxtx.c **** le_state_t le = {
  84:bluetooth_rxtx.c **** 	.access_address = 0x8e89bed6,           // advertising channel access address
  85:bluetooth_rxtx.c **** 	.synch = 0x6b7d,                        // bit-reversed adv channel AA
  86:bluetooth_rxtx.c **** 	.syncl = 0x9171,
  87:bluetooth_rxtx.c **** 	.crc_init  = 0x555555,                  // advertising channel CRCInit
  88:bluetooth_rxtx.c **** 	.crc_init_reversed = 0xAAAAAA,
  89:bluetooth_rxtx.c **** 	.crc_verify = 0,
  90:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccDKg7Fp.s 			page 3


  91:bluetooth_rxtx.c **** 	.link_state = LINK_INACTIVE,
  92:bluetooth_rxtx.c **** 	.conn_epoch = 0,
  93:bluetooth_rxtx.c **** 	.do_follow = 1,
  94:bluetooth_rxtx.c **** 	.target_set = 0,
  95:bluetooth_rxtx.c **** 	.last_packet = 0,
  96:bluetooth_rxtx.c **** };
  97:bluetooth_rxtx.c **** 
  98:bluetooth_rxtx.c **** typedef struct _le_promisc_active_aa_t {
  99:bluetooth_rxtx.c **** 	u32 aa;
 100:bluetooth_rxtx.c **** 	int count;
 101:bluetooth_rxtx.c **** } le_promisc_active_aa_t;
 102:bluetooth_rxtx.c **** 
 103:bluetooth_rxtx.c **** typedef struct _le_promisc_state_t {
 104:bluetooth_rxtx.c **** 	// LFU cache of recently seen AA's
 105:bluetooth_rxtx.c **** 	le_promisc_active_aa_t active_aa[32];
 106:bluetooth_rxtx.c **** 
 107:bluetooth_rxtx.c **** 	// recovering hop interval
 108:bluetooth_rxtx.c **** 	u32 smallest_hop_interval;
 109:bluetooth_rxtx.c **** 	int consec_intervals;
 110:bluetooth_rxtx.c **** } le_promisc_state_t;
 111:bluetooth_rxtx.c **** le_promisc_state_t le_promisc;
 112:bluetooth_rxtx.c **** #define AA_LIST_SIZE (int)(sizeof(le_promisc.active_aa) / sizeof(le_promisc_active_aa_t))
 113:bluetooth_rxtx.c **** 
 114:bluetooth_rxtx.c **** /* LE jamming */
 115:bluetooth_rxtx.c **** #define JAM_COUNT_DEFAULT 40
 116:bluetooth_rxtx.c **** int le_jam_count = 0;
 117:bluetooth_rxtx.c **** 
 118:bluetooth_rxtx.c **** /* set LE access address */
 119:bluetooth_rxtx.c **** static void le_set_access_address(u32 aa);
 120:bluetooth_rxtx.c **** 
 121:bluetooth_rxtx.c **** typedef int (*data_cb_t)(char *);
 122:bluetooth_rxtx.c **** data_cb_t data_cb = NULL;
 123:bluetooth_rxtx.c **** 
 124:bluetooth_rxtx.c **** typedef void (*packet_cb_t)(u8 *);
 125:bluetooth_rxtx.c **** packet_cb_t packet_cb = NULL;
 126:bluetooth_rxtx.c **** 
 127:bluetooth_rxtx.c **** /* Unpacked symbol buffers (two rxbufs) */
 128:bluetooth_rxtx.c **** char unpacked[DMA_SIZE*8*2];
 129:bluetooth_rxtx.c **** 
 130:bluetooth_rxtx.c **** static int enqueue(uint8_t type, uint8_t* buf)
 131:bluetooth_rxtx.c **** {
 132:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 133:bluetooth_rxtx.c **** 
 134:bluetooth_rxtx.c **** 	/* fail if queue is full */
 135:bluetooth_rxtx.c **** 	if (f == NULL) {
 136:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 137:bluetooth_rxtx.c **** 		return 0;
 138:bluetooth_rxtx.c **** 	}
 139:bluetooth_rxtx.c **** 
 140:bluetooth_rxtx.c **** 	f->pkt_type = type;
 141:bluetooth_rxtx.c **** 	if(type == SPECAN) {
 142:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 143:bluetooth_rxtx.c **** 		f->clk100ns = CLK100NS;
 144:bluetooth_rxtx.c **** 	} else {
 145:bluetooth_rxtx.c **** 		f->clkn_high = idle_buf_clkn_high;
 146:bluetooth_rxtx.c **** 		f->clk100ns = idle_buf_clk100ns;
 147:bluetooth_rxtx.c **** 		f->channel = (uint8_t)((idle_buf_channel - 2402) & 0xff);
ARM GAS  /tmp/ccDKg7Fp.s 			page 4


 148:bluetooth_rxtx.c **** 		f->rssi_min = rssi_min;
 149:bluetooth_rxtx.c **** 		f->rssi_max = rssi_max;
 150:bluetooth_rxtx.c **** 		f->rssi_avg = rssi_get_avg(idle_buf_channel);
 151:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 152:bluetooth_rxtx.c **** 	}
 153:bluetooth_rxtx.c **** 
 154:bluetooth_rxtx.c **** 	memcpy(f->data, buf, DMA_SIZE);
 155:bluetooth_rxtx.c **** 
 156:bluetooth_rxtx.c **** 	f->status = status;
 157:bluetooth_rxtx.c **** 	status = 0;
 158:bluetooth_rxtx.c **** 
 159:bluetooth_rxtx.c **** 	return 1;
 160:bluetooth_rxtx.c **** }
 161:bluetooth_rxtx.c **** 
 162:bluetooth_rxtx.c **** int enqueue_with_ts(uint8_t type, uint8_t* buf, uint32_t ts)
 163:bluetooth_rxtx.c **** {
 164:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 165:bluetooth_rxtx.c **** 
 166:bluetooth_rxtx.c **** 	/* fail if queue is full */
 167:bluetooth_rxtx.c **** 	if (f == NULL) {
 168:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 169:bluetooth_rxtx.c **** 		return 0;
 170:bluetooth_rxtx.c **** 	}
 171:bluetooth_rxtx.c **** 
 172:bluetooth_rxtx.c **** 	f->pkt_type = type;
 173:bluetooth_rxtx.c **** 
 174:bluetooth_rxtx.c **** 	f->clkn_high = 0;
 175:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 176:bluetooth_rxtx.c **** 
 177:bluetooth_rxtx.c **** 	f->channel = (uint8_t)((channel - 2402) & 0xff);
 178:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 179:bluetooth_rxtx.c **** 	f->rssi_count = 0;
 180:bluetooth_rxtx.c **** 
 181:bluetooth_rxtx.c **** 	memcpy(f->data, buf, DMA_SIZE);
 182:bluetooth_rxtx.c **** 
 183:bluetooth_rxtx.c **** 	f->status = status;
 184:bluetooth_rxtx.c **** 	status = 0;
 185:bluetooth_rxtx.c **** 
 186:bluetooth_rxtx.c **** 	return 1;
 187:bluetooth_rxtx.c **** }
 188:bluetooth_rxtx.c **** 
 189:bluetooth_rxtx.c **** static int vendor_request_handler(uint8_t request, uint16_t* request_params, uint8_t* data, int* da
 190:bluetooth_rxtx.c **** {
 191:bluetooth_rxtx.c **** 	uint32_t clock;
 192:bluetooth_rxtx.c **** 	size_t length; // string length
 193:bluetooth_rxtx.c **** 	usb_pkt_rx* p = NULL;
 194:bluetooth_rxtx.c **** 	uint16_t reg_val;
 195:bluetooth_rxtx.c **** 	uint8_t i;
 196:bluetooth_rxtx.c **** 
 197:bluetooth_rxtx.c **** 	switch (request) {
 198:bluetooth_rxtx.c **** 
 199:bluetooth_rxtx.c **** 	case UBERTOOTH_PING:
 200:bluetooth_rxtx.c **** 		*data_len = 0;
 201:bluetooth_rxtx.c **** 		break;
 202:bluetooth_rxtx.c **** 
 203:bluetooth_rxtx.c **** 	case UBERTOOTH_RX_SYMBOLS:
 204:bluetooth_rxtx.c **** 		requested_mode = MODE_RX_SYMBOLS;
ARM GAS  /tmp/ccDKg7Fp.s 			page 5


 205:bluetooth_rxtx.c **** 		*data_len = 0;
 206:bluetooth_rxtx.c **** 		break;
 207:bluetooth_rxtx.c **** 
 208:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_SYMBOLS:
 209:bluetooth_rxtx.c **** 		hop_mode = HOP_BLUETOOTH;
 210:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_SYMBOLS;
 211:bluetooth_rxtx.c **** 		*data_len = 0;
 212:bluetooth_rxtx.c **** 		break;
 213:bluetooth_rxtx.c **** 
 214:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_USRLED:
 215:bluetooth_rxtx.c **** 		data[0] = (USRLED) ? 1 : 0;
 216:bluetooth_rxtx.c **** 		*data_len = 1;
 217:bluetooth_rxtx.c **** 		break;
 218:bluetooth_rxtx.c **** 
 219:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_USRLED:
 220:bluetooth_rxtx.c **** 		if (request_params[0])
 221:bluetooth_rxtx.c **** 			USRLED_SET;
 222:bluetooth_rxtx.c **** 		else
 223:bluetooth_rxtx.c **** 			USRLED_CLR;
 224:bluetooth_rxtx.c **** 		break;
 225:bluetooth_rxtx.c **** 
 226:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_RXLED:
 227:bluetooth_rxtx.c **** 		data[0] = (RXLED) ? 1 : 0;
 228:bluetooth_rxtx.c **** 		*data_len = 1;
 229:bluetooth_rxtx.c **** 		break;
 230:bluetooth_rxtx.c **** 
 231:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_RXLED:
 232:bluetooth_rxtx.c **** 		if (request_params[0])
 233:bluetooth_rxtx.c **** 			RXLED_SET;
 234:bluetooth_rxtx.c **** 		else
 235:bluetooth_rxtx.c **** 			RXLED_CLR;
 236:bluetooth_rxtx.c **** 		break;
 237:bluetooth_rxtx.c **** 
 238:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_TXLED:
 239:bluetooth_rxtx.c **** 		data[0] = (TXLED) ? 1 : 0;
 240:bluetooth_rxtx.c **** 		*data_len = 1;
 241:bluetooth_rxtx.c **** 		break;
 242:bluetooth_rxtx.c **** 
 243:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_TXLED:
 244:bluetooth_rxtx.c **** 		if (request_params[0])
 245:bluetooth_rxtx.c **** 			TXLED_SET;
 246:bluetooth_rxtx.c **** 		else
 247:bluetooth_rxtx.c **** 			TXLED_CLR;
 248:bluetooth_rxtx.c **** 		break;
 249:bluetooth_rxtx.c **** 
 250:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_1V8:
 251:bluetooth_rxtx.c **** 		data[0] = (CC1V8) ? 1 : 0;
 252:bluetooth_rxtx.c **** 		*data_len = 1;
 253:bluetooth_rxtx.c **** 		break;
 254:bluetooth_rxtx.c **** 
 255:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_1V8:
 256:bluetooth_rxtx.c **** 		if (request_params[0])
 257:bluetooth_rxtx.c **** 			CC1V8_SET;
 258:bluetooth_rxtx.c **** 		else
 259:bluetooth_rxtx.c **** 			CC1V8_CLR;
 260:bluetooth_rxtx.c **** 		break;
 261:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccDKg7Fp.s 			page 6


 262:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PARTNUM:
 263:bluetooth_rxtx.c **** 		get_part_num(data, data_len);
 264:bluetooth_rxtx.c **** 		break;
 265:bluetooth_rxtx.c **** 
 266:bluetooth_rxtx.c **** 	case UBERTOOTH_RESET:
 267:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 268:bluetooth_rxtx.c **** 		break;
 269:bluetooth_rxtx.c **** 
 270:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_SERIAL:
 271:bluetooth_rxtx.c **** 		get_device_serial(data, data_len);
 272:bluetooth_rxtx.c **** 		break;
 273:bluetooth_rxtx.c **** 
 274:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 275:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PAEN:
 276:bluetooth_rxtx.c **** 		data[0] = (PAEN) ? 1 : 0;
 277:bluetooth_rxtx.c **** 		*data_len = 1;
 278:bluetooth_rxtx.c **** 		break;
 279:bluetooth_rxtx.c **** 
 280:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_PAEN:
 281:bluetooth_rxtx.c **** 		if (request_params[0])
 282:bluetooth_rxtx.c **** 			PAEN_SET;
 283:bluetooth_rxtx.c **** 		else
 284:bluetooth_rxtx.c **** 			PAEN_CLR;
 285:bluetooth_rxtx.c **** 		break;
 286:bluetooth_rxtx.c **** 
 287:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_HGM:
 288:bluetooth_rxtx.c **** 		data[0] = (HGM) ? 1 : 0;
 289:bluetooth_rxtx.c **** 		*data_len = 1;
 290:bluetooth_rxtx.c **** 		break;
 291:bluetooth_rxtx.c **** 
 292:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_HGM:
 293:bluetooth_rxtx.c **** 		if (request_params[0])
 294:bluetooth_rxtx.c **** 			HGM_SET;
 295:bluetooth_rxtx.c **** 		else
 296:bluetooth_rxtx.c **** 			HGM_CLR;
 297:bluetooth_rxtx.c **** 		break;
 298:bluetooth_rxtx.c **** #endif
 299:bluetooth_rxtx.c **** 
 300:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 301:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_TEST:
 302:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_TEST;
 303:bluetooth_rxtx.c **** 		break;
 304:bluetooth_rxtx.c **** 
 305:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PALEVEL:
 306:bluetooth_rxtx.c **** 		data[0] = cc2400_get(FREND) & 0x7;
 307:bluetooth_rxtx.c **** 		*data_len = 1;
 308:bluetooth_rxtx.c **** 		break;
 309:bluetooth_rxtx.c **** 
 310:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_PALEVEL:
 311:bluetooth_rxtx.c **** 		if( request_params[0] < 8 ) {
 312:bluetooth_rxtx.c **** 			cc2400_set(FREND, 8 | request_params[0]);
 313:bluetooth_rxtx.c **** 		} else {
 314:bluetooth_rxtx.c **** 			return 0;
 315:bluetooth_rxtx.c **** 		}
 316:bluetooth_rxtx.c **** 		break;
 317:bluetooth_rxtx.c **** 
 318:bluetooth_rxtx.c **** 	case UBERTOOTH_RANGE_TEST:
ARM GAS  /tmp/ccDKg7Fp.s 			page 7


 319:bluetooth_rxtx.c **** 		requested_mode = MODE_RANGE_TEST;
 320:bluetooth_rxtx.c **** 		break;
 321:bluetooth_rxtx.c **** 
 322:bluetooth_rxtx.c **** 	case UBERTOOTH_REPEATER:
 323:bluetooth_rxtx.c **** 		requested_mode = MODE_REPEATER;
 324:bluetooth_rxtx.c **** 		break;
 325:bluetooth_rxtx.c **** #endif
 326:bluetooth_rxtx.c **** 
 327:bluetooth_rxtx.c **** 	case UBERTOOTH_RANGE_CHECK:
 328:bluetooth_rxtx.c **** 		data[0] = rr.valid;
 329:bluetooth_rxtx.c **** 		data[1] = rr.request_pa;
 330:bluetooth_rxtx.c **** 		data[2] = rr.request_num;
 331:bluetooth_rxtx.c **** 		data[3] = rr.reply_pa;
 332:bluetooth_rxtx.c **** 		data[4] = rr.reply_num;
 333:bluetooth_rxtx.c **** 		*data_len = 5;
 334:bluetooth_rxtx.c **** 		break;
 335:bluetooth_rxtx.c **** 
 336:bluetooth_rxtx.c **** 	case UBERTOOTH_STOP:
 337:bluetooth_rxtx.c **** 		requested_mode = MODE_IDLE;
 338:bluetooth_rxtx.c **** 		break;
 339:bluetooth_rxtx.c **** 
 340:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_MOD:
 341:bluetooth_rxtx.c **** 		data[0] = modulation;
 342:bluetooth_rxtx.c **** 		*data_len = 1;
 343:bluetooth_rxtx.c **** 		break;
 344:bluetooth_rxtx.c **** 
 345:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_MOD:
 346:bluetooth_rxtx.c **** 		modulation = request_params[0];
 347:bluetooth_rxtx.c **** 		break;
 348:bluetooth_rxtx.c **** 
 349:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CHANNEL:
 350:bluetooth_rxtx.c **** 		data[0] = channel & 0xFF;
 351:bluetooth_rxtx.c **** 		data[1] = (channel >> 8) & 0xFF;
 352:bluetooth_rxtx.c **** 		*data_len = 2;
 353:bluetooth_rxtx.c **** 		break;
 354:bluetooth_rxtx.c **** 
 355:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CHANNEL:
 356:bluetooth_rxtx.c **** 		requested_channel = request_params[0];
 357:bluetooth_rxtx.c **** 		/* bluetooth band sweep mode, start at channel 2402 */
 358:bluetooth_rxtx.c **** 		if (requested_channel > MAX_FREQ) {
 359:bluetooth_rxtx.c **** 			hop_mode = HOP_SWEEP;
 360:bluetooth_rxtx.c **** 			requested_channel = 2402;
 361:bluetooth_rxtx.c **** 		}
 362:bluetooth_rxtx.c **** 		/* fixed channel mode, can be outside bluetooth band */
 363:bluetooth_rxtx.c **** 		else {
 364:bluetooth_rxtx.c **** 			hop_mode = HOP_NONE;
 365:bluetooth_rxtx.c **** 			requested_channel = MAX(requested_channel, MIN_FREQ);
 366:bluetooth_rxtx.c **** 			requested_channel = MIN(requested_channel, MAX_FREQ);
 367:bluetooth_rxtx.c **** 		}
 368:bluetooth_rxtx.c **** 
 369:bluetooth_rxtx.c **** 		le_adv_channel = requested_channel;
 370:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
 371:bluetooth_rxtx.c **** 			channel = requested_channel;
 372:bluetooth_rxtx.c **** 			requested_channel = 0;
 373:bluetooth_rxtx.c **** 
 374:bluetooth_rxtx.c **** 			/* CS threshold is mode-dependent. Update it after
 375:bluetooth_rxtx.c **** 			 * possible mode change. TODO - kludgy. */
ARM GAS  /tmp/ccDKg7Fp.s 			page 8


 376:bluetooth_rxtx.c **** 			cs_threshold_calc_and_set(channel);
 377:bluetooth_rxtx.c **** 		}
 378:bluetooth_rxtx.c **** 		break;
 379:bluetooth_rxtx.c **** 
 380:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_ISP:
 381:bluetooth_rxtx.c **** 		set_isp();
 382:bluetooth_rxtx.c **** 		*data_len = 0; /* should never return */
 383:bluetooth_rxtx.c **** 		break;
 384:bluetooth_rxtx.c **** 
 385:bluetooth_rxtx.c **** 	case UBERTOOTH_FLASH:
 386:bluetooth_rxtx.c **** 		bootloader_ctrl = DFU_MODE;
 387:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 388:bluetooth_rxtx.c **** 		break;
 389:bluetooth_rxtx.c **** 
 390:bluetooth_rxtx.c **** 	case UBERTOOTH_SPECAN:
 391:bluetooth_rxtx.c **** 		if (request_params[0] < 2049 || request_params[0] > 3072 ||
 392:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 393:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 394:bluetooth_rxtx.c **** 			return 0;
 395:bluetooth_rxtx.c **** 		low_freq = request_params[0];
 396:bluetooth_rxtx.c **** 		high_freq = request_params[1];
 397:bluetooth_rxtx.c **** 		requested_mode = MODE_SPECAN;
 398:bluetooth_rxtx.c **** 		*data_len = 0;
 399:bluetooth_rxtx.c **** 		break;
 400:bluetooth_rxtx.c **** 
 401:bluetooth_rxtx.c **** 	case UBERTOOTH_RX_GENERIC:
 402:bluetooth_rxtx.c **** 		requested_mode = MODE_RX_GENERIC;
 403:bluetooth_rxtx.c **** 		*data_len = 0;
 404:bluetooth_rxtx.c **** 		break;
 405:bluetooth_rxtx.c **** 
 406:bluetooth_rxtx.c **** 	case UBERTOOTH_LED_SPECAN:
 407:bluetooth_rxtx.c **** 		if (request_params[0] > 256)
 408:bluetooth_rxtx.c **** 			return 0;
 409:bluetooth_rxtx.c **** 		rssi_threshold = 54 - request_params[0];
 410:bluetooth_rxtx.c **** 		requested_mode = MODE_LED_SPECAN;
 411:bluetooth_rxtx.c **** 		*data_len = 0;
 412:bluetooth_rxtx.c **** 		break;
 413:bluetooth_rxtx.c **** 
 414:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_REV_NUM:
 415:bluetooth_rxtx.c **** 		data[0] = 0x00;
 416:bluetooth_rxtx.c **** 		data[1] = 0x00;
 417:bluetooth_rxtx.c **** 
 418:bluetooth_rxtx.c **** 		length = (u8)strlen(GIT_REVISION);
 419:bluetooth_rxtx.c **** 		data[2] = length;
 420:bluetooth_rxtx.c **** 
 421:bluetooth_rxtx.c **** 		memcpy(&data[3], GIT_REVISION, length);
 422:bluetooth_rxtx.c **** 
 423:bluetooth_rxtx.c **** 		*data_len = 2 + 1 + length;
 424:bluetooth_rxtx.c **** 		break;
 425:bluetooth_rxtx.c **** 
 426:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_COMPILE_INFO:
 427:bluetooth_rxtx.c **** 		length = (u8)strlen(compile_info);
 428:bluetooth_rxtx.c **** 		data[0] = length;
 429:bluetooth_rxtx.c **** 		memcpy(&data[1], compile_info, length);
 430:bluetooth_rxtx.c **** 		*data_len = 1 + length;
 431:bluetooth_rxtx.c **** 		break;
 432:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccDKg7Fp.s 			page 9


 433:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_BOARD_ID:
 434:bluetooth_rxtx.c **** 		data[0] = BOARD_ID;
 435:bluetooth_rxtx.c **** 		*data_len = 1;
 436:bluetooth_rxtx.c **** 		break;
 437:bluetooth_rxtx.c **** 
 438:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_SQUELCH:
 439:bluetooth_rxtx.c **** 		cs_threshold_req = (int8_t)request_params[0];
 440:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 441:bluetooth_rxtx.c **** 		break;
 442:bluetooth_rxtx.c **** 
 443:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_SQUELCH:
 444:bluetooth_rxtx.c **** 		data[0] = cs_threshold_req;
 445:bluetooth_rxtx.c **** 		*data_len = 1;
 446:bluetooth_rxtx.c **** 		break;
 447:bluetooth_rxtx.c **** 
 448:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_BDADDR:
 449:bluetooth_rxtx.c **** 		target.address = 0;
 450:bluetooth_rxtx.c **** 		target.syncword = 0;
 451:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 452:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 453:bluetooth_rxtx.c **** 		}
 454:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 455:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 456:bluetooth_rxtx.c **** 		}
 457:bluetooth_rxtx.c **** 		precalc();
 458:bluetooth_rxtx.c **** 		break;
 459:bluetooth_rxtx.c **** 
 460:bluetooth_rxtx.c **** 	case UBERTOOTH_START_HOPPING:
 461:bluetooth_rxtx.c **** 		clkn_offset = 0;
 462:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 463:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 464:bluetooth_rxtx.c **** 			clkn_offset |= data[i];
 465:bluetooth_rxtx.c **** 		}
 466:bluetooth_rxtx.c **** 		hop_mode = HOP_BLUETOOTH;
 467:bluetooth_rxtx.c **** 		dma_discard = 1;
 468:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 469:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 470:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW;
 471:bluetooth_rxtx.c **** 		break;
 472:bluetooth_rxtx.c **** 
 473:bluetooth_rxtx.c **** 	case UBERTOOTH_AFH:
 474:bluetooth_rxtx.c **** 		hop_mode = HOP_AFH;
 475:bluetooth_rxtx.c **** 		requested_mode = MODE_AFH;
 476:bluetooth_rxtx.c **** 
 477:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
 478:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 479:bluetooth_rxtx.c **** 		}
 480:bluetooth_rxtx.c **** 		used_channels = 0;
 481:bluetooth_rxtx.c **** 		afh_enabled = 1;
 482:bluetooth_rxtx.c **** 		break;
 483:bluetooth_rxtx.c **** 
 484:bluetooth_rxtx.c **** 	case UBERTOOTH_HOP:
 485:bluetooth_rxtx.c **** 		do_hop = 1;
 486:bluetooth_rxtx.c **** 		break;
 487:bluetooth_rxtx.c **** 
 488:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CLOCK:
 489:bluetooth_rxtx.c **** 		clock = data[0] | data[1] << 8 | data[2] << 16 | data[3] << 24;
ARM GAS  /tmp/ccDKg7Fp.s 			page 10


 490:bluetooth_rxtx.c **** 		clkn = clock;
 491:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 492:bluetooth_rxtx.c **** 		break;
 493:bluetooth_rxtx.c **** 
 494:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_AFHMAP:
 495:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
 496:bluetooth_rxtx.c **** 			afh_map[i] = data[i];
 497:bluetooth_rxtx.c **** 		}
 498:bluetooth_rxtx.c **** 		afh_enabled = 1;
 499:bluetooth_rxtx.c **** 		*data_len = 10;
 500:bluetooth_rxtx.c **** 		break;
 501:bluetooth_rxtx.c **** 
 502:bluetooth_rxtx.c **** 	case UBERTOOTH_CLEAR_AFHMAP:
 503:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
 504:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 505:bluetooth_rxtx.c **** 		}
 506:bluetooth_rxtx.c **** 		afh_enabled = 0;
 507:bluetooth_rxtx.c **** 		*data_len = 10;
 508:bluetooth_rxtx.c **** 		break;
 509:bluetooth_rxtx.c **** 
 510:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CLOCK:
 511:bluetooth_rxtx.c **** 		clock = clkn;
 512:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 513:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 514:bluetooth_rxtx.c **** 		}
 515:bluetooth_rxtx.c **** 		*data_len = 4;
 516:bluetooth_rxtx.c **** 		break;
 517:bluetooth_rxtx.c **** 
 518:bluetooth_rxtx.c **** 	case UBERTOOTH_TRIM_CLOCK:
 519:bluetooth_rxtx.c **** 		clk100ns_offset = (data[0] << 8) | (data[1] << 0);
 520:bluetooth_rxtx.c **** 		break;
 521:bluetooth_rxtx.c **** 
 522:bluetooth_rxtx.c **** 	case UBERTOOTH_FIX_CLOCK_DRIFT:
 523:bluetooth_rxtx.c **** 		clk_drift_ppm += (int16_t)(data[0] << 8) | (data[1] << 0);
 524:bluetooth_rxtx.c **** 
 525:bluetooth_rxtx.c **** 		// Too slow
 526:bluetooth_rxtx.c **** 		if (clk_drift_ppm < 0) {
 527:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / (uint16_t)(-clk_drift_ppm);
 528:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 529:bluetooth_rxtx.c **** 		}
 530:bluetooth_rxtx.c **** 		// Too fast
 531:bluetooth_rxtx.c **** 		else if (clk_drift_ppm > 0) {
 532:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / clk_drift_ppm;
 533:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 534:bluetooth_rxtx.c **** 		}
 535:bluetooth_rxtx.c **** 		// Don't trim
 536:bluetooth_rxtx.c **** 		else {
 537:bluetooth_rxtx.c **** 			clk_drift_correction = 0;
 538:bluetooth_rxtx.c **** 			clkn_next_drift_fix = 0;
 539:bluetooth_rxtx.c **** 		}
 540:bluetooth_rxtx.c **** 
 541:bluetooth_rxtx.c **** 		break;
 542:bluetooth_rxtx.c **** 
 543:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SNIFFING:
 544:bluetooth_rxtx.c **** 		le.do_follow = request_params[0];
 545:bluetooth_rxtx.c **** 		*data_len = 0;
 546:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccDKg7Fp.s 			page 11


 547:bluetooth_rxtx.c **** 		do_hop = 0;
 548:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 549:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW_LE;
 550:bluetooth_rxtx.c **** 
 551:bluetooth_rxtx.c **** 		usb_queue_init();
 552:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 553:bluetooth_rxtx.c **** 		break;
 554:bluetooth_rxtx.c **** 
 555:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_ACCESS_ADDRESS:
 556:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 557:bluetooth_rxtx.c **** 			data[i] = (le.access_address >> (8*i)) & 0xff;
 558:bluetooth_rxtx.c **** 		}
 559:bluetooth_rxtx.c **** 		*data_len = 4;
 560:bluetooth_rxtx.c **** 		break;
 561:bluetooth_rxtx.c **** 
 562:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_ACCESS_ADDRESS:
 563:bluetooth_rxtx.c **** 		le_set_access_address(data[0] | data[1] << 8 | data[2] << 16 | data[3] << 24);
 564:bluetooth_rxtx.c **** 		le.target_set = 1;
 565:bluetooth_rxtx.c **** 		break;
 566:bluetooth_rxtx.c **** 
 567:bluetooth_rxtx.c **** 	case UBERTOOTH_DO_SOMETHING:
 568:bluetooth_rxtx.c **** 		// do something! just don't commit anything here
 569:bluetooth_rxtx.c **** 		break;
 570:bluetooth_rxtx.c **** 
 571:bluetooth_rxtx.c **** 	case UBERTOOTH_DO_SOMETHING_REPLY:
 572:bluetooth_rxtx.c **** 		// after you do something, tell me what you did!
 573:bluetooth_rxtx.c **** 		// don't commit here please
 574:bluetooth_rxtx.c **** 		data[0] = 0x13;
 575:bluetooth_rxtx.c **** 		data[1] = 0x37;
 576:bluetooth_rxtx.c **** 		*data_len = 2;
 577:bluetooth_rxtx.c **** 		break;
 578:bluetooth_rxtx.c **** 
 579:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CRC_VERIFY:
 580:bluetooth_rxtx.c **** 		data[0] = le.crc_verify ? 1 : 0;
 581:bluetooth_rxtx.c **** 		*data_len = 1;
 582:bluetooth_rxtx.c **** 		break;
 583:bluetooth_rxtx.c **** 
 584:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CRC_VERIFY:
 585:bluetooth_rxtx.c **** 		le.crc_verify = request_params[0] ? 1 : 0;
 586:bluetooth_rxtx.c **** 		break;
 587:bluetooth_rxtx.c **** 
 588:bluetooth_rxtx.c **** 	case UBERTOOTH_POLL:
 589:bluetooth_rxtx.c **** 		p = dequeue();
 590:bluetooth_rxtx.c **** 		if (p != NULL) {
 591:bluetooth_rxtx.c **** 			memcpy(data, (void *)p, sizeof(usb_pkt_rx));
 592:bluetooth_rxtx.c **** 			*data_len = sizeof(usb_pkt_rx);
 593:bluetooth_rxtx.c **** 		} else {
 594:bluetooth_rxtx.c **** 			data[0] = 0;
 595:bluetooth_rxtx.c **** 			*data_len = 1;
 596:bluetooth_rxtx.c **** 		}
 597:bluetooth_rxtx.c **** 		break;
 598:bluetooth_rxtx.c **** 
 599:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_PROMISC:
 600:bluetooth_rxtx.c **** 		*data_len = 0;
 601:bluetooth_rxtx.c **** 
 602:bluetooth_rxtx.c **** 		hop_mode = HOP_NONE;
 603:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_PROMISC_LE;
ARM GAS  /tmp/ccDKg7Fp.s 			page 12


 604:bluetooth_rxtx.c **** 
 605:bluetooth_rxtx.c **** 		usb_queue_init();
 606:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 607:bluetooth_rxtx.c **** 		break;
 608:bluetooth_rxtx.c **** 
 609:bluetooth_rxtx.c **** 	case UBERTOOTH_READ_REGISTER:
 610:bluetooth_rxtx.c **** 		reg_val = cc2400_get(request_params[0]);
 611:bluetooth_rxtx.c **** 		data[0] = (reg_val >> 8) & 0xff;
 612:bluetooth_rxtx.c **** 		data[1] = reg_val & 0xff;
 613:bluetooth_rxtx.c **** 		*data_len = 2;
 614:bluetooth_rxtx.c **** 		break;
 615:bluetooth_rxtx.c **** 
 616:bluetooth_rxtx.c **** 	case UBERTOOTH_WRITE_REGISTER:
 617:bluetooth_rxtx.c **** 		cc2400_set(request_params[0] & 0xff, request_params[1]);
 618:bluetooth_rxtx.c **** 		break;
 619:bluetooth_rxtx.c **** 
 620:bluetooth_rxtx.c **** 	case UBERTOOTH_WRITE_REGISTERS:
 621:bluetooth_rxtx.c **** 		for(i=0; i<request_params[0]; i++) {
 622:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 623:bluetooth_rxtx.c **** 			cc2400_set(data[i*3], reg_val);
 624:bluetooth_rxtx.c **** 		}
 625:bluetooth_rxtx.c **** 		break;
 626:bluetooth_rxtx.c **** 
 627:bluetooth_rxtx.c **** 	case UBERTOOTH_READ_ALL_REGISTERS:
 628:bluetooth_rxtx.c **** 		#define MAX_READ_REG 0x2d
 629:bluetooth_rxtx.c **** 		for(i=0; i<=MAX_READ_REG; i++) {
 630:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 631:bluetooth_rxtx.c **** 			data[i*3] = i;
 632:bluetooth_rxtx.c **** 			data[(i*3)+1] = (reg_val >> 8) & 0xff;
 633:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 634:bluetooth_rxtx.c **** 		}
 635:bluetooth_rxtx.c **** 		*data_len = MAX_READ_REG*3;
 636:bluetooth_rxtx.c **** 		break;
 637:bluetooth_rxtx.c **** 
 638:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_GENERIC_PACKET:
 639:bluetooth_rxtx.c **** 		i = 7 + data[6];
 640:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 641:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 642:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_GENERIC;
 643:bluetooth_rxtx.c **** 		*data_len = 0;
 644:bluetooth_rxtx.c **** 		break;
 645:bluetooth_rxtx.c **** 
 646:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE:
 647:bluetooth_rxtx.c **** 		memcpy(slave_mac_address, data, 6);
 648:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE;
 649:bluetooth_rxtx.c **** 		break;
 650:bluetooth_rxtx.c **** 
 651:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SET_TARGET:
 652:bluetooth_rxtx.c **** 		// Addresses appear in packets in reverse-octet order.
 653:bluetooth_rxtx.c **** 		// Store the target address in reverse order so that we can do a simple memcmp later
 654:bluetooth_rxtx.c **** 		if (data[6] > 48) {
 655:bluetooth_rxtx.c **** 			return 1; // invalid mask
 656:bluetooth_rxtx.c **** 		}
 657:bluetooth_rxtx.c **** 		else if (data[6] == 0) {
 658:bluetooth_rxtx.c **** 			le.target_set = 0;
 659:bluetooth_rxtx.c **** 			memset(le.target, 0, 6);
 660:bluetooth_rxtx.c **** 			memset(le.target_mask, 0, 6);
ARM GAS  /tmp/ccDKg7Fp.s 			page 13


 661:bluetooth_rxtx.c **** 		} else {
 662:bluetooth_rxtx.c **** 			unsigned last;
 663:bluetooth_rxtx.c **** 
 664:bluetooth_rxtx.c **** 			for (i = 0; i < 6; ++i)
 665:bluetooth_rxtx.c **** 				le.target[i] = data[5-i];
 666:bluetooth_rxtx.c **** 
 667:bluetooth_rxtx.c **** 			// compute mask
 668:bluetooth_rxtx.c **** 			memset(le.target_mask, 0, 6);
 669:bluetooth_rxtx.c **** 			for (i = 5; data[6] > 8; --i, data[6] -= 8) {
 670:bluetooth_rxtx.c **** 				le.target_mask[i] = 0xff;
 671:bluetooth_rxtx.c **** 			}
 672:bluetooth_rxtx.c **** 			last = i;
 673:bluetooth_rxtx.c **** 
 674:bluetooth_rxtx.c **** 			if (data[6] > 0) {
 675:bluetooth_rxtx.c **** 				uint8_t final_byte = 0;
 676:bluetooth_rxtx.c **** 				for (i = 0; i < data[6]; ++i) {
 677:bluetooth_rxtx.c **** 					final_byte >>= 1;
 678:bluetooth_rxtx.c **** 					final_byte |= 0b10000000;
 679:bluetooth_rxtx.c **** 				}
 680:bluetooth_rxtx.c **** 				le.target_mask[last] = final_byte;
 681:bluetooth_rxtx.c **** 			}
 682:bluetooth_rxtx.c **** 
 683:bluetooth_rxtx.c **** 			// in case the user specifies a bad mask
 684:bluetooth_rxtx.c **** 			for (i = 0; i < 5; ++i)
 685:bluetooth_rxtx.c **** 				le.target[i] &= le.target_mask[i];
 686:bluetooth_rxtx.c **** 
 687:bluetooth_rxtx.c **** 			le.target_set = 1;
 688:bluetooth_rxtx.c **** 		}
 689:bluetooth_rxtx.c **** 		break;
 690:bluetooth_rxtx.c **** 
 691:bluetooth_rxtx.c **** 	case UBERTOOTH_CANCEL_FOLLOW:
 692:bluetooth_rxtx.c **** 		// cancel following an active connection
 693:bluetooth_rxtx.c **** 		cancel_follow = 1;
 694:bluetooth_rxtx.c **** 		break;
 695:bluetooth_rxtx.c **** 
 696:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 697:bluetooth_rxtx.c **** 	case UBERTOOTH_JAM_MODE:
 698:bluetooth_rxtx.c **** 		jam_mode = request_params[0];
 699:bluetooth_rxtx.c **** 		break;
 700:bluetooth_rxtx.c **** #endif
 701:bluetooth_rxtx.c **** 
 702:bluetooth_rxtx.c **** 	case UBERTOOTH_EGO:
 703:bluetooth_rxtx.c **** #ifndef TX_ENABLE
 704:bluetooth_rxtx.c **** 		if (ego_mode == EGO_JAM)
 705:bluetooth_rxtx.c **** 			return 0;
 706:bluetooth_rxtx.c **** #endif
 707:bluetooth_rxtx.c **** 		requested_mode = MODE_EGO;
 708:bluetooth_rxtx.c **** 		ego_mode = request_params[0];
 709:bluetooth_rxtx.c **** 		break;
 710:bluetooth_rxtx.c **** 
 711:bluetooth_rxtx.c **** 	default:
 712:bluetooth_rxtx.c **** 		return 0;
 713:bluetooth_rxtx.c **** 	}
 714:bluetooth_rxtx.c **** 	return 1;
 715:bluetooth_rxtx.c **** }
 716:bluetooth_rxtx.c **** 
 717:bluetooth_rxtx.c **** /* Update CLKN. */
ARM GAS  /tmp/ccDKg7Fp.s 			page 14


 718:bluetooth_rxtx.c **** void TIMER0_IRQHandler()
 719:bluetooth_rxtx.c **** {
 720:bluetooth_rxtx.c **** 	if (T0IR & TIR_MR0_Interrupt) {
 721:bluetooth_rxtx.c **** 
 722:bluetooth_rxtx.c **** 		clkn += clkn_offset + 1;
 723:bluetooth_rxtx.c **** 		clkn_offset = 0;
 724:bluetooth_rxtx.c **** 
 725:bluetooth_rxtx.c **** 		uint32_t le_clk = (clkn - le.conn_epoch) & 0x03;
 726:bluetooth_rxtx.c **** 
 727:bluetooth_rxtx.c **** 		/* Trigger hop based on mode */
 728:bluetooth_rxtx.c **** 
 729:bluetooth_rxtx.c **** 		/* NONE or SWEEP -> 25 Hz */
 730:bluetooth_rxtx.c **** 		if (hop_mode == HOP_NONE || hop_mode == HOP_SWEEP) {
 731:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 732:bluetooth_rxtx.c **** 				do_hop = 1;
 733:bluetooth_rxtx.c **** 		}
 734:bluetooth_rxtx.c **** 		/* BLUETOOTH -> 1600 Hz */
 735:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_BLUETOOTH) {
 736:bluetooth_rxtx.c **** 			if ((clkn & 0x1) == 0)
 737:bluetooth_rxtx.c **** 				do_hop = 1;
 738:bluetooth_rxtx.c **** 		}
 739:bluetooth_rxtx.c **** 		/* BLUETOOTH Low Energy -> 7.5ms - 4.0s in multiples of 1.25 ms */
 740:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_BTLE) {
 741:bluetooth_rxtx.c **** 			// Only hop if connected
 742:bluetooth_rxtx.c **** 			if (le.link_state == LINK_CONNECTED && le_clk == 0) {
 743:bluetooth_rxtx.c **** 				--le.interval_timer;
 744:bluetooth_rxtx.c **** 				if (le.interval_timer == 0) {
 745:bluetooth_rxtx.c **** 					do_hop = 1;
 746:bluetooth_rxtx.c **** 					++le.conn_count;
 747:bluetooth_rxtx.c **** 					le.interval_timer = le.conn_interval;
 748:bluetooth_rxtx.c **** 				} else {
 749:bluetooth_rxtx.c **** 					TXLED_CLR; // hack!
 750:bluetooth_rxtx.c **** 				}
 751:bluetooth_rxtx.c **** 			}
 752:bluetooth_rxtx.c **** 		}
 753:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_AFH) {
 754:bluetooth_rxtx.c **** 			if( (last_hop + hop_timeout) == clkn ) {
 755:bluetooth_rxtx.c **** 				do_hop = 1;
 756:bluetooth_rxtx.c **** 			}
 757:bluetooth_rxtx.c **** 		}
 758:bluetooth_rxtx.c **** 
 759:bluetooth_rxtx.c **** 		// Fix linear clock drift deviation
 760:bluetooth_rxtx.c **** 		if(clkn_next_drift_fix != 0 && clk100ns_offset == 0) {
 761:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
 762:bluetooth_rxtx.c **** 
 763:bluetooth_rxtx.c **** 				// Too fast
 764:bluetooth_rxtx.c **** 				if(clk_drift_ppm >= 0) {
 765:bluetooth_rxtx.c **** 					clk100ns_offset = 1;
 766:bluetooth_rxtx.c **** 				}
 767:bluetooth_rxtx.c **** 
 768:bluetooth_rxtx.c **** 				// Too slow
 769:bluetooth_rxtx.c **** 				else {
 770:bluetooth_rxtx.c **** 					clk100ns_offset = 6249;
 771:bluetooth_rxtx.c **** 				}
 772:bluetooth_rxtx.c **** 				clkn_last_drift_fix = clkn;
 773:bluetooth_rxtx.c **** 				clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 774:bluetooth_rxtx.c **** 			}
ARM GAS  /tmp/ccDKg7Fp.s 			page 15


 775:bluetooth_rxtx.c **** 		}
 776:bluetooth_rxtx.c **** 
 777:bluetooth_rxtx.c **** 		// Negative clock correction
 778:bluetooth_rxtx.c **** 		if(clk100ns_offset > 3124)
 779:bluetooth_rxtx.c **** 			clkn += 2;
 780:bluetooth_rxtx.c **** 
 781:bluetooth_rxtx.c **** 		T0MR0 = 3124 + clk100ns_offset;
 782:bluetooth_rxtx.c **** 		clk100ns_offset = 0;
 783:bluetooth_rxtx.c **** 
 784:bluetooth_rxtx.c **** 		/* Ack interrupt */
 785:bluetooth_rxtx.c **** 		T0IR = TIR_MR0_Interrupt;
 786:bluetooth_rxtx.c **** 	}
 787:bluetooth_rxtx.c **** }
 788:bluetooth_rxtx.c **** 
 789:bluetooth_rxtx.c **** /* EINT3 handler is also defined in ubertooth.c for TC13BADGE. */
 790:bluetooth_rxtx.c **** #ifndef TC13BADGE
 791:bluetooth_rxtx.c **** void EINT3_IRQHandler()
 792:bluetooth_rxtx.c **** {
 793:bluetooth_rxtx.c **** 	/* TODO - check specific source of shared interrupt */
 794:bluetooth_rxtx.c **** 	IO2IntClr   = PIN_GIO6; // clear interrupt
 795:bluetooth_rxtx.c **** 	DIO_SSEL_CLR;           // enable SPI
 796:bluetooth_rxtx.c **** 	cs_trigger  = 1;        // signal trigger
 797:bluetooth_rxtx.c **** 	if (hop_mode == HOP_BLUETOOTH)
 798:bluetooth_rxtx.c **** 		dma_discard = 0;
 799:bluetooth_rxtx.c **** 
 800:bluetooth_rxtx.c **** }
 801:bluetooth_rxtx.c **** #endif // TC13BADGE
 802:bluetooth_rxtx.c **** 
 803:bluetooth_rxtx.c **** /*
 804:bluetooth_rxtx.c ****  * Sleep (busy wait) for 'millis' milliseconds
 805:bluetooth_rxtx.c ****  * Needs clkn. Be sure to call clkn_init() before using it.
 806:bluetooth_rxtx.c ****  */
 807:bluetooth_rxtx.c **** static void msleep(uint32_t millis)
 808:bluetooth_rxtx.c **** {
 809:bluetooth_rxtx.c **** 	uint32_t now = (clkn & 0xffffff);
 810:bluetooth_rxtx.c **** 	uint32_t stop_at = now + millis * 10000 / 3125; // millis -> clkn ticks
 811:bluetooth_rxtx.c **** 
 812:bluetooth_rxtx.c **** 	// handle clkn overflow
 813:bluetooth_rxtx.c **** 	if (stop_at >= ((uint32_t)1<<28)) {
 814:bluetooth_rxtx.c **** 		stop_at -= ((uint32_t)1<<28);
 815:bluetooth_rxtx.c **** 		while ((clkn & 0xffffff) >= now || (clkn & 0xffffff) < stop_at);
 816:bluetooth_rxtx.c **** 	} else {
 817:bluetooth_rxtx.c **** 		while ((clkn & 0xffffff) < stop_at);
 818:bluetooth_rxtx.c **** 	}
 819:bluetooth_rxtx.c **** }
 820:bluetooth_rxtx.c **** 
 821:bluetooth_rxtx.c **** void legacy_DMA_IRQHandler();
 822:bluetooth_rxtx.c **** void le_DMA_IRQHandler();
 823:bluetooth_rxtx.c **** void DMA_IRQHandler(void) {
 824:bluetooth_rxtx.c **** 	if (mode == MODE_BT_FOLLOW_LE)
 825:bluetooth_rxtx.c **** 		le_DMA_IRQHandler();
 826:bluetooth_rxtx.c **** 	else
 827:bluetooth_rxtx.c **** 		legacy_DMA_IRQHandler();
 828:bluetooth_rxtx.c **** 
 829:bluetooth_rxtx.c **** 	// DMA channel 7: debug UART
 830:bluetooth_rxtx.c **** 	if (DMACIntStat & (1 << 7)) {
 831:bluetooth_rxtx.c **** 		// TC -- DMA completed, unset flag so another printf can occur
ARM GAS  /tmp/ccDKg7Fp.s 			page 16


 832:bluetooth_rxtx.c **** 		if (DMACIntTCStat & (1 << 7)) {
 833:bluetooth_rxtx.c **** 			DMACIntTCClear = (1 << 7);
 834:bluetooth_rxtx.c **** 			debug_dma_active = 0;
 835:bluetooth_rxtx.c **** 		}
 836:bluetooth_rxtx.c **** 		// error -- blow up
 837:bluetooth_rxtx.c **** 		if (DMACIntErrStat & (1 << 7)) {
 838:bluetooth_rxtx.c **** 			DMACIntErrClr = (1 << 7);
 839:bluetooth_rxtx.c **** 			// FIXME do something better here
 840:bluetooth_rxtx.c **** 			USRLED_SET;
 841:bluetooth_rxtx.c **** 			while (1) { }
 842:bluetooth_rxtx.c **** 		}
 843:bluetooth_rxtx.c **** 	}
 844:bluetooth_rxtx.c **** }
 845:bluetooth_rxtx.c **** 
 846:bluetooth_rxtx.c **** void legacy_DMA_IRQHandler()
 847:bluetooth_rxtx.c **** {
 848:bluetooth_rxtx.c **** 	if ( mode == MODE_RX_SYMBOLS
 849:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW
 850:bluetooth_rxtx.c **** 	   || mode == MODE_SPECAN
 851:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW_LE
 852:bluetooth_rxtx.c **** 	   || mode == MODE_BT_PROMISC_LE
 853:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE
 854:bluetooth_rxtx.c **** 	   || mode == MODE_RX_GENERIC)
 855:bluetooth_rxtx.c **** 	{
 856:bluetooth_rxtx.c **** 		/* interrupt on channel 0 */
 857:bluetooth_rxtx.c **** 		if (DMACIntStat & (1 << 0)) {
 858:bluetooth_rxtx.c **** 			if (DMACIntTCStat & (1 << 0)) {
 859:bluetooth_rxtx.c **** 				DMACIntTCClear = (1 << 0);
 860:bluetooth_rxtx.c **** 
 861:bluetooth_rxtx.c **** 				if (hop_mode == HOP_BLUETOOTH)
 862:bluetooth_rxtx.c **** 					DIO_SSEL_SET;
 863:bluetooth_rxtx.c **** 
 864:bluetooth_rxtx.c **** 				idle_buf_clk100ns  = CLK100NS;
 865:bluetooth_rxtx.c **** 				idle_buf_clkn_high = (clkn >> 20) & 0xff;
 866:bluetooth_rxtx.c **** 				idle_buf_channel   = channel;
 867:bluetooth_rxtx.c **** 
 868:bluetooth_rxtx.c **** 				/* Keep buffer swapping in sync with DMA. */
 869:bluetooth_rxtx.c **** 				volatile uint8_t* tmp = active_rxbuf;
 870:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 871:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 872:bluetooth_rxtx.c **** 
 873:bluetooth_rxtx.c **** 				++rx_tc;
 874:bluetooth_rxtx.c **** 			}
 875:bluetooth_rxtx.c **** 			if (DMACIntErrStat & (1 << 0)) {
 876:bluetooth_rxtx.c **** 				DMACIntErrClr = (1 << 0);
 877:bluetooth_rxtx.c **** 				++rx_err;
 878:bluetooth_rxtx.c **** 			}
 879:bluetooth_rxtx.c **** 		}
 880:bluetooth_rxtx.c **** 	}
 881:bluetooth_rxtx.c **** }
 882:bluetooth_rxtx.c **** 
 883:bluetooth_rxtx.c **** static void cc2400_idle()
 884:bluetooth_rxtx.c **** {
 885:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 886:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 887:bluetooth_rxtx.c **** 
 888:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
ARM GAS  /tmp/ccDKg7Fp.s 			page 17


 889:bluetooth_rxtx.c **** 	PAEN_CLR;
 890:bluetooth_rxtx.c **** 	HGM_CLR;
 891:bluetooth_rxtx.c **** #endif
 892:bluetooth_rxtx.c **** 
 893:bluetooth_rxtx.c **** 	RXLED_CLR;
 894:bluetooth_rxtx.c **** 	TXLED_CLR;
 895:bluetooth_rxtx.c **** 	USRLED_CLR;
 896:bluetooth_rxtx.c **** 
 897:bluetooth_rxtx.c **** 	clkn_stop();
 898:bluetooth_rxtx.c **** 	dio_ssp_stop();
 899:bluetooth_rxtx.c **** 	cs_reset();
 900:bluetooth_rxtx.c **** 	rssi_reset();
 901:bluetooth_rxtx.c **** 
 902:bluetooth_rxtx.c **** 	/* hopping stuff */
 903:bluetooth_rxtx.c **** 	hop_mode = HOP_NONE;
 904:bluetooth_rxtx.c **** 	do_hop = 0;
 905:bluetooth_rxtx.c **** 	channel = 2441;
 906:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 907:bluetooth_rxtx.c **** 	hop_timeout = 158;
 908:bluetooth_rxtx.c **** 	requested_channel = 0;
 909:bluetooth_rxtx.c **** 	le_adv_channel = 2402;
 910:bluetooth_rxtx.c **** 
 911:bluetooth_rxtx.c **** 
 912:bluetooth_rxtx.c **** 	/* bulk USB stuff */
 913:bluetooth_rxtx.c **** 	idle_buf_clkn_high = 0;
 914:bluetooth_rxtx.c **** 	idle_buf_clk100ns = 0;
 915:bluetooth_rxtx.c **** 	idle_buf_channel = 0;
 916:bluetooth_rxtx.c **** 	dma_discard = 0;
 917:bluetooth_rxtx.c **** 	status = 0;
 918:bluetooth_rxtx.c **** 
 919:bluetooth_rxtx.c **** 	/* operation mode */
 920:bluetooth_rxtx.c **** 	mode = MODE_IDLE;
 921:bluetooth_rxtx.c **** 	requested_mode = MODE_IDLE;
 922:bluetooth_rxtx.c **** 	jam_mode = JAM_NONE;
 923:bluetooth_rxtx.c **** 	ego_mode = EGO_FOLLOW;
 924:bluetooth_rxtx.c **** 
 925:bluetooth_rxtx.c **** 	modulation = MOD_BT_BASIC_RATE;
 926:bluetooth_rxtx.c **** 
 927:bluetooth_rxtx.c **** 	/* specan stuff */
 928:bluetooth_rxtx.c **** 	low_freq = 2400;
 929:bluetooth_rxtx.c **** 	high_freq = 2483;
 930:bluetooth_rxtx.c **** 	rssi_threshold = -30;
 931:bluetooth_rxtx.c **** 
 932:bluetooth_rxtx.c **** 	target.address = 0;
 933:bluetooth_rxtx.c **** 	target.syncword = 0;
 934:bluetooth_rxtx.c **** }
 935:bluetooth_rxtx.c **** 
 936:bluetooth_rxtx.c **** /* start un-buffered rx */
 937:bluetooth_rxtx.c **** static void cc2400_rx()
 938:bluetooth_rxtx.c **** {
 939:bluetooth_rxtx.c **** 	u16 mdmctrl = 0;
 940:bluetooth_rxtx.c **** 
 941:bluetooth_rxtx.c **** 	if((modulation == MOD_BT_BASIC_RATE) || (modulation == MOD_BT_LOW_ENERGY)) {
 942:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
 943:bluetooth_rxtx.c **** 			mdmctrl = 0x0029; // 160 kHz frequency deviation
 944:bluetooth_rxtx.c **** 		} else if (modulation == MOD_BT_LOW_ENERGY) {
 945:bluetooth_rxtx.c **** 			mdmctrl = 0x0040; // 250 kHz frequency deviation
ARM GAS  /tmp/ccDKg7Fp.s 			page 18


 946:bluetooth_rxtx.c **** 		}
 947:bluetooth_rxtx.c **** 		cc2400_set(MANAND,  0x7fff);
 948:bluetooth_rxtx.c **** 		cc2400_set(LMTST,   0x2b22);
 949:bluetooth_rxtx.c **** 		cc2400_set(MDMTST0, 0x134b); // without PRNG
 950:bluetooth_rxtx.c **** 		cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 951:bluetooth_rxtx.c **** 		// 0 00 00 0 010 00 0 00 0 1
 952:bluetooth_rxtx.c **** 		//      |  | |   |  +--------> CRC off
 953:bluetooth_rxtx.c **** 		//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
 954:bluetooth_rxtx.c **** 		//      |  | +---------------> 2 preamble bytes of 01010101
 955:bluetooth_rxtx.c **** 		//      |  +-----------------> not packet mode
 956:bluetooth_rxtx.c **** 			//      +--------------------> un-buffered mode
 957:bluetooth_rxtx.c **** 		cc2400_set(FSDIV,   channel - 1); // 1 MHz IF
 958:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, mdmctrl);
 959:bluetooth_rxtx.c **** 	}
 960:bluetooth_rxtx.c **** 
 961:bluetooth_rxtx.c **** 	// Set up CS register
 962:bluetooth_rxtx.c **** 	cs_threshold_calc_and_set(channel);
 963:bluetooth_rxtx.c **** 
 964:bluetooth_rxtx.c **** 	clkn_start();
 965:bluetooth_rxtx.c **** 
 966:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 967:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 968:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 969:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 970:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 971:bluetooth_rxtx.c **** 	PAEN_SET;
 972:bluetooth_rxtx.c **** 	HGM_SET;
 973:bluetooth_rxtx.c **** #endif
 974:bluetooth_rxtx.c **** }
 975:bluetooth_rxtx.c **** 
 976:bluetooth_rxtx.c **** /* start un-buffered rx */
 977:bluetooth_rxtx.c **** static void cc2400_rx_sync(u32 sync)
 978:bluetooth_rxtx.c **** {
 979:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
 980:bluetooth_rxtx.c **** 
 981:bluetooth_rxtx.c **** 	if (modulation == MOD_BT_BASIC_RATE) {
 982:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 983:bluetooth_rxtx.c **** 		grmdm = 0x0461; // un-buffered mode, packet w/ sync word detection
 984:bluetooth_rxtx.c **** 		// 0 00 00 1 000 11 0 00 0 1
 985:bluetooth_rxtx.c **** 		//   |  |  | |   |  +--------> CRC off
 986:bluetooth_rxtx.c **** 		//   |  |  | |   +-----------> sync word: 32 MSB bits of SYNC_WORD
 987:bluetooth_rxtx.c **** 		//   |  |  | +---------------> 0 preamble bytes of 01010101
 988:bluetooth_rxtx.c **** 		//   |  |  +-----------------> packet mode
 989:bluetooth_rxtx.c **** 		//   |  +--------------------> un-buffered mode
 990:bluetooth_rxtx.c **** 		//   +-----------------------> sync error bits: 0
 991:bluetooth_rxtx.c **** 
 992:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
 993:bluetooth_rxtx.c **** 		mdmctrl = 0x0040; // 250 kHz frequency deviation
 994:bluetooth_rxtx.c **** 		grmdm = 0x0561; // un-buffered mode, packet w/ sync word detection
 995:bluetooth_rxtx.c **** 		// 0 00 00 1 010 11 0 00 0 1
 996:bluetooth_rxtx.c **** 		//   |  |  | |   |  +--------> CRC off
 997:bluetooth_rxtx.c **** 		//   |  |  | |   +-----------> sync word: 32 MSB bits of SYNC_WORD
 998:bluetooth_rxtx.c **** 		//   |  |  | +---------------> 2 preamble bytes of 01010101
 999:bluetooth_rxtx.c **** 		//   |  |  +-----------------> packet mode
1000:bluetooth_rxtx.c **** 		//   |  +--------------------> un-buffered mode
1001:bluetooth_rxtx.c **** 		//   +-----------------------> sync error bits: 0
1002:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccDKg7Fp.s 			page 19


1003:bluetooth_rxtx.c **** 	} else {
1004:bluetooth_rxtx.c **** 		/* oops */
1005:bluetooth_rxtx.c **** 		return;
1006:bluetooth_rxtx.c **** 	}
1007:bluetooth_rxtx.c **** 
1008:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1009:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
1010:bluetooth_rxtx.c **** 
1011:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x124b);
1012:bluetooth_rxtx.c **** 	// 1      2      4b
1013:bluetooth_rxtx.c **** 	// 00 0 1 0 0 10 01001011
1014:bluetooth_rxtx.c **** 	//    | | | | |  +---------> AFC_DELTA = ??
1015:bluetooth_rxtx.c **** 	//    | | | | +------------> AFC settling = 4 pairs (8 bit preamble)
1016:bluetooth_rxtx.c **** 	//    | | | +--------------> no AFC adjust on packet
1017:bluetooth_rxtx.c **** 	//    | | +----------------> do not invert data
1018:bluetooth_rxtx.c **** 	//    | +------------------> TX IF freq 1 0Hz
1019:bluetooth_rxtx.c **** 	//    +--------------------> PRNG off
1020:bluetooth_rxtx.c **** 	//
1021:bluetooth_rxtx.c **** 	// ref: CC2400 datasheet page 67
1022:bluetooth_rxtx.c **** 	// AFC settling explained page 41/42
1023:bluetooth_rxtx.c **** 
1024:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   grmdm);
1025:bluetooth_rxtx.c **** 
1026:bluetooth_rxtx.c **** 	cc2400_set(SYNCL,   sync & 0xffff);
1027:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
1028:bluetooth_rxtx.c **** 
1029:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel - 1); // 1 MHz IF
1030:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
1031:bluetooth_rxtx.c **** 
1032:bluetooth_rxtx.c **** 	// Set up CS register
1033:bluetooth_rxtx.c **** 	cs_threshold_calc_and_set(channel);
1034:bluetooth_rxtx.c **** 
1035:bluetooth_rxtx.c **** 	clkn_start();
1036:bluetooth_rxtx.c **** 
1037:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1038:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1039:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1040:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
1041:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1042:bluetooth_rxtx.c **** 	PAEN_SET;
1043:bluetooth_rxtx.c **** 	HGM_SET;
1044:bluetooth_rxtx.c **** #endif
1045:bluetooth_rxtx.c **** }
1046:bluetooth_rxtx.c **** 
1047:bluetooth_rxtx.c **** /* start buffered tx */
1048:bluetooth_rxtx.c **** static void cc2400_tx_sync(uint32_t sync)
1049:bluetooth_rxtx.c **** {
1050:bluetooth_rxtx.c **** #ifdef TX_ENABLE
1051:bluetooth_rxtx.c **** 	// Bluetooth-like modulation
1052:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1053:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
1054:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
1055:bluetooth_rxtx.c **** 
1056:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
1057:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
1058:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1059:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
ARM GAS  /tmp/ccDKg7Fp.s 			page 20


1060:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1061:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1062:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1063:bluetooth_rxtx.c **** 
1064:bluetooth_rxtx.c **** 	cc2400_set(SYNCL,   sync & 0xffff);
1065:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
1066:bluetooth_rxtx.c **** 
1067:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel);
1068:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1069:bluetooth_rxtx.c **** 
1070:bluetooth_rxtx.c **** 	if (modulation == MOD_BT_BASIC_RATE) {
1071:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
1072:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
1073:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
1074:bluetooth_rxtx.c **** 	} else {
1075:bluetooth_rxtx.c **** 		/* oops */
1076:bluetooth_rxtx.c **** 		return;
1077:bluetooth_rxtx.c **** 	}
1078:bluetooth_rxtx.c **** 
1079:bluetooth_rxtx.c **** 	clkn_start();
1080:bluetooth_rxtx.c **** 
1081:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1082:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1083:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1084:bluetooth_rxtx.c **** 
1085:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1086:bluetooth_rxtx.c **** 	PAEN_SET;
1087:bluetooth_rxtx.c **** #endif
1088:bluetooth_rxtx.c **** 
1089:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1090:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
1091:bluetooth_rxtx.c **** 
1092:bluetooth_rxtx.c **** #endif
1093:bluetooth_rxtx.c **** }
1094:bluetooth_rxtx.c **** 
1095:bluetooth_rxtx.c **** /*
1096:bluetooth_rxtx.c ****  * Transmit a BTLE packet with the specified access address.
1097:bluetooth_rxtx.c ****  *
1098:bluetooth_rxtx.c ****  * All modulation parameters are set within this function. The data
1099:bluetooth_rxtx.c ****  * should not be pre-whitened, but the CRC should be calculated and
1100:bluetooth_rxtx.c ****  * included in the data length.
1101:bluetooth_rxtx.c ****  */
1102:bluetooth_rxtx.c **** void le_transmit(u32 aa, u8 len, u8 *data)
1103:bluetooth_rxtx.c **** {
1104:bluetooth_rxtx.c **** 	unsigned i, j;
1105:bluetooth_rxtx.c **** 	int bit;
1106:bluetooth_rxtx.c **** 	u8 txbuf[64];
1107:bluetooth_rxtx.c **** 	u8 tx_len;
1108:bluetooth_rxtx.c **** 	u8 byte;
1109:bluetooth_rxtx.c **** 	u16 gio_save;
1110:bluetooth_rxtx.c **** 
1111:bluetooth_rxtx.c **** 	// first four bytes: AA
1112:bluetooth_rxtx.c **** 	for (i = 0; i < 4; ++i) {
1113:bluetooth_rxtx.c **** 		byte = aa & 0xff;
1114:bluetooth_rxtx.c **** 		aa >>= 8;
1115:bluetooth_rxtx.c **** 		txbuf[i] = 0;
1116:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
ARM GAS  /tmp/ccDKg7Fp.s 			page 21


1117:bluetooth_rxtx.c **** 			txbuf[i] |= (byte & 1) << (7 - j);
1118:bluetooth_rxtx.c **** 			byte >>= 1;
1119:bluetooth_rxtx.c **** 		}
1120:bluetooth_rxtx.c **** 	}
1121:bluetooth_rxtx.c **** 
1122:bluetooth_rxtx.c **** 	// whiten the data and copy it into the txbuf
1123:bluetooth_rxtx.c **** 	int idx = whitening_index[btle_channel_index(channel)];
1124:bluetooth_rxtx.c **** 	for (i = 0; i < len; ++i) {
1125:bluetooth_rxtx.c **** 		byte = data[i];
1126:bluetooth_rxtx.c **** 		txbuf[i+4] = 0;
1127:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
1128:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
1129:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
1130:bluetooth_rxtx.c **** 			byte >>= 1;
1131:bluetooth_rxtx.c **** 			txbuf[i+4] |= bit << (7 - j);
1132:bluetooth_rxtx.c **** 		}
1133:bluetooth_rxtx.c **** 	}
1134:bluetooth_rxtx.c **** 
1135:bluetooth_rxtx.c **** 	len += 4; // include the AA in len
1136:bluetooth_rxtx.c **** 
1137:bluetooth_rxtx.c **** 	// Bluetooth-like modulation
1138:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1139:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
1140:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
1141:bluetooth_rxtx.c **** 
1142:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
1143:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
1144:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1145:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
1146:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1147:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1148:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1149:bluetooth_rxtx.c **** 
1150:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel);
1151:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1152:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
1153:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
1154:bluetooth_rxtx.c **** 
1155:bluetooth_rxtx.c **** 	// sync byte depends on the first transmitted bit of the AA
1156:bluetooth_rxtx.c **** 	if (aa & 1)
1157:bluetooth_rxtx.c **** 		cc2400_set(SYNCH,   0xaaaa);
1158:bluetooth_rxtx.c **** 	else
1159:bluetooth_rxtx.c **** 		cc2400_set(SYNCH,   0x5555);
1160:bluetooth_rxtx.c **** 
1161:bluetooth_rxtx.c **** 	// set GIO to FIFO_FULL
1162:bluetooth_rxtx.c **** 	gio_save = cc2400_get(IOCFG);
1163:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
1164:bluetooth_rxtx.c **** 
1165:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1166:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1167:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1168:bluetooth_rxtx.c **** 	TXLED_SET;
1169:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1170:bluetooth_rxtx.c **** 	PAEN_SET;
1171:bluetooth_rxtx.c **** #endif
1172:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1173:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
ARM GAS  /tmp/ccDKg7Fp.s 			page 22


1174:bluetooth_rxtx.c **** 
1175:bluetooth_rxtx.c **** 	// put the packet into the FIFO
1176:bluetooth_rxtx.c **** 	for (i = 0; i < len; i += 16) {
1177:bluetooth_rxtx.c **** 		while (GIO6) ; // wait for the FIFO to drain (FIFO_FULL false)
1178:bluetooth_rxtx.c **** 		tx_len = len - i;
1179:bluetooth_rxtx.c **** 		if (tx_len > 16)
1180:bluetooth_rxtx.c **** 			tx_len = 16;
1181:bluetooth_rxtx.c **** 		cc2400_fifo_write(tx_len, txbuf + i);
1182:bluetooth_rxtx.c **** 	}
1183:bluetooth_rxtx.c **** 
1184:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1185:bluetooth_rxtx.c **** 	TXLED_CLR;
1186:bluetooth_rxtx.c **** 
1187:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
1188:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
1189:bluetooth_rxtx.c **** 
1190:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1191:bluetooth_rxtx.c **** 	PAEN_CLR;
1192:bluetooth_rxtx.c **** #endif
1193:bluetooth_rxtx.c **** 
1194:bluetooth_rxtx.c **** 	// reset GIO
1195:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, gio_save);
1196:bluetooth_rxtx.c **** }
1197:bluetooth_rxtx.c **** 
1198:bluetooth_rxtx.c **** void le_jam(void) {
1199:bluetooth_rxtx.c **** #ifdef TX_ENABLE
1200:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1201:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
1202:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x234b);    // PRNG, 1 MHz offset
1203:bluetooth_rxtx.c **** 
1204:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
1205:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
1206:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1207:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
1208:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1209:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1210:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1211:bluetooth_rxtx.c **** 
1212:bluetooth_rxtx.c **** 	// cc2400_set(FSDIV,   channel);
1213:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1214:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
1215:bluetooth_rxtx.c **** 
1216:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1217:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1218:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1219:bluetooth_rxtx.c **** 	TXLED_SET;
1220:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1221:bluetooth_rxtx.c **** 	PAEN_SET;
1222:bluetooth_rxtx.c **** #endif
1223:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1224:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
1225:bluetooth_rxtx.c **** #endif
1226:bluetooth_rxtx.c **** }
1227:bluetooth_rxtx.c **** 
1228:bluetooth_rxtx.c **** /* TODO - return whether hop happened, or should caller have to keep
1229:bluetooth_rxtx.c ****  * track of this? */
1230:bluetooth_rxtx.c **** void hop(void)
ARM GAS  /tmp/ccDKg7Fp.s 			page 23


1231:bluetooth_rxtx.c **** {
1232:bluetooth_rxtx.c **** 	do_hop = 0;
1233:bluetooth_rxtx.c **** 	last_hop = clkn;
1234:bluetooth_rxtx.c **** 
1235:bluetooth_rxtx.c **** 	// No hopping, if channel is set correctly, do nothing
1236:bluetooth_rxtx.c **** 	if (hop_mode == HOP_NONE) {
1237:bluetooth_rxtx.c **** 		if (cc2400_get(FSDIV) == (channel - 1))
1238:bluetooth_rxtx.c **** 			return;
1239:bluetooth_rxtx.c **** 	}
1240:bluetooth_rxtx.c **** 	/* Slow sweep (100 hops/sec)
1241:bluetooth_rxtx.c **** 	 * only hop to currently used channels if AFH is enabled
1242:bluetooth_rxtx.c **** 	 */
1243:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_SWEEP) {
1244:bluetooth_rxtx.c **** 		do {
1245:bluetooth_rxtx.c **** 			channel += 32;
1246:bluetooth_rxtx.c **** 			if (channel > 2480)
1247:bluetooth_rxtx.c **** 				channel -= 79;
1248:bluetooth_rxtx.c **** 		} while ( used_channels != 0 && afh_enabled && !( afh_map[(channel-2402)/8] & 0x1<<((channel-2402
1249:bluetooth_rxtx.c **** 	}
1250:bluetooth_rxtx.c **** 
1251:bluetooth_rxtx.c **** 	/* AFH detection
1252:bluetooth_rxtx.c **** 	 * only hop to currently unused channesl
1253:bluetooth_rxtx.c **** 	 */
1254:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_AFH) {
1255:bluetooth_rxtx.c **** 		do {
1256:bluetooth_rxtx.c **** 			channel += 32;
1257:bluetooth_rxtx.c **** 			if (channel > 2480)
1258:bluetooth_rxtx.c **** 				channel -= 79;
1259:bluetooth_rxtx.c **** 		} while( used_channels != 79 && (afh_map[(channel-2402)/8] & 0x1<<((channel-2402)%8)) );
1260:bluetooth_rxtx.c **** 	}
1261:bluetooth_rxtx.c **** 
1262:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_BLUETOOTH) {
1263:bluetooth_rxtx.c **** 		channel = next_hop(clkn);
1264:bluetooth_rxtx.c **** 	}
1265:bluetooth_rxtx.c **** 
1266:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_BTLE) {
1267:bluetooth_rxtx.c **** 		channel = btle_next_hop(&le);
1268:bluetooth_rxtx.c **** 	}
1269:bluetooth_rxtx.c **** 
1270:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_DIRECT) {
1271:bluetooth_rxtx.c **** 		channel = hop_direct_channel;
1272:bluetooth_rxtx.c **** 	}
1273:bluetooth_rxtx.c **** 	/* IDLE mode, but leave amp on, so don't call cc2400_idle(). */
1274:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
1275:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
1276:bluetooth_rxtx.c **** 
1277:bluetooth_rxtx.c **** 	/* Retune */
1278:bluetooth_rxtx.c **** 	if(mode == MODE_TX_SYMBOLS)
1279:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
1280:bluetooth_rxtx.c **** 	else
1281:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel - 1);
1282:bluetooth_rxtx.c **** 
1283:bluetooth_rxtx.c **** 	/* Update CS register if hopping.  */
1284:bluetooth_rxtx.c **** 	if (hop_mode > 0) {
1285:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
1286:bluetooth_rxtx.c **** 	}
1287:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccDKg7Fp.s 			page 24


1288:bluetooth_rxtx.c **** 	/* Wait for lock */
1289:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1290:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1291:bluetooth_rxtx.c **** 
1292:bluetooth_rxtx.c **** 	dma_discard = 1;
1293:bluetooth_rxtx.c **** 
1294:bluetooth_rxtx.c **** 	if(mode == MODE_TX_SYMBOLS)
1295:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
1296:bluetooth_rxtx.c **** 	else
1297:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
1298:bluetooth_rxtx.c **** }
1299:bluetooth_rxtx.c **** 
1300:bluetooth_rxtx.c **** /* Bluetooth packet monitoring */
1301:bluetooth_rxtx.c **** void bt_stream_rx()
1302:bluetooth_rxtx.c **** {
1303:bluetooth_rxtx.c **** 	int8_t rssi;
1304:bluetooth_rxtx.c **** 	int8_t rssi_at_trigger;
1305:bluetooth_rxtx.c **** 
1306:bluetooth_rxtx.c **** 	RXLED_CLR;
1307:bluetooth_rxtx.c **** 
1308:bluetooth_rxtx.c **** 	usb_queue_init();
1309:bluetooth_rxtx.c **** 	dio_ssp_init();
1310:bluetooth_rxtx.c **** 	dma_init_rx_symbols();
1311:bluetooth_rxtx.c **** 	dio_ssp_start();
1312:bluetooth_rxtx.c **** 
1313:bluetooth_rxtx.c **** 	cc2400_rx();
1314:bluetooth_rxtx.c **** 
1315:bluetooth_rxtx.c **** 	cs_trigger_enable();
1316:bluetooth_rxtx.c **** 
1317:bluetooth_rxtx.c **** 	while ( requested_mode == MODE_RX_SYMBOLS || requested_mode == MODE_BT_FOLLOW )
1318:bluetooth_rxtx.c **** 	{
1319:bluetooth_rxtx.c **** 
1320:bluetooth_rxtx.c **** 		RXLED_CLR;
1321:bluetooth_rxtx.c **** 
1322:bluetooth_rxtx.c **** 		/* Wait for DMA transfer. TODO - need more work on
1323:bluetooth_rxtx.c **** 		 * RSSI. Should send RSSI indications to host even
1324:bluetooth_rxtx.c **** 		 * when not transferring data. That would also keep
1325:bluetooth_rxtx.c **** 		 * the USB stream going. This loop runs 50-80 times
1326:bluetooth_rxtx.c **** 		 * while waiting for DMA, but RSSI sampling does not
1327:bluetooth_rxtx.c **** 		 * cover all the symbols in a DMA transfer. Can not do
1328:bluetooth_rxtx.c **** 		 * RSSI sampling in CS interrupt, but could log time
1329:bluetooth_rxtx.c **** 		 * at multiple trigger points there. The MAX() below
1330:bluetooth_rxtx.c **** 		 * helps with statistics in the case that cs_trigger
1331:bluetooth_rxtx.c **** 		 * happened before the loop started. */
1332:bluetooth_rxtx.c **** 		rssi_reset();
1333:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
1334:bluetooth_rxtx.c **** 		while (!rx_tc) {
1335:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1336:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
1337:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
1338:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
1339:bluetooth_rxtx.c **** 			}
1340:bluetooth_rxtx.c **** 			rssi_add(rssi);
1341:bluetooth_rxtx.c **** 
1342:bluetooth_rxtx.c **** 			handle_usb(clkn);
1343:bluetooth_rxtx.c **** 
1344:bluetooth_rxtx.c **** 			/* If timer says time to hop, do it. */
ARM GAS  /tmp/ccDKg7Fp.s 			page 25


1345:bluetooth_rxtx.c **** 			if (do_hop) {
1346:bluetooth_rxtx.c **** 				hop();
1347:bluetooth_rxtx.c **** 			} else {
1348:bluetooth_rxtx.c **** 				TXLED_CLR;
1349:bluetooth_rxtx.c **** 			}
1350:bluetooth_rxtx.c **** 			/* TODO - set per-channel carrier sense threshold.
1351:bluetooth_rxtx.c **** 			 * Set by firmware or host. */
1352:bluetooth_rxtx.c **** 		}
1353:bluetooth_rxtx.c **** 
1354:bluetooth_rxtx.c **** 		RXLED_SET;
1355:bluetooth_rxtx.c **** 
1356:bluetooth_rxtx.c **** 		if (rx_err) {
1357:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1358:bluetooth_rxtx.c **** 		}
1359:bluetooth_rxtx.c **** 
1360:bluetooth_rxtx.c **** 		/* Missed a DMA trasfer? */
1361:bluetooth_rxtx.c **** 		if (rx_tc > 1)
1362:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
1363:bluetooth_rxtx.c **** 
1364:bluetooth_rxtx.c **** 		if (dma_discard) {
1365:bluetooth_rxtx.c **** 			status |= DISCARD;
1366:bluetooth_rxtx.c **** 			dma_discard = 0;
1367:bluetooth_rxtx.c **** 		}
1368:bluetooth_rxtx.c **** 
1369:bluetooth_rxtx.c **** 		rssi_iir_update(channel);
1370:bluetooth_rxtx.c **** 
1371:bluetooth_rxtx.c **** 		/* Set squelch hold if there was either a CS trigger, squelch
1372:bluetooth_rxtx.c **** 		 * is disabled, or if the current rssi_max is above the same
1373:bluetooth_rxtx.c **** 		 * threshold. Currently, this is redundant, but allows for
1374:bluetooth_rxtx.c **** 		 * per-channel or other rssi triggers in the future. */
1375:bluetooth_rxtx.c **** 		if (cs_trigger || cs_no_squelch) {
1376:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
1377:bluetooth_rxtx.c **** 			cs_trigger = 0;
1378:bluetooth_rxtx.c **** 		}
1379:bluetooth_rxtx.c **** 
1380:bluetooth_rxtx.c **** 		if (rssi_max >= (cs_threshold_cur + 54)) {
1381:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
1382:bluetooth_rxtx.c **** 		}
1383:bluetooth_rxtx.c **** 
1384:bluetooth_rxtx.c **** 		enqueue(BR_PACKET, (uint8_t*)idle_rxbuf);
1385:bluetooth_rxtx.c **** 
1386:bluetooth_rxtx.c **** 		handle_usb(clkn);
1387:bluetooth_rxtx.c **** 		rx_tc = 0;
1388:bluetooth_rxtx.c **** 		rx_err = 0;
1389:bluetooth_rxtx.c **** 	}
1390:bluetooth_rxtx.c **** 
1391:bluetooth_rxtx.c **** 	dio_ssp_stop();
1392:bluetooth_rxtx.c **** 	cs_trigger_disable();
1393:bluetooth_rxtx.c **** }
1394:bluetooth_rxtx.c **** 
1395:bluetooth_rxtx.c **** static uint8_t reverse8(uint8_t data)
1396:bluetooth_rxtx.c **** {
  26              		.loc 1 1396 0
  27              		.cfi_startproc
  28              		@ args = 0, pretend = 0, frame = 0
  29              		@ frame_needed = 0, uses_anonymous_args = 0
  30              	.LVL0:
ARM GAS  /tmp/ccDKg7Fp.s 			page 26


  31 0000 10B5     		push	{r4, lr}
  32              		.cfi_def_cfa_offset 8
  33              		.cfi_offset 4, -8
  34              		.cfi_offset 14, -4
  35              	.LVL1:
  36              	.LBB7:
1397:bluetooth_rxtx.c **** 	uint8_t reversed = 0;
1398:bluetooth_rxtx.c **** 
1399:bluetooth_rxtx.c **** 	for(size_t i=0; i<8; i++)
  37              		.loc 1 1399 0
  38 0002 0023     		movs	r3, #0
  39              	.LBE7:
1397:bluetooth_rxtx.c **** 	uint8_t reversed = 0;
  40              		.loc 1 1397 0
  41 0004 1A46     		mov	r2, r3
  42              	.LVL2:
  43              	.L2:
  44              	.LBB8:
1400:bluetooth_rxtx.c **** 	{
1401:bluetooth_rxtx.c **** 		reversed |= ((data >> i) & 0x01) << (7-i);
  45              		.loc 1 1401 0 discriminator 3
  46 0006 40FA03F1 		asr	r1, r0, r3
  47 000a C3F10704 		rsb	r4, r3, #7
  48 000e 01F00101 		and	r1, r1, #1
  49 0012 A140     		lsls	r1, r1, r4
1399:bluetooth_rxtx.c **** 	{
  50              		.loc 1 1399 0 discriminator 3
  51 0014 0133     		adds	r3, r3, #1
  52              	.LVL3:
  53              		.loc 1 1401 0 discriminator 3
  54 0016 0A43     		orrs	r2, r2, r1
  55              	.LVL4:
1399:bluetooth_rxtx.c **** 	{
  56              		.loc 1 1399 0 discriminator 3
  57 0018 082B     		cmp	r3, #8
  58              		.loc 1 1401 0 discriminator 3
  59 001a D2B2     		uxtb	r2, r2
  60              	.LVL5:
1399:bluetooth_rxtx.c **** 	{
  61              		.loc 1 1399 0 discriminator 3
  62 001c F3D1     		bne	.L2
  63              	.LBE8:
1402:bluetooth_rxtx.c **** 	}
1403:bluetooth_rxtx.c **** 
1404:bluetooth_rxtx.c **** 	return reversed;
1405:bluetooth_rxtx.c **** }
  64              		.loc 1 1405 0
  65 001e 1046     		mov	r0, r2
  66              	.LVL6:
  67 0020 10BD     		pop	{r4, pc}
  68              		.cfi_endproc
  69              	.LFE16:
  71              		.section	.text.cc2400_rx,"ax",%progbits
  72              		.align	1
  73              		.thumb
  74              		.thumb_func
  76              	cc2400_rx:
ARM GAS  /tmp/ccDKg7Fp.s 			page 27


  77              	.LFB9:
 938:bluetooth_rxtx.c **** 	u16 mdmctrl = 0;
  78              		.loc 1 938 0
  79              		.cfi_startproc
  80              		@ args = 0, pretend = 0, frame = 0
  81              		@ frame_needed = 0, uses_anonymous_args = 0
  82 0000 38B5     		push	{r3, r4, r5, lr}
  83              		.cfi_def_cfa_offset 16
  84              		.cfi_offset 3, -16
  85              		.cfi_offset 4, -12
  86              		.cfi_offset 5, -8
  87              		.cfi_offset 14, -4
  88              	.LVL7:
 941:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
  89              		.loc 1 941 0
  90 0002 254B     		ldr	r3, .L20
  91 0004 254C     		ldr	r4, .L20+4
  92 0006 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
  93 0008 12B1     		cbz	r2, .L6
 941:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
  94              		.loc 1 941 0 is_stmt 0 discriminator 1
  95 000a 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
  96 000c 012A     		cmp	r2, #1
  97 000e 27D1     		bne	.L7
  98              	.L6:
 942:bluetooth_rxtx.c **** 			mdmctrl = 0x0029; // 160 kHz frequency deviation
  99              		.loc 1 942 0 is_stmt 1
 100 0010 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 101 0012 33B1     		cbz	r3, .L11
 944:bluetooth_rxtx.c **** 			mdmctrl = 0x0040; // 250 kHz frequency deviation
 102              		.loc 1 944 0
 103 0014 204B     		ldr	r3, .L20
 104 0016 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 945:bluetooth_rxtx.c **** 		}
 105              		.loc 1 945 0
 106 0018 012B     		cmp	r3, #1
 107 001a 14BF     		ite	ne
 108 001c 0025     		movne	r5, #0
 109 001e 4025     		moveq	r5, #64
 110 0020 00E0     		b	.L8
 111              	.L11:
 943:bluetooth_rxtx.c **** 		} else if (modulation == MOD_BT_LOW_ENERGY) {
 112              		.loc 1 943 0
 113 0022 2925     		movs	r5, #41
 114              	.L8:
 115              	.LVL8:
 947:bluetooth_rxtx.c **** 		cc2400_set(LMTST,   0x2b22);
 116              		.loc 1 947 0
 117 0024 0D20     		movs	r0, #13
 118 0026 47F6FF71 		movw	r1, #32767
 119 002a FFF7FEFF 		bl	cc2400_set
 120              	.LVL9:
 948:bluetooth_rxtx.c **** 		cc2400_set(MDMTST0, 0x134b); // without PRNG
 121              		.loc 1 948 0
 122 002e 1220     		movs	r0, #18
 123 0030 42F62231 		movw	r1, #11042
 124 0034 FFF7FEFF 		bl	cc2400_set
ARM GAS  /tmp/ccDKg7Fp.s 			page 28


 125              	.LVL10:
 949:bluetooth_rxtx.c **** 		cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 126              		.loc 1 949 0
 127 0038 1420     		movs	r0, #20
 128 003a 41F24B31 		movw	r1, #4939
 129 003e FFF7FEFF 		bl	cc2400_set
 130              	.LVL11:
 950:bluetooth_rxtx.c **** 		// 0 00 00 0 010 00 0 00 0 1
 131              		.loc 1 950 0
 132 0042 2020     		movs	r0, #32
 133 0044 40F20111 		movw	r1, #257
 134 0048 FFF7FEFF 		bl	cc2400_set
 135              	.LVL12:
 957:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, mdmctrl);
 136              		.loc 1 957 0
 137 004c 2188     		ldrh	r1, [r4]
 138 004e 0220     		movs	r0, #2
 139 0050 0139     		subs	r1, r1, #1
 140 0052 89B2     		uxth	r1, r1
 141 0054 FFF7FEFF 		bl	cc2400_set
 142              	.LVL13:
 958:bluetooth_rxtx.c **** 	}
 143              		.loc 1 958 0
 144 0058 0320     		movs	r0, #3
 145 005a 2946     		mov	r1, r5
 146 005c FFF7FEFF 		bl	cc2400_set
 147              	.LVL14:
 148              	.L7:
 962:bluetooth_rxtx.c **** 
 149              		.loc 1 962 0
 150 0060 2088     		ldrh	r0, [r4]
 151 0062 80B2     		uxth	r0, r0
 152 0064 FFF7FEFF 		bl	cs_threshold_calc_and_set
 153              	.LVL15:
 964:bluetooth_rxtx.c **** 
 154              		.loc 1 964 0
 155 0068 FFF7FEFF 		bl	clkn_start
 156              	.LVL16:
 157              	.L9:
 966:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 158              		.loc 1 966 0 discriminator 1
 159 006c FFF7FEFF 		bl	cc2400_status
 160              	.LVL17:
 161 0070 4206     		lsls	r2, r0, #25
 162 0072 FBD5     		bpl	.L9
 967:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 163              		.loc 1 967 0
 164 0074 6120     		movs	r0, #97
 165 0076 FFF7FEFF 		bl	cc2400_strobe
 166              	.LVL18:
 167              	.L10:
 968:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 168              		.loc 1 968 0 discriminator 1
 169 007a FFF7FEFF 		bl	cc2400_status
 170              	.LVL19:
 171 007e 4307     		lsls	r3, r0, #29
 172 0080 FBD5     		bpl	.L10
ARM GAS  /tmp/ccDKg7Fp.s 			page 29


 969:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 173              		.loc 1 969 0
 174 0082 6220     		movs	r0, #98
 175 0084 FFF7FEFF 		bl	cc2400_strobe
 176              	.LVL20:
 971:bluetooth_rxtx.c **** 	HGM_SET;
 177              		.loc 1 971 0
 178 0088 054B     		ldr	r3, .L20+8
 179 008a 8022     		movs	r2, #128
 180 008c 1A60     		str	r2, [r3]
 972:bluetooth_rxtx.c **** #endif
 181              		.loc 1 972 0
 182 008e 4FF48072 		mov	r2, #256
 183 0092 1A60     		str	r2, [r3]
 184 0094 38BD     		pop	{r3, r4, r5, pc}
 185              	.L21:
 186 0096 00BF     		.align	2
 187              	.L20:
 188 0098 00000000 		.word	.LANCHOR0
 189 009c 00000000 		.word	.LANCHOR1
 190 00a0 58C00920 		.word	537509976
 191              		.cfi_endproc
 192              	.LFE9:
 194              		.section	.text.cc2400_rx_sync,"ax",%progbits
 195              		.align	1
 196              		.thumb
 197              		.thumb_func
 199              	cc2400_rx_sync:
 200              	.LFB10:
 978:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
 201              		.loc 1 978 0
 202              		.cfi_startproc
 203              		@ args = 0, pretend = 0, frame = 0
 204              		@ frame_needed = 0, uses_anonymous_args = 0
 205              	.LVL21:
 206 0000 70B5     		push	{r4, r5, r6, lr}
 207              		.cfi_def_cfa_offset 16
 208              		.cfi_offset 4, -16
 209              		.cfi_offset 5, -12
 210              		.cfi_offset 6, -8
 211              		.cfi_offset 14, -4
 981:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 212              		.loc 1 981 0
 213 0002 274B     		ldr	r3, .L32
 978:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
 214              		.loc 1 978 0
 215 0004 0446     		mov	r4, r0
 981:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 216              		.loc 1 981 0
 217 0006 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 218 0008 32B1     		cbz	r2, .L27
 992:bluetooth_rxtx.c **** 		mdmctrl = 0x0040; // 250 kHz frequency deviation
 219              		.loc 1 992 0
 220 000a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 221 000c 012B     		cmp	r3, #1
 222 000e 46D1     		bne	.L22
 993:bluetooth_rxtx.c **** 		grmdm = 0x0561; // un-buffered mode, packet w/ sync word detection
ARM GAS  /tmp/ccDKg7Fp.s 			page 30


 223              		.loc 1 993 0
 224 0010 4025     		movs	r5, #64
 994:bluetooth_rxtx.c **** 		// 0 00 00 1 010 11 0 00 0 1
 225              		.loc 1 994 0
 226 0012 40F26156 		movw	r6, #1377
 227 0016 02E0     		b	.L23
 228              	.L27:
 983:bluetooth_rxtx.c **** 		// 0 00 00 1 000 11 0 00 0 1
 229              		.loc 1 983 0
 230 0018 40F26146 		movw	r6, #1121
 982:bluetooth_rxtx.c **** 		grmdm = 0x0461; // un-buffered mode, packet w/ sync word detection
 231              		.loc 1 982 0
 232 001c 2925     		movs	r5, #41
 233              	.L23:
 234              	.LVL22:
1008:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 235              		.loc 1 1008 0
 236 001e 0D20     		movs	r0, #13
 237              	.LVL23:
 238 0020 47F6FF71 		movw	r1, #32767
 239 0024 FFF7FEFF 		bl	cc2400_set
 240              	.LVL24:
1009:bluetooth_rxtx.c **** 
 241              		.loc 1 1009 0
 242 0028 1220     		movs	r0, #18
 243 002a 42F62231 		movw	r1, #11042
 244 002e FFF7FEFF 		bl	cc2400_set
 245              	.LVL25:
1011:bluetooth_rxtx.c **** 	// 1      2      4b
 246              		.loc 1 1011 0
 247 0032 1420     		movs	r0, #20
 248 0034 41F24B21 		movw	r1, #4683
 249 0038 FFF7FEFF 		bl	cc2400_set
 250              	.LVL26:
1024:bluetooth_rxtx.c **** 
 251              		.loc 1 1024 0
 252 003c 2020     		movs	r0, #32
 253 003e 3146     		mov	r1, r6
 254 0040 FFF7FEFF 		bl	cc2400_set
 255              	.LVL27:
1026:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
 256              		.loc 1 1026 0
 257 0044 A1B2     		uxth	r1, r4
 258 0046 2C20     		movs	r0, #44
 259 0048 FFF7FEFF 		bl	cc2400_set
 260              	.LVL28:
1027:bluetooth_rxtx.c **** 
 261              		.loc 1 1027 0
 262 004c 210C     		lsrs	r1, r4, #16
1029:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
 263              		.loc 1 1029 0
 264 004e 154C     		ldr	r4, .L32+4
 265              	.LVL29:
1027:bluetooth_rxtx.c **** 
 266              		.loc 1 1027 0
 267 0050 2D20     		movs	r0, #45
 268 0052 FFF7FEFF 		bl	cc2400_set
ARM GAS  /tmp/ccDKg7Fp.s 			page 31


 269              	.LVL30:
1029:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
 270              		.loc 1 1029 0
 271 0056 2188     		ldrh	r1, [r4]
 272 0058 0220     		movs	r0, #2
 273 005a 0139     		subs	r1, r1, #1
 274 005c 89B2     		uxth	r1, r1
 275 005e FFF7FEFF 		bl	cc2400_set
 276              	.LVL31:
1030:bluetooth_rxtx.c **** 
 277              		.loc 1 1030 0
 278 0062 0320     		movs	r0, #3
 279 0064 2946     		mov	r1, r5
 280 0066 FFF7FEFF 		bl	cc2400_set
 281              	.LVL32:
1033:bluetooth_rxtx.c **** 
 282              		.loc 1 1033 0
 283 006a 2088     		ldrh	r0, [r4]
 284 006c 80B2     		uxth	r0, r0
 285 006e FFF7FEFF 		bl	cs_threshold_calc_and_set
 286              	.LVL33:
1035:bluetooth_rxtx.c **** 
 287              		.loc 1 1035 0
 288 0072 FFF7FEFF 		bl	clkn_start
 289              	.LVL34:
 290              	.L25:
1037:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 291              		.loc 1 1037 0 discriminator 1
 292 0076 FFF7FEFF 		bl	cc2400_status
 293              	.LVL35:
 294 007a 4206     		lsls	r2, r0, #25
 295 007c FBD5     		bpl	.L25
1038:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 296              		.loc 1 1038 0
 297 007e 6120     		movs	r0, #97
 298 0080 FFF7FEFF 		bl	cc2400_strobe
 299              	.LVL36:
 300              	.L26:
1039:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 301              		.loc 1 1039 0 discriminator 1
 302 0084 FFF7FEFF 		bl	cc2400_status
 303              	.LVL37:
 304 0088 4307     		lsls	r3, r0, #29
 305 008a FBD5     		bpl	.L26
1040:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 306              		.loc 1 1040 0
 307 008c 6220     		movs	r0, #98
 308 008e FFF7FEFF 		bl	cc2400_strobe
 309              	.LVL38:
1042:bluetooth_rxtx.c **** 	HGM_SET;
 310              		.loc 1 1042 0
 311 0092 054B     		ldr	r3, .L32+8
 312 0094 8022     		movs	r2, #128
 313 0096 1A60     		str	r2, [r3]
1043:bluetooth_rxtx.c **** #endif
 314              		.loc 1 1043 0
 315 0098 4FF48072 		mov	r2, #256
ARM GAS  /tmp/ccDKg7Fp.s 			page 32


 316 009c 1A60     		str	r2, [r3]
 317              	.LVL39:
 318              	.L22:
 319 009e 70BD     		pop	{r4, r5, r6, pc}
 320              	.L33:
 321              		.align	2
 322              	.L32:
 323 00a0 00000000 		.word	.LANCHOR0
 324 00a4 00000000 		.word	.LANCHOR1
 325 00a8 58C00920 		.word	537509976
 326              		.cfi_endproc
 327              	.LFE10:
 329              		.section	.text.enqueue,"ax",%progbits
 330              		.align	1
 331              		.thumb
 332              		.thumb_func
 334              	enqueue:
 335              	.LFB0:
 131:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 336              		.loc 1 131 0
 337              		.cfi_startproc
 338              		@ args = 0, pretend = 0, frame = 0
 339              		@ frame_needed = 0, uses_anonymous_args = 0
 340              	.LVL40:
 341 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 342              		.cfi_def_cfa_offset 24
 343              		.cfi_offset 3, -24
 344              		.cfi_offset 4, -20
 345              		.cfi_offset 5, -16
 346              		.cfi_offset 6, -12
 347              		.cfi_offset 7, -8
 348              		.cfi_offset 14, -4
 131:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 349              		.loc 1 131 0
 350 0002 0746     		mov	r7, r0
 351 0004 0E46     		mov	r6, r1
 132:bluetooth_rxtx.c **** 
 352              		.loc 1 132 0
 353 0006 FFF7FEFF 		bl	usb_enqueue
 354              	.LVL41:
 355 000a 1D4D     		ldr	r5, .L39
 135:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 356              		.loc 1 135 0
 357 000c 0446     		mov	r4, r0
 358 000e 20B9     		cbnz	r0, .L35
 136:bluetooth_rxtx.c **** 		return 0;
 359              		.loc 1 136 0
 360 0010 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 361 0012 43F00403 		orr	r3, r3, #4
 362 0016 6B70     		strb	r3, [r5, #1]
 137:bluetooth_rxtx.c **** 	}
 363              		.loc 1 137 0
 364 0018 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 365              	.LVL42:
 366              	.L35:
 141:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 367              		.loc 1 141 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 33


 368 001a 042F     		cmp	r7, #4
 140:bluetooth_rxtx.c **** 	if(type == SPECAN) {
 369              		.loc 1 140 0
 370 001c 0770     		strb	r7, [r0]
 141:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 371              		.loc 1 141 0
 372 001e 0ED1     		bne	.L37
 143:bluetooth_rxtx.c **** 	} else {
 373              		.loc 1 143 0
 374 0020 40F63541 		movw	r1, #3125
 142:bluetooth_rxtx.c **** 		f->clk100ns = CLK100NS;
 375              		.loc 1 142 0
 376 0024 174A     		ldr	r2, .L39+4
 377 0026 1368     		ldr	r3, [r2]
 378 0028 1B0D     		lsrs	r3, r3, #20
 379 002a C370     		strb	r3, [r0, #3]
 143:bluetooth_rxtx.c **** 	} else {
 380              		.loc 1 143 0
 381 002c 164B     		ldr	r3, .L39+8
 382 002e 1268     		ldr	r2, [r2]
 383 0030 1B68     		ldr	r3, [r3]
 384 0032 C2F31302 		ubfx	r2, r2, #0, #20
 385 0036 01FB0233 		mla	r3, r1, r2, r3
 386 003a 4360     		str	r3, [r0, #4]
 387 003c 14E0     		b	.L38
 388              	.L37:
 145:bluetooth_rxtx.c **** 		f->clk100ns = idle_buf_clk100ns;
 389              		.loc 1 145 0
 390 003e AB78     		ldrb	r3, [r5, #2]	@ zero_extendqisi2
 391 0040 C370     		strb	r3, [r0, #3]
 146:bluetooth_rxtx.c **** 		f->channel = (uint8_t)((idle_buf_channel - 2402) & 0xff);
 392              		.loc 1 146 0
 393 0042 6B68     		ldr	r3, [r5, #4]
 394 0044 4360     		str	r3, [r0, #4]
 147:bluetooth_rxtx.c **** 		f->rssi_min = rssi_min;
 395              		.loc 1 147 0
 396 0046 2B89     		ldrh	r3, [r5, #8]
 397 0048 623B     		subs	r3, r3, #98
 398 004a 8370     		strb	r3, [r0, #2]
 148:bluetooth_rxtx.c **** 		f->rssi_max = rssi_max;
 399              		.loc 1 148 0
 400 004c 0F4B     		ldr	r3, .L39+12
 401 004e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 402 0050 4372     		strb	r3, [r0, #9]
 149:bluetooth_rxtx.c **** 		f->rssi_avg = rssi_get_avg(idle_buf_channel);
 403              		.loc 1 149 0
 404 0052 0F4B     		ldr	r3, .L39+16
 405 0054 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 406 0056 0372     		strb	r3, [r0, #8]
 150:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 407              		.loc 1 150 0
 408 0058 2889     		ldrh	r0, [r5, #8]
 409              	.LVL43:
 410 005a 80B2     		uxth	r0, r0
 411 005c FFF7FEFF 		bl	rssi_get_avg
 412              	.LVL44:
 151:bluetooth_rxtx.c **** 	}
ARM GAS  /tmp/ccDKg7Fp.s 			page 34


 413              		.loc 1 151 0
 414 0060 0C4B     		ldr	r3, .L39+20
 150:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 415              		.loc 1 150 0
 416 0062 A072     		strb	r0, [r4, #10]
 151:bluetooth_rxtx.c **** 	}
 417              		.loc 1 151 0
 418 0064 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 419 0066 E372     		strb	r3, [r4, #11]
 420              	.L38:
 154:bluetooth_rxtx.c **** 
 421              		.loc 1 154 0
 422 0068 04F10E00 		add	r0, r4, #14
 423 006c 3146     		mov	r1, r6
 424 006e 3222     		movs	r2, #50
 425 0070 FFF7FEFF 		bl	memcpy
 426              	.LVL45:
 156:bluetooth_rxtx.c **** 	status = 0;
 427              		.loc 1 156 0
 428 0074 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 159:bluetooth_rxtx.c **** }
 429              		.loc 1 159 0
 430 0076 0120     		movs	r0, #1
 156:bluetooth_rxtx.c **** 	status = 0;
 431              		.loc 1 156 0
 432 0078 6370     		strb	r3, [r4, #1]
 157:bluetooth_rxtx.c **** 
 433              		.loc 1 157 0
 434 007a 0023     		movs	r3, #0
 435 007c 6B70     		strb	r3, [r5, #1]
 160:bluetooth_rxtx.c **** 
 436              		.loc 1 160 0
 437 007e F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 438              	.LVL46:
 439              	.L40:
 440              		.align	2
 441              	.L39:
 442 0080 00000000 		.word	.LANCHOR0
 443 0084 00000000 		.word	clkn
 444 0088 08400040 		.word	1073758216
 445 008c 00000000 		.word	rssi_min
 446 0090 00000000 		.word	rssi_max
 447 0094 00000000 		.word	rssi_count
 448              		.cfi_endproc
 449              	.LFE0:
 451              		.section	.text.le_set_access_address,"ax",%progbits
 452              		.align	1
 453              		.thumb
 454              		.thumb_func
 456              	le_set_access_address:
 457              	.LFB19:
1406:bluetooth_rxtx.c **** 
1407:bluetooth_rxtx.c **** static uint16_t reverse16(uint16_t data)
1408:bluetooth_rxtx.c **** {
1409:bluetooth_rxtx.c **** 	uint16_t reversed = 0;
1410:bluetooth_rxtx.c **** 
1411:bluetooth_rxtx.c **** 	for(size_t i=0; i<16; i++)
ARM GAS  /tmp/ccDKg7Fp.s 			page 35


1412:bluetooth_rxtx.c **** 	{
1413:bluetooth_rxtx.c **** 		reversed |= ((data >> i) & 0x01) << (15-i);
1414:bluetooth_rxtx.c **** 	}
1415:bluetooth_rxtx.c **** 
1416:bluetooth_rxtx.c **** 	return reversed;
1417:bluetooth_rxtx.c **** }
1418:bluetooth_rxtx.c **** 
1419:bluetooth_rxtx.c **** /*
1420:bluetooth_rxtx.c ****  * Transmit a BTBR packet with the specified access code.
1421:bluetooth_rxtx.c ****  *
1422:bluetooth_rxtx.c ****  * All modulation parameters are set within this function.
1423:bluetooth_rxtx.c ****  */
1424:bluetooth_rxtx.c **** void br_transmit()
1425:bluetooth_rxtx.c **** {
1426:bluetooth_rxtx.c **** 	uint16_t gio_save;
1427:bluetooth_rxtx.c **** 
1428:bluetooth_rxtx.c **** 	uint32_t clkn_saved = 0;
1429:bluetooth_rxtx.c **** 
1430:bluetooth_rxtx.c **** 	uint16_t preamble = (target.syncword & 1) == 1 ? 0x5555 : 0xaaaa;
1431:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
1432:bluetooth_rxtx.c **** 
1433:bluetooth_rxtx.c **** 	uint8_t data[16] = {
1434:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
1435:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
1436:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 16) & 0xFF),
1437:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 24) & 0xFF),
1438:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 32) & 0xFF),
1439:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 40) & 0xFF),
1440:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 48) & 0xFF),
1441:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 56) & 0xFF),
1442:bluetooth_rxtx.c **** 		reverse8(trailer),
1443:bluetooth_rxtx.c **** 		reverse8(0x77),
1444:bluetooth_rxtx.c **** 		reverse8(0x66),
1445:bluetooth_rxtx.c **** 		reverse8(0x55),
1446:bluetooth_rxtx.c **** 		reverse8(0x44),
1447:bluetooth_rxtx.c **** 		reverse8(0x33),
1448:bluetooth_rxtx.c **** 		reverse8(0x22),
1449:bluetooth_rxtx.c **** 		reverse8(0x11)
1450:bluetooth_rxtx.c **** 	};
1451:bluetooth_rxtx.c **** 
1452:bluetooth_rxtx.c **** 	cc2400_tx_sync(reverse16(preamble));
1453:bluetooth_rxtx.c **** 
1454:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
1455:bluetooth_rxtx.c **** 
1456:bluetooth_rxtx.c **** 	// set GIO to FIFO_FULL
1457:bluetooth_rxtx.c **** 	gio_save = cc2400_get(IOCFG);
1458:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
1459:bluetooth_rxtx.c **** 
1460:bluetooth_rxtx.c **** 	while ( requested_mode == MODE_TX_SYMBOLS )
1461:bluetooth_rxtx.c **** 	{
1462:bluetooth_rxtx.c **** 
1463:bluetooth_rxtx.c **** 		while ((clkn >> 1) == (clkn_saved >> 1) || T0TC < 2250) {
1464:bluetooth_rxtx.c **** 
1465:bluetooth_rxtx.c **** 			// If timer says time to hop, do it.
1466:bluetooth_rxtx.c **** 			if (do_hop) {
1467:bluetooth_rxtx.c **** 				hop();
1468:bluetooth_rxtx.c **** 			}
ARM GAS  /tmp/ccDKg7Fp.s 			page 36


1469:bluetooth_rxtx.c **** 		}
1470:bluetooth_rxtx.c **** 
1471:bluetooth_rxtx.c **** 		clkn_saved = clkn;
1472:bluetooth_rxtx.c **** 
1473:bluetooth_rxtx.c **** 		TXLED_SET;
1474:bluetooth_rxtx.c **** 
1475:bluetooth_rxtx.c **** 		cc2400_fifo_write(16, data);
1476:bluetooth_rxtx.c **** 
1477:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1478:bluetooth_rxtx.c **** 		TXLED_CLR;
1479:bluetooth_rxtx.c **** 
1480:bluetooth_rxtx.c **** 		cc2400_strobe(SRFOFF);
1481:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
1482:bluetooth_rxtx.c **** 
1483:bluetooth_rxtx.c **** 		while (!(cc2400_status() & XOSC16M_STABLE));
1484:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
1485:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
1486:bluetooth_rxtx.c **** 
1487:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1488:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
1489:bluetooth_rxtx.c **** 
1490:bluetooth_rxtx.c **** 		handle_usb(clkn);
1491:bluetooth_rxtx.c **** 	}
1492:bluetooth_rxtx.c **** 
1493:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1494:bluetooth_rxtx.c **** 	PAEN_CLR;
1495:bluetooth_rxtx.c **** #endif
1496:bluetooth_rxtx.c **** 
1497:bluetooth_rxtx.c **** 	// reset GIO
1498:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, gio_save);
1499:bluetooth_rxtx.c **** }
1500:bluetooth_rxtx.c **** 
1501:bluetooth_rxtx.c **** /* set LE access address */
1502:bluetooth_rxtx.c **** static void le_set_access_address(u32 aa) {
 458              		.loc 1 1502 0
 459              		.cfi_startproc
 460              		@ args = 0, pretend = 0, frame = 0
 461              		@ frame_needed = 0, uses_anonymous_args = 0
 462              	.LVL47:
 463 0000 10B5     		push	{r4, lr}
 464              		.cfi_def_cfa_offset 8
 465              		.cfi_offset 4, -8
 466              		.cfi_offset 14, -4
1503:bluetooth_rxtx.c **** 	u32 aa_rev;
1504:bluetooth_rxtx.c **** 
1505:bluetooth_rxtx.c **** 	le.access_address = aa;
 467              		.loc 1 1505 0
 468 0002 044C     		ldr	r4, .L42
 469 0004 6060     		str	r0, [r4, #4]
1506:bluetooth_rxtx.c **** 	aa_rev = rbit(aa);
 470              		.loc 1 1506 0
 471 0006 FFF7FEFF 		bl	rbit
 472              	.LVL48:
1507:bluetooth_rxtx.c **** 	le.syncl = aa_rev & 0xffff;
 473              		.loc 1 1507 0
 474 000a 6081     		strh	r0, [r4, #10]	@ movhi
1508:bluetooth_rxtx.c **** 	le.synch = aa_rev >> 16;
ARM GAS  /tmp/ccDKg7Fp.s 			page 37


 475              		.loc 1 1508 0
 476 000c 000C     		lsrs	r0, r0, #16
 477              	.LVL49:
 478 000e 2081     		strh	r0, [r4, #8]	@ movhi
 479 0010 10BD     		pop	{r4, pc}
 480              	.L43:
 481 0012 00BF     		.align	2
 482              	.L42:
 483 0014 00000000 		.word	.LANCHOR1
 484              		.cfi_endproc
 485              	.LFE19:
 487              		.section	.text.cc2400_idle,"ax",%progbits
 488              		.align	1
 489              		.thumb
 490              		.thumb_func
 492              	cc2400_idle:
 493              	.LFB8:
 884:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 494              		.loc 1 884 0
 495              		.cfi_startproc
 496              		@ args = 0, pretend = 0, frame = 0
 497              		@ frame_needed = 0, uses_anonymous_args = 0
 498 0000 10B5     		push	{r4, lr}
 499              		.cfi_def_cfa_offset 8
 500              		.cfi_offset 4, -8
 501              		.cfi_offset 14, -4
 885:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 502              		.loc 1 885 0
 503 0002 6420     		movs	r0, #100
 504 0004 FFF7FEFF 		bl	cc2400_strobe
 505              	.LVL50:
 506              	.L45:
 886:bluetooth_rxtx.c **** 
 507              		.loc 1 886 0 discriminator 1
 508 0008 FFF7FEFF 		bl	cc2400_status
 509              	.LVL51:
 510 000c 00F00400 		and	r0, r0, #4
 511 0010 00F0FF04 		and	r4, r0, #255
 512 0014 0028     		cmp	r0, #0
 513 0016 F7D1     		bne	.L45
 889:bluetooth_rxtx.c **** 	HGM_CLR;
 514              		.loc 1 889 0
 515 0018 214B     		ldr	r3, .L47
 516 001a 8022     		movs	r2, #128
 517 001c 1A60     		str	r2, [r3]
 893:bluetooth_rxtx.c **** 	TXLED_CLR;
 518              		.loc 1 893 0
 519 001e 1021     		movs	r1, #16
 890:bluetooth_rxtx.c **** #endif
 520              		.loc 1 890 0
 521 0020 4FF48072 		mov	r2, #256
 522 0024 1A60     		str	r2, [r3]
 893:bluetooth_rxtx.c **** 	TXLED_CLR;
 523              		.loc 1 893 0
 524 0026 43F8201C 		str	r1, [r3, #-32]
 894:bluetooth_rxtx.c **** 	USRLED_CLR;
 525              		.loc 1 894 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 38


 526 002a 43F8202C 		str	r2, [r3, #-32]
 895:bluetooth_rxtx.c **** 
 527              		.loc 1 895 0
 528 002e 0222     		movs	r2, #2
 529 0030 43F8202C 		str	r2, [r3, #-32]
 897:bluetooth_rxtx.c **** 	dio_ssp_stop();
 530              		.loc 1 897 0
 531 0034 FFF7FEFF 		bl	clkn_stop
 532              	.LVL52:
 898:bluetooth_rxtx.c **** 	cs_reset();
 533              		.loc 1 898 0
 534 0038 FFF7FEFF 		bl	dio_ssp_stop
 535              	.LVL53:
 899:bluetooth_rxtx.c **** 	rssi_reset();
 536              		.loc 1 899 0
 537 003c FFF7FEFF 		bl	cs_reset
 538              	.LVL54:
 900:bluetooth_rxtx.c **** 
 539              		.loc 1 900 0
 540 0040 FFF7FEFF 		bl	rssi_reset
 541              	.LVL55:
 905:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 542              		.loc 1 905 0
 543 0044 40F68911 		movw	r1, #2441
 903:bluetooth_rxtx.c **** 	do_hop = 0;
 544              		.loc 1 903 0
 545 0048 164B     		ldr	r3, .L47+4
 905:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 546              		.loc 1 905 0
 547 004a 174A     		ldr	r2, .L47+8
 903:bluetooth_rxtx.c **** 	do_hop = 0;
 548              		.loc 1 903 0
 549 004c 9C72     		strb	r4, [r3, #10]
 904:bluetooth_rxtx.c **** 	channel = 2441;
 550              		.loc 1 904 0
 551 004e DC72     		strb	r4, [r3, #11]
 905:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 552              		.loc 1 905 0
 553 0050 1180     		strh	r1, [r2]	@ movhi
 907:bluetooth_rxtx.c **** 	requested_channel = 0;
 554              		.loc 1 907 0
 555 0052 9E21     		movs	r1, #158
 906:bluetooth_rxtx.c **** 	hop_timeout = 158;
 556              		.loc 1 906 0
 557 0054 9C81     		strh	r4, [r3, #12]	@ movhi
 907:bluetooth_rxtx.c **** 	requested_channel = 0;
 558              		.loc 1 907 0
 559 0056 A2F85010 		strh	r1, [r2, #80]	@ movhi
 909:bluetooth_rxtx.c **** 
 560              		.loc 1 909 0
 561 005a 40F66211 		movw	r1, #2402
 908:bluetooth_rxtx.c **** 	le_adv_channel = 2402;
 562              		.loc 1 908 0
 563 005e DC81     		strh	r4, [r3, #14]	@ movhi
 909:bluetooth_rxtx.c **** 
 564              		.loc 1 909 0
 565 0060 A2F85210 		strh	r1, [r2, #82]	@ movhi
ARM GAS  /tmp/ccDKg7Fp.s 			page 39


 913:bluetooth_rxtx.c **** 	idle_buf_clk100ns = 0;
 566              		.loc 1 913 0
 567 0064 9C70     		strb	r4, [r3, #2]
 914:bluetooth_rxtx.c **** 	idle_buf_channel = 0;
 568              		.loc 1 914 0
 569 0066 5C60     		str	r4, [r3, #4]
 915:bluetooth_rxtx.c **** 	dma_discard = 0;
 570              		.loc 1 915 0
 571 0068 1C81     		strh	r4, [r3, #8]	@ movhi
 916:bluetooth_rxtx.c **** 	status = 0;
 572              		.loc 1 916 0
 573 006a 1C74     		strb	r4, [r3, #16]
 917:bluetooth_rxtx.c **** 
 574              		.loc 1 917 0
 575 006c 5C70     		strb	r4, [r3, #1]
 920:bluetooth_rxtx.c **** 	requested_mode = MODE_IDLE;
 576              		.loc 1 920 0
 577 006e 5C74     		strb	r4, [r3, #17]
 921:bluetooth_rxtx.c **** 	jam_mode = JAM_NONE;
 578              		.loc 1 921 0
 579 0070 9C74     		strb	r4, [r3, #18]
 922:bluetooth_rxtx.c **** 	ego_mode = EGO_FOLLOW;
 580              		.loc 1 922 0
 581 0072 DC74     		strb	r4, [r3, #19]
 923:bluetooth_rxtx.c **** 
 582              		.loc 1 923 0
 583 0074 1C75     		strb	r4, [r3, #20]
 925:bluetooth_rxtx.c **** 
 584              		.loc 1 925 0
 585 0076 1C70     		strb	r4, [r3]
 928:bluetooth_rxtx.c **** 	high_freq = 2483;
 586              		.loc 1 928 0
 587 0078 4FF41663 		mov	r3, #2400
 588 007c A2F85430 		strh	r3, [r2, #84]	@ movhi
 929:bluetooth_rxtx.c **** 	rssi_threshold = -30;
 589              		.loc 1 929 0
 590 0080 40F6B313 		movw	r3, #2483
 591 0084 A2F85630 		strh	r3, [r2, #86]	@ movhi
 930:bluetooth_rxtx.c **** 
 592              		.loc 1 930 0
 593 0088 E223     		movs	r3, #226
 594 008a 82F85830 		strb	r3, [r2, #88]
 932:bluetooth_rxtx.c **** 	target.syncword = 0;
 595              		.loc 1 932 0
 596 008e 074B     		ldr	r3, .L47+12
 597 0090 0020     		movs	r0, #0
 598 0092 0021     		movs	r1, #0
 599 0094 C3E90001 		strd	r0, [r3]
 933:bluetooth_rxtx.c **** }
 600              		.loc 1 933 0
 601 0098 C3E90201 		strd	r0, [r3, #8]
 602 009c 10BD     		pop	{r4, pc}
 603              	.L48:
 604 009e 00BF     		.align	2
 605              	.L47:
 606 00a0 5CC00920 		.word	537509980
 607 00a4 00000000 		.word	.LANCHOR0
ARM GAS  /tmp/ccDKg7Fp.s 			page 40


 608 00a8 00000000 		.word	.LANCHOR1
 609 00ac 00000000 		.word	target
 610              		.cfi_endproc
 611              	.LFE8:
 613              		.section	.text.cb_follow_le,"ax",%progbits
 614              		.align	1
 615              		.global	cb_follow_le
 616              		.thumb
 617              		.thumb_func
 619              	cb_follow_le:
 620              	.LFB24:
1509:bluetooth_rxtx.c **** }
1510:bluetooth_rxtx.c **** 
1511:bluetooth_rxtx.c **** /* reset le state, called by bt_generic_le and bt_follow_le() */
1512:bluetooth_rxtx.c **** void reset_le() {
1513:bluetooth_rxtx.c **** 	le_set_access_address(0x8e89bed6);     // advertising channel access address
1514:bluetooth_rxtx.c **** 	le.crc_init  = 0x555555;               // advertising channel CRCInit
1515:bluetooth_rxtx.c **** 	le.crc_init_reversed = 0xAAAAAA;
1516:bluetooth_rxtx.c **** 	le.crc_verify = 0;
1517:bluetooth_rxtx.c **** 	le.last_packet = 0;
1518:bluetooth_rxtx.c **** 
1519:bluetooth_rxtx.c **** 	le.link_state = LINK_INACTIVE;
1520:bluetooth_rxtx.c **** 
1521:bluetooth_rxtx.c **** 	le.channel_idx = 0;
1522:bluetooth_rxtx.c **** 	le.channel_increment = 0;
1523:bluetooth_rxtx.c **** 
1524:bluetooth_rxtx.c **** 	le.conn_epoch = 0;
1525:bluetooth_rxtx.c **** 	le.interval_timer = 0;
1526:bluetooth_rxtx.c **** 	le.conn_interval = 0;
1527:bluetooth_rxtx.c **** 	le.conn_interval = 0;
1528:bluetooth_rxtx.c **** 	le.conn_count = 0;
1529:bluetooth_rxtx.c **** 
1530:bluetooth_rxtx.c **** 	le.win_size = 0;
1531:bluetooth_rxtx.c **** 	le.win_offset = 0;
1532:bluetooth_rxtx.c **** 
1533:bluetooth_rxtx.c **** 	le.update_pending = 0;
1534:bluetooth_rxtx.c **** 	le.update_instant = 0;
1535:bluetooth_rxtx.c **** 	le.interval_update = 0;
1536:bluetooth_rxtx.c **** 	le.win_size_update = 0;
1537:bluetooth_rxtx.c **** 	le.win_offset_update = 0;
1538:bluetooth_rxtx.c **** 
1539:bluetooth_rxtx.c **** 	do_hop = 0;
1540:bluetooth_rxtx.c **** }
1541:bluetooth_rxtx.c **** 
1542:bluetooth_rxtx.c **** // reset LE Promisc state
1543:bluetooth_rxtx.c **** void reset_le_promisc(void) {
1544:bluetooth_rxtx.c **** 	memset(&le_promisc, 0, sizeof(le_promisc));
1545:bluetooth_rxtx.c **** 	le_promisc.smallest_hop_interval = 0xffffffff;
1546:bluetooth_rxtx.c **** }
1547:bluetooth_rxtx.c **** 
1548:bluetooth_rxtx.c **** /* generic le mode */
1549:bluetooth_rxtx.c **** void bt_generic_le(u8 active_mode)
1550:bluetooth_rxtx.c **** {
1551:bluetooth_rxtx.c **** 	u8 hold;
1552:bluetooth_rxtx.c **** 	int i, j;
1553:bluetooth_rxtx.c **** 	int8_t rssi, rssi_at_trigger;
1554:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccDKg7Fp.s 			page 41


1555:bluetooth_rxtx.c **** 	modulation = MOD_BT_LOW_ENERGY;
1556:bluetooth_rxtx.c **** 	mode = active_mode;
1557:bluetooth_rxtx.c **** 
1558:bluetooth_rxtx.c **** 	reset_le();
1559:bluetooth_rxtx.c **** 
1560:bluetooth_rxtx.c **** 	// enable USB interrupts
1561:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
1562:bluetooth_rxtx.c **** 
1563:bluetooth_rxtx.c **** 	RXLED_CLR;
1564:bluetooth_rxtx.c **** 
1565:bluetooth_rxtx.c **** 	usb_queue_init();
1566:bluetooth_rxtx.c **** 	dio_ssp_init();
1567:bluetooth_rxtx.c **** 	dma_init_rx_symbols();
1568:bluetooth_rxtx.c **** 	dio_ssp_start();
1569:bluetooth_rxtx.c **** 	cc2400_rx();
1570:bluetooth_rxtx.c **** 
1571:bluetooth_rxtx.c **** 	cs_trigger_enable();
1572:bluetooth_rxtx.c **** 
1573:bluetooth_rxtx.c **** 	hold = 0;
1574:bluetooth_rxtx.c **** 
1575:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
1576:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
1577:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1578:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
1579:bluetooth_rxtx.c **** 
1580:bluetooth_rxtx.c **** 			/* Retune */
1581:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
1582:bluetooth_rxtx.c **** 
1583:bluetooth_rxtx.c **** 			/* Wait for lock */
1584:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
1585:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
1586:bluetooth_rxtx.c **** 
1587:bluetooth_rxtx.c **** 			/* RX mode */
1588:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
1589:bluetooth_rxtx.c **** 
1590:bluetooth_rxtx.c **** 			requested_channel = 0;
1591:bluetooth_rxtx.c **** 		}
1592:bluetooth_rxtx.c **** 
1593:bluetooth_rxtx.c **** 		if (do_hop) {
1594:bluetooth_rxtx.c **** 			hop();
1595:bluetooth_rxtx.c **** 		} else {
1596:bluetooth_rxtx.c **** 			TXLED_CLR;
1597:bluetooth_rxtx.c **** 		}
1598:bluetooth_rxtx.c **** 
1599:bluetooth_rxtx.c **** 		RXLED_CLR;
1600:bluetooth_rxtx.c **** 
1601:bluetooth_rxtx.c **** 		/* Wait for DMA. Meanwhile keep track of RSSI. */
1602:bluetooth_rxtx.c **** 		rssi_reset();
1603:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
1604:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0))
1605:bluetooth_rxtx.c **** 		{
1606:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1607:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
1608:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
1609:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
1610:bluetooth_rxtx.c **** 			}
1611:bluetooth_rxtx.c **** 			rssi_add(rssi);
ARM GAS  /tmp/ccDKg7Fp.s 			page 42


1612:bluetooth_rxtx.c **** 		}
1613:bluetooth_rxtx.c **** 
1614:bluetooth_rxtx.c **** 		if (rx_err) {
1615:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1616:bluetooth_rxtx.c **** 		}
1617:bluetooth_rxtx.c **** 
1618:bluetooth_rxtx.c **** 		/* No DMA transfer? */
1619:bluetooth_rxtx.c **** 		if (!rx_tc)
1620:bluetooth_rxtx.c **** 			goto rx_continue;
1621:bluetooth_rxtx.c **** 
1622:bluetooth_rxtx.c **** 		/* Missed a DMA trasfer? */
1623:bluetooth_rxtx.c **** 		if (rx_tc > 1)
1624:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
1625:bluetooth_rxtx.c **** 
1626:bluetooth_rxtx.c **** 		rssi_iir_update(channel);
1627:bluetooth_rxtx.c **** 
1628:bluetooth_rxtx.c **** 		/* Set squelch hold if there was either a CS trigger, squelch
1629:bluetooth_rxtx.c **** 		 * is disabled, or if the current rssi_max is above the same
1630:bluetooth_rxtx.c **** 		 * threshold. Currently, this is redundant, but allows for
1631:bluetooth_rxtx.c **** 		 * per-channel or other rssi triggers in the future. */
1632:bluetooth_rxtx.c **** 		if (cs_trigger || cs_no_squelch) {
1633:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
1634:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
1635:bluetooth_rxtx.c **** 			cs_trigger = 0;
1636:bluetooth_rxtx.c **** 		}
1637:bluetooth_rxtx.c **** 
1638:bluetooth_rxtx.c **** 		if (rssi_max >= (cs_threshold_cur + 54)) {
1639:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
1640:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
1641:bluetooth_rxtx.c **** 		}
1642:bluetooth_rxtx.c **** 
1643:bluetooth_rxtx.c **** 		/* Hold expired? Ignore data. */
1644:bluetooth_rxtx.c **** 		if (hold == 0) {
1645:bluetooth_rxtx.c **** 			goto rx_continue;
1646:bluetooth_rxtx.c **** 		}
1647:bluetooth_rxtx.c **** 		hold--;
1648:bluetooth_rxtx.c **** 
1649:bluetooth_rxtx.c **** 		// copy the previously unpacked symbols to the front of the buffer
1650:bluetooth_rxtx.c **** 		memcpy(unpacked, unpacked + DMA_SIZE*8, DMA_SIZE*8);
1651:bluetooth_rxtx.c **** 
1652:bluetooth_rxtx.c **** 		// unpack the new packet to the end of the buffer
1653:bluetooth_rxtx.c **** 		for (i = 0; i < DMA_SIZE; ++i) {
1654:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
1655:bluetooth_rxtx.c **** 			for (j = 0; j < 8; ++j) {
1656:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
1657:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
1658:bluetooth_rxtx.c **** 			}
1659:bluetooth_rxtx.c **** 		}
1660:bluetooth_rxtx.c **** 
1661:bluetooth_rxtx.c **** 		int ret = data_cb(unpacked);
1662:bluetooth_rxtx.c **** 		if (!ret) break;
1663:bluetooth_rxtx.c **** 
1664:bluetooth_rxtx.c **** 	rx_continue:
1665:bluetooth_rxtx.c **** 		rx_tc = 0;
1666:bluetooth_rxtx.c **** 		rx_err = 0;
1667:bluetooth_rxtx.c **** 	}
1668:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccDKg7Fp.s 			page 43


1669:bluetooth_rxtx.c **** 	// disable USB interrupts
1670:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
1671:bluetooth_rxtx.c **** 
1672:bluetooth_rxtx.c **** 	// reset the radio completely
1673:bluetooth_rxtx.c **** 	cc2400_idle();
1674:bluetooth_rxtx.c **** 	dio_ssp_stop();
1675:bluetooth_rxtx.c **** 	cs_trigger_disable();
1676:bluetooth_rxtx.c **** }
1677:bluetooth_rxtx.c **** 
1678:bluetooth_rxtx.c **** 
1679:bluetooth_rxtx.c **** void bt_le_sync(u8 active_mode)
1680:bluetooth_rxtx.c **** {
1681:bluetooth_rxtx.c **** 	int i;
1682:bluetooth_rxtx.c **** 	int8_t rssi;
1683:bluetooth_rxtx.c **** 	static int restart_jamming = 0;
1684:bluetooth_rxtx.c **** 
1685:bluetooth_rxtx.c **** 	modulation = MOD_BT_LOW_ENERGY;
1686:bluetooth_rxtx.c **** 	mode = active_mode;
1687:bluetooth_rxtx.c **** 
1688:bluetooth_rxtx.c **** 	le.link_state = LINK_LISTENING;
1689:bluetooth_rxtx.c **** 
1690:bluetooth_rxtx.c **** 	// enable USB interrupts
1691:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
1692:bluetooth_rxtx.c **** 
1693:bluetooth_rxtx.c **** 	RXLED_CLR;
1694:bluetooth_rxtx.c **** 
1695:bluetooth_rxtx.c **** 	usb_queue_init();
1696:bluetooth_rxtx.c **** 	dio_ssp_init();
1697:bluetooth_rxtx.c **** 	dma_init_le();
1698:bluetooth_rxtx.c **** 	dio_ssp_start();
1699:bluetooth_rxtx.c **** 
1700:bluetooth_rxtx.c **** 	cc2400_rx_sync(rbit(le.access_address)); // bit-reversed access address
1701:bluetooth_rxtx.c **** 
1702:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
1703:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
1704:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1705:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
1706:bluetooth_rxtx.c **** 
1707:bluetooth_rxtx.c **** 			/* Retune */
1708:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
1709:bluetooth_rxtx.c **** 
1710:bluetooth_rxtx.c **** 			/* Wait for lock */
1711:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
1712:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
1713:bluetooth_rxtx.c **** 
1714:bluetooth_rxtx.c **** 			/* RX mode */
1715:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
1716:bluetooth_rxtx.c **** 
1717:bluetooth_rxtx.c **** 			requested_channel = 0;
1718:bluetooth_rxtx.c **** 		}
1719:bluetooth_rxtx.c **** 
1720:bluetooth_rxtx.c **** 		RXLED_CLR;
1721:bluetooth_rxtx.c **** 
1722:bluetooth_rxtx.c **** 		/* Wait for DMA. Meanwhile keep track of RSSI. */
1723:bluetooth_rxtx.c **** 		rssi_reset();
1724:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0) && (do_hop == 0) && requested_mode == active_mode)
1725:bluetooth_rxtx.c **** 			;
ARM GAS  /tmp/ccDKg7Fp.s 			page 44


1726:bluetooth_rxtx.c **** 
1727:bluetooth_rxtx.c **** 		rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1728:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
1729:bluetooth_rxtx.c **** 
1730:bluetooth_rxtx.c **** 		if (requested_mode != active_mode) {
1731:bluetooth_rxtx.c **** 			goto cleanup;
1732:bluetooth_rxtx.c **** 		}
1733:bluetooth_rxtx.c **** 
1734:bluetooth_rxtx.c **** 		if (rx_err) {
1735:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1736:bluetooth_rxtx.c **** 		}
1737:bluetooth_rxtx.c **** 
1738:bluetooth_rxtx.c **** 		if (do_hop)
1739:bluetooth_rxtx.c **** 			goto rx_flush;
1740:bluetooth_rxtx.c **** 
1741:bluetooth_rxtx.c **** 		/* No DMA transfer? */
1742:bluetooth_rxtx.c **** 		if (!rx_tc)
1743:bluetooth_rxtx.c **** 			continue;
1744:bluetooth_rxtx.c **** 
1745:bluetooth_rxtx.c **** 		/////////////////////
1746:bluetooth_rxtx.c **** 		// process the packet
1747:bluetooth_rxtx.c **** 
1748:bluetooth_rxtx.c **** 		uint32_t packet[48/4+1] = { 0, };
1749:bluetooth_rxtx.c **** 		u8 *p = (u8 *)packet;
1750:bluetooth_rxtx.c **** 		packet[0] = le.access_address;
1751:bluetooth_rxtx.c **** 
1752:bluetooth_rxtx.c **** 		const uint32_t *whit = whitening_word[btle_channel_index(channel)];
1753:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
1754:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
1755:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
1756:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
1757:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
1758:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
1759:bluetooth_rxtx.c **** 		}
1760:bluetooth_rxtx.c **** 
1761:bluetooth_rxtx.c **** 		unsigned len = (p[5] & 0x3f) + 2;
1762:bluetooth_rxtx.c **** 		if (len > 39)
1763:bluetooth_rxtx.c **** 			goto rx_flush;
1764:bluetooth_rxtx.c **** 
1765:bluetooth_rxtx.c **** 		// transfer the minimum number of bytes from the CC2400
1766:bluetooth_rxtx.c **** 		// this allows us enough time to resume RX for subsequent packets on the same channel
1767:bluetooth_rxtx.c **** 		unsigned total_transfers = ((len + 3) + 4 - 1) / 4;
1768:bluetooth_rxtx.c **** 		if (total_transfers < 11) {
1769:bluetooth_rxtx.c **** 			while (DMACC0DestAddr < (uint32_t)rxbuf1 + 4 * total_transfers && rx_err == 0)
1770:bluetooth_rxtx.c **** 				;
1771:bluetooth_rxtx.c **** 		} else { // max transfers? just wait till DMA's done
1772:bluetooth_rxtx.c **** 			while (DMACC0Config & DMACCxConfig_E && rx_err == 0)
1773:bluetooth_rxtx.c **** 				;
1774:bluetooth_rxtx.c **** 		}
1775:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
1776:bluetooth_rxtx.c **** 
1777:bluetooth_rxtx.c **** 		// strobe SFSON to allow the resync to occur while we process the packet
1778:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
1779:bluetooth_rxtx.c **** 
1780:bluetooth_rxtx.c **** 		// unwhiten the rest of the packet
1781:bluetooth_rxtx.c **** 		for (i = 4; i < 44; i += 4) {
1782:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
ARM GAS  /tmp/ccDKg7Fp.s 			page 45


1783:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
1784:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
1785:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
1786:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
1787:bluetooth_rxtx.c **** 		}
1788:bluetooth_rxtx.c **** 
1789:bluetooth_rxtx.c **** 		if (le.crc_verify) {
1790:bluetooth_rxtx.c **** 			u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, p + 4, len);
1791:bluetooth_rxtx.c **** 			u32 wire_crc = (p[4+len+2] << 16)
1792:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
1793:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
1794:bluetooth_rxtx.c **** 			if (calc_crc != wire_crc) // skip packets with a bad CRC
1795:bluetooth_rxtx.c **** 				goto rx_flush;
1796:bluetooth_rxtx.c **** 		}
1797:bluetooth_rxtx.c **** 
1798:bluetooth_rxtx.c **** 
1799:bluetooth_rxtx.c **** 		RXLED_SET;
1800:bluetooth_rxtx.c **** 		packet_cb((uint8_t *)packet);
1801:bluetooth_rxtx.c **** 
1802:bluetooth_rxtx.c **** 		// disable USB interrupts while we touch USB data structures
1803:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
1804:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t *)packet);
1805:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
1806:bluetooth_rxtx.c **** 
1807:bluetooth_rxtx.c **** 		le.last_packet = CLK100NS;
1808:bluetooth_rxtx.c **** 
1809:bluetooth_rxtx.c **** 	rx_flush:
1810:bluetooth_rxtx.c **** 		// this might happen twice, but it's safe to do so
1811:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
1812:bluetooth_rxtx.c **** 
1813:bluetooth_rxtx.c **** 		// flush any excess bytes from the SSP's buffer
1814:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
1815:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
1816:bluetooth_rxtx.c **** 			u8 tmp = (u8)DIO_SSP_DR;
1817:bluetooth_rxtx.c **** 		}
1818:bluetooth_rxtx.c **** 
1819:bluetooth_rxtx.c **** 		// timeout - FIXME this is an ugly hack
1820:bluetooth_rxtx.c **** 		u32 now = CLK100NS;
1821:bluetooth_rxtx.c **** 		if (now < le.last_packet)
1822:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
1823:bluetooth_rxtx.c **** 		if  ( // timeout
1824:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
1825:bluetooth_rxtx.c **** 			&& (now - le.last_packet > 50000000))
1826:bluetooth_rxtx.c **** 			// jam finished
1827:bluetooth_rxtx.c **** 			|| (le_jam_count == 1)
1828:bluetooth_rxtx.c **** 			)
1829:bluetooth_rxtx.c **** 		{
1830:bluetooth_rxtx.c **** 			reset_le();
1831:bluetooth_rxtx.c **** 			le_jam_count = 0;
1832:bluetooth_rxtx.c **** 			TXLED_CLR;
1833:bluetooth_rxtx.c **** 
1834:bluetooth_rxtx.c **** 			if (jam_mode == JAM_ONCE) {
1835:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
1836:bluetooth_rxtx.c **** 				requested_mode = MODE_IDLE;
1837:bluetooth_rxtx.c **** 				goto cleanup;
1838:bluetooth_rxtx.c **** 			}
1839:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccDKg7Fp.s 			page 46


1840:bluetooth_rxtx.c **** 			// go back to promisc if the connection dies
1841:bluetooth_rxtx.c **** 			if (active_mode == MODE_BT_PROMISC_LE)
1842:bluetooth_rxtx.c **** 				goto cleanup;
1843:bluetooth_rxtx.c **** 
1844:bluetooth_rxtx.c **** 			le.link_state = LINK_LISTENING;
1845:bluetooth_rxtx.c **** 
1846:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1847:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
1848:bluetooth_rxtx.c **** 
1849:bluetooth_rxtx.c **** 			/* Retune */
1850:bluetooth_rxtx.c **** 			channel = le_adv_channel != 0 ? le_adv_channel : 2402;
1851:bluetooth_rxtx.c **** 			restart_jamming = 1;
1852:bluetooth_rxtx.c **** 		}
1853:bluetooth_rxtx.c **** 
1854:bluetooth_rxtx.c **** 		cc2400_set(SYNCL, le.syncl);
1855:bluetooth_rxtx.c **** 		cc2400_set(SYNCH, le.synch);
1856:bluetooth_rxtx.c **** 
1857:bluetooth_rxtx.c **** 		if (do_hop)
1858:bluetooth_rxtx.c **** 			hop();
1859:bluetooth_rxtx.c **** 
1860:bluetooth_rxtx.c **** 		//  you can jam but you keep turning off the light 
1861:bluetooth_rxtx.c **** 		if (le_jam_count > 0) {
1862:bluetooth_rxtx.c **** 			le_jam();
1863:bluetooth_rxtx.c **** 			--le_jam_count;
1864:bluetooth_rxtx.c **** 		} else {
1865:bluetooth_rxtx.c **** 			/* RX mode */
1866:bluetooth_rxtx.c **** 			dma_init_le();
1867:bluetooth_rxtx.c **** 			dio_ssp_start();
1868:bluetooth_rxtx.c **** 
1869:bluetooth_rxtx.c **** 			if (restart_jamming) {
1870:bluetooth_rxtx.c **** 				cc2400_rx_sync(rbit(le.access_address));
1871:bluetooth_rxtx.c **** 				restart_jamming = 0;
1872:bluetooth_rxtx.c **** 			} else {
1873:bluetooth_rxtx.c **** 				// wait till we're in FSLOCK before strobing RX
1874:bluetooth_rxtx.c **** 				while (!(cc2400_status() & FS_LOCK));
1875:bluetooth_rxtx.c **** 				cc2400_strobe(SRX);
1876:bluetooth_rxtx.c **** 			}
1877:bluetooth_rxtx.c **** 		}
1878:bluetooth_rxtx.c **** 
1879:bluetooth_rxtx.c **** 		rx_tc = 0;
1880:bluetooth_rxtx.c **** 		rx_err = 0;
1881:bluetooth_rxtx.c **** 	}
1882:bluetooth_rxtx.c **** 
1883:bluetooth_rxtx.c **** cleanup:
1884:bluetooth_rxtx.c **** 
1885:bluetooth_rxtx.c **** 	// disable USB interrupts
1886:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
1887:bluetooth_rxtx.c **** 
1888:bluetooth_rxtx.c **** 	// reset the radio completely
1889:bluetooth_rxtx.c **** 	cc2400_idle();
1890:bluetooth_rxtx.c **** 	dio_ssp_stop();
1891:bluetooth_rxtx.c **** 	cs_trigger_disable();
1892:bluetooth_rxtx.c **** }
1893:bluetooth_rxtx.c **** 
1894:bluetooth_rxtx.c **** 
1895:bluetooth_rxtx.c **** 
1896:bluetooth_rxtx.c **** /* low energy connection following
ARM GAS  /tmp/ccDKg7Fp.s 			page 47


1897:bluetooth_rxtx.c ****  * follows a known AA around */
1898:bluetooth_rxtx.c **** int cb_follow_le() {
 621              		.loc 1 1898 0
 622              		.cfi_startproc
 623              		@ args = 0, pretend = 0, frame = 0
 624              		@ frame_needed = 0, uses_anonymous_args = 0
 625 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 626              		.cfi_def_cfa_offset 24
 627              		.cfi_offset 4, -24
 628              		.cfi_offset 5, -20
 629              		.cfi_offset 6, -16
 630              		.cfi_offset 7, -12
 631              		.cfi_offset 8, -8
 632              		.cfi_offset 14, -4
1899:bluetooth_rxtx.c **** 	int i, j, k;
1900:bluetooth_rxtx.c **** 	int idx = whitening_index[btle_channel_index(channel)];
 633              		.loc 1 1900 0
 634 0004 394D     		ldr	r5, .L65
 635 0006 3A4F     		ldr	r7, .L65+4
 636 0008 2888     		ldrh	r0, [r5]
 637 000a 80B2     		uxth	r0, r0
 638 000c FFF7FEFF 		bl	btle_channel_index
 639              	.LVL56:
1901:bluetooth_rxtx.c **** 
1902:bluetooth_rxtx.c **** 	u32 access_address = 0;
 640              		.loc 1 1902 0
 641 0010 0022     		movs	r2, #0
1903:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 642              		.loc 1 1903 0
 643 0012 1346     		mov	r3, r2
1900:bluetooth_rxtx.c **** 
 644              		.loc 1 1900 0
 645 0014 395C     		ldrb	r1, [r7, r0]	@ zero_extendqisi2
 646              	.LVL57:
 647              	.L50:
1904:bluetooth_rxtx.c **** 		access_address >>= 1;
1905:bluetooth_rxtx.c **** 		access_address |= (unpacked[i] << 31);
 648              		.loc 1 1905 0 discriminator 3
 649 0016 374E     		ldr	r6, .L65+8
 650 0018 985D     		ldrb	r0, [r3, r6]	@ zero_extendqisi2
1903:bluetooth_rxtx.c **** 		access_address >>= 1;
 651              		.loc 1 1903 0 discriminator 3
 652 001a 0133     		adds	r3, r3, #1
 653              	.LVL58:
 654              		.loc 1 1905 0 discriminator 3
 655 001c C007     		lsls	r0, r0, #31
1903:bluetooth_rxtx.c **** 		access_address >>= 1;
 656              		.loc 1 1903 0 discriminator 3
 657 001e 1F2B     		cmp	r3, #31
 658              		.loc 1 1905 0 discriminator 3
 659 0020 40EA5202 		orr	r2, r0, r2, lsr #1
 660              	.LVL59:
1903:bluetooth_rxtx.c **** 		access_address >>= 1;
 661              		.loc 1 1903 0 discriminator 3
 662 0024 F7D1     		bne	.L50
1906:bluetooth_rxtx.c **** 	}
1907:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccDKg7Fp.s 			page 48


1908:bluetooth_rxtx.c **** 	for (i = 31; i < DMA_SIZE * 8 + 32; i++) {
1909:bluetooth_rxtx.c **** 		access_address >>= 1;
1910:bluetooth_rxtx.c **** 		access_address |= (unpacked[i] << 31);
1911:bluetooth_rxtx.c **** 		if (access_address == le.access_address) {
 663              		.loc 1 1911 0
 664 0026 6C68     		ldr	r4, [r5, #4]
 665              	.L60:
 666              	.LVL60:
1910:bluetooth_rxtx.c **** 		if (access_address == le.access_address) {
 667              		.loc 1 1910 0
 668 0028 F05C     		ldrb	r0, [r6, r3]	@ zero_extendqisi2
 669 002a C007     		lsls	r0, r0, #31
 670 002c 40EA5202 		orr	r2, r0, r2, lsr #1
 671              	.LVL61:
 672              		.loc 1 1911 0
 673 0030 A242     		cmp	r2, r4
 674 0032 53D1     		bne	.L51
 675              	.LVL62:
 676 0034 0020     		movs	r0, #0
 677              	.LVL63:
 678              	.L52:
1903:bluetooth_rxtx.c **** 		access_address >>= 1;
 679              		.loc 1 1903 0
 680 0036 4FF00008 		mov	r8, #0
 681 003a C646     		mov	lr, r8
 682 003c 03EBC00C 		add	ip, r3, r0, lsl #3
 683              	.LVL64:
 684              	.L55:
 685 0040 0EEB0C02 		add	r2, lr, ip
 686 0044 3244     		add	r2, r2, r6
 687              	.LBB9:
 688              	.LBB10:
1912:bluetooth_rxtx.c **** 			for (j = 0; j < 46; ++j) {
1913:bluetooth_rxtx.c **** 				u8 byte = 0;
1914:bluetooth_rxtx.c **** 				for (k = 0; k < 8; k++) {
1915:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
1916:bluetooth_rxtx.c **** 					if (offset >= DMA_SIZE*8*2) break;
1917:bluetooth_rxtx.c **** 					int bit = unpacked[offset];
1918:bluetooth_rxtx.c **** 					if (j >= 4) { // unwhiten data bytes
 689              		.loc 1 1918 0
 690 0046 0328     		cmp	r0, #3
1917:bluetooth_rxtx.c **** 					if (j >= 4) { // unwhiten data bytes
 691              		.loc 1 1917 0
 692 0048 12F81F2C 		ldrb	r2, [r2, #-31]	@ zero_extendqisi2
 693              	.LVL65:
 694              		.loc 1 1918 0
 695 004c 0ADD     		ble	.L54
1919:bluetooth_rxtx.c **** 						bit ^= whitening[idx];
 696              		.loc 1 1919 0
 697 004e 7C18     		adds	r4, r7, r1
 698 0050 94F82840 		ldrb	r4, [r4, #40]	@ zero_extendqisi2
1920:bluetooth_rxtx.c **** 						idx = (idx + 1) % sizeof(whitening);
 699              		.loc 1 1920 0
 700 0054 0131     		adds	r1, r1, #1
 701              	.LVL66:
1919:bluetooth_rxtx.c **** 						bit ^= whitening[idx];
 702              		.loc 1 1919 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 49


 703 0056 6240     		eors	r2, r2, r4
 704              	.LVL67:
 705              		.loc 1 1920 0
 706 0058 7F24     		movs	r4, #127
 707 005a B1FBF4F4 		udiv	r4, r1, r4
 708 005e C4EBC414 		rsb	r4, r4, r4, lsl #7
 709 0062 091B     		subs	r1, r1, r4
 710              	.LVL68:
 711              	.L54:
1921:bluetooth_rxtx.c **** 					}
1922:bluetooth_rxtx.c **** 					byte |= bit << k;
 712              		.loc 1 1922 0 discriminator 2
 713 0064 02FA0EF2 		lsl	r2, r2, lr
 714              	.LVL69:
 715              	.LBE10:
1914:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 716              		.loc 1 1914 0 discriminator 2
 717 0068 0EF1010E 		add	lr, lr, #1
 718              	.LVL70:
 719              	.LBB11:
 720              		.loc 1 1922 0 discriminator 2
 721 006c 42EA0802 		orr	r2, r2, r8
 722              	.LBE11:
1914:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 723              		.loc 1 1914 0 discriminator 2
 724 0070 BEF1080F 		cmp	lr, #8
 725              	.LBB12:
 726              		.loc 1 1922 0 discriminator 2
 727 0074 5FFA82F8 		uxtb	r8, r2
 728              	.LVL71:
 729              	.LBE12:
1914:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 730              		.loc 1 1914 0 discriminator 2
 731 0078 E2D1     		bne	.L55
1923:bluetooth_rxtx.c **** 				}
1924:bluetooth_rxtx.c **** 				idle_rxbuf[j] = byte;
 732              		.loc 1 1924 0
 733 007a 1F4C     		ldr	r4, .L65+12
 734 007c 2268     		ldr	r2, [r4]
 735 007e 02F80080 		strb	r8, [r2, r0]
 736              	.LBE9:
1912:bluetooth_rxtx.c **** 				u8 byte = 0;
 737              		.loc 1 1912 0
 738 0082 0130     		adds	r0, r0, #1
 739              	.LVL72:
 740 0084 2E28     		cmp	r0, #46
 741 0086 D6D1     		bne	.L52
1925:bluetooth_rxtx.c **** 			}
1926:bluetooth_rxtx.c **** 
1927:bluetooth_rxtx.c **** 			// verify CRC
1928:bluetooth_rxtx.c **** 			if (le.crc_verify) {
 742              		.loc 1 1928 0
 743 0088 6B69     		ldr	r3, [r5, #20]
 744              	.LVL73:
 745 008a 5BB9     		cbnz	r3, .L57
 746              	.LVL74:
 747              	.L59:
ARM GAS  /tmp/ccDKg7Fp.s 			page 50


1929:bluetooth_rxtx.c **** 				int len		 = (idle_rxbuf[5] & 0x3f) + 2;
1930:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
1931:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
1932:bluetooth_rxtx.c **** 							 | (idle_rxbuf[4+len+1] << 8)
1933:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
1934:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
1935:bluetooth_rxtx.c **** 					break;
1936:bluetooth_rxtx.c **** 			}
1937:bluetooth_rxtx.c **** 
1938:bluetooth_rxtx.c **** 			// send to PC
1939:bluetooth_rxtx.c **** 			enqueue(LE_PACKET, (uint8_t*)idle_rxbuf);
 748              		.loc 1 1939 0
 749 008c 2168     		ldr	r1, [r4]
 750 008e 0120     		movs	r0, #1
 751 0090 FFF7FEFF 		bl	enqueue
 752              	.LVL75:
1940:bluetooth_rxtx.c **** 			RXLED_SET;
 753              		.loc 1 1940 0
 754 0094 194B     		ldr	r3, .L65+16
 755 0096 1022     		movs	r2, #16
 756 0098 1A60     		str	r2, [r3]
1941:bluetooth_rxtx.c **** 
1942:bluetooth_rxtx.c **** 			packet_cb((uint8_t*)idle_rxbuf);
 757              		.loc 1 1942 0
 758 009a 194B     		ldr	r3, .L65+20
 759 009c 2068     		ldr	r0, [r4]
 760 009e 9B69     		ldr	r3, [r3, #24]
 761 00a0 9847     		blx	r3
 762              	.LVL76:
1943:bluetooth_rxtx.c **** 
1944:bluetooth_rxtx.c **** 			break;
 763              		.loc 1 1944 0
 764 00a2 1FE0     		b	.L58
 765              	.LVL77:
 766              	.L57:
 767              	.LBB13:
1929:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
 768              		.loc 1 1929 0
 769 00a4 2368     		ldr	r3, [r4]
 770 00a6 5D79     		ldrb	r5, [r3, #5]	@ zero_extendqisi2
1930:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
 771              		.loc 1 1930 0
 772 00a8 104B     		ldr	r3, .L65
 773 00aa 2168     		ldr	r1, [r4]
 774              	.LVL78:
1929:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
 775              		.loc 1 1929 0
 776 00ac 05F03F05 		and	r5, r5, #63
 777              	.LVL79:
1930:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
 778              		.loc 1 1930 0
 779 00b0 AA1C     		adds	r2, r5, #2
 780              	.LVL80:
 781 00b2 1869     		ldr	r0, [r3, #16]
 782              	.LVL81:
 783 00b4 0431     		adds	r1, r1, #4
 784 00b6 FFF7FEFF 		bl	btle_crcgen_lut
ARM GAS  /tmp/ccDKg7Fp.s 			page 51


 785              	.LVL82:
1931:bluetooth_rxtx.c **** 							 | (idle_rxbuf[4+len+1] << 8)
 786              		.loc 1 1931 0
 787 00ba 2268     		ldr	r2, [r4]
 788 00bc 05F10803 		add	r3, r5, #8
 789 00c0 D35C     		ldrb	r3, [r2, r3]	@ zero_extendqisi2
1932:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
 790              		.loc 1 1932 0
 791 00c2 2168     		ldr	r1, [r4]
 792 00c4 EA1D     		adds	r2, r5, #7
 793 00c6 8A5C     		ldrb	r2, [r1, r2]	@ zero_extendqisi2
1933:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
 794              		.loc 1 1933 0
 795 00c8 2168     		ldr	r1, [r4]
 796 00ca 0635     		adds	r5, r5, #6
 797              	.LVL83:
 798 00cc 495D     		ldrb	r1, [r1, r5]	@ zero_extendqisi2
 799              	.LVL84:
1932:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
 800              		.loc 1 1932 0
 801 00ce 1202     		lsls	r2, r2, #8
 802              	.LVL85:
 803 00d0 42EA0343 		orr	r3, r2, r3, lsl #16
1933:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
 804              		.loc 1 1933 0
 805 00d4 0B43     		orrs	r3, r3, r1
1934:bluetooth_rxtx.c **** 					break;
 806              		.loc 1 1934 0
 807 00d6 9842     		cmp	r0, r3
 808 00d8 04D1     		bne	.L58
 809 00da D7E7     		b	.L59
 810              	.LVL86:
 811              	.L51:
 812              	.LBE13:
1908:bluetooth_rxtx.c **** 		access_address >>= 1;
 813              		.loc 1 1908 0 discriminator 2
 814 00dc 0133     		adds	r3, r3, #1
 815              	.LVL87:
 816 00de B3F5D87F 		cmp	r3, #432
 817 00e2 A1D1     		bne	.L60
 818              	.LVL88:
 819              	.L58:
1945:bluetooth_rxtx.c **** 		}
1946:bluetooth_rxtx.c **** 	}
1947:bluetooth_rxtx.c **** 
1948:bluetooth_rxtx.c **** 	return 1;
1949:bluetooth_rxtx.c **** }
 820              		.loc 1 1949 0
 821 00e4 0120     		movs	r0, #1
 822 00e6 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 823              	.L66:
 824 00ea 00BF     		.align	2
 825              	.L65:
 826 00ec 00000000 		.word	.LANCHOR1
 827 00f0 00000000 		.word	.LANCHOR2
 828 00f4 00000000 		.word	unpacked
 829 00f8 00000000 		.word	idle_rxbuf
ARM GAS  /tmp/ccDKg7Fp.s 			page 52


 830 00fc 38C00920 		.word	537509944
 831 0100 00000000 		.word	.LANCHOR0
 832              		.cfi_endproc
 833              	.LFE24:
 835              		.section	.text.connection_follow_cb,"ax",%progbits
 836              		.align	1
 837              		.global	connection_follow_cb
 838              		.thumb
 839              		.thumb_func
 841              	connection_follow_cb:
 842              	.LFB25:
1950:bluetooth_rxtx.c **** 
1951:bluetooth_rxtx.c **** /**
1952:bluetooth_rxtx.c ****  * Called when we receive a packet in connection following mode.
1953:bluetooth_rxtx.c ****  */
1954:bluetooth_rxtx.c **** void connection_follow_cb(u8 *packet) {
 843              		.loc 1 1954 0
 844              		.cfi_startproc
 845              		@ args = 0, pretend = 0, frame = 0
 846              		@ frame_needed = 0, uses_anonymous_args = 0
 847              	.LVL89:
 848 0000 70B5     		push	{r4, r5, r6, lr}
 849              		.cfi_def_cfa_offset 16
 850              		.cfi_offset 4, -16
 851              		.cfi_offset 5, -12
 852              		.cfi_offset 6, -8
 853              		.cfi_offset 14, -4
 854              	.LVL90:
1955:bluetooth_rxtx.c **** 	int i;
1956:bluetooth_rxtx.c **** 	u32 aa = 0;
1957:bluetooth_rxtx.c **** 
1958:bluetooth_rxtx.c **** #define ADV_ADDRESS_IDX 0
1959:bluetooth_rxtx.c **** #define HEADER_IDX 4
1960:bluetooth_rxtx.c **** #define DATA_LEN_IDX 5
1961:bluetooth_rxtx.c **** #define DATA_START_IDX 6
1962:bluetooth_rxtx.c **** 
1963:bluetooth_rxtx.c **** 	// u8 *adv_addr = &packet[ADV_ADDRESS_IDX];
1964:bluetooth_rxtx.c **** 	u8 header = packet[HEADER_IDX];
1965:bluetooth_rxtx.c **** 	u8 *data_len = &packet[DATA_LEN_IDX];
1966:bluetooth_rxtx.c **** 	u8 *data = &packet[DATA_START_IDX];
1967:bluetooth_rxtx.c **** 	// u8 *crc = &packet[DATA_START_IDX + *data_len];
1968:bluetooth_rxtx.c **** 
1969:bluetooth_rxtx.c **** 	if (le.link_state == LINK_CONN_PENDING) {
 855              		.loc 1 1969 0
 856 0002 594B     		ldr	r3, .L84
1954:bluetooth_rxtx.c **** 	int i;
 857              		.loc 1 1954 0
 858 0004 0546     		mov	r5, r0
 859              		.loc 1 1969 0
 860 0006 197E     		ldrb	r1, [r3, #24]	@ zero_extendqisi2
1964:bluetooth_rxtx.c **** 	u8 *data_len = &packet[DATA_LEN_IDX];
 861              		.loc 1 1964 0
 862 0008 0279     		ldrb	r2, [r0, #4]	@ zero_extendqisi2
 863              	.LVL91:
 864              		.loc 1 1969 0
 865 000a 0229     		cmp	r1, #2
 866 000c 1C46     		mov	r4, r3
ARM GAS  /tmp/ccDKg7Fp.s 			page 53


 867 000e 13D1     		bne	.L68
1970:bluetooth_rxtx.c **** 		// We received a packet in the connection pending state, so now the device *should* be connected
1971:bluetooth_rxtx.c **** 		le.link_state = LINK_CONNECTED;
 868              		.loc 1 1971 0
 869 0010 0322     		movs	r2, #3
 870              	.LVL92:
 871 0012 1A76     		strb	r2, [r3, #24]
 872              	.LVL93:
1972:bluetooth_rxtx.c **** 		le.conn_epoch = clkn;
 873              		.loc 1 1972 0
 874 0014 554A     		ldr	r2, .L84+4
 875 0016 1268     		ldr	r2, [r2]
 876 0018 DA61     		str	r2, [r3, #28]
1973:bluetooth_rxtx.c **** 		le.interval_timer = le.conn_interval - 1;
 877              		.loc 1 1973 0
 878 001a 5A8C     		ldrh	r2, [r3, #34]
 879 001c 013A     		subs	r2, r2, #1
 880 001e 92B2     		uxth	r2, r2
 881 0020 1A84     		strh	r2, [r3, #32]	@ movhi
1974:bluetooth_rxtx.c **** 		le.conn_count = 0;
 882              		.loc 1 1974 0
 883 0022 0022     		movs	r2, #0
 884 0024 9A84     		strh	r2, [r3, #36]	@ movhi
1975:bluetooth_rxtx.c **** 		le.update_pending = 0;
 885              		.loc 1 1975 0
 886 0026 DA62     		str	r2, [r3, #44]
1976:bluetooth_rxtx.c **** 
1977:bluetooth_rxtx.c **** 		// hue hue hue
1978:bluetooth_rxtx.c **** 		if (jam_mode != JAM_NONE)
 887              		.loc 1 1978 0
 888 0028 514B     		ldr	r3, .L84+8
 889 002a DA7C     		ldrb	r2, [r3, #19]	@ zero_extendqisi2
 890 002c 002A     		cmp	r2, #0
 891 002e 00F09980 		beq	.L67
1979:bluetooth_rxtx.c **** 			le_jam_count = JAM_COUNT_DEFAULT;
 892              		.loc 1 1979 0
 893 0032 2822     		movs	r2, #40
 894 0034 DA61     		str	r2, [r3, #28]
 895 0036 70BD     		pop	{r4, r5, r6, pc}
 896              	.LVL94:
 897              	.L68:
1980:bluetooth_rxtx.c **** 
1981:bluetooth_rxtx.c **** 	} else if (le.link_state == LINK_CONNECTED) {
 898              		.loc 1 1981 0
 899 0038 0329     		cmp	r1, #3
 900 003a 3BD1     		bne	.L71
 901              	.LBB14:
1982:bluetooth_rxtx.c **** 		u8 llid =  header & 0x03;
1983:bluetooth_rxtx.c **** 
1984:bluetooth_rxtx.c **** 		// Apply any connection parameter update if necessary
1985:bluetooth_rxtx.c **** 		if (le.update_pending && le.conn_count == le.update_instant) {
 902              		.loc 1 1985 0
 903 003c DB6A     		ldr	r3, [r3, #44]
1982:bluetooth_rxtx.c **** 		u8 llid =  header & 0x03;
 904              		.loc 1 1982 0
 905 003e 02F00302 		and	r2, r2, #3
 906              	.LVL95:
ARM GAS  /tmp/ccDKg7Fp.s 			page 54


 907              		.loc 1 1985 0
 908 0042 A3B1     		cbz	r3, .L72
 909              		.loc 1 1985 0 is_stmt 0 discriminator 1
 910 0044 A38C     		ldrh	r3, [r4, #36]
 911 0046 218E     		ldrh	r1, [r4, #48]
 912 0048 9BB2     		uxth	r3, r3
 913 004a 9942     		cmp	r1, r3
 914 004c 0FD1     		bne	.L72
1986:bluetooth_rxtx.c **** 			// This is the first packet received in the connection interval for which the new parameters app
1987:bluetooth_rxtx.c **** 			le.conn_epoch = clkn;
 915              		.loc 1 1987 0 is_stmt 1
 916 004e 474B     		ldr	r3, .L84+4
 917 0050 1B68     		ldr	r3, [r3]
 918 0052 E361     		str	r3, [r4, #28]
 919              	.LVL96:
1988:bluetooth_rxtx.c **** 			le.conn_interval = le.interval_update;
 920              		.loc 1 1988 0
 921 0054 638E     		ldrh	r3, [r4, #50]
 922 0056 6384     		strh	r3, [r4, #34]	@ movhi
1989:bluetooth_rxtx.c **** 			le.interval_timer = le.interval_update - 1;
 923              		.loc 1 1989 0
 924 0058 013B     		subs	r3, r3, #1
 925 005a 9BB2     		uxth	r3, r3
 926 005c 2384     		strh	r3, [r4, #32]	@ movhi
1990:bluetooth_rxtx.c **** 			le.win_size = le.win_size_update;
 927              		.loc 1 1990 0
 928 005e 94F83430 		ldrb	r3, [r4, #52]	@ zero_extendqisi2
 929 0062 84F82630 		strb	r3, [r4, #38]
1991:bluetooth_rxtx.c **** 			le.win_offset = le.win_offset_update;
 930              		.loc 1 1991 0
 931 0066 E38E     		ldrh	r3, [r4, #54]
 932 0068 2385     		strh	r3, [r4, #40]	@ movhi
1992:bluetooth_rxtx.c **** 			le.update_pending = 0;
 933              		.loc 1 1992 0
 934 006a 0023     		movs	r3, #0
 935 006c E362     		str	r3, [r4, #44]
 936              	.L72:
1993:bluetooth_rxtx.c **** 		}
1994:bluetooth_rxtx.c **** 
1995:bluetooth_rxtx.c **** 		if (llid == 0x03 && data[0] == 0x00) {
 937              		.loc 1 1995 0
 938 006e 032A     		cmp	r2, #3
 939 0070 78D1     		bne	.L67
 940              		.loc 1 1995 0 is_stmt 0 discriminator 1
 941 0072 AB79     		ldrb	r3, [r5, #6]	@ zero_extendqisi2
 942 0074 002B     		cmp	r3, #0
 943 0076 75D1     		bne	.L67
1996:bluetooth_rxtx.c **** 			// This is a CONNECTION_UPDATE_REQ.
1997:bluetooth_rxtx.c **** 			// The host is changing the connection parameters.
1998:bluetooth_rxtx.c **** 			le.win_size_update = packet[7];
 944              		.loc 1 1998 0 is_stmt 1
 945 0078 EB79     		ldrb	r3, [r5, #7]	@ zero_extendqisi2
 946 007a 84F83430 		strb	r3, [r4, #52]
1999:bluetooth_rxtx.c **** 			le.win_offset_update = packet[8] + ((u16)packet[9] << 8);
 947              		.loc 1 1999 0
 948 007e 6A7A     		ldrb	r2, [r5, #9]	@ zero_extendqisi2
 949              	.LVL97:
ARM GAS  /tmp/ccDKg7Fp.s 			page 55


 950 0080 2B7A     		ldrb	r3, [r5, #8]	@ zero_extendqisi2
 951 0082 03EB0223 		add	r3, r3, r2, lsl #8
 952 0086 E386     		strh	r3, [r4, #54]	@ movhi
2000:bluetooth_rxtx.c **** 			le.interval_update = packet[10] + ((u16)packet[11] << 8);
 953              		.loc 1 2000 0
 954 0088 EA7A     		ldrb	r2, [r5, #11]	@ zero_extendqisi2
 955 008a AB7A     		ldrb	r3, [r5, #10]	@ zero_extendqisi2
 956 008c 03EB0223 		add	r3, r3, r2, lsl #8
 957 0090 6386     		strh	r3, [r4, #50]	@ movhi
2001:bluetooth_rxtx.c **** 			le.update_instant = packet[16] + ((u16)packet[17] << 8);
 958              		.loc 1 2001 0
 959 0092 6A7C     		ldrb	r2, [r5, #17]	@ zero_extendqisi2
 960 0094 2B7C     		ldrb	r3, [r5, #16]	@ zero_extendqisi2
 961 0096 03EB0223 		add	r3, r3, r2, lsl #8
2002:bluetooth_rxtx.c **** 			if (le.update_instant - le.conn_count < 32767)
 962              		.loc 1 2002 0
 963 009a A28C     		ldrh	r2, [r4, #36]
2001:bluetooth_rxtx.c **** 			le.update_instant = packet[16] + ((u16)packet[17] << 8);
 964              		.loc 1 2001 0
 965 009c 9BB2     		uxth	r3, r3
 966              		.loc 1 2002 0
 967 009e 92B2     		uxth	r2, r2
2001:bluetooth_rxtx.c **** 			le.update_instant = packet[16] + ((u16)packet[17] << 8);
 968              		.loc 1 2001 0
 969 00a0 2386     		strh	r3, [r4, #48]	@ movhi
 970              		.loc 1 2002 0
 971 00a2 9B1A     		subs	r3, r3, r2
 972 00a4 47F6FE72 		movw	r2, #32766
 973 00a8 9342     		cmp	r3, r2
 974 00aa 5BDC     		bgt	.L67
2003:bluetooth_rxtx.c **** 				le.update_pending = 1;
 975              		.loc 1 2003 0
 976 00ac 2E4B     		ldr	r3, .L84
 977 00ae 0122     		movs	r2, #1
 978 00b0 DA62     		str	r2, [r3, #44]
 979 00b2 70BD     		pop	{r4, r5, r6, pc}
 980              	.LVL98:
 981              	.L71:
 982              	.LBE14:
2004:bluetooth_rxtx.c **** 		}
2005:bluetooth_rxtx.c **** 
2006:bluetooth_rxtx.c **** 	} else if (le.link_state == LINK_LISTENING) {
 983              		.loc 1 2006 0
 984 00b4 0129     		cmp	r1, #1
 985 00b6 55D1     		bne	.L67
 986              	.LVL99:
 987              	.LBB15:
2007:bluetooth_rxtx.c **** 		u8 pkt_type = packet[4] & 0x0F;
2008:bluetooth_rxtx.c **** 		if (pkt_type == 0x05) {
 988              		.loc 1 2008 0
 989 00b8 02F00F02 		and	r2, r2, #15
 990              	.LVL100:
 991 00bc 052A     		cmp	r2, #5
 992 00be 51D1     		bne	.L67
 993              	.LBB16:
2009:bluetooth_rxtx.c **** 			uint16_t conn_interval;
2010:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccDKg7Fp.s 			page 56


2011:bluetooth_rxtx.c **** 			// ignore packets with incorrect length
2012:bluetooth_rxtx.c **** 			if (*data_len != 34)
 994              		.loc 1 2012 0
 995 00c0 4379     		ldrb	r3, [r0, #5]	@ zero_extendqisi2
 996 00c2 222B     		cmp	r3, #34
 997 00c4 4ED1     		bne	.L67
 998              	.LVL101:
2013:bluetooth_rxtx.c **** 				return;
2014:bluetooth_rxtx.c **** 
2015:bluetooth_rxtx.c **** 			// conn interval must be [7.5 ms, 4.0s] in units of 1.25 ms
2016:bluetooth_rxtx.c **** 			conn_interval = (packet[29] << 8) | packet[28];
 999              		.loc 1 2016 0
 1000 00c6 427F     		ldrb	r2, [r0, #29]	@ zero_extendqisi2
 1001 00c8 037F     		ldrb	r3, [r0, #28]	@ zero_extendqisi2
 1002 00ca 43EA0223 		orr	r3, r3, r2, lsl #8
2017:bluetooth_rxtx.c **** 			if (conn_interval < 6 || conn_interval > 3200)
 1003              		.loc 1 2017 0
 1004 00ce 40F67A42 		movw	r2, #3194
 1005 00d2 063B     		subs	r3, r3, #6
 1006 00d4 9BB2     		uxth	r3, r3
 1007 00d6 9342     		cmp	r3, r2
 1008 00d8 44D8     		bhi	.L67
2018:bluetooth_rxtx.c **** 				return;
2019:bluetooth_rxtx.c **** 
2020:bluetooth_rxtx.c **** 			// This is a connect packet
2021:bluetooth_rxtx.c **** 			// if we have a target, see if InitA or AdvA matches
2022:bluetooth_rxtx.c **** 			if (le.target_set &&
 1009              		.loc 1 2022 0
 1010 00da A36C     		ldr	r3, [r4, #72]
 1011 00dc 3BB9     		cbnz	r3, .L74
 1012              	.LVL102:
 1013              	.L76:
2023:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[6], 6) &&  // Target address doesn't match Initiator.
2024:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[12], 6)) {  // Target address doesn't match Advertiser.
2025:bluetooth_rxtx.c **** 				return;
2026:bluetooth_rxtx.c **** 			}
2027:bluetooth_rxtx.c **** 
2028:bluetooth_rxtx.c **** 			le.link_state = LINK_CONN_PENDING;
 1014              		.loc 1 2028 0
 1015 00de 0223     		movs	r3, #2
2029:bluetooth_rxtx.c **** 			le.crc_verify = 0; // we will drop many packets if we attempt to filter by CRC
 1016              		.loc 1 2029 0
 1017 00e0 0020     		movs	r0, #0
2028:bluetooth_rxtx.c **** 			le.crc_verify = 0; // we will drop many packets if we attempt to filter by CRC
 1018              		.loc 1 2028 0
 1019 00e2 2376     		strb	r3, [r4, #24]
 1020              		.loc 1 2029 0
 1021 00e4 6061     		str	r0, [r4, #20]
 1022              	.LVL103:
 1023 00e6 05F11101 		add	r1, r5, #17
2030:bluetooth_rxtx.c **** 
2031:bluetooth_rxtx.c **** 			for (i = 0; i < 4; ++i)
 1024              		.loc 1 2031 0
 1025 00ea 0346     		mov	r3, r0
 1026 00ec 11E0     		b	.L75
 1027              	.LVL104:
 1028              	.L74:
ARM GAS  /tmp/ccDKg7Fp.s 			page 57


2023:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[12], 6)) {  // Target address doesn't match Advertiser.
 1029              		.loc 1 2023 0 discriminator 1
 1030 00ee 04F13C00 		add	r0, r4, #60
 1031              	.LVL105:
 1032 00f2 A91D     		adds	r1, r5, #6
 1033 00f4 0622     		movs	r2, #6
 1034 00f6 FFF7FEFF 		bl	memcmp
 1035              	.LVL106:
2022:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[6], 6) &&  // Target address doesn't match Initiator.
 1036              		.loc 1 2022 0 discriminator 1
 1037 00fa 0028     		cmp	r0, #0
 1038 00fc EFD0     		beq	.L76
2024:bluetooth_rxtx.c **** 				return;
 1039              		.loc 1 2024 0
 1040 00fe 04F13C00 		add	r0, r4, #60
 1041 0102 05F10C01 		add	r1, r5, #12
 1042 0106 0622     		movs	r2, #6
 1043 0108 FFF7FEFF 		bl	memcmp
 1044              	.LVL107:
2023:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[12], 6)) {  // Target address doesn't match Advertiser.
 1045              		.loc 1 2023 0
 1046 010c 0028     		cmp	r0, #0
 1047 010e E6D0     		beq	.L76
 1048 0110 70BD     		pop	{r4, r5, r6, pc}
 1049              	.LVL108:
 1050              	.L75:
2032:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 1051              		.loc 1 2032 0 discriminator 3
 1052 0112 11F8012F 		ldrb	r2, [r1, #1]!	@ zero_extendqisi2
 1053 0116 DE00     		lsls	r6, r3, #3
2031:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 1054              		.loc 1 2031 0 discriminator 3
 1055 0118 0133     		adds	r3, r3, #1
 1056              	.LVL109:
 1057              		.loc 1 2032 0 discriminator 3
 1058 011a B240     		lsls	r2, r2, r6
2031:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 1059              		.loc 1 2031 0 discriminator 3
 1060 011c 042B     		cmp	r3, #4
 1061              		.loc 1 2032 0 discriminator 3
 1062 011e 40EA0200 		orr	r0, r0, r2
 1063              	.LVL110:
2031:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 1064              		.loc 1 2031 0 discriminator 3
 1065 0122 F6D1     		bne	.L75
2033:bluetooth_rxtx.c **** 			le_set_access_address(aa);
 1066              		.loc 1 2033 0
 1067 0124 FFF7FEFF 		bl	le_set_access_address
 1068              	.LVL111:
2034:bluetooth_rxtx.c **** 
2035:bluetooth_rxtx.c **** #define CRC_INIT (2+4+6+6+4)
2036:bluetooth_rxtx.c **** 			le.crc_init = (packet[CRC_INIT+2] << 16)
2037:bluetooth_rxtx.c **** 						| (packet[CRC_INIT+1] << 8)
 1069              		.loc 1 2037 0
 1070 0128 EB7D     		ldrb	r3, [r5, #23]	@ zero_extendqisi2
2036:bluetooth_rxtx.c **** 						| (packet[CRC_INIT+1] << 8)
 1071              		.loc 1 2036 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 58


 1072 012a 287E     		ldrb	r0, [r5, #24]	@ zero_extendqisi2
 1073              		.loc 1 2037 0
 1074 012c 1B02     		lsls	r3, r3, #8
 1075 012e 43EA0043 		orr	r3, r3, r0, lsl #16
2038:bluetooth_rxtx.c **** 						|  packet[CRC_INIT+0];
 1076              		.loc 1 2038 0
 1077 0132 A87D     		ldrb	r0, [r5, #22]	@ zero_extendqisi2
 1078 0134 1843     		orrs	r0, r0, r3
2036:bluetooth_rxtx.c **** 						| (packet[CRC_INIT+1] << 8)
 1079              		.loc 1 2036 0
 1080 0136 E060     		str	r0, [r4, #12]
2039:bluetooth_rxtx.c **** 			le.crc_init_reversed = rbit(le.crc_init);
 1081              		.loc 1 2039 0
 1082 0138 FFF7FEFF 		bl	rbit
 1083              	.LVL112:
2040:bluetooth_rxtx.c **** 
2041:bluetooth_rxtx.c **** #define WIN_SIZE (2+4+6+6+4+3)
2042:bluetooth_rxtx.c **** 			le.win_size = packet[WIN_SIZE];
 1084              		.loc 1 2042 0
 1085 013c 6B7E     		ldrb	r3, [r5, #25]	@ zero_extendqisi2
2039:bluetooth_rxtx.c **** 			le.crc_init_reversed = rbit(le.crc_init);
 1086              		.loc 1 2039 0
 1087 013e 2061     		str	r0, [r4, #16]
 1088              		.loc 1 2042 0
 1089 0140 84F82630 		strb	r3, [r4, #38]
2043:bluetooth_rxtx.c **** 
2044:bluetooth_rxtx.c **** #define WIN_OFFSET (2+4+6+6+4+3+1)
2045:bluetooth_rxtx.c **** 			le.win_offset = packet[WIN_OFFSET];
 1090              		.loc 1 2045 0
 1091 0144 AB7E     		ldrb	r3, [r5, #26]	@ zero_extendqisi2
 1092 0146 2385     		strh	r3, [r4, #40]	@ movhi
2046:bluetooth_rxtx.c **** 
2047:bluetooth_rxtx.c **** #define CONN_INTERVAL (2+4+6+6+4+3+1+2)
2048:bluetooth_rxtx.c **** 			le.conn_interval = (packet[CONN_INTERVAL+1] << 8)
 1093              		.loc 1 2048 0
 1094 0148 6A7F     		ldrb	r2, [r5, #29]	@ zero_extendqisi2
 1095 014a 2B7F     		ldrb	r3, [r5, #28]	@ zero_extendqisi2
 1096 014c 43EA0223 		orr	r3, r3, r2, lsl #8
 1097 0150 6384     		strh	r3, [r4, #34]	@ movhi
2049:bluetooth_rxtx.c **** 							 |  packet[CONN_INTERVAL+0];
2050:bluetooth_rxtx.c **** 
2051:bluetooth_rxtx.c **** #define CHANNEL_INC (2+4+6+6+4+3+1+2+2+2+2+5)
2052:bluetooth_rxtx.c **** 			le.channel_increment = packet[CHANNEL_INC] & 0x1f;
 1098              		.loc 1 2052 0
 1099 0152 95F82730 		ldrb	r3, [r5, #39]	@ zero_extendqisi2
2053:bluetooth_rxtx.c **** 			le.channel_idx = le.channel_increment;
2054:bluetooth_rxtx.c **** 
2055:bluetooth_rxtx.c **** 			// Hop to the initial channel immediately
2056:bluetooth_rxtx.c **** 			do_hop = 1;
 1100              		.loc 1 2056 0
 1101 0156 0122     		movs	r2, #1
2052:bluetooth_rxtx.c **** 			le.channel_idx = le.channel_increment;
 1102              		.loc 1 2052 0
 1103 0158 03F01F03 		and	r3, r3, #31
 1104 015c A376     		strb	r3, [r4, #26]
2053:bluetooth_rxtx.c **** 			le.channel_idx = le.channel_increment;
 1105              		.loc 1 2053 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 59


 1106 015e 6376     		strb	r3, [r4, #25]
 1107              		.loc 1 2056 0
 1108 0160 034B     		ldr	r3, .L84+8
 1109 0162 DA72     		strb	r2, [r3, #11]
 1110              	.L67:
 1111 0164 70BD     		pop	{r4, r5, r6, pc}
 1112              	.LVL113:
 1113              	.L85:
 1114 0166 00BF     		.align	2
 1115              	.L84:
 1116 0168 00000000 		.word	.LANCHOR1
 1117 016c 00000000 		.word	clkn
 1118 0170 00000000 		.word	.LANCHOR0
 1119              	.LBE16:
 1120              	.LBE15:
 1121              		.cfi_endproc
 1122              	.LFE25:
 1124              		.global	__aeabi_llsl
 1125              		.section	.text.vendor_request_handler,"ax",%progbits
 1126              		.align	1
 1127              		.thumb
 1128              		.thumb_func
 1130              	vendor_request_handler:
 1131              	.LFB2:
 190:bluetooth_rxtx.c **** 	uint32_t clock;
 1132              		.loc 1 190 0
 1133              		.cfi_startproc
 1134              		@ args = 0, pretend = 0, frame = 0
 1135              		@ frame_needed = 0, uses_anonymous_args = 0
 1136              	.LVL114:
 1137 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 1138              		.cfi_def_cfa_offset 24
 1139              		.cfi_offset 3, -24
 1140              		.cfi_offset 4, -20
 1141              		.cfi_offset 5, -16
 1142              		.cfi_offset 6, -12
 1143              		.cfi_offset 7, -8
 1144              		.cfi_offset 14, -4
 1145              	.LVL115:
 190:bluetooth_rxtx.c **** 	uint32_t clock;
 1146              		.loc 1 190 0
 1147 0002 0E46     		mov	r6, r1
 1148 0004 1546     		mov	r5, r2
 1149 0006 1C46     		mov	r4, r3
 197:bluetooth_rxtx.c **** 
 1150              		.loc 1 197 0
 1151 0008 4628     		cmp	r0, #70
 1152 000a 00F24E83 		bhi	.L199
 1153 000e DFE810F0 		tbh	[pc, r0, lsl #1]
 1154              	.LVL116:
 1155              	.L89:
 1156 0012 FF00     		.2byte	(.L225-.L89)/2
 1157 0014 4700     		.2byte	(.L90-.L89)/2
 1158 0016 4C00     		.2byte	(.L91-.L89)/2
 1159 0018 5000     		.2byte	(.L92-.L89)/2
 1160 001a 5500     		.2byte	(.L93-.L89)/2
 1161 001c 5800     		.2byte	(.L94-.L89)/2
ARM GAS  /tmp/ccDKg7Fp.s 			page 60


 1162 001e 5D00     		.2byte	(.L95-.L89)/2
 1163 0020 6000     		.2byte	(.L96-.L89)/2
 1164 0022 6200     		.2byte	(.L97-.L89)/2
 1165 0024 6600     		.2byte	(.L98-.L89)/2
 1166 0026 6B00     		.2byte	(.L99-.L89)/2
 1167 0028 C000     		.2byte	(.L100-.L89)/2
 1168 002a C700     		.2byte	(.L101-.L89)/2
 1169 002c 0401     		.2byte	(.L235-.L89)/2
 1170 002e 7900     		.2byte	(.L103-.L89)/2
 1171 0030 7400     		.2byte	(.L104-.L89)/2
 1172 0032 7E00     		.2byte	(.L105-.L89)/2
 1173 0034 8300     		.2byte	(.L106-.L89)/2
 1174 0036 8600     		.2byte	(.L107-.L89)/2
 1175 0038 8B00     		.2byte	(.L108-.L89)/2
 1176 003a 9300     		.2byte	(.L109-.L89)/2
 1177 003c B800     		.2byte	(.L110-.L89)/2
 1178 003e BA00     		.2byte	(.L111-.L89)/2
 1179 0040 BC00     		.2byte	(.L112-.L89)/2
 1180 0042 FD00     		.2byte	(.L113-.L89)/2
 1181 0044 0101     		.2byte	(.L114-.L89)/2
 1182 0046 4C03     		.2byte	(.L199-.L89)/2
 1183 0048 0601     		.2byte	(.L115-.L89)/2
 1184 004a 9700     		.2byte	(.L116-.L89)/2
 1185 004c 9E00     		.2byte	(.L117-.L89)/2
 1186 004e A800     		.2byte	(.L118-.L89)/2
 1187 0050 A600     		.2byte	(.L119-.L89)/2
 1188 0052 AA00     		.2byte	(.L120-.L89)/2
 1189 0054 2F01     		.2byte	(.L121-.L89)/2
 1190 0056 2201     		.2byte	(.L122-.L89)/2
 1191 0058 4C01     		.2byte	(.L123-.L89)/2
 1192 005a 4F01     		.2byte	(.L124-.L89)/2
 1193 005c 5301     		.2byte	(.L125-.L89)/2
 1194 005e 5701     		.2byte	(.L126-.L89)/2
 1195 0060 9F01     		.2byte	(.L127-.L89)/2
 1196 0062 D701     		.2byte	(.L128-.L89)/2
 1197 0064 FA01     		.2byte	(.L129-.L89)/2
 1198 0066 3A02     		.2byte	(.L130-.L89)/2
 1199 0068 4902     		.2byte	(.L189-.L89)/2
 1200 006a 5302     		.2byte	(.L132-.L89)/2
 1201 006c 4A03     		.2byte	(.L212-.L89)/2
 1202 006e 6002     		.2byte	(.L134-.L89)/2
 1203 0070 6502     		.2byte	(.L135-.L89)/2
 1204 0072 6B02     		.2byte	(.L136-.L89)/2
 1205 0074 7202     		.2byte	(.L137-.L89)/2
 1206 0076 8002     		.2byte	(.L138-.L89)/2
 1207 0078 E401     		.2byte	(.L190-.L89)/2
 1208 007a F001     		.2byte	(.L191-.L89)/2
 1209 007c 8E02     		.2byte	(.L141-.L89)/2
 1210 007e C902     		.2byte	(.L142-.L89)/2
 1211 0080 3E01     		.2byte	(.L143-.L89)/2
 1212 0082 D302     		.2byte	(.L144-.L89)/2
 1213 0084 4C03     		.2byte	(.L199-.L89)/2
 1214 0086 9602     		.2byte	(.L145-.L89)/2
 1215 0088 4103     		.2byte	(.L146-.L89)/2
 1216 008a 4503     		.2byte	(.L147-.L89)/2
 1217 008c C101     		.2byte	(.L148-.L89)/2
 1218 008e D301     		.2byte	(.L149-.L89)/2
ARM GAS  /tmp/ccDKg7Fp.s 			page 61


 1219 0090 0602     		.2byte	(.L150-.L89)/2
 1220 0092 4C03     		.2byte	(.L199-.L89)/2
 1221 0094 9B02     		.2byte	(.L192-.L89)/2
 1222 0096 AE02     		.2byte	(.L152-.L89)/2
 1223 0098 2001     		.2byte	(.L153-.L89)/2
 1224 009a BE02     		.2byte	(.L154-.L89)/2
 1225 009c 0D02     		.2byte	(.L155-.L89)/2
 1226 009e 3D03     		.2byte	(.L156-.L89)/2
 1227              		.p2align 1
 1228              	.L90:
 204:bluetooth_rxtx.c **** 		*data_len = 0;
 1229              		.loc 1 204 0
 1230 00a0 9C4B     		ldr	r3, .L246
 1231 00a2 0120     		movs	r0, #1
 1232              	.LVL117:
 1233 00a4 9874     		strb	r0, [r3, #18]
 205:bluetooth_rxtx.c **** 		break;
 1234              		.loc 1 205 0
 1235 00a6 0023     		movs	r3, #0
 1236 00a8 A1E1     		b	.L216
 1237              	.LVL118:
 1238              	.L91:
 209:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_SYMBOLS;
 1239              		.loc 1 209 0
 1240 00aa 9A4B     		ldr	r3, .L246
 1241 00ac 0222     		movs	r2, #2
 1242              	.LVL119:
 1243 00ae 9A72     		strb	r2, [r3, #10]
 1244 00b0 76E2     		b	.L236
 1245              	.LVL120:
 1246              	.L92:
 215:bluetooth_rxtx.c **** 		*data_len = 1;
 1247              		.loc 1 215 0
 1248 00b2 994B     		ldr	r3, .L246+4
 1249 00b4 1B68     		ldr	r3, [r3]
 1250 00b6 C3F34003 		ubfx	r3, r3, #1, #1
 1251 00ba FFE0     		b	.L218
 1252              	.L93:
 220:bluetooth_rxtx.c **** 			USRLED_SET;
 1253              		.loc 1 220 0
 1254 00bc 0A88     		ldrh	r2, [r1]
 1255              	.LVL121:
 1256 00be 0223     		movs	r3, #2
 1257 00c0 15E0     		b	.L231
 1258              	.LVL122:
 1259              	.L94:
 227:bluetooth_rxtx.c **** 		*data_len = 1;
 1260              		.loc 1 227 0
 1261 00c2 954B     		ldr	r3, .L246+4
 1262 00c4 1B68     		ldr	r3, [r3]
 1263 00c6 C3F30013 		ubfx	r3, r3, #4, #1
 1264 00ca F7E0     		b	.L218
 1265              	.L95:
 232:bluetooth_rxtx.c **** 			RXLED_SET;
 1266              		.loc 1 232 0
 1267 00cc 0A88     		ldrh	r2, [r1]
 1268              	.LVL123:
ARM GAS  /tmp/ccDKg7Fp.s 			page 62


 1269 00ce 1023     		movs	r3, #16
 1270 00d0 0DE0     		b	.L231
 1271              	.LVL124:
 1272              	.L96:
 239:bluetooth_rxtx.c **** 		*data_len = 1;
 1273              		.loc 1 239 0
 1274 00d2 914B     		ldr	r3, .L246+4
 1275 00d4 24E0     		b	.L238
 1276              	.L97:
 244:bluetooth_rxtx.c **** 			TXLED_SET;
 1277              		.loc 1 244 0
 1278 00d6 0A88     		ldrh	r2, [r1]
 1279              	.LVL125:
 1280 00d8 4FF48073 		mov	r3, #256
 1281 00dc 07E0     		b	.L231
 1282              	.LVL126:
 1283              	.L98:
 251:bluetooth_rxtx.c **** 		*data_len = 1;
 1284              		.loc 1 251 0
 1285 00de 8E4B     		ldr	r3, .L246+4
 1286 00e0 1B68     		ldr	r3, [r3]
 1287 00e2 C3F34023 		ubfx	r3, r3, #9, #1
 1288 00e6 E9E0     		b	.L218
 1289              	.L99:
 256:bluetooth_rxtx.c **** 			CC1V8_SET;
 1290              		.loc 1 256 0
 1291 00e8 0A88     		ldrh	r2, [r1]
 1292              	.LVL127:
 1293 00ea 4FF40073 		mov	r3, #512
 1294              	.L231:
 1295 00ee 0AB1     		cbz	r2, .L160
 257:bluetooth_rxtx.c **** 		else
 1296              		.loc 1 257 0
 1297 00f0 8A4A     		ldr	r2, .L246+8
 1298 00f2 00E0     		b	.L220
 1299              	.L160:
 259:bluetooth_rxtx.c **** 		break;
 1300              		.loc 1 259 0
 1301 00f4 8A4A     		ldr	r2, .L246+12
 1302              	.L220:
 1303 00f6 1360     		str	r3, [r2]
 1304 00f8 D5E2     		b	.L212
 1305              	.LVL128:
 1306              	.L104:
 263:bluetooth_rxtx.c **** 		break;
 1307              		.loc 1 263 0
 1308 00fa 1046     		mov	r0, r2
 1309              	.LVL129:
 1310 00fc 2146     		mov	r1, r4
 1311              	.LVL130:
 1312 00fe FFF7FEFF 		bl	get_part_num
 1313              	.LVL131:
 1314 0102 D0E2     		b	.L212
 1315              	.LVL132:
 1316              	.L103:
 271:bluetooth_rxtx.c **** 		break;
 1317              		.loc 1 271 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 63


 1318 0104 1046     		mov	r0, r2
 1319              	.LVL133:
 1320 0106 2146     		mov	r1, r4
 1321              	.LVL134:
 1322 0108 FFF7FEFF 		bl	get_device_serial
 1323              	.LVL135:
 1324 010c CBE2     		b	.L212
 1325              	.LVL136:
 1326              	.L105:
 276:bluetooth_rxtx.c **** 		*data_len = 1;
 1327              		.loc 1 276 0
 1328 010e 854B     		ldr	r3, .L246+16
 1329 0110 1B68     		ldr	r3, [r3]
 1330 0112 C3F3C013 		ubfx	r3, r3, #7, #1
 1331 0116 D1E0     		b	.L218
 1332              	.L106:
 281:bluetooth_rxtx.c **** 			PAEN_SET;
 1333              		.loc 1 281 0
 1334 0118 0A88     		ldrh	r2, [r1]
 1335              	.LVL137:
 1336 011a 8023     		movs	r3, #128
 1337 011c 07E0     		b	.L234
 1338              	.LVL138:
 1339              	.L107:
 288:bluetooth_rxtx.c **** 		*data_len = 1;
 1340              		.loc 1 288 0
 1341 011e 814B     		ldr	r3, .L246+16
 1342              	.L238:
 1343 0120 1B68     		ldr	r3, [r3]
 1344 0122 C3F30023 		ubfx	r3, r3, #8, #1
 1345 0126 C9E0     		b	.L218
 1346              	.L108:
 293:bluetooth_rxtx.c **** 			HGM_SET;
 1347              		.loc 1 293 0
 1348 0128 0A88     		ldrh	r2, [r1]
 1349              	.LVL139:
 1350 012a 4FF48073 		mov	r3, #256
 1351              	.L234:
 1352 012e 0AB1     		cbz	r2, .L162
 294:bluetooth_rxtx.c **** 		else
 1353              		.loc 1 294 0
 1354 0130 7D4A     		ldr	r2, .L246+20
 1355 0132 E0E7     		b	.L220
 1356              	.L162:
 296:bluetooth_rxtx.c **** 		break;
 1357              		.loc 1 296 0
 1358 0134 7D4A     		ldr	r2, .L246+24
 1359 0136 DEE7     		b	.L220
 1360              	.LVL140:
 1361              	.L109:
 302:bluetooth_rxtx.c **** 		break;
 1362              		.loc 1 302 0
 1363 0138 0322     		movs	r2, #3
 1364              	.LVL141:
 1365              	.L221:
 1366 013a 764B     		ldr	r3, .L246
 1367 013c 9A74     		strb	r2, [r3, #18]
ARM GAS  /tmp/ccDKg7Fp.s 			page 64


 1368 013e B2E2     		b	.L212
 1369              	.LVL142:
 1370              	.L116:
 306:bluetooth_rxtx.c **** 		*data_len = 1;
 1371              		.loc 1 306 0
 1372 0140 0520     		movs	r0, #5
 1373              	.LVL143:
 1374 0142 FFF7FEFF 		bl	cc2400_get
 1375              	.LVL144:
 1376 0146 00F00700 		and	r0, r0, #7
 1377 014a 2870     		strb	r0, [r5]
 1378 014c DEE1     		b	.L213
 1379              	.LVL145:
 1380              	.L117:
 311:bluetooth_rxtx.c **** 			cc2400_set(FREND, 8 | request_params[0]);
 1381              		.loc 1 311 0
 1382 014e 0988     		ldrh	r1, [r1]
 1383              	.LVL146:
 1384 0150 0729     		cmp	r1, #7
 1385 0152 00F2AA82 		bhi	.L199
 312:bluetooth_rxtx.c **** 		} else {
 1386              		.loc 1 312 0
 1387 0156 0520     		movs	r0, #5
 1388              	.LVL147:
 1389 0158 41F00801 		orr	r1, r1, #8
 1390 015c F1E1     		b	.L224
 1391              	.LVL148:
 1392              	.L119:
 319:bluetooth_rxtx.c **** 		break;
 1393              		.loc 1 319 0
 1394 015e 0522     		movs	r2, #5
 1395              	.LVL149:
 1396 0160 EBE7     		b	.L221
 1397              	.LVL150:
 1398              	.L118:
 323:bluetooth_rxtx.c **** 		break;
 1399              		.loc 1 323 0
 1400 0162 0622     		movs	r2, #6
 1401              	.LVL151:
 1402 0164 E9E7     		b	.L221
 1403              	.LVL152:
 1404              	.L120:
 328:bluetooth_rxtx.c **** 		data[1] = rr.request_pa;
 1405              		.loc 1 328 0
 1406 0166 724B     		ldr	r3, .L246+28
 1407 0168 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1408              	.LVL153:
 1409 016a 2A70     		strb	r2, [r5]
 329:bluetooth_rxtx.c **** 		data[2] = rr.request_num;
 1410              		.loc 1 329 0
 1411 016c 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 1412 016e 6A70     		strb	r2, [r5, #1]
 330:bluetooth_rxtx.c **** 		data[3] = rr.reply_pa;
 1413              		.loc 1 330 0
 1414 0170 9A78     		ldrb	r2, [r3, #2]	@ zero_extendqisi2
 1415 0172 AA70     		strb	r2, [r5, #2]
 331:bluetooth_rxtx.c **** 		data[4] = rr.reply_num;
ARM GAS  /tmp/ccDKg7Fp.s 			page 65


 1416              		.loc 1 331 0
 1417 0174 DA78     		ldrb	r2, [r3, #3]	@ zero_extendqisi2
 1418 0176 EA70     		strb	r2, [r5, #3]
 332:bluetooth_rxtx.c **** 		*data_len = 5;
 1419              		.loc 1 332 0
 1420 0178 1B79     		ldrb	r3, [r3, #4]	@ zero_extendqisi2
 1421 017a 2B71     		strb	r3, [r5, #4]
 333:bluetooth_rxtx.c **** 		break;
 1422              		.loc 1 333 0
 1423 017c 0523     		movs	r3, #5
 1424              	.LVL154:
 1425              	.L226:
 1426 017e 2360     		str	r3, [r4]
 1427 0180 91E2     		b	.L212
 1428              	.LVL155:
 1429              	.L110:
 337:bluetooth_rxtx.c **** 		break;
 1430              		.loc 1 337 0
 1431 0182 0022     		movs	r2, #0
 1432              	.LVL156:
 1433 0184 D9E7     		b	.L221
 1434              	.LVL157:
 1435              	.L111:
 341:bluetooth_rxtx.c **** 		*data_len = 1;
 1436              		.loc 1 341 0
 1437 0186 634B     		ldr	r3, .L246
 1438 0188 97E0     		b	.L217
 1439              	.L112:
 346:bluetooth_rxtx.c **** 		break;
 1440              		.loc 1 346 0
 1441 018a 0A78     		ldrb	r2, [r1]	@ zero_extendqisi2
 1442              	.LVL158:
 1443 018c 614B     		ldr	r3, .L246
 1444 018e 1A70     		strb	r2, [r3]
 1445 0190 89E2     		b	.L212
 1446              	.LVL159:
 1447              	.L100:
 350:bluetooth_rxtx.c **** 		data[1] = (channel >> 8) & 0xFF;
 1448              		.loc 1 350 0
 1449 0192 684B     		ldr	r3, .L246+32
 1450 0194 1A88     		ldrh	r2, [r3]
 1451              	.LVL160:
 1452 0196 2A70     		strb	r2, [r5]
 351:bluetooth_rxtx.c **** 		*data_len = 2;
 1453              		.loc 1 351 0
 1454 0198 1B88     		ldrh	r3, [r3]
 1455 019a C3F30723 		ubfx	r3, r3, #8, #8
 1456 019e 9BE1     		b	.L243
 1457              	.LVL161:
 1458              	.L101:
 356:bluetooth_rxtx.c **** 		/* bluetooth band sweep mode, start at channel 2402 */
 1459              		.loc 1 356 0
 1460 01a0 0A88     		ldrh	r2, [r1]
 1461              	.LVL162:
 358:bluetooth_rxtx.c **** 			hop_mode = HOP_SWEEP;
 1462              		.loc 1 358 0
 1463 01a2 40F6EA21 		movw	r1, #2794
ARM GAS  /tmp/ccDKg7Fp.s 			page 66


 1464              	.LVL163:
 356:bluetooth_rxtx.c **** 		/* bluetooth band sweep mode, start at channel 2402 */
 1465              		.loc 1 356 0
 1466 01a6 5B4B     		ldr	r3, .L246
 1467 01a8 DA81     		strh	r2, [r3, #14]	@ movhi
 358:bluetooth_rxtx.c **** 			hop_mode = HOP_SWEEP;
 1468              		.loc 1 358 0
 1469 01aa DA89     		ldrh	r2, [r3, #14]
 1470 01ac 92B2     		uxth	r2, r2
 1471 01ae 8A42     		cmp	r2, r1
 1472 01b0 04D9     		bls	.L163
 359:bluetooth_rxtx.c **** 			requested_channel = 2402;
 1473              		.loc 1 359 0
 1474 01b2 0122     		movs	r2, #1
 1475 01b4 9A72     		strb	r2, [r3, #10]
 360:bluetooth_rxtx.c **** 		}
 1476              		.loc 1 360 0
 1477 01b6 40F66212 		movw	r2, #2402
 1478 01ba 15E0     		b	.L166
 1479              	.L163:
 364:bluetooth_rxtx.c **** 			requested_channel = MAX(requested_channel, MIN_FREQ);
 1480              		.loc 1 364 0
 1481 01bc 0022     		movs	r2, #0
 1482 01be 9A72     		strb	r2, [r3, #10]
 365:bluetooth_rxtx.c **** 			requested_channel = MIN(requested_channel, MAX_FREQ);
 1483              		.loc 1 365 0
 1484 01c0 40F6DC02 		movw	r2, #2268
 1485 01c4 D989     		ldrh	r1, [r3, #14]
 1486 01c6 89B2     		uxth	r1, r1
 1487 01c8 9142     		cmp	r1, r2
 366:bluetooth_rxtx.c **** 		}
 1488              		.loc 1 366 0
 1489 01ca 40F6E921 		movw	r1, #2793
 365:bluetooth_rxtx.c **** 			requested_channel = MIN(requested_channel, MAX_FREQ);
 1490              		.loc 1 365 0
 1491 01ce 84BF     		itt	hi
 1492 01d0 DA89     		ldrhhi	r2, [r3, #14]
 1493 01d2 92B2     		uxthhi	r2, r2
 1494 01d4 DA81     		strh	r2, [r3, #14]	@ movhi
 366:bluetooth_rxtx.c **** 		}
 1495              		.loc 1 366 0
 1496 01d6 DA89     		ldrh	r2, [r3, #14]
 1497 01d8 92B2     		uxth	r2, r2
 1498 01da 8A42     		cmp	r2, r1
 1499 01dc 8FBF     		iteee	hi
 1500 01de 40F6EA22 		movwhi	r2, #2794
 1501 01e2 4C4A     		ldrls	r2, .L246
 1502 01e4 D289     		ldrhls	r2, [r2, #14]
 1503 01e6 92B2     		uxthls	r2, r2
 1504              	.L166:
 366:bluetooth_rxtx.c **** 		}
 1505              		.loc 1 366 0 is_stmt 0 discriminator 4
 1506 01e8 DA81     		strh	r2, [r3, #14]	@ movhi
 369:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
 1507              		.loc 1 369 0 is_stmt 1 discriminator 4
 1508 01ea D989     		ldrh	r1, [r3, #14]
 1509 01ec 514A     		ldr	r2, .L246+32
ARM GAS  /tmp/ccDKg7Fp.s 			page 67


 1510 01ee 89B2     		uxth	r1, r1
 1511 01f0 A2F85210 		strh	r1, [r2, #82]	@ movhi
 370:bluetooth_rxtx.c **** 			channel = requested_channel;
 1512              		.loc 1 370 0 discriminator 4
 1513 01f4 5B7C     		ldrb	r3, [r3, #17]	@ zero_extendqisi2
 369:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
 1514              		.loc 1 369 0 discriminator 4
 1515 01f6 4748     		ldr	r0, .L246
 1516              	.LVL164:
 370:bluetooth_rxtx.c **** 			channel = requested_channel;
 1517              		.loc 1 370 0 discriminator 4
 1518 01f8 092B     		cmp	r3, #9
 1519 01fa 00F05482 		beq	.L212
 371:bluetooth_rxtx.c **** 			requested_channel = 0;
 1520              		.loc 1 371 0
 1521 01fe C389     		ldrh	r3, [r0, #14]
 1522 0200 9BB2     		uxth	r3, r3
 1523 0202 1380     		strh	r3, [r2]	@ movhi
 372:bluetooth_rxtx.c **** 
 1524              		.loc 1 372 0
 1525 0204 0023     		movs	r3, #0
 1526 0206 C381     		strh	r3, [r0, #14]	@ movhi
 376:bluetooth_rxtx.c **** 		}
 1527              		.loc 1 376 0
 1528 0208 1088     		ldrh	r0, [r2]
 1529 020a 8CE1     		b	.L227
 1530              	.LVL165:
 1531              	.L113:
 381:bluetooth_rxtx.c **** 		*data_len = 0; /* should never return */
 1532              		.loc 1 381 0
 1533 020c FFF7FEFF 		bl	set_isp
 1534              	.LVL166:
 1535              	.L225:
 382:bluetooth_rxtx.c **** 		break;
 1536              		.loc 1 382 0
 1537 0210 0023     		movs	r3, #0
 1538 0212 B4E7     		b	.L226
 1539              	.LVL167:
 1540              	.L114:
 386:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 1541              		.loc 1 386 0
 1542 0214 484A     		ldr	r2, .L246+36
 1543              	.LVL168:
 1544 0216 494B     		ldr	r3, .L246+40
 1545 0218 1A60     		str	r2, [r3]
 1546              	.L235:
 387:bluetooth_rxtx.c **** 		break;
 1547              		.loc 1 387 0
 1548 021a 0B22     		movs	r2, #11
 1549 021c 8DE7     		b	.L221
 1550              	.LVL169:
 1551              	.L115:
 391:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 1552              		.loc 1 391 0
 1553 021e 0A88     		ldrh	r2, [r1]
 1554              	.LVL170:
 1555 0220 6FF40060 		mvn	r0, #2048
ARM GAS  /tmp/ccDKg7Fp.s 			page 68


 1556              	.LVL171:
 1557 0224 1318     		adds	r3, r2, r0
 1558 0226 B3F5806F 		cmp	r3, #1024
 1559 022a 80F03E82 		bcs	.L199
 392:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 1560              		.loc 1 392 0 discriminator 1
 1561 022e 4B88     		ldrh	r3, [r1, #2]
 391:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 1562              		.loc 1 391 0 discriminator 1
 1563 0230 6FF40061 		mvn	r1, #2048
 1564              	.LVL172:
 1565 0234 5918     		adds	r1, r3, r1
 1566 0236 B1F5806F 		cmp	r1, #1024
 1567 023a 80F03682 		bcs	.L199
 392:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 1568              		.loc 1 392 0 discriminator 1
 1569 023e 9342     		cmp	r3, r2
 1570 0240 C0F03382 		bcc	.L199
 395:bluetooth_rxtx.c **** 		high_freq = request_params[1];
 1571              		.loc 1 395 0
 1572 0244 3B49     		ldr	r1, .L246+32
 1573 0246 A1F85420 		strh	r2, [r1, #84]	@ movhi
 396:bluetooth_rxtx.c **** 		requested_mode = MODE_SPECAN;
 1574              		.loc 1 396 0
 1575 024a A1F85630 		strh	r3, [r1, #86]	@ movhi
 397:bluetooth_rxtx.c **** 		*data_len = 0;
 1576              		.loc 1 397 0
 1577 024e 0422     		movs	r2, #4
 1578 0250 A5E1     		b	.L237
 1579              	.LVL173:
 1580              	.L153:
 402:bluetooth_rxtx.c **** 		*data_len = 0;
 1581              		.loc 1 402 0
 1582 0252 0F22     		movs	r2, #15
 1583              	.LVL174:
 1584 0254 A3E1     		b	.L237
 1585              	.LVL175:
 1586              	.L122:
 407:bluetooth_rxtx.c **** 			return 0;
 1587              		.loc 1 407 0
 1588 0256 0B88     		ldrh	r3, [r1]
 1589 0258 B3F5807F 		cmp	r3, #256
 1590 025c 00F22582 		bhi	.L199
 409:bluetooth_rxtx.c **** 		requested_mode = MODE_LED_SPECAN;
 1591              		.loc 1 409 0
 1592 0260 344A     		ldr	r2, .L246+32
 1593              	.LVL176:
 1594 0262 C3F13603 		rsb	r3, r3, #54
 1595 0266 DBB2     		uxtb	r3, r3
 1596 0268 82F85830 		strb	r3, [r2, #88]
 410:bluetooth_rxtx.c **** 		*data_len = 0;
 1597              		.loc 1 410 0
 1598 026c 0722     		movs	r2, #7
 1599 026e 96E1     		b	.L237
 1600              	.LVL177:
 1601              	.L121:
 415:bluetooth_rxtx.c **** 		data[1] = 0x00;
ARM GAS  /tmp/ccDKg7Fp.s 			page 69


 1602              		.loc 1 415 0
 1603 0270 0023     		movs	r3, #0
 1604 0272 1370     		strb	r3, [r2]
 416:bluetooth_rxtx.c **** 
 1605              		.loc 1 416 0
 1606 0274 5370     		strb	r3, [r2, #1]
 418:bluetooth_rxtx.c **** 		data[2] = length;
 1607              		.loc 1 418 0
 1608 0276 3248     		ldr	r0, .L246+44
 1609              	.LVL178:
 1610 0278 FFF7FEFF 		bl	strlen
 1611              	.LVL179:
 1612 027c C6B2     		uxtb	r6, r0
 1613              	.LVL180:
 419:bluetooth_rxtx.c **** 
 1614              		.loc 1 419 0
 1615 027e AE70     		strb	r6, [r5, #2]
 421:bluetooth_rxtx.c **** 
 1616              		.loc 1 421 0
 1617 0280 3246     		mov	r2, r6
 1618 0282 E81C     		adds	r0, r5, #3
 1619 0284 2E49     		ldr	r1, .L246+44
 1620 0286 FFF7FEFF 		bl	memcpy
 1621              	.LVL181:
 423:bluetooth_rxtx.c **** 		break;
 1622              		.loc 1 423 0
 1623 028a 0336     		adds	r6, r6, #3
 1624              	.LVL182:
 1625 028c 0BE0     		b	.L229
 1626              	.LVL183:
 1627              	.L143:
 427:bluetooth_rxtx.c **** 		data[0] = length;
 1628              		.loc 1 427 0
 1629 028e 2D48     		ldr	r0, .L246+48
 1630              	.LVL184:
 1631 0290 FFF7FEFF 		bl	strlen
 1632              	.LVL185:
 1633 0294 C6B2     		uxtb	r6, r0
 1634              	.LVL186:
 428:bluetooth_rxtx.c **** 		memcpy(&data[1], compile_info, length);
 1635              		.loc 1 428 0
 1636 0296 2846     		mov	r0, r5
 429:bluetooth_rxtx.c **** 		*data_len = 1 + length;
 1637              		.loc 1 429 0
 1638 0298 3246     		mov	r2, r6
 428:bluetooth_rxtx.c **** 		memcpy(&data[1], compile_info, length);
 1639              		.loc 1 428 0
 1640 029a 00F8016B 		strb	r6, [r0], #1
 429:bluetooth_rxtx.c **** 		*data_len = 1 + length;
 1641              		.loc 1 429 0
 1642 029e 2949     		ldr	r1, .L246+48
 1643 02a0 FFF7FEFF 		bl	memcpy
 1644              	.LVL187:
 430:bluetooth_rxtx.c **** 		break;
 1645              		.loc 1 430 0
 1646 02a4 0136     		adds	r6, r6, #1
 1647              	.LVL188:
ARM GAS  /tmp/ccDKg7Fp.s 			page 70


 1648              	.L229:
 1649 02a6 2660     		str	r6, [r4]
 1650 02a8 FDE1     		b	.L212
 1651              	.LVL189:
 1652              	.L123:
 434:bluetooth_rxtx.c **** 		*data_len = 1;
 1653              		.loc 1 434 0
 1654 02aa 0120     		movs	r0, #1
 1655              	.LVL190:
 1656 02ac 1070     		strb	r0, [r2]
 1657 02ae 2EE1     		b	.L214
 1658              	.LVL191:
 1659              	.L124:
 439:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 1660              		.loc 1 439 0
 1661 02b0 0A88     		ldrh	r2, [r1]
 1662              	.LVL192:
 1663 02b2 254B     		ldr	r3, .L246+52
 1664 02b4 1A70     		strb	r2, [r3]
 1665 02b6 34E1     		b	.L228
 1666              	.LVL193:
 1667              	.L125:
 444:bluetooth_rxtx.c **** 		*data_len = 1;
 1668              		.loc 1 444 0
 1669 02b8 234B     		ldr	r3, .L246+52
 1670              	.L217:
 1671 02ba 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1672              	.L218:
 1673 02bc 2B70     		strb	r3, [r5]
 1674 02be 25E1     		b	.L213
 1675              	.L126:
 449:bluetooth_rxtx.c **** 		target.syncword = 0;
 1676              		.loc 1 449 0
 1677 02c0 224C     		ldr	r4, .L246+56
 1678              	.LVL194:
 1679 02c2 0022     		movs	r2, #0
 1680              	.LVL195:
 1681 02c4 0023     		movs	r3, #0
 1682 02c6 C4E90023 		strd	r2, [r4]
 450:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 1683              		.loc 1 450 0
 1684 02ca C4E90223 		strd	r2, [r4, #8]
 1685              	.LVL196:
 1686              	.LBB17:
 451:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1687              		.loc 1 451 0
 1688 02ce 0026     		movs	r6, #0
 1689              	.LVL197:
 1690              	.L168:
 452:bluetooth_rxtx.c **** 		}
 1691              		.loc 1 452 0 discriminator 3
 1692 02d0 A85D     		ldrb	r0, [r5, r6]	@ zero_extendqisi2
 1693 02d2 F200     		lsls	r2, r6, #3
 1694 02d4 0021     		movs	r1, #0
 1695 02d6 FFF7FEFF 		bl	__aeabi_llsl
 1696              	.LVL198:
 1697 02da D4E90023 		ldrd	r2, [r4]
ARM GAS  /tmp/ccDKg7Fp.s 			page 71


 451:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1698              		.loc 1 451 0 discriminator 3
 1699 02de 0136     		adds	r6, r6, #1
 1700              	.LVL199:
 452:bluetooth_rxtx.c **** 		}
 1701              		.loc 1 452 0 discriminator 3
 1702 02e0 1043     		orrs	r0, r0, r2
 1703 02e2 1943     		orrs	r1, r1, r3
 451:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1704              		.loc 1 451 0 discriminator 3
 1705 02e4 082E     		cmp	r6, #8
 452:bluetooth_rxtx.c **** 		}
 1706              		.loc 1 452 0 discriminator 3
 1707 02e6 C4E90001 		strd	r0, [r4]
 451:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1708              		.loc 1 451 0 discriminator 3
 1709 02ea F1D1     		bne	.L168
 1710 02ec 0735     		adds	r5, r5, #7
 1711              	.LVL200:
 451:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1712              		.loc 1 451 0 is_stmt 0
 1713 02ee 0026     		movs	r6, #0
 1714              	.LVL201:
 1715              	.L169:
 1716              	.LBE17:
 1717              	.LBB18:
 455:bluetooth_rxtx.c **** 		}
 1718              		.loc 1 455 0 is_stmt 1 discriminator 3
 1719 02f0 F200     		lsls	r2, r6, #3
 1720 02f2 15F8010F 		ldrb	r0, [r5, #1]!	@ zero_extendqisi2
 1721 02f6 0021     		movs	r1, #0
 1722 02f8 FFF7FEFF 		bl	__aeabi_llsl
 1723              	.LVL202:
 1724 02fc D4E90223 		ldrd	r2, [r4, #8]
 454:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 1725              		.loc 1 454 0 discriminator 3
 1726 0300 0136     		adds	r6, r6, #1
 1727              	.LVL203:
 455:bluetooth_rxtx.c **** 		}
 1728              		.loc 1 455 0 discriminator 3
 1729 0302 1043     		orrs	r0, r0, r2
 1730 0304 1943     		orrs	r1, r1, r3
 454:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 1731              		.loc 1 454 0 discriminator 3
 1732 0306 082E     		cmp	r6, #8
 455:bluetooth_rxtx.c **** 		}
 1733              		.loc 1 455 0 discriminator 3
 1734 0308 C4E90201 		strd	r0, [r4, #8]
 454:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 1735              		.loc 1 454 0 discriminator 3
 1736 030c F0D1     		bne	.L169
 1737              	.LBE18:
 457:bluetooth_rxtx.c **** 		break;
 1738              		.loc 1 457 0
 1739 030e FFF7FEFF 		bl	precalc
 1740              	.LVL204:
 1741 0312 C8E1     		b	.L212
ARM GAS  /tmp/ccDKg7Fp.s 			page 72


 1742              	.L247:
 1743              		.align	2
 1744              	.L246:
 1745 0314 00000000 		.word	.LANCHOR0
 1746 0318 34C00920 		.word	537509940
 1747 031c 38C00920 		.word	537509944
 1748 0320 3CC00920 		.word	537509948
 1749 0324 54C00920 		.word	537509972
 1750 0328 58C00920 		.word	537509976
 1751 032c 5CC00920 		.word	537509980
 1752 0330 00000000 		.word	rr
 1753 0334 00000000 		.word	.LANCHOR1
 1754 0338 21BB0543 		.word	1124449057
 1755 033c 00000000 		.word	bootloader_ctrl
 1756 0340 00000000 		.word	.LC3
 1757 0344 A7000000 		.word	.LANCHOR2+167
 1758 0348 00000000 		.word	cs_threshold_req
 1759 034c 00000000 		.word	target
 1760              	.LVL205:
 1761              	.L127:
 461:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 1762              		.loc 1 461 0
 1763 0350 A34B     		ldr	r3, .L248
 1764 0352 0022     		movs	r2, #0
 1765              	.LVL206:
 1766 0354 1A60     		str	r2, [r3]
 1767              	.LVL207:
 1768 0356 E81C     		adds	r0, r5, #3
 1769              	.LVL208:
 1770 0358 6A1E     		subs	r2, r5, #1
 1771              	.LVL209:
 1772              	.L170:
 1773              	.LBB19:
 463:bluetooth_rxtx.c **** 			clkn_offset |= data[i];
 1774              		.loc 1 463 0 discriminator 3
 1775 035a 1968     		ldr	r1, [r3]
 1776 035c 0902     		lsls	r1, r1, #8
 1777 035e 1960     		str	r1, [r3]
 464:bluetooth_rxtx.c **** 		}
 1778              		.loc 1 464 0 discriminator 3
 1779 0360 12F8014F 		ldrb	r4, [r2, #1]!	@ zero_extendqisi2
 1780 0364 1968     		ldr	r1, [r3]
 462:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 1781              		.loc 1 462 0 discriminator 3
 1782 0366 8242     		cmp	r2, r0
 464:bluetooth_rxtx.c **** 		}
 1783              		.loc 1 464 0 discriminator 3
 1784 0368 41EA0401 		orr	r1, r1, r4
 1785 036c 1960     		str	r1, [r3]
 462:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 1786              		.loc 1 462 0 discriminator 3
 1787 036e F4D1     		bne	.L170
 1788              	.LBE19:
 466:bluetooth_rxtx.c **** 		dma_discard = 1;
 1789              		.loc 1 466 0
 1790 0370 9C4B     		ldr	r3, .L248+4
 1791 0372 0222     		movs	r2, #2
ARM GAS  /tmp/ccDKg7Fp.s 			page 73


 1792 0374 9A72     		strb	r2, [r3, #10]
 468:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1793              		.loc 1 468 0
 1794 0376 9C4A     		ldr	r2, .L248+8
 467:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 1795              		.loc 1 467 0
 1796 0378 0120     		movs	r0, #1
 468:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1797              		.loc 1 468 0
 1798 037a 4FF08051 		mov	r1, #268435456
 467:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 1799              		.loc 1 467 0
 1800 037e 1874     		strb	r0, [r3, #16]
 468:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1801              		.loc 1 468 0
 1802 0380 1160     		str	r1, [r2]
 469:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW;
 1803              		.loc 1 469 0
 1804 0382 2979     		ldrb	r1, [r5, #4]	@ zero_extendqisi2
 1805 0384 6A79     		ldrb	r2, [r5, #5]	@ zero_extendqisi2
 1806 0386 42EA0122 		orr	r2, r2, r1, lsl #8
 1807 038a 9849     		ldr	r1, .L248+12
 1808 038c 0A80     		strh	r2, [r1]	@ movhi
 470:bluetooth_rxtx.c **** 		break;
 1809              		.loc 1 470 0
 1810 038e 0822     		movs	r2, #8
 1811 0390 9A74     		strb	r2, [r3, #18]
 471:bluetooth_rxtx.c **** 
 1812              		.loc 1 471 0
 1813 0392 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 1814              	.LVL210:
 1815              	.L148:
 474:bluetooth_rxtx.c **** 		requested_mode = MODE_AFH;
 1816              		.loc 1 474 0
 1817 0394 934B     		ldr	r3, .L248+4
 1818 0396 0522     		movs	r2, #5
 1819              	.LVL211:
 1820 0398 9A72     		strb	r2, [r3, #10]
 475:bluetooth_rxtx.c **** 
 1821              		.loc 1 475 0
 1822 039a 0E22     		movs	r2, #14
 1823 039c 9A74     		strb	r2, [r3, #18]
 1824              	.LVL212:
 1825              	.LBB20:
 477:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1826              		.loc 1 477 0
 1827 039e 0023     		movs	r3, #0
 1828              	.LVL213:
 1829              	.L171:
 478:bluetooth_rxtx.c **** 		}
 1830              		.loc 1 478 0 discriminator 3
 1831 03a0 9349     		ldr	r1, .L248+16
 1832 03a2 0022     		movs	r2, #0
 1833 03a4 5A54     		strb	r2, [r3, r1]
 477:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1834              		.loc 1 477 0 discriminator 3
 1835 03a6 0133     		adds	r3, r3, #1
ARM GAS  /tmp/ccDKg7Fp.s 			page 74


 1836              	.LVL214:
 1837 03a8 0A2B     		cmp	r3, #10
 1838 03aa F9D1     		bne	.L171
 1839              	.LBE20:
 480:bluetooth_rxtx.c **** 		afh_enabled = 1;
 1840              		.loc 1 480 0
 1841 03ac 914B     		ldr	r3, .L248+20
 1842              	.LVL215:
 481:bluetooth_rxtx.c **** 		break;
 1843              		.loc 1 481 0
 1844 03ae 0120     		movs	r0, #1
 1845              	.LVL216:
 480:bluetooth_rxtx.c **** 		afh_enabled = 1;
 1846              		.loc 1 480 0
 1847 03b0 1A70     		strb	r2, [r3]
 481:bluetooth_rxtx.c **** 		break;
 1848              		.loc 1 481 0
 1849 03b2 914B     		ldr	r3, .L248+24
 1850 03b4 1870     		strb	r0, [r3]
 482:bluetooth_rxtx.c **** 
 1851              		.loc 1 482 0
 1852 03b6 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 1853              	.LVL217:
 1854              	.L149:
 485:bluetooth_rxtx.c **** 		break;
 1855              		.loc 1 485 0
 1856 03b8 8A4B     		ldr	r3, .L248+4
 1857 03ba 0120     		movs	r0, #1
 1858              	.LVL218:
 1859 03bc D872     		strb	r0, [r3, #11]
 486:bluetooth_rxtx.c **** 
 1860              		.loc 1 486 0
 1861 03be F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 1862              	.LVL219:
 1863              	.L128:
 489:bluetooth_rxtx.c **** 		clkn = clock;
 1864              		.loc 1 489 0
 1865 03c0 AB78     		ldrb	r3, [r5, #2]	@ zero_extendqisi2
 1866 03c2 5278     		ldrb	r2, [r2, #1]	@ zero_extendqisi2
 1867              	.LVL220:
 1868 03c4 1B04     		lsls	r3, r3, #16
 1869 03c6 43EA0223 		orr	r3, r3, r2, lsl #8
 1870 03ca 2A78     		ldrb	r2, [r5]	@ zero_extendqisi2
 1871 03cc 1343     		orrs	r3, r3, r2
 1872 03ce EA78     		ldrb	r2, [r5, #3]	@ zero_extendqisi2
 1873 03d0 43EA0263 		orr	r3, r3, r2, lsl #24
 1874              	.LVL221:
 490:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 1875              		.loc 1 490 0
 1876 03d4 894A     		ldr	r2, .L248+28
 1877 03d6 1360     		str	r3, [r2]
 1878 03d8 A3E0     		b	.L228
 1879              	.LVL222:
 1880              	.L190:
 197:bluetooth_rxtx.c **** 
 1881              		.loc 1 197 0
 1882 03da 0023     		movs	r3, #0
ARM GAS  /tmp/ccDKg7Fp.s 			page 75


 1883              	.LVL223:
 1884              	.L139:
 1885              	.LBB21:
 496:bluetooth_rxtx.c **** 		}
 1886              		.loc 1 496 0 discriminator 3
 1887 03dc E95C     		ldrb	r1, [r5, r3]	@ zero_extendqisi2
 1888 03de 844A     		ldr	r2, .L248+16
 1889 03e0 9954     		strb	r1, [r3, r2]
 495:bluetooth_rxtx.c **** 			afh_map[i] = data[i];
 1890              		.loc 1 495 0 discriminator 3
 1891 03e2 0133     		adds	r3, r3, #1
 1892              	.LVL224:
 1893 03e4 0A2B     		cmp	r3, #10
 1894 03e6 F9D1     		bne	.L139
 1895              	.LBE21:
 498:bluetooth_rxtx.c **** 		*data_len = 10;
 1896              		.loc 1 498 0
 1897 03e8 834A     		ldr	r2, .L248+24
 1898 03ea 0120     		movs	r0, #1
 1899              	.LVL225:
 1900 03ec 1070     		strb	r0, [r2]
 1901              	.LVL226:
 1902              	.L216:
 499:bluetooth_rxtx.c **** 		break;
 1903              		.loc 1 499 0
 1904 03ee 2360     		str	r3, [r4]
 500:bluetooth_rxtx.c **** 
 1905              		.loc 1 500 0
 1906 03f0 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 1907              	.LVL227:
 1908              	.L191:
 197:bluetooth_rxtx.c **** 
 1909              		.loc 1 197 0
 1910 03f2 0023     		movs	r3, #0
 1911              	.LVL228:
 1912              	.L140:
 1913              	.LBB22:
 504:bluetooth_rxtx.c **** 		}
 1914              		.loc 1 504 0 discriminator 3
 1915 03f4 7E49     		ldr	r1, .L248+16
 1916 03f6 0022     		movs	r2, #0
 1917 03f8 5A54     		strb	r2, [r3, r1]
 503:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1918              		.loc 1 503 0 discriminator 3
 1919 03fa 0133     		adds	r3, r3, #1
 1920              	.LVL229:
 1921 03fc 0A2B     		cmp	r3, #10
 1922 03fe F9D1     		bne	.L140
 1923              	.LBE22:
 506:bluetooth_rxtx.c **** 		*data_len = 10;
 1924              		.loc 1 506 0
 1925 0400 7D49     		ldr	r1, .L248+24
 1926 0402 0A70     		strb	r2, [r1]
 1927 0404 BBE6     		b	.L226
 1928              	.LVL230:
 1929              	.L129:
 511:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
ARM GAS  /tmp/ccDKg7Fp.s 			page 76


 1930              		.loc 1 511 0
 1931 0406 7D4B     		ldr	r3, .L248+28
 1932 0408 1968     		ldr	r1, [r3]
 1933              	.LVL231:
 1934              	.LBB23:
 512:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 1935              		.loc 1 512 0
 1936 040a 0023     		movs	r3, #0
 1937              	.LVL232:
 1938              	.L172:
 1939 040c DA00     		lsls	r2, r3, #3
 513:bluetooth_rxtx.c **** 		}
 1940              		.loc 1 513 0 discriminator 3
 1941 040e 21FA02F2 		lsr	r2, r1, r2
 1942 0412 EA54     		strb	r2, [r5, r3]
 512:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 1943              		.loc 1 512 0 discriminator 3
 1944 0414 0133     		adds	r3, r3, #1
 1945              	.LVL233:
 1946 0416 042B     		cmp	r3, #4
 1947 0418 F8D1     		bne	.L172
 1948              	.LVL234:
 1949              	.L175:
 1950              	.LBE23:
 515:bluetooth_rxtx.c **** 		break;
 1951              		.loc 1 515 0
 1952 041a 0423     		movs	r3, #4
 1953 041c AFE6     		b	.L226
 1954              	.LVL235:
 1955              	.L150:
 519:bluetooth_rxtx.c **** 		break;
 1956              		.loc 1 519 0
 1957 041e 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 1958              	.LVL236:
 1959 0420 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 1960 0422 43EA0223 		orr	r3, r3, r2, lsl #8
 1961 0426 714A     		ldr	r2, .L248+12
 1962 0428 1380     		strh	r3, [r2]	@ movhi
 1963 042a 3CE1     		b	.L212
 1964              	.LVL237:
 1965              	.L155:
 523:bluetooth_rxtx.c **** 
 1966              		.loc 1 523 0
 1967 042c 744B     		ldr	r3, .L248+32
 1968 042e 1078     		ldrb	r0, [r2]	@ zero_extendqisi2
 1969              	.LVL238:
 1970 0430 5278     		ldrb	r2, [r2, #1]	@ zero_extendqisi2
 1971              	.LVL239:
 1972 0432 1988     		ldrh	r1, [r3]
 1973              	.LVL240:
 1974 0434 42EA0022 		orr	r2, r2, r0, lsl #8
 1975 0438 0A44     		add	r2, r2, r1
 1976 043a 92B2     		uxth	r2, r2
 1977 043c 1A80     		strh	r2, [r3]	@ movhi
 526:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / (uint16_t)(-clk_drift_ppm);
 1978              		.loc 1 526 0
 1979 043e 1A88     		ldrh	r2, [r3]
ARM GAS  /tmp/ccDKg7Fp.s 			page 77


 1980 0440 7048     		ldr	r0, .L248+36
 1981 0442 12B2     		sxth	r2, r2
 1982 0444 002A     		cmp	r2, #0
 1983 0446 704A     		ldr	r2, .L248+40
 1984 0448 07DA     		bge	.L173
 527:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 1985              		.loc 1 527 0
 1986 044a 1B88     		ldrh	r3, [r3]
 1987 044c 4FF4A071 		mov	r1, #320
 1988 0450 5B42     		negs	r3, r3
 1989 0452 9BB2     		uxth	r3, r3
 1990 0454 91FBF3F3 		sdiv	r3, r1, r3
 1991 0458 0AE0     		b	.L239
 1992              	.L173:
 531:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / clk_drift_ppm;
 1993              		.loc 1 531 0
 1994 045a 1988     		ldrh	r1, [r3]
 1995 045c 09B2     		sxth	r1, r1
 1996 045e 0029     		cmp	r1, #0
 1997 0460 0DDD     		ble	.L174
 532:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 1998              		.loc 1 532 0
 1999 0462 1B88     		ldrh	r3, [r3]
 2000 0464 4FF4A071 		mov	r1, #320
 2001 0468 1BB2     		sxth	r3, r3
 2002 046a 91FBF3F3 		sdiv	r3, r1, r3
 2003 046e 9BB2     		uxth	r3, r3
 2004              	.L239:
 2005 0470 1380     		strh	r3, [r2]	@ movhi
 533:bluetooth_rxtx.c **** 		}
 2006              		.loc 1 533 0
 2007 0472 664B     		ldr	r3, .L248+44
 2008 0474 1968     		ldr	r1, [r3]
 2009 0476 1388     		ldrh	r3, [r2]
 2010 0478 9BB2     		uxth	r3, r3
 2011 047a 0B44     		add	r3, r3, r1
 2012 047c 01E0     		b	.L222
 2013              	.L174:
 537:bluetooth_rxtx.c **** 			clkn_next_drift_fix = 0;
 2014              		.loc 1 537 0
 2015 047e 0023     		movs	r3, #0
 2016 0480 1380     		strh	r3, [r2]	@ movhi
 2017              	.L222:
 538:bluetooth_rxtx.c **** 		}
 2018              		.loc 1 538 0
 2019 0482 0360     		str	r3, [r0]
 2020 0484 0FE1     		b	.L212
 2021              	.LVL241:
 2022              	.L130:
 544:bluetooth_rxtx.c **** 		*data_len = 0;
 2023              		.loc 1 544 0
 2024 0486 0B88     		ldrh	r3, [r1]
 2025 0488 614D     		ldr	r5, .L248+48
 545:bluetooth_rxtx.c **** 
 2026              		.loc 1 545 0
 2027 048a 0022     		movs	r2, #0
 2028              	.LVL242:
ARM GAS  /tmp/ccDKg7Fp.s 			page 78


 544:bluetooth_rxtx.c **** 		*data_len = 0;
 2029              		.loc 1 544 0
 2030 048c AB63     		str	r3, [r5, #56]
 547:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 2031              		.loc 1 547 0
 2032 048e 554B     		ldr	r3, .L248+4
 545:bluetooth_rxtx.c **** 
 2033              		.loc 1 545 0
 2034 0490 2260     		str	r2, [r4]
 547:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 2035              		.loc 1 547 0
 2036 0492 DA72     		strb	r2, [r3, #11]
 548:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW_LE;
 2037              		.loc 1 548 0
 2038 0494 0322     		movs	r2, #3
 2039 0496 9A72     		strb	r2, [r3, #10]
 549:bluetooth_rxtx.c **** 
 2040              		.loc 1 549 0
 2041 0498 0922     		movs	r2, #9
 2042 049a 9A74     		strb	r2, [r3, #18]
 551:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 2043              		.loc 1 551 0
 2044 049c FFF7FEFF 		bl	usb_queue_init
 2045              	.LVL243:
 552:bluetooth_rxtx.c **** 		break;
 2046              		.loc 1 552 0
 2047 04a0 2888     		ldrh	r0, [r5]
 2048 04a2 40E0     		b	.L227
 2049              	.LVL244:
 2050              	.L189:
 197:bluetooth_rxtx.c **** 
 2051              		.loc 1 197 0
 2052 04a4 0023     		movs	r3, #0
 2053              	.LVL245:
 2054              	.L131:
 2055              	.LBB24:
 557:bluetooth_rxtx.c **** 		}
 2056              		.loc 1 557 0 discriminator 3
 2057 04a6 5A4A     		ldr	r2, .L248+48
 2058 04a8 D900     		lsls	r1, r3, #3
 2059 04aa 5268     		ldr	r2, [r2, #4]
 2060 04ac CA40     		lsrs	r2, r2, r1
 2061 04ae EA54     		strb	r2, [r5, r3]
 556:bluetooth_rxtx.c **** 			data[i] = (le.access_address >> (8*i)) & 0xff;
 2062              		.loc 1 556 0 discriminator 3
 2063 04b0 0133     		adds	r3, r3, #1
 2064              	.LVL246:
 2065 04b2 042B     		cmp	r3, #4
 2066 04b4 F7D1     		bne	.L131
 2067 04b6 B0E7     		b	.L175
 2068              	.LVL247:
 2069              	.L132:
 2070              	.LBE24:
 563:bluetooth_rxtx.c **** 		le.target_set = 1;
 2071              		.loc 1 563 0
 2072 04b8 9378     		ldrb	r3, [r2, #2]	@ zero_extendqisi2
 2073 04ba 5078     		ldrb	r0, [r2, #1]	@ zero_extendqisi2
ARM GAS  /tmp/ccDKg7Fp.s 			page 79


 2074              	.LVL248:
 2075 04bc 1B04     		lsls	r3, r3, #16
 2076 04be 43EA0023 		orr	r3, r3, r0, lsl #8
 2077 04c2 1078     		ldrb	r0, [r2]	@ zero_extendqisi2
 2078 04c4 0343     		orrs	r3, r3, r0
 2079 04c6 D078     		ldrb	r0, [r2, #3]	@ zero_extendqisi2
 2080 04c8 43EA0060 		orr	r0, r3, r0, lsl #24
 2081 04cc FFF7FEFF 		bl	le_set_access_address
 2082              	.LVL249:
 2083 04d0 D8E0     		b	.L215
 2084              	.LVL250:
 2085              	.L134:
 574:bluetooth_rxtx.c **** 		data[1] = 0x37;
 2086              		.loc 1 574 0
 2087 04d2 1323     		movs	r3, #19
 2088 04d4 1370     		strb	r3, [r2]
 575:bluetooth_rxtx.c **** 		*data_len = 2;
 2089              		.loc 1 575 0
 2090 04d6 3723     		movs	r3, #55
 2091              	.LVL251:
 2092              	.L243:
 2093 04d8 6B70     		strb	r3, [r5, #1]
 2094 04da 2EE0     		b	.L242
 2095              	.LVL252:
 2096              	.L135:
 580:bluetooth_rxtx.c **** 		*data_len = 1;
 2097              		.loc 1 580 0
 2098 04dc 4C4B     		ldr	r3, .L248+48
 2099 04de 5B69     		ldr	r3, [r3, #20]
 2100 04e0 0033     		adds	r3, r3, #0
 2101 04e2 18BF     		it	ne
 2102 04e4 0123     		movne	r3, #1
 2103 04e6 E9E6     		b	.L218
 2104              	.L136:
 585:bluetooth_rxtx.c **** 		break;
 2105              		.loc 1 585 0
 2106 04e8 0B88     		ldrh	r3, [r1]
 2107 04ea 494A     		ldr	r2, .L248+48
 2108              	.LVL253:
 2109 04ec 0033     		adds	r3, r3, #0
 2110 04ee 18BF     		it	ne
 2111 04f0 0123     		movne	r3, #1
 2112 04f2 5361     		str	r3, [r2, #20]
 2113 04f4 D7E0     		b	.L212
 2114              	.LVL254:
 2115              	.L137:
 589:bluetooth_rxtx.c **** 		if (p != NULL) {
 2116              		.loc 1 589 0
 2117 04f6 FFF7FEFF 		bl	dequeue
 2118              	.LVL255:
 590:bluetooth_rxtx.c **** 			memcpy(data, (void *)p, sizeof(usb_pkt_rx));
 2119              		.loc 1 590 0
 2120 04fa 0146     		mov	r1, r0
 2121 04fc 28B1     		cbz	r0, .L176
 591:bluetooth_rxtx.c **** 			*data_len = sizeof(usb_pkt_rx);
 2122              		.loc 1 591 0
 2123 04fe 2846     		mov	r0, r5
ARM GAS  /tmp/ccDKg7Fp.s 			page 80


 2124              	.LVL256:
 2125 0500 4022     		movs	r2, #64
 2126 0502 FFF7FEFF 		bl	memcpy
 2127              	.LVL257:
 592:bluetooth_rxtx.c **** 		} else {
 2128              		.loc 1 592 0
 2129 0506 4023     		movs	r3, #64
 2130 0508 39E6     		b	.L226
 2131              	.LVL258:
 2132              	.L176:
 594:bluetooth_rxtx.c **** 			*data_len = 1;
 2133              		.loc 1 594 0
 2134 050a 2870     		strb	r0, [r5]
 2135              	.LVL259:
 2136              	.L213:
 595:bluetooth_rxtx.c **** 		}
 2137              		.loc 1 595 0
 2138 050c 0120     		movs	r0, #1
 2139              	.L214:
 2140 050e 2060     		str	r0, [r4]
 2141 0510 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 2142              	.LVL260:
 2143              	.L138:
 602:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_PROMISC_LE;
 2144              		.loc 1 602 0
 2145 0512 344B     		ldr	r3, .L248+4
 600:bluetooth_rxtx.c **** 
 2146              		.loc 1 600 0
 2147 0514 0022     		movs	r2, #0
 2148              	.LVL261:
 2149 0516 2260     		str	r2, [r4]
 602:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_PROMISC_LE;
 2150              		.loc 1 602 0
 2151 0518 9A72     		strb	r2, [r3, #10]
 603:bluetooth_rxtx.c **** 
 2152              		.loc 1 603 0
 2153 051a 0A22     		movs	r2, #10
 2154 051c 9A74     		strb	r2, [r3, #18]
 605:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 2155              		.loc 1 605 0
 2156 051e FFF7FEFF 		bl	usb_queue_init
 2157              	.LVL262:
 2158              	.L228:
 606:bluetooth_rxtx.c **** 		break;
 2159              		.loc 1 606 0
 2160 0522 3B4B     		ldr	r3, .L248+48
 2161 0524 1888     		ldrh	r0, [r3]
 2162              	.LVL263:
 2163              	.L227:
 2164 0526 80B2     		uxth	r0, r0
 2165 0528 FFF7FEFF 		bl	cs_threshold_calc_and_set
 2166              	.LVL264:
 2167 052c BBE0     		b	.L212
 2168              	.LVL265:
 2169              	.L141:
 610:bluetooth_rxtx.c **** 		data[0] = (reg_val >> 8) & 0xff;
 2170              		.loc 1 610 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 81


 2171 052e 0878     		ldrb	r0, [r1]	@ zero_extendqisi2
 2172              	.LVL266:
 2173 0530 FFF7FEFF 		bl	cc2400_get
 2174              	.LVL267:
 611:bluetooth_rxtx.c **** 		data[1] = reg_val & 0xff;
 2175              		.loc 1 611 0
 2176 0534 030A     		lsrs	r3, r0, #8
 2177 0536 2B70     		strb	r3, [r5]
 612:bluetooth_rxtx.c **** 		*data_len = 2;
 2178              		.loc 1 612 0
 2179 0538 6870     		strb	r0, [r5, #1]
 2180              	.LVL268:
 2181              	.L242:
 613:bluetooth_rxtx.c **** 		break;
 2182              		.loc 1 613 0
 2183 053a 0223     		movs	r3, #2
 2184 053c 1FE6     		b	.L226
 2185              	.LVL269:
 2186              	.L145:
 617:bluetooth_rxtx.c **** 		break;
 2187              		.loc 1 617 0
 2188 053e 0878     		ldrb	r0, [r1]	@ zero_extendqisi2
 2189              	.LVL270:
 2190 0540 4988     		ldrh	r1, [r1, #2]
 2191              	.LVL271:
 2192              	.L224:
 2193 0542 FFF7FEFF 		bl	cc2400_set
 2194              	.LVL272:
 2195 0546 AEE0     		b	.L212
 2196              	.LVL273:
 2197              	.L192:
 197:bluetooth_rxtx.c **** 
 2198              		.loc 1 197 0
 2199 0548 0023     		movs	r3, #0
 2200              	.LVL274:
 2201              	.L151:
 621:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 2202              		.loc 1 621 0 discriminator 1
 2203 054a 3288     		ldrh	r2, [r6]
 2204 054c 5C1C     		adds	r4, r3, #1
 2205 054e DBB2     		uxtb	r3, r3
 2206 0550 9342     		cmp	r3, r2
 2207 0552 80F0A880 		bcs	.L212
 622:bluetooth_rxtx.c **** 			cc2400_set(data[i*3], reg_val);
 2208              		.loc 1 622 0 discriminator 3
 2209 0556 03EB4303 		add	r3, r3, r3, lsl #1
 2210              	.LVL275:
 2211 055a EA18     		adds	r2, r5, r3
 2212              	.LVL276:
 2213 055c 5178     		ldrb	r1, [r2, #1]	@ zero_extendqisi2
 2214 055e 9278     		ldrb	r2, [r2, #2]	@ zero_extendqisi2
 2215              	.LVL277:
 623:bluetooth_rxtx.c **** 		}
 2216              		.loc 1 623 0 discriminator 3
 2217 0560 E85C     		ldrb	r0, [r5, r3]	@ zero_extendqisi2
 2218 0562 42EA0121 		orr	r1, r2, r1, lsl #8
 2219 0566 FFF7FEFF 		bl	cc2400_set
ARM GAS  /tmp/ccDKg7Fp.s 			page 82


 2220              	.LVL278:
 2221 056a 2346     		mov	r3, r4
 2222 056c EDE7     		b	.L151
 2223              	.LVL279:
 2224              	.L152:
 197:bluetooth_rxtx.c **** 
 2225              		.loc 1 197 0
 2226 056e 0026     		movs	r6, #0
 2227              	.LVL280:
 2228              	.L179:
 2229 0570 F7B2     		uxtb	r7, r6
 2230              	.LVL281:
 630:bluetooth_rxtx.c **** 			data[i*3] = i;
 2231              		.loc 1 630 0 discriminator 3
 2232 0572 3846     		mov	r0, r7
 2233 0574 FFF7FEFF 		bl	cc2400_get
 2234              	.LVL282:
 2235 0578 0136     		adds	r6, r6, #1
 632:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 2236              		.loc 1 632 0 discriminator 3
 2237 057a 030A     		lsrs	r3, r0, #8
 629:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 2238              		.loc 1 629 0 discriminator 3
 2239 057c 2E2E     		cmp	r6, #46
 631:bluetooth_rxtx.c **** 			data[(i*3)+1] = (reg_val >> 8) & 0xff;
 2240              		.loc 1 631 0 discriminator 3
 2241 057e 2F70     		strb	r7, [r5]
 632:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 2242              		.loc 1 632 0 discriminator 3
 2243 0580 6B70     		strb	r3, [r5, #1]
 633:bluetooth_rxtx.c **** 		}
 2244              		.loc 1 633 0 discriminator 3
 2245 0582 A870     		strb	r0, [r5, #2]
 2246              	.LVL283:
 2247 0584 05F10305 		add	r5, r5, #3
 629:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 2248              		.loc 1 629 0 discriminator 3
 2249 0588 F2D1     		bne	.L179
 635:bluetooth_rxtx.c **** 		break;
 2250              		.loc 1 635 0
 2251 058a 8723     		movs	r3, #135
 2252 058c F7E5     		b	.L226
 2253              	.LVL284:
 2254              	.L154:
 639:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 2255              		.loc 1 639 0
 2256 058e 9279     		ldrb	r2, [r2, #6]	@ zero_extendqisi2
 2257              	.LVL285:
 640:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 2258              		.loc 1 640 0
 2259 0590 2048     		ldr	r0, .L248+52
 2260              	.LVL286:
 639:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 2261              		.loc 1 639 0
 2262 0592 0732     		adds	r2, r2, #7
 640:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 2263              		.loc 1 640 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 83


 2264 0594 D2B2     		uxtb	r2, r2
 2265 0596 2946     		mov	r1, r5
 2266              	.LVL287:
 2267 0598 FFF7FEFF 		bl	memcpy
 2268              	.LVL288:
 642:bluetooth_rxtx.c **** 		*data_len = 0;
 2269              		.loc 1 642 0
 2270 059c 1022     		movs	r2, #16
 2271              	.L237:
 2272 059e 114B     		ldr	r3, .L248+4
 2273              	.L236:
 2274 05a0 9A74     		strb	r2, [r3, #18]
 2275 05a2 35E6     		b	.L225
 2276              	.LVL289:
 2277              	.L142:
 647:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE;
 2278              		.loc 1 647 0
 2279 05a4 0F4C     		ldr	r4, .L248+4
 2280              	.LVL290:
 2281 05a6 1146     		mov	r1, r2
 2282              	.LVL291:
 2283 05a8 04F12000 		add	r0, r4, #32
 2284              	.LVL292:
 2285 05ac 0622     		movs	r2, #6
 2286              	.LVL293:
 2287 05ae FFF7FEFF 		bl	memcpy
 2288              	.LVL294:
 648:bluetooth_rxtx.c **** 		break;
 2289              		.loc 1 648 0
 2290 05b2 0C23     		movs	r3, #12
 2291 05b4 A374     		strb	r3, [r4, #18]
 2292 05b6 76E0     		b	.L212
 2293              	.LVL295:
 2294              	.L144:
 654:bluetooth_rxtx.c **** 			return 1; // invalid mask
 2295              		.loc 1 654 0
 2296 05b8 9479     		ldrb	r4, [r2, #6]	@ zero_extendqisi2
 2297              	.LVL296:
 2298 05ba 302C     		cmp	r4, #48
 2299 05bc 73D8     		bhi	.L212
 657:bluetooth_rxtx.c **** 			le.target_set = 0;
 2300              		.loc 1 657 0
 2301 05be 5CBB     		cbnz	r4, .L180
 658:bluetooth_rxtx.c **** 			memset(le.target, 0, 6);
 2302              		.loc 1 658 0
 2303 05c0 134D     		ldr	r5, .L248+48
 659:bluetooth_rxtx.c **** 			memset(le.target_mask, 0, 6);
 2304              		.loc 1 659 0
 2305 05c2 2146     		mov	r1, r4
 2306              	.LVL297:
 2307 05c4 05F13C00 		add	r0, r5, #60
 2308              	.LVL298:
 2309 05c8 0622     		movs	r2, #6
 2310              	.LVL299:
 658:bluetooth_rxtx.c **** 			memset(le.target, 0, 6);
 2311              		.loc 1 658 0
 2312 05ca AC64     		str	r4, [r5, #72]
ARM GAS  /tmp/ccDKg7Fp.s 			page 84


 659:bluetooth_rxtx.c **** 			memset(le.target_mask, 0, 6);
 2313              		.loc 1 659 0
 2314 05cc FFF7FEFF 		bl	memset
 2315              	.LVL300:
 660:bluetooth_rxtx.c **** 		} else {
 2316              		.loc 1 660 0
 2317 05d0 05F14200 		add	r0, r5, #66
 2318 05d4 2146     		mov	r1, r4
 2319 05d6 0622     		movs	r2, #6
 2320 05d8 FFF7FEFF 		bl	memset
 2321              	.LVL301:
 2322 05dc 63E0     		b	.L212
 2323              	.L249:
 2324 05de 00BF     		.align	2
 2325              	.L248:
 2326 05e0 00000000 		.word	clkn_offset
 2327 05e4 00000000 		.word	.LANCHOR0
 2328 05e8 98C00920 		.word	537510040
 2329 05ec 00000000 		.word	clk100ns_offset
 2330 05f0 00000000 		.word	afh_map
 2331 05f4 00000000 		.word	used_channels
 2332 05f8 00000000 		.word	afh_enabled
 2333 05fc 00000000 		.word	clkn
 2334 0600 00000000 		.word	clk_drift_ppm
 2335 0604 00000000 		.word	clkn_next_drift_fix
 2336 0608 00000000 		.word	clk_drift_correction
 2337 060c 00000000 		.word	clkn_last_drift_fix
 2338 0610 00000000 		.word	.LANCHOR1
 2339 0614 00000000 		.word	tx_pkt
 2340              	.LVL302:
 2341              	.L180:
 2342 0618 254C     		ldr	r4, .L250
 2343 061a 0632     		adds	r2, r2, #6
 2344              	.LVL303:
 657:bluetooth_rxtx.c **** 			le.target_set = 0;
 2345              		.loc 1 657 0
 2346 061c 2346     		mov	r3, r4
 2347 061e A11D     		adds	r1, r4, #6
 2348              	.LVL304:
 2349              	.L181:
 2350              	.LBB25:
 665:bluetooth_rxtx.c **** 
 2351              		.loc 1 665 0 discriminator 3
 2352 0620 12F8010D 		ldrb	r0, [r2, #-1]!	@ zero_extendqisi2
 2353 0624 03F8010F 		strb	r0, [r3, #1]!
 2354              	.LVL305:
 664:bluetooth_rxtx.c **** 				le.target[i] = data[5-i];
 2355              		.loc 1 664 0 discriminator 3
 2356 0628 8B42     		cmp	r3, r1
 2357 062a F9D1     		bne	.L181
 668:bluetooth_rxtx.c **** 			for (i = 5; data[6] > 8; --i, data[6] -= 8) {
 2358              		.loc 1 668 0
 2359 062c 2148     		ldr	r0, .L250+4
 2360 062e 0021     		movs	r1, #0
 2361 0630 0622     		movs	r2, #6
 2362 0632 FFF7FEFF 		bl	memset
 2363              	.LVL306:
ARM GAS  /tmp/ccDKg7Fp.s 			page 85


 669:bluetooth_rxtx.c **** 				le.target_mask[i] = 0xff;
 2364              		.loc 1 669 0
 2365 0636 0523     		movs	r3, #5
 2366              	.LVL307:
 2367              	.L182:
 669:bluetooth_rxtx.c **** 				le.target_mask[i] = 0xff;
 2368              		.loc 1 669 0 is_stmt 0 discriminator 1
 2369 0638 A879     		ldrb	r0, [r5, #6]	@ zero_extendqisi2
 2370 063a 0828     		cmp	r0, #8
 2371 063c 0AD9     		bls	.L244
 670:bluetooth_rxtx.c **** 			}
 2372              		.loc 1 670 0 is_stmt 1 discriminator 3
 2373 063e 1E4A     		ldr	r2, .L250+8
 2374 0640 FF21     		movs	r1, #255
 2375 0642 1A44     		add	r2, r2, r3
 2376 0644 82F84210 		strb	r1, [r2, #66]
 669:bluetooth_rxtx.c **** 				le.target_mask[i] = 0xff;
 2377              		.loc 1 669 0 discriminator 3
 2378 0648 AA79     		ldrb	r2, [r5, #6]	@ zero_extendqisi2
 2379 064a 013B     		subs	r3, r3, #1
 2380              	.LVL308:
 2381 064c 083A     		subs	r2, r2, #8
 2382 064e DBB2     		uxtb	r3, r3
 2383              	.LVL309:
 2384 0650 AA71     		strb	r2, [r5, #6]
 2385 0652 F1E7     		b	.L182
 2386              	.L244:
 2387              	.LVL310:
 674:bluetooth_rxtx.c **** 				uint8_t final_byte = 0;
 2388              		.loc 1 674 0
 2389 0654 68B1     		cbz	r0, .L185
 2390 0656 0021     		movs	r1, #0
 2391 0658 0A46     		mov	r2, r1
 2392              	.LVL311:
 2393              	.L184:
 2394              	.LBB26:
 676:bluetooth_rxtx.c **** 					final_byte >>= 1;
 2395              		.loc 1 676 0 discriminator 1
 2396 065a CDB2     		uxtb	r5, r1
 2397 065c 8542     		cmp	r5, r0
 2398 065e 04D2     		bcs	.L245
 677:bluetooth_rxtx.c **** 					final_byte |= 0b10000000;
 2399              		.loc 1 677 0 discriminator 3
 2400 0660 5208     		lsrs	r2, r2, #1
 2401              	.LVL312:
 678:bluetooth_rxtx.c **** 				}
 2402              		.loc 1 678 0 discriminator 3
 2403 0662 42F08002 		orr	r2, r2, #128
 2404              	.LVL313:
 2405 0666 0131     		adds	r1, r1, #1
 2406              	.LVL314:
 2407 0668 F7E7     		b	.L184
 2408              	.LVL315:
 2409              	.L245:
 680:bluetooth_rxtx.c **** 			}
 2410              		.loc 1 680 0
 2411 066a 1349     		ldr	r1, .L250+8
ARM GAS  /tmp/ccDKg7Fp.s 			page 86


 2412              	.LVL316:
 2413 066c 0B44     		add	r3, r3, r1
 2414              	.LVL317:
 2415 066e 83F84220 		strb	r2, [r3, #66]
 2416              	.LVL318:
 2417              	.L185:
 2418 0672 124A     		ldr	r2, .L250+12
 2419              	.LVL319:
 2420              	.L187:
 2421 0674 0134     		adds	r4, r4, #1
 2422              	.LVL320:
 2423              	.LBE26:
 685:bluetooth_rxtx.c **** 
 2424              		.loc 1 685 0 discriminator 3
 2425 0676 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 2426 0678 A179     		ldrb	r1, [r4, #6]	@ zero_extendqisi2
 684:bluetooth_rxtx.c **** 				le.target[i] &= le.target_mask[i];
 2427              		.loc 1 684 0 discriminator 3
 2428 067a 9442     		cmp	r4, r2
 685:bluetooth_rxtx.c **** 
 2429              		.loc 1 685 0 discriminator 3
 2430 067c 03EA0103 		and	r3, r3, r1
 2431 0680 2370     		strb	r3, [r4]
 2432              	.LVL321:
 684:bluetooth_rxtx.c **** 				le.target[i] &= le.target_mask[i];
 2433              		.loc 1 684 0 discriminator 3
 2434 0682 F7D1     		bne	.L187
 2435              	.LVL322:
 2436              	.L215:
 687:bluetooth_rxtx.c **** 		}
 2437              		.loc 1 687 0
 2438 0684 0C4B     		ldr	r3, .L250+8
 2439 0686 0120     		movs	r0, #1
 2440 0688 9864     		str	r0, [r3, #72]
 2441 068a F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 2442              	.LVL323:
 2443              	.L156:
 2444              	.LBE25:
 693:bluetooth_rxtx.c **** 		break;
 2445              		.loc 1 693 0
 2446 068c 0C4B     		ldr	r3, .L250+16
 2447 068e 0120     		movs	r0, #1
 2448              	.LVL324:
 2449 0690 9862     		str	r0, [r3, #40]
 694:bluetooth_rxtx.c **** 
 2450              		.loc 1 694 0
 2451 0692 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 2452              	.LVL325:
 2453              	.L146:
 698:bluetooth_rxtx.c **** 		break;
 2454              		.loc 1 698 0
 2455 0694 0A78     		ldrb	r2, [r1]	@ zero_extendqisi2
 2456              	.LVL326:
 2457 0696 0A4B     		ldr	r3, .L250+16
 2458 0698 DA74     		strb	r2, [r3, #19]
 2459 069a 04E0     		b	.L212
 2460              	.LVL327:
ARM GAS  /tmp/ccDKg7Fp.s 			page 87


 2461              	.L147:
 707:bluetooth_rxtx.c **** 		ego_mode = request_params[0];
 2462              		.loc 1 707 0
 2463 069c 084B     		ldr	r3, .L250+16
 2464 069e 0D22     		movs	r2, #13
 2465              	.LVL328:
 2466 06a0 9A74     		strb	r2, [r3, #18]
 708:bluetooth_rxtx.c **** 		break;
 2467              		.loc 1 708 0
 2468 06a2 0A78     		ldrb	r2, [r1]	@ zero_extendqisi2
 2469 06a4 1A75     		strb	r2, [r3, #20]
 2470              	.LVL329:
 2471              	.L212:
 714:bluetooth_rxtx.c **** }
 2472              		.loc 1 714 0
 2473 06a6 0120     		movs	r0, #1
 709:bluetooth_rxtx.c **** 
 2474              		.loc 1 709 0
 2475 06a8 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 2476              	.LVL330:
 2477              	.L199:
 314:bluetooth_rxtx.c **** 		}
 2478              		.loc 1 314 0
 2479 06aa 0020     		movs	r0, #0
 715:bluetooth_rxtx.c **** 
 2480              		.loc 1 715 0
 2481 06ac F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 2482              	.LVL331:
 2483              	.L251:
 2484 06ae 00BF     		.align	2
 2485              	.L250:
 2486 06b0 3B000000 		.word	.LANCHOR1+59
 2487 06b4 42000000 		.word	.LANCHOR1+66
 2488 06b8 00000000 		.word	.LANCHOR1
 2489 06bc 40000000 		.word	.LANCHOR1+64
 2490 06c0 00000000 		.word	.LANCHOR0
 2491              		.cfi_endproc
 2492              	.LFE2:
 2494              		.section	.text.enqueue_with_ts,"ax",%progbits
 2495              		.align	1
 2496              		.global	enqueue_with_ts
 2497              		.thumb
 2498              		.thumb_func
 2500              	enqueue_with_ts:
 2501              	.LFB1:
 163:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 2502              		.loc 1 163 0
 2503              		.cfi_startproc
 2504              		@ args = 0, pretend = 0, frame = 0
 2505              		@ frame_needed = 0, uses_anonymous_args = 0
 2506              	.LVL332:
 2507 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 2508              		.cfi_def_cfa_offset 24
 2509              		.cfi_offset 4, -24
 2510              		.cfi_offset 5, -20
 2511              		.cfi_offset 6, -16
 2512              		.cfi_offset 7, -12
ARM GAS  /tmp/ccDKg7Fp.s 			page 88


 2513              		.cfi_offset 8, -8
 2514              		.cfi_offset 14, -4
 163:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 2515              		.loc 1 163 0
 2516 0004 0646     		mov	r6, r0
 2517 0006 0F46     		mov	r7, r1
 2518 0008 9046     		mov	r8, r2
 164:bluetooth_rxtx.c **** 
 2519              		.loc 1 164 0
 2520 000a FFF7FEFF 		bl	usb_enqueue
 2521              	.LVL333:
 2522 000e 0F4D     		ldr	r5, .L255
 167:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 2523              		.loc 1 167 0
 2524 0010 0446     		mov	r4, r0
 2525 0012 28B9     		cbnz	r0, .L253
 168:bluetooth_rxtx.c **** 		return 0;
 2526              		.loc 1 168 0
 2527 0014 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 2528 0016 43F00403 		orr	r3, r3, #4
 2529 001a 6B70     		strb	r3, [r5, #1]
 169:bluetooth_rxtx.c **** 	}
 2530              		.loc 1 169 0
 2531 001c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2532              	.LVL334:
 2533              	.L253:
 177:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2534              		.loc 1 177 0
 2535 0020 0B4B     		ldr	r3, .L255+4
 172:bluetooth_rxtx.c **** 
 2536              		.loc 1 172 0
 2537 0022 0670     		strb	r6, [r0]
 177:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2538              		.loc 1 177 0
 2539 0024 1B88     		ldrh	r3, [r3]
 174:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 2540              		.loc 1 174 0
 2541 0026 0026     		movs	r6, #0
 177:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2542              		.loc 1 177 0
 2543 0028 623B     		subs	r3, r3, #98
 174:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 2544              		.loc 1 174 0
 2545 002a C670     		strb	r6, [r0, #3]
 175:bluetooth_rxtx.c **** 
 2546              		.loc 1 175 0
 2547 002c C0F80480 		str	r8, [r0, #4]
 177:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2548              		.loc 1 177 0
 2549 0030 8370     		strb	r3, [r0, #2]
 178:bluetooth_rxtx.c **** 	f->rssi_count = 0;
 2550              		.loc 1 178 0
 2551 0032 8672     		strb	r6, [r0, #10]
 179:bluetooth_rxtx.c **** 
 2552              		.loc 1 179 0
 2553 0034 C672     		strb	r6, [r0, #11]
 181:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccDKg7Fp.s 			page 89


 2554              		.loc 1 181 0
 2555 0036 3946     		mov	r1, r7
 2556 0038 3222     		movs	r2, #50
 2557 003a 0E30     		adds	r0, r0, #14
 2558              	.LVL335:
 2559 003c FFF7FEFF 		bl	memcpy
 2560              	.LVL336:
 183:bluetooth_rxtx.c **** 	status = 0;
 2561              		.loc 1 183 0
 2562 0040 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 184:bluetooth_rxtx.c **** 
 2563              		.loc 1 184 0
 2564 0042 6E70     		strb	r6, [r5, #1]
 183:bluetooth_rxtx.c **** 	status = 0;
 2565              		.loc 1 183 0
 2566 0044 6370     		strb	r3, [r4, #1]
 186:bluetooth_rxtx.c **** }
 2567              		.loc 1 186 0
 2568 0046 0120     		movs	r0, #1
 187:bluetooth_rxtx.c **** 
 2569              		.loc 1 187 0
 2570 0048 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2571              	.LVL337:
 2572              	.L256:
 2573              		.align	2
 2574              	.L255:
 2575 004c 00000000 		.word	.LANCHOR0
 2576 0050 00000000 		.word	.LANCHOR1
 2577              		.cfi_endproc
 2578              	.LFE1:
 2580              		.section	.text.TIMER0_IRQHandler,"ax",%progbits
 2581              		.align	1
 2582              		.global	TIMER0_IRQHandler
 2583              		.thumb
 2584              		.thumb_func
 2586              	TIMER0_IRQHandler:
 2587              	.LFB3:
 719:bluetooth_rxtx.c **** 	if (T0IR & TIR_MR0_Interrupt) {
 2588              		.loc 1 719 0
 2589              		.cfi_startproc
 2590              		@ args = 0, pretend = 0, frame = 0
 2591              		@ frame_needed = 0, uses_anonymous_args = 0
 2592 0000 70B5     		push	{r4, r5, r6, lr}
 2593              		.cfi_def_cfa_offset 16
 2594              		.cfi_offset 4, -16
 2595              		.cfi_offset 5, -12
 2596              		.cfi_offset 6, -8
 2597              		.cfi_offset 14, -4
 720:bluetooth_rxtx.c **** 
 2598              		.loc 1 720 0
 2599 0002 4FF04023 		mov	r3, #1073758208
 2600 0006 1B68     		ldr	r3, [r3]
 2601 0008 DB07     		lsls	r3, r3, #31
 2602 000a 7DD5     		bpl	.L257
 2603              	.LBB27:
 722:bluetooth_rxtx.c **** 		clkn_offset = 0;
 2604              		.loc 1 722 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 90


 2605 000c 3F49     		ldr	r1, .L280
 2606 000e 404B     		ldr	r3, .L280+4
 2607 0010 0868     		ldr	r0, [r1]
 2608 0012 1A68     		ldr	r2, [r3]
 2609 0014 0244     		add	r2, r2, r0
 2610 0016 0132     		adds	r2, r2, #1
 2611 0018 1A60     		str	r2, [r3]
 723:bluetooth_rxtx.c **** 
 2612              		.loc 1 723 0
 2613 001a 0022     		movs	r2, #0
 2614 001c 0A60     		str	r2, [r1]
 730:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2615              		.loc 1 730 0
 2616 001e 3D49     		ldr	r1, .L280+8
 725:bluetooth_rxtx.c **** 
 2617              		.loc 1 725 0
 2618 0020 1868     		ldr	r0, [r3]
 2619 0022 3D4A     		ldr	r2, .L280+12
 730:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2620              		.loc 1 730 0
 2621 0024 8E7A     		ldrb	r6, [r1, #10]	@ zero_extendqisi2
 725:bluetooth_rxtx.c **** 
 2622              		.loc 1 725 0
 2623 0026 D469     		ldr	r4, [r2, #28]
 2624              	.LVL338:
 2625 0028 0D46     		mov	r5, r1
 730:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2626              		.loc 1 730 0
 2627 002a 16B1     		cbz	r6, .L259
 730:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2628              		.loc 1 730 0 is_stmt 0 discriminator 1
 2629 002c 8E7A     		ldrb	r6, [r1, #10]	@ zero_extendqisi2
 2630 002e 012E     		cmp	r6, #1
 2631 0030 05D1     		bne	.L260
 2632              	.L259:
 731:bluetooth_rxtx.c **** 				do_hop = 1;
 2633              		.loc 1 731 0 is_stmt 1
 2634 0032 1A68     		ldr	r2, [r3]
 2635 0034 5606     		lsls	r6, r2, #25
 2636 0036 35D1     		bne	.L261
 732:bluetooth_rxtx.c **** 		}
 2637              		.loc 1 732 0
 2638 0038 0122     		movs	r2, #1
 2639 003a EA72     		strb	r2, [r5, #11]
 2640 003c 32E0     		b	.L261
 2641              	.L260:
 735:bluetooth_rxtx.c **** 			if ((clkn & 0x1) == 0)
 2642              		.loc 1 735 0
 2643 003e 8D7A     		ldrb	r5, [r1, #10]	@ zero_extendqisi2
 2644 0040 022D     		cmp	r5, #2
 2645 0042 03D1     		bne	.L262
 736:bluetooth_rxtx.c **** 				do_hop = 1;
 2646              		.loc 1 736 0
 2647 0044 1A68     		ldr	r2, [r3]
 2648 0046 D407     		lsls	r4, r2, #31
 2649              	.LVL339:
 2650 0048 2CD4     		bmi	.L261
ARM GAS  /tmp/ccDKg7Fp.s 			page 91


 2651 004a 29E0     		b	.L278
 2652              	.LVL340:
 2653              	.L262:
 740:bluetooth_rxtx.c **** 			// Only hop if connected
 2654              		.loc 1 740 0
 2655 004c 8D7A     		ldrb	r5, [r1, #10]	@ zero_extendqisi2
 2656 004e 032D     		cmp	r5, #3
 2657 0050 1AD1     		bne	.L263
 742:bluetooth_rxtx.c **** 				--le.interval_timer;
 2658              		.loc 1 742 0
 2659 0052 157E     		ldrb	r5, [r2, #24]	@ zero_extendqisi2
 2660 0054 032D     		cmp	r5, #3
 2661 0056 25D1     		bne	.L261
 725:bluetooth_rxtx.c **** 
 2662              		.loc 1 725 0 discriminator 1
 2663 0058 001B     		subs	r0, r0, r4
 2664              	.LVL341:
 742:bluetooth_rxtx.c **** 				--le.interval_timer;
 2665              		.loc 1 742 0 discriminator 1
 2666 005a 8007     		lsls	r0, r0, #30
 2667 005c 22D1     		bne	.L261
 743:bluetooth_rxtx.c **** 				if (le.interval_timer == 0) {
 2668              		.loc 1 743 0
 2669 005e 108C     		ldrh	r0, [r2, #32]
 2670 0060 0138     		subs	r0, r0, #1
 2671 0062 80B2     		uxth	r0, r0
 2672 0064 1084     		strh	r0, [r2, #32]	@ movhi
 744:bluetooth_rxtx.c **** 					do_hop = 1;
 2673              		.loc 1 744 0
 2674 0066 108C     		ldrh	r0, [r2, #32]
 2675 0068 80B2     		uxth	r0, r0
 2676 006a 40B9     		cbnz	r0, .L264
 745:bluetooth_rxtx.c **** 					++le.conn_count;
 2677              		.loc 1 745 0
 2678 006c 0120     		movs	r0, #1
 2679 006e C872     		strb	r0, [r1, #11]
 746:bluetooth_rxtx.c **** 					le.interval_timer = le.conn_interval;
 2680              		.loc 1 746 0
 2681 0070 918C     		ldrh	r1, [r2, #36]
 2682 0072 0144     		add	r1, r1, r0
 2683 0074 89B2     		uxth	r1, r1
 2684 0076 9184     		strh	r1, [r2, #36]	@ movhi
 747:bluetooth_rxtx.c **** 				} else {
 2685              		.loc 1 747 0
 2686 0078 518C     		ldrh	r1, [r2, #34]
 2687 007a 1184     		strh	r1, [r2, #32]	@ movhi
 2688 007c 12E0     		b	.L261
 2689              	.L264:
 749:bluetooth_rxtx.c **** 				}
 2690              		.loc 1 749 0
 2691 007e 274A     		ldr	r2, .L280+16
 2692 0080 4FF48071 		mov	r1, #256
 2693 0084 1160     		str	r1, [r2]
 2694 0086 0DE0     		b	.L261
 2695              	.LVL342:
 2696              	.L263:
 753:bluetooth_rxtx.c **** 			if( (last_hop + hop_timeout) == clkn ) {
ARM GAS  /tmp/ccDKg7Fp.s 			page 92


 2697              		.loc 1 753 0
 2698 0088 887A     		ldrb	r0, [r1, #10]	@ zero_extendqisi2
 2699              	.LVL343:
 2700 008a 0528     		cmp	r0, #5
 2701 008c 0AD1     		bne	.L261
 754:bluetooth_rxtx.c **** 				do_hop = 1;
 2702              		.loc 1 754 0
 2703 008e 2448     		ldr	r0, .L280+20
 2704 0090 0068     		ldr	r0, [r0]
 2705 0092 B2F85020 		ldrh	r2, [r2, #80]
 2706 0096 1C68     		ldr	r4, [r3]
 2707 0098 92B2     		uxth	r2, r2
 2708 009a 0244     		add	r2, r2, r0
 2709 009c A242     		cmp	r2, r4
 2710 009e 01D1     		bne	.L261
 2711              	.L278:
 755:bluetooth_rxtx.c **** 			}
 2712              		.loc 1 755 0
 2713 00a0 0122     		movs	r2, #1
 2714 00a2 CA72     		strb	r2, [r1, #11]
 2715              	.L261:
 760:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
 2716              		.loc 1 760 0
 2717 00a4 1F49     		ldr	r1, .L280+24
 2718 00a6 204A     		ldr	r2, .L280+28
 2719 00a8 0868     		ldr	r0, [r1]
 2720 00aa C0B1     		cbz	r0, .L265
 760:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
 2721              		.loc 1 760 0 is_stmt 0 discriminator 1
 2722 00ac 1088     		ldrh	r0, [r2]
 2723 00ae 80B2     		uxth	r0, r0
 2724 00b0 A8B9     		cbnz	r0, .L265
 761:bluetooth_rxtx.c **** 
 2725              		.loc 1 761 0 is_stmt 1
 2726 00b2 1C68     		ldr	r4, [r3]
 2727 00b4 0868     		ldr	r0, [r1]
 2728 00b6 8442     		cmp	r4, r0
 2729 00b8 11D3     		bcc	.L265
 764:bluetooth_rxtx.c **** 					clk100ns_offset = 1;
 2730              		.loc 1 764 0
 2731 00ba 1C48     		ldr	r0, .L280+32
 2732 00bc 0088     		ldrh	r0, [r0]
 2733 00be 00B2     		sxth	r0, r0
 2734 00c0 0028     		cmp	r0, #0
 770:bluetooth_rxtx.c **** 				}
 2735              		.loc 1 770 0
 2736 00c2 B4BF     		ite	lt
 2737 00c4 41F66900 		movwlt	r0, #6249
 765:bluetooth_rxtx.c **** 				}
 2738              		.loc 1 765 0
 2739 00c8 0120     		movge	r0, #1
 770:bluetooth_rxtx.c **** 				}
 2740              		.loc 1 770 0
 2741 00ca 1080     		strh	r0, [r2]	@ movhi
 772:bluetooth_rxtx.c **** 				clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 2742              		.loc 1 772 0
 2743 00cc 1C68     		ldr	r4, [r3]
ARM GAS  /tmp/ccDKg7Fp.s 			page 93


 2744 00ce 1848     		ldr	r0, .L280+36
 2745 00d0 0460     		str	r4, [r0]
 773:bluetooth_rxtx.c **** 			}
 2746              		.loc 1 773 0
 2747 00d2 0468     		ldr	r4, [r0]
 2748 00d4 1748     		ldr	r0, .L280+40
 2749 00d6 0088     		ldrh	r0, [r0]
 2750 00d8 80B2     		uxth	r0, r0
 2751 00da 2044     		add	r0, r0, r4
 2752 00dc 0860     		str	r0, [r1]
 2753              	.L265:
 778:bluetooth_rxtx.c **** 			clkn += 2;
 2754              		.loc 1 778 0
 2755 00de 40F63440 		movw	r0, #3124
 2756 00e2 1188     		ldrh	r1, [r2]
 2757 00e4 89B2     		uxth	r1, r1
 2758 00e6 8142     		cmp	r1, r0
 779:bluetooth_rxtx.c **** 
 2759              		.loc 1 779 0
 2760 00e8 82BF     		ittt	hi
 2761 00ea 1968     		ldrhi	r1, [r3]
 2762 00ec 0231     		addhi	r1, r1, #2
 2763 00ee 1960     		strhi	r1, [r3]
 781:bluetooth_rxtx.c **** 		clk100ns_offset = 0;
 2764              		.loc 1 781 0
 2765 00f0 1388     		ldrh	r3, [r2]
 2766 00f2 1149     		ldr	r1, .L280+44
 2767 00f4 9BB2     		uxth	r3, r3
 2768 00f6 03F63443 		addw	r3, r3, #3124
 2769 00fa 0B60     		str	r3, [r1]
 782:bluetooth_rxtx.c **** 
 2770              		.loc 1 782 0
 2771 00fc 0023     		movs	r3, #0
 2772 00fe 1380     		strh	r3, [r2]	@ movhi
 785:bluetooth_rxtx.c **** 	}
 2773              		.loc 1 785 0
 2774 0100 0122     		movs	r2, #1
 2775 0102 4FF04023 		mov	r3, #1073758208
 2776 0106 1A60     		str	r2, [r3]
 2777              	.L257:
 2778 0108 70BD     		pop	{r4, r5, r6, pc}
 2779              	.L281:
 2780 010a 00BF     		.align	2
 2781              	.L280:
 2782 010c 00000000 		.word	clkn_offset
 2783 0110 00000000 		.word	clkn
 2784 0114 00000000 		.word	.LANCHOR0
 2785 0118 00000000 		.word	.LANCHOR1
 2786 011c 3CC00920 		.word	537509948
 2787 0120 00000000 		.word	last_hop
 2788 0124 00000000 		.word	clkn_next_drift_fix
 2789 0128 00000000 		.word	clk100ns_offset
 2790 012c 00000000 		.word	clk_drift_ppm
 2791 0130 00000000 		.word	clkn_last_drift_fix
 2792 0134 00000000 		.word	clk_drift_correction
 2793 0138 18400040 		.word	1073758232
 2794              	.LBE27:
ARM GAS  /tmp/ccDKg7Fp.s 			page 94


 2795              		.cfi_endproc
 2796              	.LFE3:
 2798              		.section	.text.EINT3_IRQHandler,"ax",%progbits
 2799              		.align	1
 2800              		.global	EINT3_IRQHandler
 2801              		.thumb
 2802              		.thumb_func
 2804              	EINT3_IRQHandler:
 2805              	.LFB4:
 792:bluetooth_rxtx.c **** 	/* TODO - check specific source of shared interrupt */
 2806              		.loc 1 792 0
 2807              		.cfi_startproc
 2808              		@ args = 0, pretend = 0, frame = 0
 2809              		@ frame_needed = 0, uses_anonymous_args = 0
 2810              		@ link register save eliminated.
 794:bluetooth_rxtx.c **** 	DIO_SSEL_CLR;           // enable SPI
 2811              		.loc 1 794 0
 2812 0000 084B     		ldr	r3, .L284
 2813 0002 0422     		movs	r2, #4
 2814 0004 1A60     		str	r2, [r3]
 795:bluetooth_rxtx.c **** 	cs_trigger  = 1;        // signal trigger
 2815              		.loc 1 795 0
 2816 0006 084B     		ldr	r3, .L284+4
 2817 0008 4FF08052 		mov	r2, #268435456
 2818 000c 1A60     		str	r2, [r3]
 796:bluetooth_rxtx.c **** 	if (hop_mode == HOP_BLUETOOTH)
 2819              		.loc 1 796 0
 2820 000e 074B     		ldr	r3, .L284+8
 2821 0010 0122     		movs	r2, #1
 2822 0012 1A70     		strb	r2, [r3]
 797:bluetooth_rxtx.c **** 		dma_discard = 0;
 2823              		.loc 1 797 0
 2824 0014 064B     		ldr	r3, .L284+12
 2825 0016 9A7A     		ldrb	r2, [r3, #10]	@ zero_extendqisi2
 2826 0018 022A     		cmp	r2, #2
 798:bluetooth_rxtx.c **** 
 2827              		.loc 1 798 0
 2828 001a 04BF     		itt	eq
 2829 001c 0022     		moveq	r2, #0
 2830 001e 1A74     		strbeq	r2, [r3, #16]
 2831 0020 7047     		bx	lr
 2832              	.L285:
 2833 0022 00BF     		.align	2
 2834              	.L284:
 2835 0024 AC800240 		.word	1073905836
 2836 0028 9CC00920 		.word	537510044
 2837 002c 00000000 		.word	cs_trigger
 2838 0030 00000000 		.word	.LANCHOR0
 2839              		.cfi_endproc
 2840              	.LFE4:
 2842              		.section	.text.legacy_DMA_IRQHandler,"ax",%progbits
 2843              		.align	1
 2844              		.global	legacy_DMA_IRQHandler
 2845              		.thumb
 2846              		.thumb_func
 2848              	legacy_DMA_IRQHandler:
 2849              	.LFB7:
ARM GAS  /tmp/ccDKg7Fp.s 			page 95


 847:bluetooth_rxtx.c **** 	if ( mode == MODE_RX_SYMBOLS
 2850              		.loc 1 847 0
 2851              		.cfi_startproc
 2852              		@ args = 0, pretend = 0, frame = 0
 2853              		@ frame_needed = 0, uses_anonymous_args = 0
 2854 0000 10B5     		push	{r4, lr}
 2855              		.cfi_def_cfa_offset 8
 2856              		.cfi_offset 4, -8
 2857              		.cfi_offset 14, -4
 848:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW
 2858              		.loc 1 848 0
 2859 0002 284B     		ldr	r3, .L322
 2860 0004 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2861 0006 012A     		cmp	r2, #1
 2862 0008 11D0     		beq	.L287
 849:bluetooth_rxtx.c **** 	   || mode == MODE_SPECAN
 2863              		.loc 1 849 0
 2864 000a 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2865 000c 082A     		cmp	r2, #8
 2866 000e 0ED0     		beq	.L287
 850:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW_LE
 2867              		.loc 1 850 0
 2868 0010 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2869 0012 042A     		cmp	r2, #4
 2870 0014 0BD0     		beq	.L287
 851:bluetooth_rxtx.c **** 	   || mode == MODE_BT_PROMISC_LE
 2871              		.loc 1 851 0
 2872 0016 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2873 0018 092A     		cmp	r2, #9
 2874 001a 08D0     		beq	.L287
 852:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE
 2875              		.loc 1 852 0
 2876 001c 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2877 001e 0A2A     		cmp	r2, #10
 2878 0020 05D0     		beq	.L287
 853:bluetooth_rxtx.c **** 	   || mode == MODE_RX_GENERIC)
 2879              		.loc 1 853 0
 2880 0022 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2881 0024 0C2A     		cmp	r2, #12
 2882 0026 02D0     		beq	.L287
 854:bluetooth_rxtx.c **** 	{
 2883              		.loc 1 854 0
 2884 0028 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2885 002a 0F2A     		cmp	r2, #15
 2886 002c 39D1     		bne	.L286
 2887              	.L287:
 857:bluetooth_rxtx.c **** 			if (DMACIntTCStat & (1 << 0)) {
 2888              		.loc 1 857 0
 2889 002e 1E4A     		ldr	r2, .L322+4
 2890 0030 1268     		ldr	r2, [r2]
 2891 0032 D107     		lsls	r1, r2, #31
 2892 0034 35D5     		bpl	.L286
 2893              	.LBB31:
 858:bluetooth_rxtx.c **** 				DMACIntTCClear = (1 << 0);
 2894              		.loc 1 858 0
 2895 0036 1D4A     		ldr	r2, .L322+8
 2896 0038 1268     		ldr	r2, [r2]
ARM GAS  /tmp/ccDKg7Fp.s 			page 96


 2897 003a D207     		lsls	r2, r2, #31
 2898 003c 26D5     		bpl	.L290
 2899              	.LBB32:
 864:bluetooth_rxtx.c **** 				idle_buf_clkn_high = (clkn >> 20) & 0xff;
 2900              		.loc 1 864 0
 2901 003e 40F63544 		movw	r4, #3125
 859:bluetooth_rxtx.c **** 
 2902              		.loc 1 859 0
 2903 0042 1B4A     		ldr	r2, .L322+12
 2904 0044 0121     		movs	r1, #1
 2905 0046 1160     		str	r1, [r2]
 861:bluetooth_rxtx.c **** 					DIO_SSEL_SET;
 2906              		.loc 1 861 0
 2907 0048 9A7A     		ldrb	r2, [r3, #10]	@ zero_extendqisi2
 864:bluetooth_rxtx.c **** 				idle_buf_clkn_high = (clkn >> 20) & 0xff;
 2908              		.loc 1 864 0
 2909 004a 1A48     		ldr	r0, .L322+16
 861:bluetooth_rxtx.c **** 					DIO_SSEL_SET;
 2910              		.loc 1 861 0
 2911 004c 022A     		cmp	r2, #2
 862:bluetooth_rxtx.c **** 
 2912              		.loc 1 862 0
 2913 004e 02BF     		ittt	eq
 2914 0050 194A     		ldreq	r2, .L322+20
 2915 0052 4FF08051 		moveq	r1, #268435456
 2916 0056 1160     		streq	r1, [r2]
 864:bluetooth_rxtx.c **** 				idle_buf_clkn_high = (clkn >> 20) & 0xff;
 2917              		.loc 1 864 0
 2918 0058 184A     		ldr	r2, .L322+24
 2919 005a 0168     		ldr	r1, [r0]
 2920 005c 1268     		ldr	r2, [r2]
 2921 005e C1F31301 		ubfx	r1, r1, #0, #20
 2922 0062 04FB0122 		mla	r2, r4, r1, r2
 2923 0066 5A60     		str	r2, [r3, #4]
 865:bluetooth_rxtx.c **** 				idle_buf_channel   = channel;
 2924              		.loc 1 865 0
 2925 0068 0268     		ldr	r2, [r0]
 2926 006a C2F30752 		ubfx	r2, r2, #20, #8
 2927 006e 9A70     		strb	r2, [r3, #2]
 866:bluetooth_rxtx.c **** 
 2928              		.loc 1 866 0
 2929 0070 134A     		ldr	r2, .L322+28
 2930 0072 1288     		ldrh	r2, [r2]
 2931 0074 92B2     		uxth	r2, r2
 2932 0076 1A81     		strh	r2, [r3, #8]	@ movhi
 869:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 2933              		.loc 1 869 0
 2934 0078 124A     		ldr	r2, .L322+32
 870:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 2935              		.loc 1 870 0
 2936 007a 134B     		ldr	r3, .L322+36
 869:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 2937              		.loc 1 869 0
 2938 007c 1168     		ldr	r1, [r2]
 2939              	.LVL344:
 870:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 2940              		.loc 1 870 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 97


 2941 007e 1868     		ldr	r0, [r3]
 2942 0080 1060     		str	r0, [r2]
 873:bluetooth_rxtx.c **** 			}
 2943              		.loc 1 873 0
 2944 0082 124A     		ldr	r2, .L322+40
 871:bluetooth_rxtx.c **** 
 2945              		.loc 1 871 0
 2946 0084 1960     		str	r1, [r3]
 873:bluetooth_rxtx.c **** 			}
 2947              		.loc 1 873 0
 2948 0086 1368     		ldr	r3, [r2]
 2949 0088 0133     		adds	r3, r3, #1
 2950 008a 1360     		str	r3, [r2]
 2951              	.LVL345:
 2952              	.L290:
 2953              	.LBE32:
 875:bluetooth_rxtx.c **** 				DMACIntErrClr = (1 << 0);
 2954              		.loc 1 875 0
 2955 008c 104B     		ldr	r3, .L322+44
 2956 008e 1B68     		ldr	r3, [r3]
 2957 0090 DB07     		lsls	r3, r3, #31
 2958 0092 06D5     		bpl	.L286
 876:bluetooth_rxtx.c **** 				++rx_err;
 2959              		.loc 1 876 0
 2960 0094 0F4B     		ldr	r3, .L322+48
 2961 0096 0122     		movs	r2, #1
 2962 0098 1A60     		str	r2, [r3]
 877:bluetooth_rxtx.c **** 			}
 2963              		.loc 1 877 0
 2964 009a 0F4A     		ldr	r2, .L322+52
 2965 009c 1368     		ldr	r3, [r2]
 2966 009e 0133     		adds	r3, r3, #1
 2967 00a0 1360     		str	r3, [r2]
 2968              	.L286:
 2969 00a2 10BD     		pop	{r4, pc}
 2970              	.L323:
 2971              		.align	2
 2972              	.L322:
 2973 00a4 00000000 		.word	.LANCHOR0
 2974 00a8 00400050 		.word	1342193664
 2975 00ac 04400050 		.word	1342193668
 2976 00b0 08400050 		.word	1342193672
 2977 00b4 00000000 		.word	clkn
 2978 00b8 98C00920 		.word	537510040
 2979 00bc 08400040 		.word	1073758216
 2980 00c0 00000000 		.word	.LANCHOR1
 2981 00c4 00000000 		.word	active_rxbuf
 2982 00c8 00000000 		.word	idle_rxbuf
 2983 00cc 00000000 		.word	rx_tc
 2984 00d0 0C400050 		.word	1342193676
 2985 00d4 10400050 		.word	1342193680
 2986 00d8 00000000 		.word	rx_err
 2987              	.LBE31:
 2988              		.cfi_endproc
 2989              	.LFE7:
 2991              		.section	.text.DMA_IRQHandler,"ax",%progbits
 2992              		.align	1
ARM GAS  /tmp/ccDKg7Fp.s 			page 98


 2993              		.global	DMA_IRQHandler
 2994              		.thumb
 2995              		.thumb_func
 2997              	DMA_IRQHandler:
 2998              	.LFB6:
 823:bluetooth_rxtx.c **** 	if (mode == MODE_BT_FOLLOW_LE)
 2999              		.loc 1 823 0
 3000              		.cfi_startproc
 3001              		@ args = 0, pretend = 0, frame = 0
 3002              		@ frame_needed = 0, uses_anonymous_args = 0
 3003 0000 08B5     		push	{r3, lr}
 3004              		.cfi_def_cfa_offset 8
 3005              		.cfi_offset 3, -8
 3006              		.cfi_offset 14, -4
 824:bluetooth_rxtx.c **** 		le_DMA_IRQHandler();
 3007              		.loc 1 824 0
 3008 0002 124B     		ldr	r3, .L339
 3009 0004 5B7C     		ldrb	r3, [r3, #17]	@ zero_extendqisi2
 3010 0006 092B     		cmp	r3, #9
 3011 0008 02D1     		bne	.L325
 825:bluetooth_rxtx.c **** 	else
 3012              		.loc 1 825 0
 3013 000a FFF7FEFF 		bl	le_DMA_IRQHandler
 3014              	.LVL346:
 3015 000e 01E0     		b	.L326
 3016              	.L325:
 827:bluetooth_rxtx.c **** 
 3017              		.loc 1 827 0
 3018 0010 FFF7FEFF 		bl	legacy_DMA_IRQHandler
 3019              	.LVL347:
 3020              	.L326:
 830:bluetooth_rxtx.c **** 		// TC -- DMA completed, unset flag so another printf can occur
 3021              		.loc 1 830 0
 3022 0014 0E4B     		ldr	r3, .L339+4
 3023 0016 1B68     		ldr	r3, [r3]
 3024 0018 1906     		lsls	r1, r3, #24
 3025 001a 15D5     		bpl	.L324
 832:bluetooth_rxtx.c **** 			DMACIntTCClear = (1 << 7);
 3026              		.loc 1 832 0
 3027 001c 0D4B     		ldr	r3, .L339+8
 3028 001e 1B68     		ldr	r3, [r3]
 3029 0020 1A06     		lsls	r2, r3, #24
 833:bluetooth_rxtx.c **** 			debug_dma_active = 0;
 3030              		.loc 1 833 0
 3031 0022 41BF     		itttt	mi
 3032 0024 0C4B     		ldrmi	r3, .L339+12
 3033 0026 8022     		movmi	r2, #128
 3034 0028 1A60     		strmi	r2, [r3]
 834:bluetooth_rxtx.c **** 		}
 3035              		.loc 1 834 0
 3036 002a 0C4B     		ldrmi	r3, .L339+16
 3037 002c 44BF     		itt	mi
 3038 002e 0022     		movmi	r2, #0
 3039 0030 1A60     		strmi	r2, [r3]
 837:bluetooth_rxtx.c **** 			DMACIntErrClr = (1 << 7);
 3040              		.loc 1 837 0
 3041 0032 0B4B     		ldr	r3, .L339+20
ARM GAS  /tmp/ccDKg7Fp.s 			page 99


 3042 0034 1B68     		ldr	r3, [r3]
 3043 0036 1B06     		lsls	r3, r3, #24
 3044 0038 06D5     		bpl	.L324
 838:bluetooth_rxtx.c **** 			// FIXME do something better here
 3045              		.loc 1 838 0
 3046 003a 0A4B     		ldr	r3, .L339+24
 3047 003c 8022     		movs	r2, #128
 3048 003e 1A60     		str	r2, [r3]
 840:bluetooth_rxtx.c **** 			while (1) { }
 3049              		.loc 1 840 0
 3050 0040 094B     		ldr	r3, .L339+28
 3051 0042 0222     		movs	r2, #2
 3052 0044 1A60     		str	r2, [r3]
 3053              	.L329:
 841:bluetooth_rxtx.c **** 		}
 3054              		.loc 1 841 0 discriminator 1
 3055 0046 FEE7     		b	.L329
 3056              	.L324:
 3057 0048 08BD     		pop	{r3, pc}
 3058              	.L340:
 3059 004a 00BF     		.align	2
 3060              	.L339:
 3061 004c 00000000 		.word	.LANCHOR0
 3062 0050 00400050 		.word	1342193664
 3063 0054 04400050 		.word	1342193668
 3064 0058 08400050 		.word	1342193672
 3065 005c 00000000 		.word	debug_dma_active
 3066 0060 0C400050 		.word	1342193676
 3067 0064 10400050 		.word	1342193680
 3068 0068 38C00920 		.word	537509944
 3069              		.cfi_endproc
 3070              	.LFE6:
 3072              		.section	.text.le_transmit,"ax",%progbits
 3073              		.align	1
 3074              		.global	le_transmit
 3075              		.thumb
 3076              		.thumb_func
 3078              	le_transmit:
 3079              	.LFB12:
1103:bluetooth_rxtx.c **** 	unsigned i, j;
 3080              		.loc 1 1103 0
 3081              		.cfi_startproc
 3082              		@ args = 0, pretend = 0, frame = 64
 3083              		@ frame_needed = 0, uses_anonymous_args = 0
 3084              	.LVL348:
 3085 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 3086              		.cfi_def_cfa_offset 32
 3087              		.cfi_offset 4, -32
 3088              		.cfi_offset 5, -28
 3089              		.cfi_offset 6, -24
 3090              		.cfi_offset 7, -20
 3091              		.cfi_offset 8, -16
 3092              		.cfi_offset 9, -12
 3093              		.cfi_offset 10, -8
 3094              		.cfi_offset 14, -4
 3095 0004 90B0     		sub	sp, sp, #64
 3096              		.cfi_def_cfa_offset 96
ARM GAS  /tmp/ccDKg7Fp.s 			page 100


1103:bluetooth_rxtx.c **** 	unsigned i, j;
 3097              		.loc 1 1103 0
 3098 0006 0546     		mov	r5, r0
 3099 0008 0C46     		mov	r4, r1
 3100              	.LVL349:
 3101 000a 9146     		mov	r9, r2
 3102 000c 0DF10307 		add	r7, sp, #3
 3103 0010 0DF1FF32 		add	r2, sp, #-1
 3104              	.LVL350:
 3105              	.L343:
1113:bluetooth_rxtx.c **** 		aa >>= 8;
 3106              		.loc 1 1113 0
 3107 0014 E8B2     		uxtb	r0, r5
 3108              	.LVL351:
 3109 0016 0132     		adds	r2, r2, #1
 3110              	.LVL352:
1114:bluetooth_rxtx.c **** 		txbuf[i] = 0;
 3111              		.loc 1 1114 0
 3112 0018 2D0A     		lsrs	r5, r5, #8
 3113              	.LVL353:
 3114 001a 0721     		movs	r1, #7
 3115 001c 0023     		movs	r3, #0
 3116              	.LVL354:
 3117              	.L342:
1117:bluetooth_rxtx.c **** 			byte >>= 1;
 3118              		.loc 1 1117 0 discriminator 3
 3119 001e 00F00106 		and	r6, r0, #1
 3120 0022 8E40     		lsls	r6, r6, r1
 3121 0024 3343     		orrs	r3, r3, r6
1116:bluetooth_rxtx.c **** 			txbuf[i] |= (byte & 1) << (7 - j);
 3122              		.loc 1 1116 0 discriminator 3
 3123 0026 11F1FF31 		adds	r1, r1, #-1
 3124              	.LVL355:
1117:bluetooth_rxtx.c **** 			byte >>= 1;
 3125              		.loc 1 1117 0 discriminator 3
 3126 002a DBB2     		uxtb	r3, r3
1118:bluetooth_rxtx.c **** 		}
 3127              		.loc 1 1118 0 discriminator 3
 3128 002c 4FEA5000 		lsr	r0, r0, #1
 3129              	.LVL356:
1116:bluetooth_rxtx.c **** 			txbuf[i] |= (byte & 1) << (7 - j);
 3130              		.loc 1 1116 0 discriminator 3
 3131 0030 F5D2     		bcs	.L342
1112:bluetooth_rxtx.c **** 		byte = aa & 0xff;
 3132              		.loc 1 1112 0 discriminator 2
 3133 0032 BA42     		cmp	r2, r7
 3134 0034 1370     		strb	r3, [r2]
 3135              	.LVL357:
 3136 0036 EDD1     		bne	.L343
1123:bluetooth_rxtx.c **** 	for (i = 0; i < len; ++i) {
 3137              		.loc 1 1123 0
 3138 0038 594E     		ldr	r6, .L371
 3139 003a 5A4F     		ldr	r7, .L371+4
 3140 003c 3088     		ldrh	r0, [r6]
 3141              	.LVL358:
 3142 003e 0DF1040A 		add	r10, sp, #4
 3143 0042 80B2     		uxth	r0, r0
ARM GAS  /tmp/ccDKg7Fp.s 			page 101


 3144 0044 FFF7FEFF 		bl	btle_channel_index
 3145              	.LVL359:
1124:bluetooth_rxtx.c **** 		byte = data[i];
 3146              		.loc 1 1124 0
 3147 0048 CC46     		mov	ip, r9
1123:bluetooth_rxtx.c **** 	for (i = 0; i < len; ++i) {
 3148              		.loc 1 1123 0
 3149 004a 3B5C     		ldrb	r3, [r7, r0]	@ zero_extendqisi2
 3150              	.LVL360:
 3151              	.L344:
 3152 004c C9EB0C02 		rsb	r2, r9, ip
1124:bluetooth_rxtx.c **** 		byte = data[i];
 3153              		.loc 1 1124 0 discriminator 1
 3154 0050 A242     		cmp	r2, r4
 3155 0052 21D2     		bcs	.L370
1125:bluetooth_rxtx.c **** 		txbuf[i+4] = 0;
 3156              		.loc 1 1125 0
 3157 0054 1CF8012B 		ldrb	r2, [ip], #1	@ zero_extendqisi2
 3158              	.LVL361:
 3159 0058 4FF0070E 		mov	lr, #7
 3160 005c 4FF00008 		mov	r8, #0
 3161              	.LVL362:
 3162              	.L345:
1128:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 3163              		.loc 1 1128 0 discriminator 3
 3164 0060 F818     		adds	r0, r7, r3
 3165 0062 90F82800 		ldrb	r0, [r0, #40]	@ zero_extendqisi2
 3166 0066 02F00101 		and	r1, r2, #1
 3167 006a 4140     		eors	r1, r1, r0
 3168              	.LVL363:
1129:bluetooth_rxtx.c **** 			byte >>= 1;
 3169              		.loc 1 1129 0 discriminator 3
 3170 006c 0133     		adds	r3, r3, #1
 3171              	.LVL364:
 3172 006e 7F20     		movs	r0, #127
 3173 0070 B3FBF0F0 		udiv	r0, r3, r0
1131:bluetooth_rxtx.c **** 		}
 3174              		.loc 1 1131 0 discriminator 3
 3175 0074 01FA0EF1 		lsl	r1, r1, lr
 3176              	.LVL365:
1129:bluetooth_rxtx.c **** 			byte >>= 1;
 3177              		.loc 1 1129 0 discriminator 3
 3178 0078 C0EBC010 		rsb	r0, r0, r0, lsl #7
1131:bluetooth_rxtx.c **** 		}
 3179              		.loc 1 1131 0 discriminator 3
 3180 007c 41EA0808 		orr	r8, r1, r8
1127:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
 3181              		.loc 1 1127 0 discriminator 3
 3182 0080 1EF1FF3E 		adds	lr, lr, #-1
 3183              	.LVL366:
1129:bluetooth_rxtx.c **** 			byte >>= 1;
 3184              		.loc 1 1129 0 discriminator 3
 3185 0084 A3EB0003 		sub	r3, r3, r0
 3186              	.LVL367:
1130:bluetooth_rxtx.c **** 			txbuf[i+4] |= bit << (7 - j);
 3187              		.loc 1 1130 0 discriminator 3
 3188 0088 4FEA5202 		lsr	r2, r2, #1
ARM GAS  /tmp/ccDKg7Fp.s 			page 102


 3189              	.LVL368:
1131:bluetooth_rxtx.c **** 		}
 3190              		.loc 1 1131 0 discriminator 3
 3191 008c 5FFA88F8 		uxtb	r8, r8
 3192              	.LVL369:
1127:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
 3193              		.loc 1 1127 0 discriminator 3
 3194 0090 E6D2     		bcs	.L345
 3195 0092 0AF8018B 		strb	r8, [r10], #1
 3196 0096 D9E7     		b	.L344
 3197              	.LVL370:
 3198              	.L370:
1138:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 3199              		.loc 1 1138 0
 3200 0098 0D20     		movs	r0, #13
 3201 009a 47F6FF71 		movw	r1, #32767
 3202 009e FFF7FEFF 		bl	cc2400_set
 3203              	.LVL371:
1139:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
 3204              		.loc 1 1139 0
 3205 00a2 1220     		movs	r0, #18
 3206 00a4 42F62231 		movw	r1, #11042
 3207 00a8 FFF7FEFF 		bl	cc2400_set
 3208              	.LVL372:
1140:bluetooth_rxtx.c **** 
 3209              		.loc 1 1140 0
 3210 00ac 1420     		movs	r0, #20
 3211 00ae 41F24B31 		movw	r1, #4939
 3212 00b2 FFF7FEFF 		bl	cc2400_set
 3213              	.LVL373:
1142:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
 3214              		.loc 1 1142 0
 3215 00b6 2020     		movs	r0, #32
 3216 00b8 40F60141 		movw	r1, #3073
 3217 00bc FFF7FEFF 		bl	cc2400_set
 3218              	.LVL374:
1150:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 3219              		.loc 1 1150 0
 3220 00c0 3188     		ldrh	r1, [r6]
 3221 00c2 0220     		movs	r0, #2
 3222 00c4 89B2     		uxth	r1, r1
 3223 00c6 FFF7FEFF 		bl	cc2400_set
 3224              	.LVL375:
1151:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
 3225              		.loc 1 1151 0
 3226 00ca 0520     		movs	r0, #5
 3227 00cc 0B21     		movs	r1, #11
 3228 00ce FFF7FEFF 		bl	cc2400_set
 3229              	.LVL376:
1152:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
 3230              		.loc 1 1152 0
 3231 00d2 0320     		movs	r0, #3
 3232 00d4 4021     		movs	r1, #64
 3233 00d6 FFF7FEFF 		bl	cc2400_set
 3234              	.LVL377:
1153:bluetooth_rxtx.c **** 
 3235              		.loc 1 1153 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 103


 3236 00da 1421     		movs	r1, #20
 3237 00dc 2320     		movs	r0, #35
 3238 00de FFF7FEFF 		bl	cc2400_set
 3239              	.LVL378:
1156:bluetooth_rxtx.c **** 		cc2400_set(SYNCH,   0xaaaa);
 3240              		.loc 1 1156 0
 3241 00e2 ED07     		lsls	r5, r5, #31
 3242              	.LVL379:
1157:bluetooth_rxtx.c **** 	else
 3243              		.loc 1 1157 0
 3244 00e4 4CBF     		ite	mi
 3245 00e6 4AF6AA21 		movwmi	r1, #43690
1159:bluetooth_rxtx.c **** 
 3246              		.loc 1 1159 0
 3247 00ea 45F25551 		movwpl	r1, #21845
1157:bluetooth_rxtx.c **** 	else
 3248              		.loc 1 1157 0
 3249 00ee 2D20     		movs	r0, #45
1159:bluetooth_rxtx.c **** 
 3250              		.loc 1 1159 0
 3251 00f0 FFF7FEFF 		bl	cc2400_set
 3252              	.LVL380:
1162:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 3253              		.loc 1 1162 0
 3254 00f4 0820     		movs	r0, #8
 3255 00f6 FFF7FEFF 		bl	cc2400_get
 3256              	.LVL381:
1163:bluetooth_rxtx.c **** 
 3257              		.loc 1 1163 0
 3258 00fa C0F30801 		ubfx	r1, r0, #0, #9
1135:bluetooth_rxtx.c **** 
 3259              		.loc 1 1135 0
 3260 00fe 0434     		adds	r4, r4, #4
1162:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 3261              		.loc 1 1162 0
 3262 0100 0646     		mov	r6, r0
1163:bluetooth_rxtx.c **** 
 3263              		.loc 1 1163 0
 3264 0102 41F49C41 		orr	r1, r1, #19968
 3265 0106 0820     		movs	r0, #8
1135:bluetooth_rxtx.c **** 
 3266              		.loc 1 1135 0
 3267 0108 E4B2     		uxtb	r4, r4
 3268              	.LVL382:
1163:bluetooth_rxtx.c **** 
 3269              		.loc 1 1163 0
 3270 010a FFF7FEFF 		bl	cc2400_set
 3271              	.LVL383:
 3272              	.L349:
1165:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 3273              		.loc 1 1165 0 discriminator 1
 3274 010e FFF7FEFF 		bl	cc2400_status
 3275              	.LVL384:
 3276 0112 4006     		lsls	r0, r0, #25
 3277 0114 FBD5     		bpl	.L349
1166:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 3278              		.loc 1 1166 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 104


 3279 0116 6120     		movs	r0, #97
 3280 0118 FFF7FEFF 		bl	cc2400_strobe
 3281              	.LVL385:
 3282              	.L350:
1167:bluetooth_rxtx.c **** 	TXLED_SET;
 3283              		.loc 1 1167 0 discriminator 1
 3284 011c FFF7FEFF 		bl	cc2400_status
 3285              	.LVL386:
 3286 0120 4107     		lsls	r1, r0, #29
 3287 0122 FBD5     		bpl	.L350
1168:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 3288              		.loc 1 1168 0
 3289 0124 204B     		ldr	r3, .L371+8
 3290 0126 4FF48072 		mov	r2, #256
 3291 012a 1A60     		str	r2, [r3]
1170:bluetooth_rxtx.c **** #endif
 3292              		.loc 1 1170 0
 3293 012c 8022     		movs	r2, #128
 3294 012e 1A62     		str	r2, [r3, #32]
 3295              	.L351:
1172:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 3296              		.loc 1 1172 0 discriminator 1
 3297 0130 0E20     		movs	r0, #14
 3298 0132 FFF7FEFF 		bl	cc2400_get
 3299              	.LVL387:
 3300 0136 00F01F00 		and	r0, r0, #31
 3301 013a 0F28     		cmp	r0, #15
 3302 013c F8D1     		bne	.L351
1173:bluetooth_rxtx.c **** 
 3303              		.loc 1 1173 0
 3304 013e 6320     		movs	r0, #99
 3305 0140 FFF7FEFF 		bl	cc2400_strobe
 3306              	.LVL388:
1176:bluetooth_rxtx.c **** 		while (GIO6) ; // wait for the FIFO to drain (FIFO_FULL false)
 3307              		.loc 1 1176 0
 3308 0144 0025     		movs	r5, #0
 3309              	.LVL389:
 3310              	.L352:
1176:bluetooth_rxtx.c **** 		while (GIO6) ; // wait for the FIFO to drain (FIFO_FULL false)
 3311              		.loc 1 1176 0 is_stmt 0 discriminator 1
 3312 0146 A542     		cmp	r5, r4
 3313 0148 0ED2     		bcs	.L358
 3314              	.L359:
1177:bluetooth_rxtx.c **** 		tx_len = len - i;
 3315              		.loc 1 1177 0 is_stmt 1 discriminator 1
 3316 014a 184B     		ldr	r3, .L371+12
 3317 014c 1B68     		ldr	r3, [r3]
 3318 014e 5A07     		lsls	r2, r3, #29
 3319 0150 FBD4     		bmi	.L359
 3320              	.LVL390:
 3321 0152 601B     		subs	r0, r4, r5
 3322 0154 C0B2     		uxtb	r0, r0
 3323              	.LVL391:
1181:bluetooth_rxtx.c **** 	}
 3324              		.loc 1 1181 0
 3325 0156 1028     		cmp	r0, #16
 3326 0158 0DEB0501 		add	r1, sp, r5
ARM GAS  /tmp/ccDKg7Fp.s 			page 105


 3327 015c 28BF     		it	cs
 3328 015e 1020     		movcs	r0, #16
 3329              	.LVL392:
 3330 0160 FFF7FEFF 		bl	cc2400_fifo_write
 3331              	.LVL393:
1176:bluetooth_rxtx.c **** 		while (GIO6) ; // wait for the FIFO to drain (FIFO_FULL false)
 3332              		.loc 1 1176 0
 3333 0164 1035     		adds	r5, r5, #16
 3334              	.LVL394:
 3335 0166 EEE7     		b	.L352
 3336              	.LVL395:
 3337              	.L358:
1184:bluetooth_rxtx.c **** 	TXLED_CLR;
 3338              		.loc 1 1184 0 discriminator 1
 3339 0168 0E20     		movs	r0, #14
 3340 016a FFF7FEFF 		bl	cc2400_get
 3341              	.LVL396:
 3342 016e 00F01F00 		and	r0, r0, #31
 3343 0172 0F28     		cmp	r0, #15
 3344 0174 F8D1     		bne	.L358
1185:bluetooth_rxtx.c **** 
 3345              		.loc 1 1185 0
 3346 0176 0E4B     		ldr	r3, .L371+16
 3347 0178 4FF48072 		mov	r2, #256
 3348 017c 1A60     		str	r2, [r3]
1187:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 3349              		.loc 1 1187 0
 3350 017e 6420     		movs	r0, #100
 3351 0180 FFF7FEFF 		bl	cc2400_strobe
 3352              	.LVL397:
 3353              	.L355:
1188:bluetooth_rxtx.c **** 
 3354              		.loc 1 1188 0 discriminator 1
 3355 0184 FFF7FEFF 		bl	cc2400_status
 3356              	.LVL398:
 3357 0188 4307     		lsls	r3, r0, #29
 3358 018a FBD4     		bmi	.L355
1191:bluetooth_rxtx.c **** #endif
 3359              		.loc 1 1191 0
 3360 018c 094B     		ldr	r3, .L371+20
 3361 018e 8022     		movs	r2, #128
 3362 0190 1A60     		str	r2, [r3]
1195:bluetooth_rxtx.c **** }
 3363              		.loc 1 1195 0
 3364 0192 0820     		movs	r0, #8
 3365 0194 3146     		mov	r1, r6
 3366 0196 FFF7FEFF 		bl	cc2400_set
 3367              	.LVL399:
1196:bluetooth_rxtx.c **** 
 3368              		.loc 1 1196 0
 3369 019a 10B0     		add	sp, sp, #64
 3370              		.cfi_def_cfa_offset 32
 3371              		@ sp needed
 3372 019c BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 3373              	.LVL400:
 3374              	.L372:
 3375              		.align	2
ARM GAS  /tmp/ccDKg7Fp.s 			page 106


 3376              	.L371:
 3377 01a0 00000000 		.word	.LANCHOR1
 3378 01a4 00000000 		.word	.LANCHOR2
 3379 01a8 38C00920 		.word	537509944
 3380 01ac 54C00920 		.word	537509972
 3381 01b0 3CC00920 		.word	537509948
 3382 01b4 5CC00920 		.word	537509980
 3383              		.cfi_endproc
 3384              	.LFE12:
 3386              		.section	.text.le_jam,"ax",%progbits
 3387              		.align	1
 3388              		.global	le_jam
 3389              		.thumb
 3390              		.thumb_func
 3392              	le_jam:
 3393              	.LFB13:
1198:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 3394              		.loc 1 1198 0
 3395              		.cfi_startproc
 3396              		@ args = 0, pretend = 0, frame = 0
 3397              		@ frame_needed = 0, uses_anonymous_args = 0
 3398 0000 08B5     		push	{r3, lr}
 3399              		.cfi_def_cfa_offset 8
 3400              		.cfi_offset 3, -8
 3401              		.cfi_offset 14, -4
1200:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 3402              		.loc 1 1200 0
 3403 0002 0D20     		movs	r0, #13
 3404 0004 47F6FF71 		movw	r1, #32767
 3405 0008 FFF7FEFF 		bl	cc2400_set
 3406              	.LVL401:
1201:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x234b);    // PRNG, 1 MHz offset
 3407              		.loc 1 1201 0
 3408 000c 1220     		movs	r0, #18
 3409 000e 42F62231 		movw	r1, #11042
 3410 0012 FFF7FEFF 		bl	cc2400_set
 3411              	.LVL402:
1202:bluetooth_rxtx.c **** 
 3412              		.loc 1 1202 0
 3413 0016 1420     		movs	r0, #20
 3414 0018 42F24B31 		movw	r1, #9035
 3415 001c FFF7FEFF 		bl	cc2400_set
 3416              	.LVL403:
1204:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
 3417              		.loc 1 1204 0
 3418 0020 2020     		movs	r0, #32
 3419 0022 40F60141 		movw	r1, #3073
 3420 0026 FFF7FEFF 		bl	cc2400_set
 3421              	.LVL404:
1213:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
 3422              		.loc 1 1213 0
 3423 002a 0520     		movs	r0, #5
 3424 002c 0B21     		movs	r1, #11
 3425 002e FFF7FEFF 		bl	cc2400_set
 3426              	.LVL405:
1214:bluetooth_rxtx.c **** 
 3427              		.loc 1 1214 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 107


 3428 0032 0320     		movs	r0, #3
 3429 0034 4021     		movs	r1, #64
 3430 0036 FFF7FEFF 		bl	cc2400_set
 3431              	.LVL406:
 3432              	.L374:
1216:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 3433              		.loc 1 1216 0 discriminator 1
 3434 003a FFF7FEFF 		bl	cc2400_status
 3435              	.LVL407:
 3436 003e 4206     		lsls	r2, r0, #25
 3437 0040 FBD5     		bpl	.L374
1217:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 3438              		.loc 1 1217 0
 3439 0042 6120     		movs	r0, #97
 3440 0044 FFF7FEFF 		bl	cc2400_strobe
 3441              	.LVL408:
 3442              	.L375:
1218:bluetooth_rxtx.c **** 	TXLED_SET;
 3443              		.loc 1 1218 0 discriminator 1
 3444 0048 FFF7FEFF 		bl	cc2400_status
 3445              	.LVL409:
 3446 004c 4307     		lsls	r3, r0, #29
 3447 004e FBD5     		bpl	.L375
1219:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 3448              		.loc 1 1219 0
 3449 0050 084B     		ldr	r3, .L382
 3450 0052 4FF48072 		mov	r2, #256
 3451 0056 1A60     		str	r2, [r3]
1221:bluetooth_rxtx.c **** #endif
 3452              		.loc 1 1221 0
 3453 0058 8022     		movs	r2, #128
 3454 005a 1A62     		str	r2, [r3, #32]
 3455              	.L376:
1223:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 3456              		.loc 1 1223 0 discriminator 1
 3457 005c 0E20     		movs	r0, #14
 3458 005e FFF7FEFF 		bl	cc2400_get
 3459              	.LVL410:
 3460 0062 00F01F00 		and	r0, r0, #31
 3461 0066 0F28     		cmp	r0, #15
 3462 0068 F8D1     		bne	.L376
1224:bluetooth_rxtx.c **** #endif
 3463              		.loc 1 1224 0
 3464 006a 6320     		movs	r0, #99
1226:bluetooth_rxtx.c **** 
 3465              		.loc 1 1226 0
 3466 006c BDE80840 		pop	{r3, lr}
 3467              		.cfi_restore 14
 3468              		.cfi_restore 3
 3469              		.cfi_def_cfa_offset 0
1224:bluetooth_rxtx.c **** #endif
 3470              		.loc 1 1224 0
 3471 0070 FFF7FEBF 		b	cc2400_strobe
 3472              	.LVL411:
 3473              	.L383:
 3474              		.align	2
 3475              	.L382:
ARM GAS  /tmp/ccDKg7Fp.s 			page 108


 3476 0074 38C00920 		.word	537509944
 3477              		.cfi_endproc
 3478              	.LFE13:
 3480              		.section	.text.hop,"ax",%progbits
 3481              		.align	1
 3482              		.global	hop
 3483              		.thumb
 3484              		.thumb_func
 3486              	hop:
 3487              	.LFB14:
1231:bluetooth_rxtx.c **** 	do_hop = 0;
 3488              		.loc 1 1231 0
 3489              		.cfi_startproc
 3490              		@ args = 0, pretend = 0, frame = 0
 3491              		@ frame_needed = 0, uses_anonymous_args = 0
 3492 0000 38B5     		push	{r3, r4, r5, lr}
 3493              		.cfi_def_cfa_offset 16
 3494              		.cfi_offset 3, -16
 3495              		.cfi_offset 4, -12
 3496              		.cfi_offset 5, -8
 3497              		.cfi_offset 14, -4
1232:bluetooth_rxtx.c **** 	last_hop = clkn;
 3498              		.loc 1 1232 0
 3499 0002 5D4C     		ldr	r4, .L425
 3500 0004 0023     		movs	r3, #0
 3501 0006 E372     		strb	r3, [r4, #11]
1233:bluetooth_rxtx.c **** 
 3502              		.loc 1 1233 0
 3503 0008 5C4B     		ldr	r3, .L425+4
 3504 000a 5D4A     		ldr	r2, .L425+8
 3505 000c 1968     		ldr	r1, [r3]
 3506 000e 1160     		str	r1, [r2]
1236:bluetooth_rxtx.c **** 		if (cc2400_get(FSDIV) == (channel - 1))
 3507              		.loc 1 1236 0
 3508 0010 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3509 0012 4AB9     		cbnz	r2, .L385
1237:bluetooth_rxtx.c **** 			return;
 3510              		.loc 1 1237 0
 3511 0014 0220     		movs	r0, #2
 3512 0016 FFF7FEFF 		bl	cc2400_get
 3513              	.LVL412:
 3514 001a 5A4B     		ldr	r3, .L425+12
 3515 001c 1B88     		ldrh	r3, [r3]
 3516 001e 9BB2     		uxth	r3, r3
 3517 0020 013B     		subs	r3, r3, #1
 3518 0022 9842     		cmp	r0, r3
 3519 0024 7DD1     		bne	.L387
 3520 0026 38BD     		pop	{r3, r4, r5, pc}
 3521              	.L385:
1243:bluetooth_rxtx.c **** 		do {
 3522              		.loc 1 1243 0
 3523 0028 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3524 002a 012A     		cmp	r2, #1
 3525 002c 30D1     		bne	.L388
1248:bluetooth_rxtx.c **** 	}
 3526              		.loc 1 1248 0
 3527 002e 564B     		ldr	r3, .L425+16
ARM GAS  /tmp/ccDKg7Fp.s 			page 109


 3528 0030 1978     		ldrb	r1, [r3]	@ zero_extendqisi2
 3529 0032 564B     		ldr	r3, .L425+20
 3530 0034 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
 3531              	.L391:
1245:bluetooth_rxtx.c **** 			if (channel > 2480)
 3532              		.loc 1 1245 0
 3533 0036 534A     		ldr	r2, .L425+12
 3534 0038 1388     		ldrh	r3, [r2]
 3535 003a 2033     		adds	r3, r3, #32
 3536 003c 9BB2     		uxth	r3, r3
 3537 003e 1380     		strh	r3, [r2]	@ movhi
1246:bluetooth_rxtx.c **** 				channel -= 79;
 3538              		.loc 1 1246 0
 3539 0040 1388     		ldrh	r3, [r2]
 3540 0042 9BB2     		uxth	r3, r3
 3541 0044 B3F51B6F 		cmp	r3, #2480
1247:bluetooth_rxtx.c **** 		} while ( used_channels != 0 && afh_enabled && !( afh_map[(channel-2402)/8] & 0x1<<((channel-2402
 3542              		.loc 1 1247 0
 3543 0048 81BF     		itttt	hi
 3544 004a 1388     		ldrhhi	r3, [r2]
 3545 004c 4F3B     		subhi	r3, r3, #79
 3546 004e 9BB2     		uxthhi	r3, r3
 3547 0050 1380     		strhhi	r3, [r2]	@ movhi
1248:bluetooth_rxtx.c **** 	}
 3548              		.loc 1 1248 0
 3549 0052 0029     		cmp	r1, #0
 3550 0054 65D0     		beq	.L387
1248:bluetooth_rxtx.c **** 	}
 3551              		.loc 1 1248 0 is_stmt 0 discriminator 1
 3552 0056 0028     		cmp	r0, #0
 3553 0058 63D0     		beq	.L387
1248:bluetooth_rxtx.c **** 	}
 3554              		.loc 1 1248 0 discriminator 2
 3555 005a 1388     		ldrh	r3, [r2]
 3556 005c 0825     		movs	r5, #8
 3557 005e 9BB2     		uxth	r3, r3
 3558 0060 A3F66213 		subw	r3, r3, #2402
 3559 0064 93FBF5F3 		sdiv	r3, r3, r5
 3560 0068 1288     		ldrh	r2, [r2]
 3561 006a 494D     		ldr	r5, .L425+24
 3562 006c 92B2     		uxth	r2, r2
 3563 006e ED5C     		ldrb	r5, [r5, r3]	@ zero_extendqisi2
 3564 0070 484B     		ldr	r3, .L425+28
 3565 0072 A2F66212 		subw	r2, r2, #2402
 3566 0076 1340     		ands	r3, r3, r2
 3567 0078 002B     		cmp	r3, #0
 3568 007a BEBF     		ittt	lt
 3569 007c 03F1FF33 		addlt	r3, r3, #-1
 3570 0080 63F00703 		ornlt	r3, r3, #7
 3571 0084 0133     		addlt	r3, r3, #1
 3572 0086 45FA03F3 		asr	r3, r5, r3
 3573 008a DD07     		lsls	r5, r3, #31
 3574 008c D3D5     		bpl	.L391
 3575 008e 48E0     		b	.L387
 3576              	.L388:
1254:bluetooth_rxtx.c **** 		do {
 3577              		.loc 1 1254 0 is_stmt 1
ARM GAS  /tmp/ccDKg7Fp.s 			page 110


 3578 0090 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3579 0092 052A     		cmp	r2, #5
 3580 0094 2CD1     		bne	.L393
1259:bluetooth_rxtx.c **** 	}
 3581              		.loc 1 1259 0
 3582 0096 3C4B     		ldr	r3, .L425+16
 3583 0098 1978     		ldrb	r1, [r3]	@ zero_extendqisi2
 3584              	.L395:
1256:bluetooth_rxtx.c **** 			if (channel > 2480)
 3585              		.loc 1 1256 0
 3586 009a 3A4A     		ldr	r2, .L425+12
 3587 009c 1388     		ldrh	r3, [r2]
 3588 009e 2033     		adds	r3, r3, #32
 3589 00a0 9BB2     		uxth	r3, r3
 3590 00a2 1380     		strh	r3, [r2]	@ movhi
1257:bluetooth_rxtx.c **** 				channel -= 79;
 3591              		.loc 1 1257 0
 3592 00a4 1388     		ldrh	r3, [r2]
 3593 00a6 9BB2     		uxth	r3, r3
 3594 00a8 B3F51B6F 		cmp	r3, #2480
1258:bluetooth_rxtx.c **** 		} while( used_channels != 79 && (afh_map[(channel-2402)/8] & 0x1<<((channel-2402)%8)) );
 3595              		.loc 1 1258 0
 3596 00ac 81BF     		itttt	hi
 3597 00ae 1388     		ldrhhi	r3, [r2]
 3598 00b0 4F3B     		subhi	r3, r3, #79
 3599 00b2 9BB2     		uxthhi	r3, r3
 3600 00b4 1380     		strhhi	r3, [r2]	@ movhi
1259:bluetooth_rxtx.c **** 	}
 3601              		.loc 1 1259 0
 3602 00b6 4F29     		cmp	r1, #79
 3603 00b8 33D0     		beq	.L387
1259:bluetooth_rxtx.c **** 	}
 3604              		.loc 1 1259 0 is_stmt 0 discriminator 1
 3605 00ba 1388     		ldrh	r3, [r2]
 3606 00bc 0820     		movs	r0, #8
 3607 00be 9BB2     		uxth	r3, r3
 3608 00c0 A3F66213 		subw	r3, r3, #2402
 3609 00c4 93FBF0F3 		sdiv	r3, r3, r0
 3610 00c8 1288     		ldrh	r2, [r2]
 3611 00ca 3148     		ldr	r0, .L425+24
 3612 00cc 92B2     		uxth	r2, r2
 3613 00ce C05C     		ldrb	r0, [r0, r3]	@ zero_extendqisi2
 3614 00d0 304B     		ldr	r3, .L425+28
 3615 00d2 A2F66212 		subw	r2, r2, #2402
 3616 00d6 1340     		ands	r3, r3, r2
 3617 00d8 002B     		cmp	r3, #0
 3618 00da BEBF     		ittt	lt
 3619 00dc 03F1FF33 		addlt	r3, r3, #-1
 3620 00e0 63F00703 		ornlt	r3, r3, #7
 3621 00e4 0133     		addlt	r3, r3, #1
 3622 00e6 40FA03F3 		asr	r3, r0, r3
 3623 00ea D807     		lsls	r0, r3, #31
 3624 00ec D5D4     		bmi	.L395
 3625 00ee 18E0     		b	.L387
 3626              	.L393:
1262:bluetooth_rxtx.c **** 		channel = next_hop(clkn);
 3627              		.loc 1 1262 0 is_stmt 1
ARM GAS  /tmp/ccDKg7Fp.s 			page 111


 3628 00f0 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3629 00f2 022A     		cmp	r2, #2
 3630 00f4 05D1     		bne	.L397
1263:bluetooth_rxtx.c **** 	}
 3631              		.loc 1 1263 0
 3632 00f6 1868     		ldr	r0, [r3]
 3633 00f8 FFF7FEFF 		bl	next_hop
 3634              	.LVL413:
 3635 00fc 214B     		ldr	r3, .L425+12
 3636 00fe 1880     		strh	r0, [r3]	@ movhi
 3637 0100 0FE0     		b	.L387
 3638              	.L397:
1266:bluetooth_rxtx.c **** 		channel = btle_next_hop(&le);
 3639              		.loc 1 1266 0
 3640 0102 A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3641 0104 032B     		cmp	r3, #3
 3642 0106 05D1     		bne	.L398
1267:bluetooth_rxtx.c **** 	}
 3643              		.loc 1 1267 0
 3644 0108 1E4D     		ldr	r5, .L425+12
 3645 010a 281D     		adds	r0, r5, #4
 3646 010c FFF7FEFF 		bl	btle_next_hop
 3647              	.LVL414:
 3648 0110 2880     		strh	r0, [r5]	@ movhi
 3649 0112 06E0     		b	.L387
 3650              	.L398:
1270:bluetooth_rxtx.c **** 		channel = hop_direct_channel;
 3651              		.loc 1 1270 0
 3652 0114 A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3653 0116 042B     		cmp	r3, #4
1271:bluetooth_rxtx.c **** 	}
 3654              		.loc 1 1271 0
 3655 0118 01BF     		itttt	eq
 3656 011a A389     		ldrheq	r3, [r4, #12]
 3657 011c 194A     		ldreq	r2, .L425+12
 3658 011e 9BB2     		uxtheq	r3, r3
 3659 0120 1380     		strheq	r3, [r2]	@ movhi
 3660              	.L387:
1274:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 3661              		.loc 1 1274 0
 3662 0122 6420     		movs	r0, #100
 3663 0124 FFF7FEFF 		bl	cc2400_strobe
 3664              	.LVL415:
 3665              	.L399:
1275:bluetooth_rxtx.c **** 
 3666              		.loc 1 1275 0 discriminator 1
 3667 0128 FFF7FEFF 		bl	cc2400_status
 3668              	.LVL416:
 3669 012c 4207     		lsls	r2, r0, #29
 3670 012e FBD4     		bmi	.L399
1278:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
 3671              		.loc 1 1278 0
 3672 0130 607C     		ldrb	r0, [r4, #17]	@ zero_extendqisi2
 3673 0132 144D     		ldr	r5, .L425+12
 3674 0134 C0B2     		uxtb	r0, r0
1279:bluetooth_rxtx.c **** 	else
 3675              		.loc 1 1279 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 112


 3676 0136 2988     		ldrh	r1, [r5]
1278:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
 3677              		.loc 1 1278 0
 3678 0138 0228     		cmp	r0, #2
1281:bluetooth_rxtx.c **** 
 3679              		.loc 1 1281 0
 3680 013a 1CBF     		itt	ne
 3681 013c 01F1FF31 		addne	r1, r1, #-1
 3682 0140 0220     		movne	r0, #2
 3683 0142 89B2     		uxth	r1, r1
 3684 0144 FFF7FEFF 		bl	cc2400_set
 3685              	.LVL417:
1284:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 3686              		.loc 1 1284 0
 3687 0148 A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3688 014a 1BB1     		cbz	r3, .L402
1285:bluetooth_rxtx.c **** 	}
 3689              		.loc 1 1285 0
 3690 014c 2888     		ldrh	r0, [r5]
 3691 014e 80B2     		uxth	r0, r0
 3692 0150 FFF7FEFF 		bl	cs_threshold_calc_and_set
 3693              	.LVL418:
 3694              	.L402:
1289:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 3695              		.loc 1 1289 0
 3696 0154 6120     		movs	r0, #97
 3697 0156 FFF7FEFF 		bl	cc2400_strobe
 3698              	.LVL419:
 3699              	.L403:
1290:bluetooth_rxtx.c **** 
 3700              		.loc 1 1290 0 discriminator 1
 3701 015a FFF7FEFF 		bl	cc2400_status
 3702              	.LVL420:
 3703 015e 4307     		lsls	r3, r0, #29
 3704 0160 FBD5     		bpl	.L403
1292:bluetooth_rxtx.c **** 
 3705              		.loc 1 1292 0
 3706 0162 0123     		movs	r3, #1
 3707 0164 2374     		strb	r3, [r4, #16]
1294:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
 3708              		.loc 1 1294 0
 3709 0166 637C     		ldrb	r3, [r4, #17]	@ zero_extendqisi2
 3710 0168 022B     		cmp	r3, #2
1295:bluetooth_rxtx.c **** 	else
 3711              		.loc 1 1295 0
 3712 016a 0CBF     		ite	eq
 3713 016c 6320     		moveq	r0, #99
1297:bluetooth_rxtx.c **** }
 3714              		.loc 1 1297 0
 3715 016e 6220     		movne	r0, #98
1298:bluetooth_rxtx.c **** 
 3716              		.loc 1 1298 0
 3717 0170 BDE83840 		pop	{r3, r4, r5, lr}
 3718              		.cfi_restore 14
 3719              		.cfi_restore 5
 3720              		.cfi_restore 4
 3721              		.cfi_restore 3
ARM GAS  /tmp/ccDKg7Fp.s 			page 113


 3722              		.cfi_def_cfa_offset 0
1297:bluetooth_rxtx.c **** }
 3723              		.loc 1 1297 0
 3724 0174 FFF7FEBF 		b	cc2400_strobe
 3725              	.LVL421:
 3726              	.L426:
 3727              		.align	2
 3728              	.L425:
 3729 0178 00000000 		.word	.LANCHOR0
 3730 017c 00000000 		.word	clkn
 3731 0180 00000000 		.word	last_hop
 3732 0184 00000000 		.word	.LANCHOR1
 3733 0188 00000000 		.word	used_channels
 3734 018c 00000000 		.word	afh_enabled
 3735 0190 00000000 		.word	afh_map
 3736 0194 07000080 		.word	-2147483641
 3737              		.cfi_endproc
 3738              	.LFE14:
 3740              		.section	.text.bt_stream_rx,"ax",%progbits
 3741              		.align	1
 3742              		.global	bt_stream_rx
 3743              		.thumb
 3744              		.thumb_func
 3746              	bt_stream_rx:
 3747              	.LFB15:
1302:bluetooth_rxtx.c **** 	int8_t rssi;
 3748              		.loc 1 1302 0
 3749              		.cfi_startproc
 3750              		@ args = 0, pretend = 0, frame = 0
 3751              		@ frame_needed = 0, uses_anonymous_args = 0
 3752 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 3753              		.cfi_def_cfa_offset 32
 3754              		.cfi_offset 4, -32
 3755              		.cfi_offset 5, -28
 3756              		.cfi_offset 6, -24
 3757              		.cfi_offset 7, -20
 3758              		.cfi_offset 8, -16
 3759              		.cfi_offset 9, -12
 3760              		.cfi_offset 10, -8
 3761              		.cfi_offset 14, -4
1306:bluetooth_rxtx.c **** 
 3762              		.loc 1 1306 0
 3763 0004 4A4E     		ldr	r6, .L461
 3764 0006 1023     		movs	r3, #16
 3765 0008 3360     		str	r3, [r6]
1308:bluetooth_rxtx.c **** 	dio_ssp_init();
 3766              		.loc 1 1308 0
 3767 000a FFF7FEFF 		bl	usb_queue_init
 3768              	.LVL422:
1309:bluetooth_rxtx.c **** 	dma_init_rx_symbols();
 3769              		.loc 1 1309 0
 3770 000e FFF7FEFF 		bl	dio_ssp_init
 3771              	.LVL423:
1310:bluetooth_rxtx.c **** 	dio_ssp_start();
 3772              		.loc 1 1310 0
 3773 0012 FFF7FEFF 		bl	dma_init_rx_symbols
 3774              	.LVL424:
ARM GAS  /tmp/ccDKg7Fp.s 			page 114


1311:bluetooth_rxtx.c **** 
 3775              		.loc 1 1311 0
 3776 0016 FFF7FEFF 		bl	dio_ssp_start
 3777              	.LVL425:
1313:bluetooth_rxtx.c **** 
 3778              		.loc 1 1313 0
 3779 001a FFF7FEFF 		bl	cc2400_rx
 3780              	.LVL426:
1315:bluetooth_rxtx.c **** 
 3781              		.loc 1 1315 0
 3782 001e FFF7FEFF 		bl	cs_trigger_enable
 3783              	.LVL427:
 3784              	.L428:
1317:bluetooth_rxtx.c **** 	{
 3785              		.loc 1 1317 0
 3786 0022 444C     		ldr	r4, .L461+4
 3787 0024 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 3788 0026 A046     		mov	r8, r4
 3789 0028 012B     		cmp	r3, #1
 3790 002a 78D1     		bne	.L459
 3791              	.L440:
1320:bluetooth_rxtx.c **** 
 3792              		.loc 1 1320 0
 3793 002c 1023     		movs	r3, #16
 3794 002e 3360     		str	r3, [r6]
1332:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
 3795              		.loc 1 1332 0
 3796 0030 FFF7FEFF 		bl	rssi_reset
 3797              	.LVL428:
1333:bluetooth_rxtx.c **** 		while (!rx_tc) {
 3798              		.loc 1 1333 0
 3799 0034 8025     		movs	r5, #128
 3800              	.LVL429:
 3801              	.L429:
1334:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
 3802              		.loc 1 1334 0
 3803 0036 404B     		ldr	r3, .L461+8
 3804 0038 DFF820A1 		ldr	r10, .L461+44
 3805 003c 1A68     		ldr	r2, [r3]
 3806 003e 3F4F     		ldr	r7, .L461+12
 3807 0040 9946     		mov	r9, r3
 3808 0042 1ABB     		cbnz	r2, .L460
1335:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 3809              		.loc 1 1335 0
 3810 0044 0620     		movs	r0, #6
 3811 0046 FFF7FEFF 		bl	cc2400_get
 3812              	.LVL430:
1336:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 3813              		.loc 1 1336 0
 3814 004a 9AF80030 		ldrb	r3, [r10]	@ zero_extendqisi2
1335:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 3815              		.loc 1 1335 0
 3816 004e C0F30720 		ubfx	r0, r0, #8, #8
 3817              	.LVL431:
1336:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 3818              		.loc 1 1336 0
 3819 0052 5BB1     		cbz	r3, .L430
ARM GAS  /tmp/ccDKg7Fp.s 			page 115


1336:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 3820              		.loc 1 1336 0 is_stmt 0 discriminator 1
 3821 0054 802D     		cmp	r5, #128
 3822 0056 09D1     		bne	.L430
1337:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
 3823              		.loc 1 1337 0 is_stmt 1
 3824 0058 394B     		ldr	r3, .L461+16
 3825 005a 40B2     		sxtb	r0, r0
 3826 005c 93F90050 		ldrsb	r5, [r3]
 3827              	.LVL432:
 3828 0060 3635     		adds	r5, r5, #54
 3829 0062 A842     		cmp	r0, r5
 3830 0064 B8BF     		it	lt
 3831 0066 2846     		movlt	r0, r5
 3832              	.LVL433:
 3833 0068 C5B2     		uxtb	r5, r0
1338:bluetooth_rxtx.c **** 			}
 3834              		.loc 1 1338 0
 3835 006a 2846     		mov	r0, r5
 3836              	.L430:
 3837              	.LVL434:
1340:bluetooth_rxtx.c **** 
 3838              		.loc 1 1340 0
 3839 006c 40B2     		sxtb	r0, r0
 3840 006e FFF7FEFF 		bl	rssi_add
 3841              	.LVL435:
1342:bluetooth_rxtx.c **** 
 3842              		.loc 1 1342 0
 3843 0072 3868     		ldr	r0, [r7]
 3844 0074 FFF7FEFF 		bl	handle_usb
 3845              	.LVL436:
1345:bluetooth_rxtx.c **** 				hop();
 3846              		.loc 1 1345 0
 3847 0078 98F80B30 		ldrb	r3, [r8, #11]	@ zero_extendqisi2
 3848 007c 13B1     		cbz	r3, .L431
1346:bluetooth_rxtx.c **** 			} else {
 3849              		.loc 1 1346 0
 3850 007e FFF7FEFF 		bl	hop
 3851              	.LVL437:
 3852 0082 D8E7     		b	.L429
 3853              	.L431:
1348:bluetooth_rxtx.c **** 			}
 3854              		.loc 1 1348 0
 3855 0084 4FF48073 		mov	r3, #256
 3856 0088 3360     		str	r3, [r6]
 3857 008a D4E7     		b	.L429
 3858              	.L460:
1354:bluetooth_rxtx.c **** 
 3859              		.loc 1 1354 0
 3860 008c 2D4B     		ldr	r3, .L461+20
 3861 008e 1022     		movs	r2, #16
1356:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 3862              		.loc 1 1356 0
 3863 0090 2D4D     		ldr	r5, .L461+24
 3864              	.LVL438:
1354:bluetooth_rxtx.c **** 
 3865              		.loc 1 1354 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 116


 3866 0092 1A60     		str	r2, [r3]
1356:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 3867              		.loc 1 1356 0
 3868 0094 2B68     		ldr	r3, [r5]
 3869 0096 1BB1     		cbz	r3, .L434
1357:bluetooth_rxtx.c **** 		}
 3870              		.loc 1 1357 0
 3871 0098 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 3872 009a 43F00203 		orr	r3, r3, #2
 3873 009e 6370     		strb	r3, [r4, #1]
 3874              	.L434:
1361:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
 3875              		.loc 1 1361 0
 3876 00a0 D9F80030 		ldr	r3, [r9]
 3877 00a4 012B     		cmp	r3, #1
1362:bluetooth_rxtx.c **** 
 3878              		.loc 1 1362 0
 3879 00a6 82BF     		ittt	hi
 3880 00a8 6378     		ldrbhi	r3, [r4, #1]	@ zero_extendqisi2
 3881 00aa 43F00103 		orrhi	r3, r3, #1
 3882 00ae 6370     		strbhi	r3, [r4, #1]
1364:bluetooth_rxtx.c **** 			status |= DISCARD;
 3883              		.loc 1 1364 0
 3884 00b0 227C     		ldrb	r2, [r4, #16]	@ zero_extendqisi2
 3885 00b2 204B     		ldr	r3, .L461+4
 3886 00b4 2AB1     		cbz	r2, .L436
1365:bluetooth_rxtx.c **** 			dma_discard = 0;
 3887              		.loc 1 1365 0
 3888 00b6 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 3889 00b8 42F02002 		orr	r2, r2, #32
 3890 00bc 5A70     		strb	r2, [r3, #1]
1366:bluetooth_rxtx.c **** 		}
 3891              		.loc 1 1366 0
 3892 00be 0022     		movs	r2, #0
 3893 00c0 1A74     		strb	r2, [r3, #16]
 3894              	.L436:
1369:bluetooth_rxtx.c **** 
 3895              		.loc 1 1369 0
 3896 00c2 224B     		ldr	r3, .L461+28
 3897 00c4 1888     		ldrh	r0, [r3]
 3898 00c6 80B2     		uxth	r0, r0
 3899 00c8 FFF7FEFF 		bl	rssi_iir_update
 3900              	.LVL439:
1375:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 3901              		.loc 1 1375 0
 3902 00cc 9AF80030 		ldrb	r3, [r10]	@ zero_extendqisi2
 3903 00d0 13B9     		cbnz	r3, .L437
1375:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 3904              		.loc 1 1375 0 is_stmt 0 discriminator 1
 3905 00d2 1F4B     		ldr	r3, .L461+32
 3906 00d4 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3907 00d6 33B1     		cbz	r3, .L438
 3908              	.L437:
1376:bluetooth_rxtx.c **** 			cs_trigger = 0;
 3909              		.loc 1 1376 0 is_stmt 1
 3910 00d8 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 3911 00da 43F00803 		orr	r3, r3, #8
ARM GAS  /tmp/ccDKg7Fp.s 			page 117


 3912 00de 6370     		strb	r3, [r4, #1]
1377:bluetooth_rxtx.c **** 		}
 3913              		.loc 1 1377 0
 3914 00e0 0023     		movs	r3, #0
 3915 00e2 8AF80030 		strb	r3, [r10]
 3916              	.L438:
1380:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
 3917              		.loc 1 1380 0
 3918 00e6 164B     		ldr	r3, .L461+16
 3919 00e8 1A4A     		ldr	r2, .L461+36
 3920 00ea 93F90030 		ldrsb	r3, [r3]
 3921 00ee 92F90020 		ldrsb	r2, [r2]
 3922 00f2 3533     		adds	r3, r3, #53
 3923 00f4 9342     		cmp	r3, r2
1381:bluetooth_rxtx.c **** 		}
 3924              		.loc 1 1381 0
 3925 00f6 B8BF     		it	lt
 3926 00f8 6378     		ldrblt	r3, [r4, #1]	@ zero_extendqisi2
1384:bluetooth_rxtx.c **** 
 3927              		.loc 1 1384 0
 3928 00fa 4FF00000 		mov	r0, #0
1381:bluetooth_rxtx.c **** 		}
 3929              		.loc 1 1381 0
 3930 00fe BCBF     		itt	lt
 3931 0100 43F01003 		orrlt	r3, r3, #16
 3932 0104 6370     		strblt	r3, [r4, #1]
1384:bluetooth_rxtx.c **** 
 3933              		.loc 1 1384 0
 3934 0106 144B     		ldr	r3, .L461+40
 3935 0108 1968     		ldr	r1, [r3]
 3936 010a FFF7FEFF 		bl	enqueue
 3937              	.LVL440:
1386:bluetooth_rxtx.c **** 		rx_tc = 0;
 3938              		.loc 1 1386 0
 3939 010e 3868     		ldr	r0, [r7]
 3940 0110 FFF7FEFF 		bl	handle_usb
 3941              	.LVL441:
1387:bluetooth_rxtx.c **** 		rx_err = 0;
 3942              		.loc 1 1387 0
 3943 0114 0023     		movs	r3, #0
 3944 0116 C9F80030 		str	r3, [r9]
1388:bluetooth_rxtx.c **** 	}
 3945              		.loc 1 1388 0
 3946 011a 2B60     		str	r3, [r5]
 3947 011c 81E7     		b	.L428
 3948              	.L459:
1317:bluetooth_rxtx.c **** 	{
 3949              		.loc 1 1317 0 discriminator 1
 3950 011e A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 3951 0120 082B     		cmp	r3, #8
 3952 0122 83D0     		beq	.L440
1391:bluetooth_rxtx.c **** 	cs_trigger_disable();
 3953              		.loc 1 1391 0
 3954 0124 FFF7FEFF 		bl	dio_ssp_stop
 3955              	.LVL442:
1393:bluetooth_rxtx.c **** 
 3956              		.loc 1 1393 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 118


 3957 0128 BDE8F047 		pop	{r4, r5, r6, r7, r8, r9, r10, lr}
 3958              		.cfi_restore 14
 3959              		.cfi_restore 10
 3960              		.cfi_restore 9
 3961              		.cfi_restore 8
 3962              		.cfi_restore 7
 3963              		.cfi_restore 6
 3964              		.cfi_restore 5
 3965              		.cfi_restore 4
 3966              		.cfi_def_cfa_offset 0
1392:bluetooth_rxtx.c **** }
 3967              		.loc 1 1392 0
 3968 012c FFF7FEBF 		b	cs_trigger_disable
 3969              	.LVL443:
 3970              	.L462:
 3971              		.align	2
 3972              	.L461:
 3973 0130 3CC00920 		.word	537509948
 3974 0134 00000000 		.word	.LANCHOR0
 3975 0138 00000000 		.word	rx_tc
 3976 013c 00000000 		.word	clkn
 3977 0140 00000000 		.word	cs_threshold_cur
 3978 0144 38C00920 		.word	537509944
 3979 0148 00000000 		.word	rx_err
 3980 014c 00000000 		.word	.LANCHOR1
 3981 0150 00000000 		.word	cs_no_squelch
 3982 0154 00000000 		.word	rssi_max
 3983 0158 00000000 		.word	idle_rxbuf
 3984 015c 00000000 		.word	cs_trigger
 3985              		.cfi_endproc
 3986              	.LFE15:
 3988              		.section	.text.br_transmit,"ax",%progbits
 3989              		.align	1
 3990              		.global	br_transmit
 3991              		.thumb
 3992              		.thumb_func
 3994              	br_transmit:
 3995              	.LFB18:
1425:bluetooth_rxtx.c **** 	uint16_t gio_save;
 3996              		.loc 1 1425 0
 3997              		.cfi_startproc
 3998              		@ args = 0, pretend = 0, frame = 16
 3999              		@ frame_needed = 0, uses_anonymous_args = 0
 4000 0000 2DE9FF41 		push	{r0, r1, r2, r3, r4, r5, r6, r7, r8, lr}
 4001              		.cfi_def_cfa_offset 40
 4002              		.cfi_offset 4, -24
 4003              		.cfi_offset 5, -20
 4004              		.cfi_offset 6, -16
 4005              		.cfi_offset 7, -12
 4006              		.cfi_offset 8, -8
 4007              		.cfi_offset 14, -4
 4008              	.LVL444:
1430:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 4009              		.loc 1 1430 0
 4010 0004 934B     		ldr	r3, .L503
1431:bluetooth_rxtx.c **** 
 4011              		.loc 1 1431 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 119


 4012 0006 0027     		movs	r7, #0
1430:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 4013              		.loc 1 1430 0
 4014 0008 D3E90245 		ldrd	r4, [r3, #8]
 4015 000c 0023     		movs	r3, #0
 4016 000e 04F00102 		and	r2, r4, #1
 4017 0012 1343     		orrs	r3, r2, r3
 4018 0014 4AF6AA23 		movw	r3, #43690
1431:bluetooth_rxtx.c **** 
 4019              		.loc 1 1431 0
 4020 0018 4FEAD576 		lsr	r6, r5, #31
1430:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 4021              		.loc 1 1430 0
 4022 001c 45F25558 		movw	r8, #21845
 4023 0020 08BF     		it	eq
 4024 0022 9846     		moveq	r8, r3
 4025              	.LVL445:
1431:bluetooth_rxtx.c **** 
 4026              		.loc 1 1431 0
 4027 0024 002F     		cmp	r7, #0
 4028 0026 08BF     		it	eq
 4029 0028 012E     		cmpeq	r6, #1
1434:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
 4030              		.loc 1 1434 0
 4031 002a E0B2     		uxtb	r0, r4
1431:bluetooth_rxtx.c **** 
 4032              		.loc 1 1431 0
 4033 002c 0CBF     		ite	eq
 4034 002e AA26     		moveq	r6, #170
 4035 0030 5526     		movne	r6, #85
 4036              	.LVL446:
1434:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
 4037              		.loc 1 1434 0
 4038 0032 FFF7FEFF 		bl	reverse8
 4039              	.LVL447:
1433:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4040              		.loc 1 1433 0
 4041 0036 8DF80000 		strb	r0, [sp]
1435:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 16) & 0xFF),
 4042              		.loc 1 1435 0
 4043 003a C4F30720 		ubfx	r0, r4, #8, #8
 4044 003e FFF7FEFF 		bl	reverse8
 4045              	.LVL448:
1433:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4046              		.loc 1 1433 0
 4047 0042 8DF80100 		strb	r0, [sp, #1]
1436:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 24) & 0xFF),
 4048              		.loc 1 1436 0
 4049 0046 C4F30740 		ubfx	r0, r4, #16, #8
 4050 004a FFF7FEFF 		bl	reverse8
 4051              	.LVL449:
1433:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4052              		.loc 1 1433 0
 4053 004e 8DF80200 		strb	r0, [sp, #2]
1437:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 32) & 0xFF),
 4054              		.loc 1 1437 0
 4055 0052 200E     		lsrs	r0, r4, #24
ARM GAS  /tmp/ccDKg7Fp.s 			page 120


 4056 0054 FFF7FEFF 		bl	reverse8
 4057              	.LVL450:
1433:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4058              		.loc 1 1433 0
 4059 0058 8DF80300 		strb	r0, [sp, #3]
1438:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 40) & 0xFF),
 4060              		.loc 1 1438 0
 4061 005c E8B2     		uxtb	r0, r5
 4062 005e FFF7FEFF 		bl	reverse8
 4063              	.LVL451:
1433:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4064              		.loc 1 1433 0
 4065 0062 8DF80400 		strb	r0, [sp, #4]
1439:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 48) & 0xFF),
 4066              		.loc 1 1439 0
 4067 0066 C5F30720 		ubfx	r0, r5, #8, #8
 4068 006a FFF7FEFF 		bl	reverse8
 4069              	.LVL452:
1433:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4070              		.loc 1 1433 0
 4071 006e 8DF80500 		strb	r0, [sp, #5]
1440:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 56) & 0xFF),
 4072              		.loc 1 1440 0
 4073 0072 C5F30740 		ubfx	r0, r5, #16, #8
 4074 0076 FFF7FEFF 		bl	reverse8
 4075              	.LVL453:
1433:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4076              		.loc 1 1433 0
 4077 007a 8DF80600 		strb	r0, [sp, #6]
1441:bluetooth_rxtx.c **** 		reverse8(trailer),
 4078              		.loc 1 1441 0
 4079 007e 280E     		lsrs	r0, r5, #24
 4080 0080 FFF7FEFF 		bl	reverse8
 4081              	.LVL454:
1433:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4082              		.loc 1 1433 0
 4083 0084 8DF80700 		strb	r0, [sp, #7]
1442:bluetooth_rxtx.c **** 		reverse8(0x77),
 4084              		.loc 1 1442 0
 4085 0088 3046     		mov	r0, r6
 4086 008a FFF7FEFF 		bl	reverse8
 4087              	.LVL455:
1433:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4088              		.loc 1 1433 0
 4089 008e 8DF80800 		strb	r0, [sp, #8]
1443:bluetooth_rxtx.c **** 		reverse8(0x66),
 4090              		.loc 1 1443 0
 4091 0092 7720     		movs	r0, #119
 4092 0094 FFF7FEFF 		bl	reverse8
 4093              	.LVL456:
1433:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4094              		.loc 1 1433 0
 4095 0098 8DF80900 		strb	r0, [sp, #9]
1444:bluetooth_rxtx.c **** 		reverse8(0x55),
 4096              		.loc 1 1444 0
 4097 009c 6620     		movs	r0, #102
 4098 009e FFF7FEFF 		bl	reverse8
ARM GAS  /tmp/ccDKg7Fp.s 			page 121


 4099              	.LVL457:
1433:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4100              		.loc 1 1433 0
 4101 00a2 8DF80A00 		strb	r0, [sp, #10]
1445:bluetooth_rxtx.c **** 		reverse8(0x44),
 4102              		.loc 1 1445 0
 4103 00a6 5520     		movs	r0, #85
 4104 00a8 FFF7FEFF 		bl	reverse8
 4105              	.LVL458:
1433:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4106              		.loc 1 1433 0
 4107 00ac 8DF80B00 		strb	r0, [sp, #11]
1446:bluetooth_rxtx.c **** 		reverse8(0x33),
 4108              		.loc 1 1446 0
 4109 00b0 4420     		movs	r0, #68
 4110 00b2 FFF7FEFF 		bl	reverse8
 4111              	.LVL459:
1433:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4112              		.loc 1 1433 0
 4113 00b6 8DF80C00 		strb	r0, [sp, #12]
1447:bluetooth_rxtx.c **** 		reverse8(0x22),
 4114              		.loc 1 1447 0
 4115 00ba 3320     		movs	r0, #51
 4116 00bc FFF7FEFF 		bl	reverse8
 4117              	.LVL460:
1433:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4118              		.loc 1 1433 0
 4119 00c0 8DF80D00 		strb	r0, [sp, #13]
1448:bluetooth_rxtx.c **** 		reverse8(0x11)
 4120              		.loc 1 1448 0
 4121 00c4 2220     		movs	r0, #34
 4122 00c6 FFF7FEFF 		bl	reverse8
 4123              	.LVL461:
1433:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4124              		.loc 1 1433 0
 4125 00ca 8DF80E00 		strb	r0, [sp, #14]
1449:bluetooth_rxtx.c **** 	};
 4126              		.loc 1 1449 0
 4127 00ce 1120     		movs	r0, #17
 4128 00d0 FFF7FEFF 		bl	reverse8
 4129              	.LVL462:
 4130              	.LBB38:
 4131              	.LBB39:
1409:bluetooth_rxtx.c **** 
 4132              		.loc 1 1409 0
 4133 00d4 3C46     		mov	r4, r7
 4134              	.LBB40:
1411:bluetooth_rxtx.c **** 	{
 4135              		.loc 1 1411 0
 4136 00d6 3B46     		mov	r3, r7
 4137              	.LBE40:
 4138              	.LBE39:
 4139              	.LBE38:
1433:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4140              		.loc 1 1433 0
 4141 00d8 8DF80F00 		strb	r0, [sp, #15]
 4142              	.LVL463:
ARM GAS  /tmp/ccDKg7Fp.s 			page 122


 4143              	.L466:
 4144              	.LBB43:
 4145              	.LBB42:
 4146              	.LBB41:
1413:bluetooth_rxtx.c **** 	}
 4147              		.loc 1 1413 0
 4148 00dc 48FA03F2 		asr	r2, r8, r3
 4149 00e0 C3F10F01 		rsb	r1, r3, #15
 4150 00e4 02F00102 		and	r2, r2, #1
 4151 00e8 8A40     		lsls	r2, r2, r1
1411:bluetooth_rxtx.c **** 	{
 4152              		.loc 1 1411 0
 4153 00ea 0133     		adds	r3, r3, #1
 4154              	.LVL464:
1413:bluetooth_rxtx.c **** 	}
 4155              		.loc 1 1413 0
 4156 00ec 1443     		orrs	r4, r4, r2
 4157              	.LVL465:
1411:bluetooth_rxtx.c **** 	{
 4158              		.loc 1 1411 0
 4159 00ee 102B     		cmp	r3, #16
1413:bluetooth_rxtx.c **** 	}
 4160              		.loc 1 1413 0
 4161 00f0 A4B2     		uxth	r4, r4
 4162              	.LVL466:
1411:bluetooth_rxtx.c **** 	{
 4163              		.loc 1 1411 0
 4164 00f2 F3D1     		bne	.L466
 4165              	.LVL467:
 4166              	.LBE41:
 4167              	.LBE42:
 4168              	.LBE43:
 4169              	.LBB44:
 4170              	.LBB45:
1052:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 4171              		.loc 1 1052 0
 4172 00f4 0D20     		movs	r0, #13
 4173 00f6 47F6FF71 		movw	r1, #32767
 4174 00fa FFF7FEFF 		bl	cc2400_set
 4175              	.LVL468:
1053:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
 4176              		.loc 1 1053 0
 4177 00fe 1220     		movs	r0, #18
 4178 0100 42F62231 		movw	r1, #11042
 4179 0104 FFF7FEFF 		bl	cc2400_set
 4180              	.LVL469:
1054:bluetooth_rxtx.c **** 
 4181              		.loc 1 1054 0
 4182 0108 1420     		movs	r0, #20
 4183 010a 41F24B31 		movw	r1, #4939
 4184 010e FFF7FEFF 		bl	cc2400_set
 4185              	.LVL470:
1056:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
 4186              		.loc 1 1056 0
 4187 0112 2020     		movs	r0, #32
 4188 0114 40F60141 		movw	r1, #3073
 4189 0118 FFF7FEFF 		bl	cc2400_set
ARM GAS  /tmp/ccDKg7Fp.s 			page 123


 4190              	.LVL471:
1064:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
 4191              		.loc 1 1064 0
 4192 011c 2146     		mov	r1, r4
 4193 011e 2C20     		movs	r0, #44
 4194 0120 FFF7FEFF 		bl	cc2400_set
 4195              	.LVL472:
1065:bluetooth_rxtx.c **** 
 4196              		.loc 1 1065 0
 4197 0124 2D20     		movs	r0, #45
 4198 0126 0021     		movs	r1, #0
 4199 0128 FFF7FEFF 		bl	cc2400_set
 4200              	.LVL473:
1067:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 4201              		.loc 1 1067 0
 4202 012c 4A4B     		ldr	r3, .L503+4
 4203 012e 0220     		movs	r0, #2
 4204 0130 1988     		ldrh	r1, [r3]
1070:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
 4205              		.loc 1 1070 0
 4206 0132 4A4C     		ldr	r4, .L503+8
 4207              	.LVL474:
1067:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 4208              		.loc 1 1067 0
 4209 0134 89B2     		uxth	r1, r1
 4210 0136 FFF7FEFF 		bl	cc2400_set
 4211              	.LVL475:
1068:bluetooth_rxtx.c **** 
 4212              		.loc 1 1068 0
 4213 013a 0520     		movs	r0, #5
 4214 013c 0B21     		movs	r1, #11
 4215 013e FFF7FEFF 		bl	cc2400_set
 4216              	.LVL476:
1070:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
 4217              		.loc 1 1070 0
 4218 0142 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 4219 0144 13B9     		cbnz	r3, .L467
1071:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
 4220              		.loc 1 1071 0
 4221 0146 0320     		movs	r0, #3
 4222 0148 2921     		movs	r1, #41
 4223 014a 04E0     		b	.L501
 4224              	.L467:
1072:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
 4225              		.loc 1 1072 0
 4226 014c 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 4227 014e 012B     		cmp	r3, #1
 4228 0150 1DD1     		bne	.L469
1073:bluetooth_rxtx.c **** 	} else {
 4229              		.loc 1 1073 0
 4230 0152 0320     		movs	r0, #3
 4231 0154 4021     		movs	r1, #64
 4232              	.L501:
 4233 0156 FFF7FEFF 		bl	cc2400_set
 4234              	.LVL477:
1079:bluetooth_rxtx.c **** 
 4235              		.loc 1 1079 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 124


 4236 015a FFF7FEFF 		bl	clkn_start
 4237              	.LVL478:
 4238              	.L470:
1081:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 4239              		.loc 1 1081 0
 4240 015e FFF7FEFF 		bl	cc2400_status
 4241              	.LVL479:
 4242 0162 4506     		lsls	r5, r0, #25
 4243 0164 FBD5     		bpl	.L470
1082:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 4244              		.loc 1 1082 0
 4245 0166 6120     		movs	r0, #97
 4246 0168 FFF7FEFF 		bl	cc2400_strobe
 4247              	.LVL480:
 4248              	.L471:
1083:bluetooth_rxtx.c **** 
 4249              		.loc 1 1083 0
 4250 016c FFF7FEFF 		bl	cc2400_status
 4251              	.LVL481:
 4252 0170 4007     		lsls	r0, r0, #29
 4253 0172 FBD5     		bpl	.L471
1086:bluetooth_rxtx.c **** #endif
 4254              		.loc 1 1086 0
 4255 0174 3A4B     		ldr	r3, .L503+12
 4256 0176 8022     		movs	r2, #128
 4257 0178 1A60     		str	r2, [r3]
 4258              	.L472:
1089:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 4259              		.loc 1 1089 0
 4260 017a 0E20     		movs	r0, #14
 4261 017c FFF7FEFF 		bl	cc2400_get
 4262              	.LVL482:
 4263 0180 00F01F00 		and	r0, r0, #31
 4264 0184 0F28     		cmp	r0, #15
 4265 0186 F8D1     		bne	.L472
1090:bluetooth_rxtx.c **** 
 4266              		.loc 1 1090 0
 4267 0188 6320     		movs	r0, #99
 4268 018a FFF7FEFF 		bl	cc2400_strobe
 4269              	.LVL483:
 4270              	.L469:
 4271              	.LBE45:
 4272              	.LBE44:
1454:bluetooth_rxtx.c **** 
 4273              		.loc 1 1454 0 discriminator 4
 4274 018e 1421     		movs	r1, #20
 4275 0190 2320     		movs	r0, #35
 4276 0192 FFF7FEFF 		bl	cc2400_set
 4277              	.LVL484:
1457:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 4278              		.loc 1 1457 0 discriminator 4
 4279 0196 0820     		movs	r0, #8
 4280 0198 FFF7FEFF 		bl	cc2400_get
 4281              	.LVL485:
1458:bluetooth_rxtx.c **** 
 4282              		.loc 1 1458 0 discriminator 4
 4283 019c C0F30801 		ubfx	r1, r0, #0, #9
ARM GAS  /tmp/ccDKg7Fp.s 			page 125


1457:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 4284              		.loc 1 1457 0 discriminator 4
 4285 01a0 0746     		mov	r7, r0
 4286              	.LVL486:
1458:bluetooth_rxtx.c **** 
 4287              		.loc 1 1458 0 discriminator 4
 4288 01a2 41F49C41 		orr	r1, r1, #19968
 4289 01a6 0820     		movs	r0, #8
 4290              	.LVL487:
 4291 01a8 FFF7FEFF 		bl	cc2400_set
 4292              	.LVL488:
1428:bluetooth_rxtx.c **** 
 4293              		.loc 1 1428 0 discriminator 4
 4294 01ac 0026     		movs	r6, #0
 4295              	.LVL489:
 4296              	.L473:
1460:bluetooth_rxtx.c **** 	{
 4297              		.loc 1 1460 0
 4298 01ae A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 4299 01b0 022B     		cmp	r3, #2
 4300 01b2 45D1     		bne	.L481
1463:bluetooth_rxtx.c **** 
 4301              		.loc 1 1463 0
 4302 01b4 7608     		lsrs	r6, r6, #1
 4303              	.LVL490:
 4304              	.L474:
 4305 01b6 2B4D     		ldr	r5, .L503+16
 4306 01b8 2B68     		ldr	r3, [r5]
 4307 01ba B6EB530F 		cmp	r6, r3, lsr #1
 4308 01be 05D1     		bne	.L502
 4309              	.L475:
1466:bluetooth_rxtx.c **** 				hop();
 4310              		.loc 1 1466 0
 4311 01c0 E37A     		ldrb	r3, [r4, #11]	@ zero_extendqisi2
 4312 01c2 002B     		cmp	r3, #0
 4313 01c4 F7D0     		beq	.L474
1467:bluetooth_rxtx.c **** 			}
 4314              		.loc 1 1467 0
 4315 01c6 FFF7FEFF 		bl	hop
 4316              	.LVL491:
 4317 01ca F4E7     		b	.L474
 4318              	.L502:
1463:bluetooth_rxtx.c **** 
 4319              		.loc 1 1463 0 discriminator 1
 4320 01cc 264B     		ldr	r3, .L503+20
 4321 01ce 1A68     		ldr	r2, [r3]
 4322 01d0 40F6C903 		movw	r3, #2249
 4323 01d4 9A42     		cmp	r2, r3
 4324 01d6 F3D9     		bls	.L475
1473:bluetooth_rxtx.c **** 
 4325              		.loc 1 1473 0
 4326 01d8 244B     		ldr	r3, .L503+24
 4327 01da 4FF48072 		mov	r2, #256
1471:bluetooth_rxtx.c **** 
 4328              		.loc 1 1471 0
 4329 01de 2E68     		ldr	r6, [r5]
 4330              	.LVL492:
ARM GAS  /tmp/ccDKg7Fp.s 			page 126


1475:bluetooth_rxtx.c **** 
 4331              		.loc 1 1475 0
 4332 01e0 1020     		movs	r0, #16
1473:bluetooth_rxtx.c **** 
 4333              		.loc 1 1473 0
 4334 01e2 1A60     		str	r2, [r3]
1475:bluetooth_rxtx.c **** 
 4335              		.loc 1 1475 0
 4336 01e4 6946     		mov	r1, sp
 4337 01e6 FFF7FEFF 		bl	cc2400_fifo_write
 4338              	.LVL493:
 4339              	.L476:
1477:bluetooth_rxtx.c **** 		TXLED_CLR;
 4340              		.loc 1 1477 0 discriminator 1
 4341 01ea 0E20     		movs	r0, #14
 4342 01ec FFF7FEFF 		bl	cc2400_get
 4343              	.LVL494:
 4344 01f0 00F01F00 		and	r0, r0, #31
 4345 01f4 0F28     		cmp	r0, #15
 4346 01f6 F8D1     		bne	.L476
1478:bluetooth_rxtx.c **** 
 4347              		.loc 1 1478 0
 4348 01f8 1D4B     		ldr	r3, .L503+28
 4349 01fa 4FF48072 		mov	r2, #256
 4350 01fe 1A60     		str	r2, [r3]
1480:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
 4351              		.loc 1 1480 0
 4352 0200 6420     		movs	r0, #100
 4353 0202 FFF7FEFF 		bl	cc2400_strobe
 4354              	.LVL495:
 4355              	.L477:
1481:bluetooth_rxtx.c **** 
 4356              		.loc 1 1481 0 discriminator 1
 4357 0206 FFF7FEFF 		bl	cc2400_status
 4358              	.LVL496:
 4359 020a 4107     		lsls	r1, r0, #29
 4360 020c FBD4     		bmi	.L477
 4361              	.L478:
1483:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 4362              		.loc 1 1483 0 discriminator 1
 4363 020e FFF7FEFF 		bl	cc2400_status
 4364              	.LVL497:
 4365 0212 4206     		lsls	r2, r0, #25
 4366 0214 FBD5     		bpl	.L478
1484:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
 4367              		.loc 1 1484 0
 4368 0216 6120     		movs	r0, #97
 4369 0218 FFF7FEFF 		bl	cc2400_strobe
 4370              	.LVL498:
 4371              	.L479:
1485:bluetooth_rxtx.c **** 
 4372              		.loc 1 1485 0 discriminator 1
 4373 021c FFF7FEFF 		bl	cc2400_status
 4374              	.LVL499:
 4375 0220 4307     		lsls	r3, r0, #29
 4376 0222 FBD5     		bpl	.L479
 4377              	.L490:
ARM GAS  /tmp/ccDKg7Fp.s 			page 127


1487:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
 4378              		.loc 1 1487 0 discriminator 1
 4379 0224 0E20     		movs	r0, #14
 4380 0226 FFF7FEFF 		bl	cc2400_get
 4381              	.LVL500:
 4382 022a 00F01F00 		and	r0, r0, #31
 4383 022e 0F28     		cmp	r0, #15
 4384 0230 F8D1     		bne	.L490
1488:bluetooth_rxtx.c **** 
 4385              		.loc 1 1488 0
 4386 0232 6320     		movs	r0, #99
 4387 0234 FFF7FEFF 		bl	cc2400_strobe
 4388              	.LVL501:
1490:bluetooth_rxtx.c **** 	}
 4389              		.loc 1 1490 0
 4390 0238 2868     		ldr	r0, [r5]
 4391 023a FFF7FEFF 		bl	handle_usb
 4392              	.LVL502:
 4393 023e B6E7     		b	.L473
 4394              	.L481:
1494:bluetooth_rxtx.c **** #endif
 4395              		.loc 1 1494 0
 4396 0240 0C4B     		ldr	r3, .L503+32
 4397 0242 8022     		movs	r2, #128
 4398 0244 1A60     		str	r2, [r3]
1498:bluetooth_rxtx.c **** }
 4399              		.loc 1 1498 0
 4400 0246 0820     		movs	r0, #8
 4401 0248 3946     		mov	r1, r7
 4402 024a FFF7FEFF 		bl	cc2400_set
 4403              	.LVL503:
1499:bluetooth_rxtx.c **** 
 4404              		.loc 1 1499 0
 4405 024e 04B0     		add	sp, sp, #16
 4406              		.cfi_def_cfa_offset 24
 4407              		@ sp needed
 4408 0250 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 4409              	.LVL504:
 4410              	.L504:
 4411              		.align	2
 4412              	.L503:
 4413 0254 00000000 		.word	target
 4414 0258 00000000 		.word	.LANCHOR1
 4415 025c 00000000 		.word	.LANCHOR0
 4416 0260 58C00920 		.word	537509976
 4417 0264 00000000 		.word	clkn
 4418 0268 08400040 		.word	1073758216
 4419 026c 38C00920 		.word	537509944
 4420 0270 3CC00920 		.word	537509948
 4421 0274 5CC00920 		.word	537509980
 4422              		.cfi_endproc
 4423              	.LFE18:
 4425              		.section	.text.reset_le,"ax",%progbits
 4426              		.align	1
 4427              		.global	reset_le
 4428              		.thumb
 4429              		.thumb_func
ARM GAS  /tmp/ccDKg7Fp.s 			page 128


 4431              	reset_le:
 4432              	.LFB20:
1512:bluetooth_rxtx.c **** 	le_set_access_address(0x8e89bed6);     // advertising channel access address
 4433              		.loc 1 1512 0
 4434              		.cfi_startproc
 4435              		@ args = 0, pretend = 0, frame = 0
 4436              		@ frame_needed = 0, uses_anonymous_args = 0
 4437 0000 08B5     		push	{r3, lr}
 4438              		.cfi_def_cfa_offset 8
 4439              		.cfi_offset 3, -8
 4440              		.cfi_offset 14, -4
1513:bluetooth_rxtx.c **** 	le.crc_init  = 0x555555;               // advertising channel CRCInit
 4441              		.loc 1 1513 0
 4442 0002 0F48     		ldr	r0, .L506
 4443 0004 FFF7FEFF 		bl	le_set_access_address
 4444              	.LVL505:
1514:bluetooth_rxtx.c **** 	le.crc_init_reversed = 0xAAAAAA;
 4445              		.loc 1 1514 0
 4446 0008 0E4B     		ldr	r3, .L506+4
 4447 000a 0F4A     		ldr	r2, .L506+8
 4448 000c DA60     		str	r2, [r3, #12]
1515:bluetooth_rxtx.c **** 	le.crc_verify = 0;
 4449              		.loc 1 1515 0
 4450 000e 0F4A     		ldr	r2, .L506+12
 4451 0010 1A61     		str	r2, [r3, #16]
1516:bluetooth_rxtx.c **** 	le.last_packet = 0;
 4452              		.loc 1 1516 0
 4453 0012 0022     		movs	r2, #0
1525:bluetooth_rxtx.c **** 	le.conn_interval = 0;
 4454              		.loc 1 1525 0
 4455 0014 1A84     		strh	r2, [r3, #32]	@ movhi
1516:bluetooth_rxtx.c **** 	le.last_packet = 0;
 4456              		.loc 1 1516 0
 4457 0016 5A61     		str	r2, [r3, #20]
1528:bluetooth_rxtx.c **** 
 4458              		.loc 1 1528 0
 4459 0018 9A84     		strh	r2, [r3, #36]	@ movhi
1517:bluetooth_rxtx.c **** 
 4460              		.loc 1 1517 0
 4461 001a DA64     		str	r2, [r3, #76]
1519:bluetooth_rxtx.c **** 
 4462              		.loc 1 1519 0
 4463 001c 1A76     		strb	r2, [r3, #24]
1521:bluetooth_rxtx.c **** 	le.channel_increment = 0;
 4464              		.loc 1 1521 0
 4465 001e 5A76     		strb	r2, [r3, #25]
1522:bluetooth_rxtx.c **** 
 4466              		.loc 1 1522 0
 4467 0020 9A76     		strb	r2, [r3, #26]
1524:bluetooth_rxtx.c **** 	le.interval_timer = 0;
 4468              		.loc 1 1524 0
 4469 0022 DA61     		str	r2, [r3, #28]
1526:bluetooth_rxtx.c **** 	le.conn_interval = 0;
 4470              		.loc 1 1526 0
 4471 0024 5A84     		strh	r2, [r3, #34]	@ movhi
1530:bluetooth_rxtx.c **** 	le.win_offset = 0;
 4472              		.loc 1 1530 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 129


 4473 0026 83F82620 		strb	r2, [r3, #38]
1531:bluetooth_rxtx.c **** 
 4474              		.loc 1 1531 0
 4475 002a 1A85     		strh	r2, [r3, #40]	@ movhi
1533:bluetooth_rxtx.c **** 	le.update_instant = 0;
 4476              		.loc 1 1533 0
 4477 002c DA62     		str	r2, [r3, #44]
1534:bluetooth_rxtx.c **** 	le.interval_update = 0;
 4478              		.loc 1 1534 0
 4479 002e 1A86     		strh	r2, [r3, #48]	@ movhi
1535:bluetooth_rxtx.c **** 	le.win_size_update = 0;
 4480              		.loc 1 1535 0
 4481 0030 5A86     		strh	r2, [r3, #50]	@ movhi
1536:bluetooth_rxtx.c **** 	le.win_offset_update = 0;
 4482              		.loc 1 1536 0
 4483 0032 83F83420 		strb	r2, [r3, #52]
1537:bluetooth_rxtx.c **** 
 4484              		.loc 1 1537 0
 4485 0036 DA86     		strh	r2, [r3, #54]	@ movhi
1539:bluetooth_rxtx.c **** }
 4486              		.loc 1 1539 0
 4487 0038 054B     		ldr	r3, .L506+16
 4488 003a DA72     		strb	r2, [r3, #11]
 4489 003c 08BD     		pop	{r3, pc}
 4490              	.L507:
 4491 003e 00BF     		.align	2
 4492              	.L506:
 4493 0040 D6BE898E 		.word	-1903575338
 4494 0044 00000000 		.word	.LANCHOR1
 4495 0048 55555500 		.word	5592405
 4496 004c AAAAAA00 		.word	11184810
 4497 0050 00000000 		.word	.LANCHOR0
 4498              		.cfi_endproc
 4499              	.LFE20:
 4501              		.section	.text.reset_le_promisc,"ax",%progbits
 4502              		.align	1
 4503              		.global	reset_le_promisc
 4504              		.thumb
 4505              		.thumb_func
 4507              	reset_le_promisc:
 4508              	.LFB21:
1543:bluetooth_rxtx.c **** 	memset(&le_promisc, 0, sizeof(le_promisc));
 4509              		.loc 1 1543 0
 4510              		.cfi_startproc
 4511              		@ args = 0, pretend = 0, frame = 0
 4512              		@ frame_needed = 0, uses_anonymous_args = 0
 4513 0000 10B5     		push	{r4, lr}
 4514              		.cfi_def_cfa_offset 8
 4515              		.cfi_offset 4, -8
 4516              		.cfi_offset 14, -4
1544:bluetooth_rxtx.c **** 	le_promisc.smallest_hop_interval = 0xffffffff;
 4517              		.loc 1 1544 0
 4518 0002 064C     		ldr	r4, .L509
 4519 0004 0021     		movs	r1, #0
 4520 0006 2046     		mov	r0, r4
 4521 0008 4FF48472 		mov	r2, #264
 4522 000c FFF7FEFF 		bl	memset
ARM GAS  /tmp/ccDKg7Fp.s 			page 130


 4523              	.LVL506:
1545:bluetooth_rxtx.c **** }
 4524              		.loc 1 1545 0
 4525 0010 4FF0FF33 		mov	r3, #-1
 4526 0014 C4F80031 		str	r3, [r4, #256]
 4527 0018 10BD     		pop	{r4, pc}
 4528              	.L510:
 4529 001a 00BF     		.align	2
 4530              	.L509:
 4531 001c 00000000 		.word	le_promisc
 4532              		.cfi_endproc
 4533              	.LFE21:
 4535              		.section	.text.bt_generic_le,"ax",%progbits
 4536              		.align	1
 4537              		.global	bt_generic_le
 4538              		.thumb
 4539              		.thumb_func
 4541              	bt_generic_le:
 4542              	.LFB22:
1550:bluetooth_rxtx.c **** 	u8 hold;
 4543              		.loc 1 1550 0
 4544              		.cfi_startproc
 4545              		@ args = 0, pretend = 0, frame = 0
 4546              		@ frame_needed = 0, uses_anonymous_args = 0
 4547              	.LVL507:
 4548 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 4549              		.cfi_def_cfa_offset 32
 4550              		.cfi_offset 4, -32
 4551              		.cfi_offset 5, -28
 4552              		.cfi_offset 6, -24
 4553              		.cfi_offset 7, -20
 4554              		.cfi_offset 8, -16
 4555              		.cfi_offset 9, -12
 4556              		.cfi_offset 10, -8
 4557              		.cfi_offset 14, -4
1555:bluetooth_rxtx.c **** 	mode = active_mode;
 4558              		.loc 1 1555 0
 4559 0004 6A4C     		ldr	r4, .L556
 4560 0006 0123     		movs	r3, #1
1550:bluetooth_rxtx.c **** 	u8 hold;
 4561              		.loc 1 1550 0
 4562 0008 8246     		mov	r10, r0
1555:bluetooth_rxtx.c **** 	mode = active_mode;
 4563              		.loc 1 1555 0
 4564 000a 2370     		strb	r3, [r4]
1556:bluetooth_rxtx.c **** 
 4565              		.loc 1 1556 0
 4566 000c 6074     		strb	r0, [r4, #17]
1558:bluetooth_rxtx.c **** 
 4567              		.loc 1 1558 0
 4568 000e FFF7FEFF 		bl	reset_le
 4569              	.LVL508:
1561:bluetooth_rxtx.c **** 
 4570              		.loc 1 1561 0
 4571 0012 684B     		ldr	r3, .L556+4
 4572 0014 4FF08072 		mov	r2, #16777216
1563:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccDKg7Fp.s 			page 131


 4573              		.loc 1 1563 0
 4574 0018 674F     		ldr	r7, .L556+8
1561:bluetooth_rxtx.c **** 
 4575              		.loc 1 1561 0
 4576 001a 1A60     		str	r2, [r3]
1563:bluetooth_rxtx.c **** 
 4577              		.loc 1 1563 0
 4578 001c 1023     		movs	r3, #16
 4579 001e 3B60     		str	r3, [r7]
1565:bluetooth_rxtx.c **** 	dio_ssp_init();
 4580              		.loc 1 1565 0
 4581 0020 FFF7FEFF 		bl	usb_queue_init
 4582              	.LVL509:
1566:bluetooth_rxtx.c **** 	dma_init_rx_symbols();
 4583              		.loc 1 1566 0
 4584 0024 FFF7FEFF 		bl	dio_ssp_init
 4585              	.LVL510:
1567:bluetooth_rxtx.c **** 	dio_ssp_start();
 4586              		.loc 1 1567 0
 4587 0028 FFF7FEFF 		bl	dma_init_rx_symbols
 4588              	.LVL511:
1568:bluetooth_rxtx.c **** 	cc2400_rx();
 4589              		.loc 1 1568 0
 4590 002c FFF7FEFF 		bl	dio_ssp_start
 4591              	.LVL512:
1569:bluetooth_rxtx.c **** 
 4592              		.loc 1 1569 0
 4593 0030 FFF7FEFF 		bl	cc2400_rx
 4594              	.LVL513:
1571:bluetooth_rxtx.c **** 
 4595              		.loc 1 1571 0
 4596 0034 FFF7FEFF 		bl	cs_trigger_enable
 4597              	.LVL514:
1573:bluetooth_rxtx.c **** 
 4598              		.loc 1 1573 0
 4599 0038 0026     		movs	r6, #0
 4600              	.LVL515:
 4601              	.L512:
1575:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 4602              		.loc 1 1575 0
 4603 003a A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 4604 003c 5345     		cmp	r3, r10
 4605 003e 40F0A580 		bne	.L533
 4606              	.LBB46:
1576:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 4607              		.loc 1 1576 0
 4608 0042 5B4B     		ldr	r3, .L556
 4609 0044 DB89     		ldrh	r3, [r3, #14]
 4610 0046 9BB2     		uxth	r3, r3
 4611 0048 CBB1     		cbz	r3, .L513
1577:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 4612              		.loc 1 1577 0
 4613 004a 6420     		movs	r0, #100
 4614 004c FFF7FEFF 		bl	cc2400_strobe
 4615              	.LVL516:
 4616              	.L514:
1578:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccDKg7Fp.s 			page 132


 4617              		.loc 1 1578 0 discriminator 1
 4618 0050 FFF7FEFF 		bl	cc2400_status
 4619              	.LVL517:
 4620 0054 4207     		lsls	r2, r0, #29
 4621 0056 FBD4     		bmi	.L514
1581:bluetooth_rxtx.c **** 
 4622              		.loc 1 1581 0
 4623 0058 584B     		ldr	r3, .L556+12
 4624 005a 0220     		movs	r0, #2
 4625 005c 1988     		ldrh	r1, [r3]
 4626 005e 0139     		subs	r1, r1, #1
 4627 0060 89B2     		uxth	r1, r1
 4628 0062 FFF7FEFF 		bl	cc2400_set
 4629              	.LVL518:
1584:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 4630              		.loc 1 1584 0
 4631 0066 6120     		movs	r0, #97
 4632 0068 FFF7FEFF 		bl	cc2400_strobe
 4633              	.LVL519:
 4634              	.L515:
1585:bluetooth_rxtx.c **** 
 4635              		.loc 1 1585 0 discriminator 1
 4636 006c FFF7FEFF 		bl	cc2400_status
 4637              	.LVL520:
 4638 0070 4307     		lsls	r3, r0, #29
 4639 0072 FBD5     		bpl	.L515
1588:bluetooth_rxtx.c **** 
 4640              		.loc 1 1588 0
 4641 0074 6220     		movs	r0, #98
 4642 0076 FFF7FEFF 		bl	cc2400_strobe
 4643              	.LVL521:
1590:bluetooth_rxtx.c **** 		}
 4644              		.loc 1 1590 0
 4645 007a 0023     		movs	r3, #0
 4646 007c E381     		strh	r3, [r4, #14]	@ movhi
 4647              	.L513:
1593:bluetooth_rxtx.c **** 			hop();
 4648              		.loc 1 1593 0
 4649 007e E37A     		ldrb	r3, [r4, #11]	@ zero_extendqisi2
 4650 0080 13B1     		cbz	r3, .L516
1594:bluetooth_rxtx.c **** 		} else {
 4651              		.loc 1 1594 0
 4652 0082 FFF7FEFF 		bl	hop
 4653              	.LVL522:
 4654 0086 02E0     		b	.L517
 4655              	.L516:
1596:bluetooth_rxtx.c **** 		}
 4656              		.loc 1 1596 0
 4657 0088 4FF48073 		mov	r3, #256
 4658 008c 3B60     		str	r3, [r7]
 4659              	.L517:
1599:bluetooth_rxtx.c **** 
 4660              		.loc 1 1599 0
 4661 008e 1023     		movs	r3, #16
 4662 0090 3B60     		str	r3, [r7]
1602:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
 4663              		.loc 1 1602 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 133


 4664 0092 FFF7FEFF 		bl	rssi_reset
 4665              	.LVL523:
1603:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0))
 4666              		.loc 1 1603 0
 4667 0096 8025     		movs	r5, #128
 4668              	.LVL524:
 4669              	.L518:
1604:bluetooth_rxtx.c **** 		{
 4670              		.loc 1 1604 0
 4671 0098 494B     		ldr	r3, .L556+16
 4672 009a DFF84491 		ldr	r9, .L556+48
 4673 009e 1A68     		ldr	r2, [r3]
 4674 00a0 9846     		mov	r8, r3
 4675 00a2 D2B9     		cbnz	r2, .L520
1604:bluetooth_rxtx.c **** 		{
 4676              		.loc 1 1604 0 is_stmt 0 discriminator 1
 4677 00a4 D9F80030 		ldr	r3, [r9]
 4678 00a8 BBB9     		cbnz	r3, .L520
1606:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 4679              		.loc 1 1606 0 is_stmt 1
 4680 00aa 0620     		movs	r0, #6
 4681 00ac FFF7FEFF 		bl	cc2400_get
 4682              	.LVL525:
1607:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4683              		.loc 1 1607 0
 4684 00b0 444B     		ldr	r3, .L556+20
1606:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 4685              		.loc 1 1606 0
 4686 00b2 C0F30720 		ubfx	r0, r0, #8, #8
 4687              	.LVL526:
1607:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4688              		.loc 1 1607 0
 4689 00b6 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 4690 00b8 5BB1     		cbz	r3, .L519
1607:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4691              		.loc 1 1607 0 is_stmt 0 discriminator 1
 4692 00ba 802D     		cmp	r5, #128
 4693 00bc 09D1     		bne	.L519
1608:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
 4694              		.loc 1 1608 0 is_stmt 1
 4695 00be 424B     		ldr	r3, .L556+24
 4696 00c0 40B2     		sxtb	r0, r0
 4697 00c2 93F90050 		ldrsb	r5, [r3]
 4698              	.LVL527:
 4699 00c6 3635     		adds	r5, r5, #54
 4700 00c8 A842     		cmp	r0, r5
 4701 00ca B8BF     		it	lt
 4702 00cc 2846     		movlt	r0, r5
 4703              	.LVL528:
 4704 00ce C5B2     		uxtb	r5, r0
1609:bluetooth_rxtx.c **** 			}
 4705              		.loc 1 1609 0
 4706 00d0 2846     		mov	r0, r5
 4707              	.L519:
 4708              	.LVL529:
1611:bluetooth_rxtx.c **** 		}
 4709              		.loc 1 1611 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 134


 4710 00d2 40B2     		sxtb	r0, r0
 4711 00d4 FFF7FEFF 		bl	rssi_add
 4712              	.LVL530:
 4713 00d8 DEE7     		b	.L518
 4714              	.L520:
1614:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 4715              		.loc 1 1614 0
 4716 00da D9F80030 		ldr	r3, [r9]
 4717 00de 1BB1     		cbz	r3, .L522
1615:bluetooth_rxtx.c **** 		}
 4718              		.loc 1 1615 0
 4719 00e0 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 4720 00e2 43F00203 		orr	r3, r3, #2
 4721 00e6 6370     		strb	r3, [r4, #1]
 4722              	.L522:
1619:bluetooth_rxtx.c **** 			goto rx_continue;
 4723              		.loc 1 1619 0
 4724 00e8 D8F80030 		ldr	r3, [r8]
 4725 00ec 002B     		cmp	r3, #0
 4726 00ee 59D0     		beq	.L523
1623:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
 4727              		.loc 1 1623 0
 4728 00f0 334B     		ldr	r3, .L556+16
 4729 00f2 1B68     		ldr	r3, [r3]
 4730 00f4 012B     		cmp	r3, #1
1624:bluetooth_rxtx.c **** 
 4731              		.loc 1 1624 0
 4732 00f6 82BF     		ittt	hi
 4733 00f8 6378     		ldrbhi	r3, [r4, #1]	@ zero_extendqisi2
 4734 00fa 43F00103 		orrhi	r3, r3, #1
 4735 00fe 6370     		strbhi	r3, [r4, #1]
1626:bluetooth_rxtx.c **** 
 4736              		.loc 1 1626 0
 4737 0100 2E4B     		ldr	r3, .L556+12
 4738 0102 1888     		ldrh	r0, [r3]
 4739 0104 80B2     		uxth	r0, r0
 4740 0106 FFF7FEFF 		bl	rssi_iir_update
 4741              	.LVL531:
1632:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 4742              		.loc 1 1632 0
 4743 010a 2E4A     		ldr	r2, .L556+20
 4744 010c 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 4745 010e 13B9     		cbnz	r3, .L525
1632:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 4746              		.loc 1 1632 0 is_stmt 0 discriminator 1
 4747 0110 2E4B     		ldr	r3, .L556+28
 4748 0112 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 4749 0114 33B1     		cbz	r3, .L526
 4750              	.L525:
1633:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4751              		.loc 1 1633 0 is_stmt 1
 4752 0116 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
1634:bluetooth_rxtx.c **** 			cs_trigger = 0;
 4753              		.loc 1 1634 0
 4754 0118 0226     		movs	r6, #2
 4755              	.LVL532:
1633:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
ARM GAS  /tmp/ccDKg7Fp.s 			page 135


 4756              		.loc 1 1633 0
 4757 011a 43F00803 		orr	r3, r3, #8
 4758 011e 6370     		strb	r3, [r4, #1]
 4759              	.LVL533:
1635:bluetooth_rxtx.c **** 		}
 4760              		.loc 1 1635 0
 4761 0120 0023     		movs	r3, #0
 4762 0122 1370     		strb	r3, [r2]
 4763              	.LVL534:
 4764              	.L526:
1638:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
 4765              		.loc 1 1638 0
 4766 0124 284B     		ldr	r3, .L556+24
 4767 0126 2A4A     		ldr	r2, .L556+32
 4768 0128 93F90030 		ldrsb	r3, [r3]
 4769 012c 92F90020 		ldrsb	r2, [r2]
 4770 0130 3533     		adds	r3, r3, #53
 4771 0132 9342     		cmp	r3, r2
 4772 0134 05DA     		bge	.L527
1639:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4773              		.loc 1 1639 0
 4774 0136 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
1640:bluetooth_rxtx.c **** 		}
 4775              		.loc 1 1640 0
 4776 0138 0226     		movs	r6, #2
 4777              	.LVL535:
1639:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4778              		.loc 1 1639 0
 4779 013a 43F01003 		orr	r3, r3, #16
 4780 013e 6370     		strb	r3, [r4, #1]
 4781              	.LVL536:
 4782 0140 00E0     		b	.L528
 4783              	.LVL537:
 4784              	.L527:
1644:bluetooth_rxtx.c **** 			goto rx_continue;
 4785              		.loc 1 1644 0
 4786 0142 7EB3     		cbz	r6, .L523
 4787              	.LVL538:
 4788              	.L528:
1650:bluetooth_rxtx.c **** 
 4789              		.loc 1 1650 0
 4790 0144 2348     		ldr	r0, .L556+36
 4791 0146 4FF4C872 		mov	r2, #400
1647:bluetooth_rxtx.c **** 
 4792              		.loc 1 1647 0
 4793 014a 013E     		subs	r6, r6, #1
 4794              	.LVL539:
1650:bluetooth_rxtx.c **** 
 4795              		.loc 1 1650 0
 4796 014c 00F5C871 		add	r1, r0, #400
 4797 0150 FFF7FEFF 		bl	memcpy
 4798              	.LVL540:
1647:bluetooth_rxtx.c **** 
 4799              		.loc 1 1647 0
 4800 0154 F6B2     		uxtb	r6, r6
 4801              	.LVL541:
1653:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
ARM GAS  /tmp/ccDKg7Fp.s 			page 136


 4802              		.loc 1 1653 0
 4803 0156 0022     		movs	r2, #0
 4804              	.LVL542:
 4805              	.L529:
 4806 0158 1E4B     		ldr	r3, .L556+36
 4807 015a 02F13200 		add	r0, r2, #50
 4808 015e 03EBC000 		add	r0, r3, r0, lsl #3
1640:bluetooth_rxtx.c **** 		}
 4809              		.loc 1 1640 0
 4810 0162 0021     		movs	r1, #0
 4811              	.LVL543:
 4812              	.L530:
1656:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
 4813              		.loc 1 1656 0 discriminator 3
 4814 0164 1C4D     		ldr	r5, .L556+40
 4815 0166 2B68     		ldr	r3, [r5]
 4816 0168 9B5C     		ldrb	r3, [r3, r2]	@ zero_extendqisi2
1657:bluetooth_rxtx.c **** 			}
 4817              		.loc 1 1657 0 discriminator 3
 4818 016a 2D68     		ldr	r5, [r5]
1656:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
 4819              		.loc 1 1656 0 discriminator 3
 4820 016c DB09     		lsrs	r3, r3, #7
 4821 016e 4354     		strb	r3, [r0, r1]
1657:bluetooth_rxtx.c **** 			}
 4822              		.loc 1 1657 0 discriminator 3
 4823 0170 AB5C     		ldrb	r3, [r5, r2]	@ zero_extendqisi2
1655:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 4824              		.loc 1 1655 0 discriminator 3
 4825 0172 0131     		adds	r1, r1, #1
 4826              	.LVL544:
1657:bluetooth_rxtx.c **** 			}
 4827              		.loc 1 1657 0 discriminator 3
 4828 0174 5B00     		lsls	r3, r3, #1
 4829 0176 DBB2     		uxtb	r3, r3
1655:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 4830              		.loc 1 1655 0 discriminator 3
 4831 0178 0829     		cmp	r1, #8
1657:bluetooth_rxtx.c **** 			}
 4832              		.loc 1 1657 0 discriminator 3
 4833 017a AB54     		strb	r3, [r5, r2]
1655:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 4834              		.loc 1 1655 0 discriminator 3
 4835 017c F2D1     		bne	.L530
1653:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
 4836              		.loc 1 1653 0 discriminator 2
 4837 017e 0132     		adds	r2, r2, #1
 4838              	.LVL545:
 4839 0180 322A     		cmp	r2, #50
 4840 0182 E9D1     		bne	.L529
1661:bluetooth_rxtx.c **** 		if (!ret) break;
 4841              		.loc 1 1661 0
 4842 0184 E36A     		ldr	r3, [r4, #44]
 4843 0186 1348     		ldr	r0, .L556+36
 4844 0188 9847     		blx	r3
 4845              	.LVL546:
1662:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccDKg7Fp.s 			page 137


 4846              		.loc 1 1662 0
 4847 018a 58B9     		cbnz	r0, .L523
 4848              	.LVL547:
 4849              	.L533:
 4850              	.LBE46:
1670:bluetooth_rxtx.c **** 
 4851              		.loc 1 1670 0
 4852 018c 134B     		ldr	r3, .L556+44
 4853 018e 4FF08072 		mov	r2, #16777216
 4854 0192 1A60     		str	r2, [r3]
1673:bluetooth_rxtx.c **** 	dio_ssp_stop();
 4855              		.loc 1 1673 0
 4856 0194 FFF7FEFF 		bl	cc2400_idle
 4857              	.LVL548:
1674:bluetooth_rxtx.c **** 	cs_trigger_disable();
 4858              		.loc 1 1674 0
 4859 0198 FFF7FEFF 		bl	dio_ssp_stop
 4860              	.LVL549:
1676:bluetooth_rxtx.c **** 
 4861              		.loc 1 1676 0
 4862 019c BDE8F047 		pop	{r4, r5, r6, r7, r8, r9, r10, lr}
 4863              		.cfi_remember_state
 4864              		.cfi_restore 14
 4865              		.cfi_restore 10
 4866              		.cfi_restore 9
 4867              		.cfi_restore 8
 4868              		.cfi_restore 7
 4869              		.cfi_restore 6
 4870              		.cfi_restore 5
 4871              		.cfi_restore 4
 4872              		.cfi_def_cfa_offset 0
 4873              	.LVL550:
1675:bluetooth_rxtx.c **** }
 4874              		.loc 1 1675 0
 4875 01a0 FFF7FEBF 		b	cs_trigger_disable
 4876              	.LVL551:
 4877              	.L523:
 4878              		.cfi_restore_state
 4879              	.LBB47:
1665:bluetooth_rxtx.c **** 		rx_err = 0;
 4880              		.loc 1 1665 0
 4881 01a4 0023     		movs	r3, #0
 4882 01a6 C8F80030 		str	r3, [r8]
1666:bluetooth_rxtx.c **** 	}
 4883              		.loc 1 1666 0
 4884 01aa C9F80030 		str	r3, [r9]
 4885 01ae 44E7     		b	.L512
 4886              	.L557:
 4887              		.align	2
 4888              	.L556:
 4889 01b0 00000000 		.word	.LANCHOR0
 4890 01b4 00E100E0 		.word	-536813312
 4891 01b8 3CC00920 		.word	537509948
 4892 01bc 00000000 		.word	.LANCHOR1
 4893 01c0 00000000 		.word	rx_tc
 4894 01c4 00000000 		.word	cs_trigger
 4895 01c8 00000000 		.word	cs_threshold_cur
ARM GAS  /tmp/ccDKg7Fp.s 			page 138


 4896 01cc 00000000 		.word	cs_no_squelch
 4897 01d0 00000000 		.word	rssi_max
 4898 01d4 00000000 		.word	unpacked
 4899 01d8 00000000 		.word	idle_rxbuf
 4900 01dc 80E100E0 		.word	-536813184
 4901 01e0 00000000 		.word	rx_err
 4902              	.LBE47:
 4903              		.cfi_endproc
 4904              	.LFE22:
 4906              		.section	.text.bt_le_sync,"ax",%progbits
 4907              		.align	1
 4908              		.global	bt_le_sync
 4909              		.thumb
 4910              		.thumb_func
 4912              	bt_le_sync:
 4913              	.LFB23:
1680:bluetooth_rxtx.c **** 	int i;
 4914              		.loc 1 1680 0
 4915              		.cfi_startproc
 4916              		@ args = 0, pretend = 0, frame = 72
 4917              		@ frame_needed = 0, uses_anonymous_args = 0
 4918              	.LVL552:
 4919 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 4920              		.cfi_def_cfa_offset 36
 4921              		.cfi_offset 4, -36
 4922              		.cfi_offset 5, -32
 4923              		.cfi_offset 6, -28
 4924              		.cfi_offset 7, -24
 4925              		.cfi_offset 8, -20
 4926              		.cfi_offset 9, -16
 4927              		.cfi_offset 10, -12
 4928              		.cfi_offset 11, -8
 4929              		.cfi_offset 14, -4
 4930 0004 93B0     		sub	sp, sp, #76
 4931              		.cfi_def_cfa_offset 112
1685:bluetooth_rxtx.c **** 	mode = active_mode;
 4932              		.loc 1 1685 0
 4933 0006 A74D     		ldr	r5, .L628
1688:bluetooth_rxtx.c **** 
 4934              		.loc 1 1688 0
 4935 0008 A74C     		ldr	r4, .L628+4
1685:bluetooth_rxtx.c **** 	mode = active_mode;
 4936              		.loc 1 1685 0
 4937 000a 0123     		movs	r3, #1
 4938 000c 2B70     		strb	r3, [r5]
1688:bluetooth_rxtx.c **** 
 4939              		.loc 1 1688 0
 4940 000e 2376     		strb	r3, [r4, #24]
1691:bluetooth_rxtx.c **** 
 4941              		.loc 1 1691 0
 4942 0010 A64B     		ldr	r3, .L628+8
 4943 0012 4FF08072 		mov	r2, #16777216
1693:bluetooth_rxtx.c **** 
 4944              		.loc 1 1693 0
 4945 0016 A64E     		ldr	r6, .L628+12
1686:bluetooth_rxtx.c **** 
 4946              		.loc 1 1686 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 139


 4947 0018 6874     		strb	r0, [r5, #17]
1691:bluetooth_rxtx.c **** 
 4948              		.loc 1 1691 0
 4949 001a 1A60     		str	r2, [r3]
1693:bluetooth_rxtx.c **** 
 4950              		.loc 1 1693 0
 4951 001c 1023     		movs	r3, #16
 4952 001e 3360     		str	r3, [r6]
1680:bluetooth_rxtx.c **** 	int i;
 4953              		.loc 1 1680 0
 4954 0020 8046     		mov	r8, r0
1695:bluetooth_rxtx.c **** 	dio_ssp_init();
 4955              		.loc 1 1695 0
 4956 0022 FFF7FEFF 		bl	usb_queue_init
 4957              	.LVL553:
1696:bluetooth_rxtx.c **** 	dma_init_le();
 4958              		.loc 1 1696 0
 4959 0026 FFF7FEFF 		bl	dio_ssp_init
 4960              	.LVL554:
1697:bluetooth_rxtx.c **** 	dio_ssp_start();
 4961              		.loc 1 1697 0
 4962 002a FFF7FEFF 		bl	dma_init_le
 4963              	.LVL555:
1698:bluetooth_rxtx.c **** 
 4964              		.loc 1 1698 0
 4965 002e FFF7FEFF 		bl	dio_ssp_start
 4966              	.LVL556:
1700:bluetooth_rxtx.c **** 
 4967              		.loc 1 1700 0
 4968 0032 6068     		ldr	r0, [r4, #4]
 4969 0034 FFF7FEFF 		bl	rbit
 4970              	.LVL557:
 4971 0038 FFF7FEFF 		bl	cc2400_rx_sync
 4972              	.LVL558:
 4973 003c B146     		mov	r9, r6
 4974              	.L559:
1702:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 4975              		.loc 1 1702 0
 4976 003e AB7C     		ldrb	r3, [r5, #18]	@ zero_extendqisi2
 4977 0040 4345     		cmp	r3, r8
 4978 0042 40F0A281 		bne	.L592
 4979              	.LBB48:
1703:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 4980              		.loc 1 1703 0
 4981 0046 974B     		ldr	r3, .L628
 4982 0048 DB89     		ldrh	r3, [r3, #14]
 4983 004a 9BB2     		uxth	r3, r3
 4984 004c C3B1     		cbz	r3, .L560
1704:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 4985              		.loc 1 1704 0
 4986 004e 6420     		movs	r0, #100
 4987 0050 FFF7FEFF 		bl	cc2400_strobe
 4988              	.LVL559:
 4989              	.L561:
1705:bluetooth_rxtx.c **** 
 4990              		.loc 1 1705 0 discriminator 1
 4991 0054 FFF7FEFF 		bl	cc2400_status
ARM GAS  /tmp/ccDKg7Fp.s 			page 140


 4992              	.LVL560:
 4993 0058 4707     		lsls	r7, r0, #29
 4994 005a FBD4     		bmi	.L561
1708:bluetooth_rxtx.c **** 
 4995              		.loc 1 1708 0
 4996 005c 2188     		ldrh	r1, [r4]
 4997 005e 0220     		movs	r0, #2
 4998 0060 0139     		subs	r1, r1, #1
 4999 0062 89B2     		uxth	r1, r1
 5000 0064 FFF7FEFF 		bl	cc2400_set
 5001              	.LVL561:
1711:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 5002              		.loc 1 1711 0
 5003 0068 6120     		movs	r0, #97
 5004 006a FFF7FEFF 		bl	cc2400_strobe
 5005              	.LVL562:
 5006              	.L562:
1712:bluetooth_rxtx.c **** 
 5007              		.loc 1 1712 0 discriminator 1
 5008 006e FFF7FEFF 		bl	cc2400_status
 5009              	.LVL563:
 5010 0072 4607     		lsls	r6, r0, #29
 5011 0074 FBD5     		bpl	.L562
1715:bluetooth_rxtx.c **** 
 5012              		.loc 1 1715 0
 5013 0076 6220     		movs	r0, #98
 5014 0078 FFF7FEFF 		bl	cc2400_strobe
 5015              	.LVL564:
1717:bluetooth_rxtx.c **** 		}
 5016              		.loc 1 1717 0
 5017 007c 0023     		movs	r3, #0
 5018 007e EB81     		strh	r3, [r5, #14]	@ movhi
 5019              	.L560:
1720:bluetooth_rxtx.c **** 
 5020              		.loc 1 1720 0
 5021 0080 1023     		movs	r3, #16
 5022 0082 C9F80030 		str	r3, [r9]
1723:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0) && (do_hop == 0) && requested_mode == active_mode)
 5023              		.loc 1 1723 0
 5024 0086 FFF7FEFF 		bl	rssi_reset
 5025              	.LVL565:
 5026              	.L564:
1724:bluetooth_rxtx.c **** 			;
 5027              		.loc 1 1724 0 discriminator 4
 5028 008a 8A4B     		ldr	r3, .L628+16
 5029 008c 1A68     		ldr	r2, [r3]
 5030 008e 9A46     		mov	r10, r3
 5031 0090 42B9     		cbnz	r2, .L563
1724:bluetooth_rxtx.c **** 			;
 5032              		.loc 1 1724 0 is_stmt 0 discriminator 1
 5033 0092 894B     		ldr	r3, .L628+20
 5034 0094 1B68     		ldr	r3, [r3]
 5035 0096 2BB9     		cbnz	r3, .L563
1724:bluetooth_rxtx.c **** 			;
 5036              		.loc 1 1724 0 discriminator 2
 5037 0098 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 5038 009a 1BB9     		cbnz	r3, .L563
ARM GAS  /tmp/ccDKg7Fp.s 			page 141


1724:bluetooth_rxtx.c **** 			;
 5039              		.loc 1 1724 0 discriminator 3
 5040 009c 814B     		ldr	r3, .L628
 5041 009e 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 5042 00a0 4345     		cmp	r3, r8
 5043 00a2 F2D0     		beq	.L564
 5044              	.L563:
1727:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
 5045              		.loc 1 1727 0 is_stmt 1
 5046 00a4 0620     		movs	r0, #6
 5047 00a6 FFF7FEFF 		bl	cc2400_get
 5048              	.LVL566:
1728:bluetooth_rxtx.c **** 
 5049              		.loc 1 1728 0
 5050 00aa 844B     		ldr	r3, .L628+24
1727:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
 5051              		.loc 1 1727 0
 5052 00ac C0F30720 		ubfx	r0, r0, #8, #8
 5053              	.LVL567:
1728:bluetooth_rxtx.c **** 
 5054              		.loc 1 1728 0
 5055 00b0 1870     		strb	r0, [r3]
 5056 00b2 834B     		ldr	r3, .L628+28
1730:bluetooth_rxtx.c **** 			goto cleanup;
 5057              		.loc 1 1730 0
 5058 00b4 7B4A     		ldr	r2, .L628
1728:bluetooth_rxtx.c **** 
 5059              		.loc 1 1728 0
 5060 00b6 1870     		strb	r0, [r3]
1730:bluetooth_rxtx.c **** 			goto cleanup;
 5061              		.loc 1 1730 0
 5062 00b8 AB7C     		ldrb	r3, [r5, #18]	@ zero_extendqisi2
 5063 00ba 4345     		cmp	r3, r8
 5064 00bc 40F06581 		bne	.L592
1734:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 5065              		.loc 1 1734 0
 5066 00c0 DFF8F4B1 		ldr	fp, .L628+20
 5067 00c4 DBF80030 		ldr	r3, [fp]
 5068 00c8 DC46     		mov	ip, fp
 5069 00ca 1BB1     		cbz	r3, .L566
1735:bluetooth_rxtx.c **** 		}
 5070              		.loc 1 1735 0
 5071 00cc 5378     		ldrb	r3, [r2, #1]	@ zero_extendqisi2
 5072 00ce 43F00203 		orr	r3, r3, #2
 5073 00d2 5370     		strb	r3, [r2, #1]
 5074              	.L566:
1738:bluetooth_rxtx.c **** 			goto rx_flush;
 5075              		.loc 1 1738 0
 5076 00d4 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 5077 00d6 03F0FF01 		and	r1, r3, #255
 5078 00da 002B     		cmp	r3, #0
 5079 00dc 40F0A580 		bne	.L568
1742:bluetooth_rxtx.c **** 			continue;
 5080              		.loc 1 1742 0
 5081 00e0 DAF80030 		ldr	r3, [r10]
 5082 00e4 002B     		cmp	r3, #0
 5083 00e6 AAD0     		beq	.L559
ARM GAS  /tmp/ccDKg7Fp.s 			page 142


1748:bluetooth_rxtx.c **** 		u8 *p = (u8 *)packet;
 5084              		.loc 1 1748 0
 5085 00e8 3422     		movs	r2, #52
 5086 00ea 05A8     		add	r0, sp, #20
 5087              	.LVL568:
 5088 00ec CDF80CC0 		str	ip, [sp, #12]
 5089 00f0 FFF7FEFF 		bl	memset
 5090              	.LVL569:
1752:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 5091              		.loc 1 1752 0
 5092 00f4 2088     		ldrh	r0, [r4]
1750:bluetooth_rxtx.c **** 
 5093              		.loc 1 1750 0
 5094 00f6 6368     		ldr	r3, [r4, #4]
1752:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 5095              		.loc 1 1752 0
 5096 00f8 80B2     		uxth	r0, r0
1750:bluetooth_rxtx.c **** 
 5097              		.loc 1 1750 0
 5098 00fa 0593     		str	r3, [sp, #20]
1752:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 5099              		.loc 1 1752 0
 5100 00fc FFF7FEFF 		bl	btle_channel_index
 5101              	.LVL570:
 5102 0100 3026     		movs	r6, #48
 5103 0102 4643     		muls	r6, r0, r6
 5104 0104 6F4F     		ldr	r7, .L628+32
 5105 0106 BB19     		adds	r3, r7, r6
 5106 0108 0193     		str	r3, [sp, #4]
 5107              	.LVL571:
 5108              	.LBB49:
1754:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 5109              		.loc 1 1754 0
 5110 010a 6F4B     		ldr	r3, .L628+36
 5111              	.LVL572:
 5112 010c 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
1755:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5113              		.loc 1 1755 0
 5114 010e 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
1756:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5115              		.loc 1 1756 0
 5116 0110 93F802E0 		ldrb	lr, [r3, #2]	@ zero_extendqisi2
1755:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5117              		.loc 1 1755 0
 5118 0114 1204     		lsls	r2, r2, #16
1757:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 5119              		.loc 1 1757 0
 5120 0116 D978     		ldrb	r1, [r3, #3]	@ zero_extendqisi2
 5121              	.LVL573:
1755:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5122              		.loc 1 1755 0
 5123 0118 42EA0060 		orr	r0, r2, r0, lsl #24
 5124 011c 0843     		orrs	r0, r0, r1
1758:bluetooth_rxtx.c **** 		}
 5125              		.loc 1 1758 0
 5126 011e 40EA0E20 		orr	r0, r0, lr, lsl #8
1757:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
ARM GAS  /tmp/ccDKg7Fp.s 			page 143


 5127              		.loc 1 1757 0
 5128 0122 0293     		str	r3, [sp, #8]
1758:bluetooth_rxtx.c **** 		}
 5129              		.loc 1 1758 0
 5130 0124 FFF7FEFF 		bl	rbit
 5131              	.LVL574:
 5132 0128 BE59     		ldr	r6, [r7, r6]
 5133              	.LBE49:
1762:bluetooth_rxtx.c **** 			goto rx_flush;
 5134              		.loc 1 1762 0
 5135 012a 029B     		ldr	r3, [sp, #8]
 5136              	.LBB50:
1758:bluetooth_rxtx.c **** 		}
 5137              		.loc 1 1758 0
 5138 012c 7040     		eors	r0, r0, r6
 5139              	.LBE50:
1761:bluetooth_rxtx.c **** 		if (len > 39)
 5140              		.loc 1 1761 0
 5141 012e C0F30526 		ubfx	r6, r0, #8, #6
 5142 0132 B71C     		adds	r7, r6, #2
1762:bluetooth_rxtx.c **** 			goto rx_flush;
 5143              		.loc 1 1762 0
 5144 0134 272F     		cmp	r7, #39
 5145              	.LBB51:
1758:bluetooth_rxtx.c **** 		}
 5146              		.loc 1 1758 0
 5147 0136 0690     		str	r0, [sp, #24]
 5148              	.LVL575:
 5149              	.LBE51:
1762:bluetooth_rxtx.c **** 			goto rx_flush;
 5150              		.loc 1 1762 0
 5151 0138 DDF80CC0 		ldr	ip, [sp, #12]
 5152 013c 75DC     		bgt	.L568
1767:bluetooth_rxtx.c **** 		if (total_transfers < 11) {
 5153              		.loc 1 1767 0
 5154 013e 0836     		adds	r6, r6, #8
 5155 0140 B208     		lsrs	r2, r6, #2
 5156              	.LVL576:
1768:bluetooth_rxtx.c **** 			while (DMACC0DestAddr < (uint32_t)rxbuf1 + 4 * total_transfers && rx_err == 0)
 5157              		.loc 1 1768 0
 5158 0142 0B2A     		cmp	r2, #11
 5159 0144 0DD0     		beq	.L572
1769:bluetooth_rxtx.c **** 				;
 5160              		.loc 1 1769 0
 5161 0146 03EB8203 		add	r3, r3, r2, lsl #2
 5162              	.LVL577:
 5163              	.L574:
1769:bluetooth_rxtx.c **** 				;
 5164              		.loc 1 1769 0 is_stmt 0 discriminator 2
 5165 014a 604A     		ldr	r2, .L628+40
 5166 014c 1268     		ldr	r2, [r2]
 5167 014e 9A42     		cmp	r2, r3
 5168 0150 0BD2     		bcs	.L573
1769:bluetooth_rxtx.c **** 				;
 5169              		.loc 1 1769 0 discriminator 1
 5170 0152 DCF80020 		ldr	r2, [ip]
 5171 0156 002A     		cmp	r2, #0
ARM GAS  /tmp/ccDKg7Fp.s 			page 144


 5172 0158 F7D0     		beq	.L574
 5173 015a 06E0     		b	.L573
 5174              	.LVL578:
 5175              	.L626:
1772:bluetooth_rxtx.c **** 				;
 5176              		.loc 1 1772 0 is_stmt 1 discriminator 1
 5177 015c DCF80030 		ldr	r3, [ip]
 5178 0160 1BB9     		cbnz	r3, .L573
 5179              	.L572:
1772:bluetooth_rxtx.c **** 				;
 5180              		.loc 1 1772 0 is_stmt 0 discriminator 2
 5181 0162 5B4B     		ldr	r3, .L628+44
 5182 0164 1B68     		ldr	r3, [r3]
 5183 0166 D807     		lsls	r0, r3, #31
 5184 0168 F8D4     		bmi	.L626
 5185              	.LVL579:
 5186              	.L573:
1775:bluetooth_rxtx.c **** 
 5187              		.loc 1 1775 0 is_stmt 1
 5188 016a 5A4A     		ldr	r2, .L628+48
1778:bluetooth_rxtx.c **** 
 5189              		.loc 1 1778 0
 5190 016c 6120     		movs	r0, #97
1775:bluetooth_rxtx.c **** 
 5191              		.loc 1 1775 0
 5192 016e 1368     		ldr	r3, [r2]
 5193 0170 23F00103 		bic	r3, r3, #1
 5194 0174 1360     		str	r3, [r2]
1778:bluetooth_rxtx.c **** 
 5195              		.loc 1 1778 0
 5196 0176 FFF7FEFF 		bl	cc2400_strobe
 5197              	.LVL580:
1781:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5198              		.loc 1 1781 0
 5199 017a 0423     		movs	r3, #4
 5200              	.LVL581:
 5201              	.L575:
 5202              	.LBB52:
1782:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 5203              		.loc 1 1782 0 discriminator 3
 5204 017c 5249     		ldr	r1, .L628+36
 5205 017e 581C     		adds	r0, r3, #1
 5206 0180 CA5C     		ldrb	r2, [r1, r3]	@ zero_extendqisi2
 5207 0182 03F1030E 		add	lr, r3, #3
1783:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5208              		.loc 1 1783 0 discriminator 3
 5209 0186 11F800C0 		ldrb	ip, [r1, r0]	@ zero_extendqisi2
 5210 018a 981C     		adds	r0, r3, #2
1784:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5211              		.loc 1 1784 0 discriminator 3
 5212 018c 085C     		ldrb	r0, [r1, r0]	@ zero_extendqisi2
1785:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 5213              		.loc 1 1785 0 discriminator 3
 5214 018e 11F80EE0 		ldrb	lr, [r1, lr]	@ zero_extendqisi2
 5215              	.LVL582:
1786:bluetooth_rxtx.c **** 		}
 5216              		.loc 1 1786 0 discriminator 3
ARM GAS  /tmp/ccDKg7Fp.s 			page 145


 5217 0192 9910     		asrs	r1, r3, #2
 5218 0194 4EEA0262 		orr	r2, lr, r2, lsl #24
 5219              	.LVL583:
 5220 0198 42EA0C42 		orr	r2, r2, ip, lsl #16
 5221 019c 42EA0020 		orr	r0, r2, r0, lsl #8
 5222 01a0 0393     		str	r3, [sp, #12]
 5223 01a2 0291     		str	r1, [sp, #8]
 5224 01a4 FFF7FEFF 		bl	rbit
 5225              	.LVL584:
 5226 01a8 0299     		ldr	r1, [sp, #8]
 5227 01aa 12AB     		add	r3, sp, #72
 5228 01ac 03EB810E 		add	lr, r3, r1, lsl #2
 5229 01b0 019B     		ldr	r3, [sp, #4]
 5230 01b2 53F82120 		ldr	r2, [r3, r1, lsl #2]
 5231              	.LBE52:
1781:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5232              		.loc 1 1781 0 discriminator 3
 5233 01b6 039B     		ldr	r3, [sp, #12]
 5234              	.LBB53:
1786:bluetooth_rxtx.c **** 		}
 5235              		.loc 1 1786 0 discriminator 3
 5236 01b8 5040     		eors	r0, r0, r2
 5237              	.LBE53:
1781:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5238              		.loc 1 1781 0 discriminator 3
 5239 01ba 0433     		adds	r3, r3, #4
 5240              	.LVL585:
 5241 01bc 2C2B     		cmp	r3, #44
 5242              	.LBB54:
1786:bluetooth_rxtx.c **** 		}
 5243              		.loc 1 1786 0 discriminator 3
 5244 01be 4EF8300C 		str	r0, [lr, #-48]
 5245              	.LBE54:
1781:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5246              		.loc 1 1781 0 discriminator 3
 5247 01c2 DBD1     		bne	.L575
1789:bluetooth_rxtx.c **** 			u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, p + 4, len);
 5248              		.loc 1 1789 0
 5249 01c4 6369     		ldr	r3, [r4, #20]
 5250              	.LVL586:
 5251 01c6 DBB9     		cbnz	r3, .L576
 5252              	.LVL587:
 5253              	.L577:
1799:bluetooth_rxtx.c **** 		packet_cb((uint8_t *)packet);
 5254              		.loc 1 1799 0
 5255 01c8 434B     		ldr	r3, .L628+52
 5256 01ca 1022     		movs	r2, #16
 5257 01cc 1A60     		str	r2, [r3]
1800:bluetooth_rxtx.c **** 
 5258              		.loc 1 1800 0
 5259 01ce 05A8     		add	r0, sp, #20
 5260              	.LVL588:
 5261 01d0 AB69     		ldr	r3, [r5, #24]
 5262 01d2 9847     		blx	r3
 5263              	.LVL589:
1803:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t *)packet);
 5264              		.loc 1 1803 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 146


 5265 01d4 414B     		ldr	r3, .L628+56
 5266 01d6 4FF08076 		mov	r6, #16777216
 5267 01da 1E60     		str	r6, [r3]
1804:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
 5268              		.loc 1 1804 0
 5269 01dc 05A9     		add	r1, sp, #20
 5270              	.LVL590:
 5271 01de 0120     		movs	r0, #1
 5272 01e0 FFF7FEFF 		bl	enqueue
 5273              	.LVL591:
1807:bluetooth_rxtx.c **** 
 5274              		.loc 1 1807 0
 5275 01e4 40F63541 		movw	r1, #3125
1805:bluetooth_rxtx.c **** 
 5276              		.loc 1 1805 0
 5277 01e8 304B     		ldr	r3, .L628+8
 5278 01ea 1E60     		str	r6, [r3]
1807:bluetooth_rxtx.c **** 
 5279              		.loc 1 1807 0
 5280 01ec 3C4B     		ldr	r3, .L628+60
 5281 01ee 1A68     		ldr	r2, [r3]
 5282 01f0 3C4B     		ldr	r3, .L628+64
 5283 01f2 C2F31302 		ubfx	r2, r2, #0, #20
 5284 01f6 1B68     		ldr	r3, [r3]
 5285 01f8 01FB0233 		mla	r3, r1, r2, r3
 5286 01fc E364     		str	r3, [r4, #76]
 5287 01fe 14E0     		b	.L568
 5288              	.LVL592:
 5289              	.L576:
 5290              	.LBB55:
1790:bluetooth_rxtx.c **** 			u32 wire_crc = (p[4+len+2] << 16)
 5291              		.loc 1 1790 0
 5292 0200 294B     		ldr	r3, .L628+4
 5293 0202 3A46     		mov	r2, r7
 5294 0204 1869     		ldr	r0, [r3, #16]
 5295 0206 06A9     		add	r1, sp, #24
 5296 0208 FFF7FEFF 		bl	btle_crcgen_lut
 5297              	.LVL593:
1791:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
 5298              		.loc 1 1791 0
 5299 020c 12AB     		add	r3, sp, #72
1792:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
 5300              		.loc 1 1792 0
 5301 020e 1F44     		add	r7, r7, r3
 5302              	.LVL594:
1791:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
 5303              		.loc 1 1791 0
 5304 0210 1E44     		add	r6, r6, r3
 5305              	.LVL595:
1792:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
 5306              		.loc 1 1792 0
 5307 0212 17F82F3C 		ldrb	r3, [r7, #-47]	@ zero_extendqisi2
1791:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
 5308              		.loc 1 1791 0
 5309 0216 16F8342C 		ldrb	r2, [r6, #-52]	@ zero_extendqisi2
1792:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
 5310              		.loc 1 1792 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 147


 5311 021a 1B02     		lsls	r3, r3, #8
 5312 021c 43EA0243 		orr	r3, r3, r2, lsl #16
1793:bluetooth_rxtx.c **** 			if (calc_crc != wire_crc) // skip packets with a bad CRC
 5313              		.loc 1 1793 0
 5314 0220 17F8302C 		ldrb	r2, [r7, #-48]	@ zero_extendqisi2
 5315 0224 1343     		orrs	r3, r3, r2
1794:bluetooth_rxtx.c **** 				goto rx_flush;
 5316              		.loc 1 1794 0
 5317 0226 9842     		cmp	r0, r3
 5318 0228 CED0     		beq	.L577
 5319              	.LVL596:
 5320              	.L568:
 5321              	.LBE55:
1811:bluetooth_rxtx.c **** 
 5322              		.loc 1 1811 0
 5323 022a 6120     		movs	r0, #97
 5324 022c FFF7FEFF 		bl	cc2400_strobe
 5325              	.LVL597:
1814:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
 5326              		.loc 1 1814 0
 5327 0230 284A     		ldr	r2, .L628+48
 5328 0232 1368     		ldr	r3, [r2]
 5329 0234 23F00103 		bic	r3, r3, #1
 5330 0238 1360     		str	r3, [r2]
 5331              	.L578:
1815:bluetooth_rxtx.c **** 			u8 tmp = (u8)DIO_SSP_DR;
 5332              		.loc 1 1815 0
 5333 023a 2B4B     		ldr	r3, .L628+68
 5334 023c 1B68     		ldr	r3, [r3]
 5335 023e 5907     		lsls	r1, r3, #29
 5336 0240 02D5     		bpl	.L627
 5337              	.LBB56:
1816:bluetooth_rxtx.c **** 		}
 5338              		.loc 1 1816 0
 5339 0242 2A4B     		ldr	r3, .L628+72
 5340 0244 1B68     		ldr	r3, [r3]
 5341 0246 F8E7     		b	.L578
 5342              	.L627:
 5343              	.LBE56:
1820:bluetooth_rxtx.c **** 		if (now < le.last_packet)
 5344              		.loc 1 1820 0
 5345 0248 40F63541 		movw	r1, #3125
 5346 024c 244B     		ldr	r3, .L628+60
 5347 024e 1A68     		ldr	r2, [r3]
 5348 0250 244B     		ldr	r3, .L628+64
 5349 0252 C2F31302 		ubfx	r2, r2, #0, #20
 5350 0256 1B68     		ldr	r3, [r3]
 5351 0258 01FB0233 		mla	r3, r1, r2, r3
 5352              	.LVL598:
1821:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
 5353              		.loc 1 1821 0
 5354 025c E16C     		ldr	r1, [r4, #76]
1824:bluetooth_rxtx.c **** 			&& (now - le.last_packet > 50000000))
 5355              		.loc 1 1824 0
 5356 025e 227E     		ldrb	r2, [r4, #24]	@ zero_extendqisi2
1821:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
 5357              		.loc 1 1821 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 148


 5358 0260 8B42     		cmp	r3, r1
1822:bluetooth_rxtx.c **** 		if  ( // timeout
 5359              		.loc 1 1822 0
 5360 0262 38BF     		it	cc
 5361 0264 03F14343 		addcc	r3, r3, #-1023410176
 5362              	.LVL599:
1823:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
 5363              		.loc 1 1823 0
 5364 0268 A2F10202 		sub	r2, r2, #2
1822:bluetooth_rxtx.c **** 		if  ( // timeout
 5365              		.loc 1 1822 0
 5366 026c 38BF     		it	cc
 5367 026e 03F5A003 		addcc	r3, r3, #5242880
 5368              	.LVL600:
1823:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
 5369              		.loc 1 1823 0
 5370 0272 012A     		cmp	r2, #1
 5371 0274 03D8     		bhi	.L581
1825:bluetooth_rxtx.c **** 			// jam finished
 5372              		.loc 1 1825 0
 5373 0276 1E4A     		ldr	r2, .L628+76
 5374 0278 5B1A     		subs	r3, r3, r1
 5375              	.LVL601:
 5376 027a 9342     		cmp	r3, r2
 5377 027c 02D8     		bhi	.L582
 5378              	.L581:
1827:bluetooth_rxtx.c **** 			)
 5379              		.loc 1 1827 0
 5380 027e EB69     		ldr	r3, [r5, #28]
 5381 0280 012B     		cmp	r3, #1
 5382 0282 51D1     		bne	.L583
 5383              	.L582:
1830:bluetooth_rxtx.c **** 			le_jam_count = 0;
 5384              		.loc 1 1830 0
 5385 0284 FFF7FEFF 		bl	reset_le
 5386              	.LVL602:
1832:bluetooth_rxtx.c **** 
 5387              		.loc 1 1832 0
 5388 0288 4FF48071 		mov	r1, #256
1831:bluetooth_rxtx.c **** 			TXLED_CLR;
 5389              		.loc 1 1831 0
 5390 028c 0023     		movs	r3, #0
 5391 028e EB61     		str	r3, [r5, #28]
1832:bluetooth_rxtx.c **** 
 5392              		.loc 1 1832 0
 5393 0290 C9F80010 		str	r1, [r9]
1834:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
 5394              		.loc 1 1834 0
 5395 0294 E97C     		ldrb	r1, [r5, #19]	@ zero_extendqisi2
1831:bluetooth_rxtx.c **** 			TXLED_CLR;
 5396              		.loc 1 1831 0
 5397 0296 034A     		ldr	r2, .L628
1834:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
 5398              		.loc 1 1834 0
 5399 0298 0129     		cmp	r1, #1
 5400 029a 2BD1     		bne	.L584
1835:bluetooth_rxtx.c **** 				requested_mode = MODE_IDLE;
ARM GAS  /tmp/ccDKg7Fp.s 			page 149


 5401              		.loc 1 1835 0
 5402 029c D374     		strb	r3, [r2, #19]
1836:bluetooth_rxtx.c **** 				goto cleanup;
 5403              		.loc 1 1836 0
 5404 029e 9374     		strb	r3, [r2, #18]
1837:bluetooth_rxtx.c **** 			}
 5405              		.loc 1 1837 0
 5406 02a0 73E0     		b	.L592
 5407              	.L629:
 5408 02a2 00BF     		.align	2
 5409              	.L628:
 5410 02a4 00000000 		.word	.LANCHOR0
 5411 02a8 00000000 		.word	.LANCHOR1
 5412 02ac 00E100E0 		.word	-536813312
 5413 02b0 3CC00920 		.word	537509948
 5414 02b4 00000000 		.word	rx_tc
 5415 02b8 00000000 		.word	rx_err
 5416 02bc 00000000 		.word	rssi_max
 5417 02c0 00000000 		.word	rssi_min
 5418 02c4 F0000000 		.word	.LANCHOR2+240
 5419 02c8 00000000 		.word	rxbuf1
 5420 02cc 04410050 		.word	1342193924
 5421 02d0 10410050 		.word	1342193936
 5422 02d4 24000340 		.word	1073938468
 5423 02d8 38C00920 		.word	537509944
 5424 02dc 80E100E0 		.word	-536813184
 5425 02e0 00000000 		.word	clkn
 5426 02e4 08400040 		.word	1073758216
 5427 02e8 0C000340 		.word	1073938444
 5428 02ec 08000340 		.word	1073938440
 5429 02f0 80F0FA02 		.word	50000000
 5430              	.L584:
1841:bluetooth_rxtx.c **** 				goto cleanup;
 5431              		.loc 1 1841 0
 5432 02f4 B8F10A0F 		cmp	r8, #10
 5433 02f8 47D0     		beq	.L592
1844:bluetooth_rxtx.c **** 
 5434              		.loc 1 1844 0
 5435 02fa 0123     		movs	r3, #1
1846:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 5436              		.loc 1 1846 0
 5437 02fc 6420     		movs	r0, #100
1844:bluetooth_rxtx.c **** 
 5438              		.loc 1 1844 0
 5439 02fe 2376     		strb	r3, [r4, #24]
1846:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 5440              		.loc 1 1846 0
 5441 0300 FFF7FEFF 		bl	cc2400_strobe
 5442              	.LVL603:
 5443              	.L586:
1847:bluetooth_rxtx.c **** 
 5444              		.loc 1 1847 0 discriminator 1
 5445 0304 FFF7FEFF 		bl	cc2400_status
 5446              	.LVL604:
 5447 0308 4207     		lsls	r2, r0, #29
 5448 030a FBD4     		bmi	.L586
1850:bluetooth_rxtx.c **** 			restart_jamming = 1;
ARM GAS  /tmp/ccDKg7Fp.s 			page 150


 5449              		.loc 1 1850 0
 5450 030c B4F85230 		ldrh	r3, [r4, #82]
 5451 0310 9BB2     		uxth	r3, r3
 5452 0312 23B1     		cbz	r3, .L594
1850:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5453              		.loc 1 1850 0 is_stmt 0 discriminator 1
 5454 0314 234B     		ldr	r3, .L630
 5455 0316 B3F85230 		ldrh	r3, [r3, #82]
 5456 031a 9BB2     		uxth	r3, r3
 5457 031c 01E0     		b	.L587
 5458              	.L594:
1850:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5459              		.loc 1 1850 0
 5460 031e 40F66213 		movw	r3, #2402
 5461              	.L587:
1850:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5462              		.loc 1 1850 0 discriminator 4
 5463 0322 2380     		strh	r3, [r4]	@ movhi
1851:bluetooth_rxtx.c **** 		}
 5464              		.loc 1 1851 0 is_stmt 1 discriminator 4
 5465 0324 0123     		movs	r3, #1
 5466 0326 2B63     		str	r3, [r5, #48]
 5467              	.L583:
1854:bluetooth_rxtx.c **** 		cc2400_set(SYNCH, le.synch);
 5468              		.loc 1 1854 0
 5469 0328 2C20     		movs	r0, #44
 5470 032a 6189     		ldrh	r1, [r4, #10]
 5471 032c FFF7FEFF 		bl	cc2400_set
 5472              	.LVL605:
1855:bluetooth_rxtx.c **** 
 5473              		.loc 1 1855 0
 5474 0330 2D20     		movs	r0, #45
 5475 0332 2189     		ldrh	r1, [r4, #8]
 5476 0334 FFF7FEFF 		bl	cc2400_set
 5477              	.LVL606:
1857:bluetooth_rxtx.c **** 			hop();
 5478              		.loc 1 1857 0
 5479 0338 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 5480 033a 0BB1     		cbz	r3, .L588
1858:bluetooth_rxtx.c **** 
 5481              		.loc 1 1858 0
 5482 033c FFF7FEFF 		bl	hop
 5483              	.LVL607:
 5484              	.L588:
1861:bluetooth_rxtx.c **** 			le_jam();
 5485              		.loc 1 1861 0
 5486 0340 EB69     		ldr	r3, [r5, #28]
 5487 0342 194E     		ldr	r6, .L630+4
 5488 0344 002B     		cmp	r3, #0
 5489 0346 05DD     		ble	.L589
1862:bluetooth_rxtx.c **** 			--le_jam_count;
 5490              		.loc 1 1862 0
 5491 0348 FFF7FEFF 		bl	le_jam
 5492              	.LVL608:
1863:bluetooth_rxtx.c **** 		} else {
 5493              		.loc 1 1863 0
 5494 034c F369     		ldr	r3, [r6, #28]
ARM GAS  /tmp/ccDKg7Fp.s 			page 151


 5495 034e 013B     		subs	r3, r3, #1
 5496 0350 F361     		str	r3, [r6, #28]
 5497 0352 14E0     		b	.L590
 5498              	.L589:
1866:bluetooth_rxtx.c **** 			dio_ssp_start();
 5499              		.loc 1 1866 0
 5500 0354 FFF7FEFF 		bl	dma_init_le
 5501              	.LVL609:
1867:bluetooth_rxtx.c **** 
 5502              		.loc 1 1867 0
 5503 0358 FFF7FEFF 		bl	dio_ssp_start
 5504              	.LVL610:
1869:bluetooth_rxtx.c **** 				cc2400_rx_sync(rbit(le.access_address));
 5505              		.loc 1 1869 0
 5506 035c 336B     		ldr	r3, [r6, #48]
 5507 035e 3BB1     		cbz	r3, .L591
1870:bluetooth_rxtx.c **** 				restart_jamming = 0;
 5508              		.loc 1 1870 0
 5509 0360 6068     		ldr	r0, [r4, #4]
 5510 0362 FFF7FEFF 		bl	rbit
 5511              	.LVL611:
 5512 0366 FFF7FEFF 		bl	cc2400_rx_sync
 5513              	.LVL612:
1871:bluetooth_rxtx.c **** 			} else {
 5514              		.loc 1 1871 0
 5515 036a 0023     		movs	r3, #0
 5516 036c 3363     		str	r3, [r6, #48]
 5517 036e 06E0     		b	.L590
 5518              	.L591:
1874:bluetooth_rxtx.c **** 				cc2400_strobe(SRX);
 5519              		.loc 1 1874 0 discriminator 1
 5520 0370 FFF7FEFF 		bl	cc2400_status
 5521              	.LVL613:
 5522 0374 4307     		lsls	r3, r0, #29
 5523 0376 FBD5     		bpl	.L591
1875:bluetooth_rxtx.c **** 			}
 5524              		.loc 1 1875 0
 5525 0378 6220     		movs	r0, #98
 5526 037a FFF7FEFF 		bl	cc2400_strobe
 5527              	.LVL614:
 5528              	.L590:
1879:bluetooth_rxtx.c **** 		rx_err = 0;
 5529              		.loc 1 1879 0
 5530 037e 0023     		movs	r3, #0
 5531 0380 CAF80030 		str	r3, [r10]
1880:bluetooth_rxtx.c **** 	}
 5532              		.loc 1 1880 0
 5533 0384 CBF80030 		str	r3, [fp]
 5534 0388 59E6     		b	.L559
 5535              	.L592:
 5536              	.LBE48:
1886:bluetooth_rxtx.c **** 
 5537              		.loc 1 1886 0
 5538 038a 084B     		ldr	r3, .L630+8
 5539 038c 4FF08072 		mov	r2, #16777216
 5540 0390 1A60     		str	r2, [r3]
1889:bluetooth_rxtx.c **** 	dio_ssp_stop();
ARM GAS  /tmp/ccDKg7Fp.s 			page 152


 5541              		.loc 1 1889 0
 5542 0392 FFF7FEFF 		bl	cc2400_idle
 5543              	.LVL615:
1890:bluetooth_rxtx.c **** 	cs_trigger_disable();
 5544              		.loc 1 1890 0
 5545 0396 FFF7FEFF 		bl	dio_ssp_stop
 5546              	.LVL616:
1891:bluetooth_rxtx.c **** }
 5547              		.loc 1 1891 0
 5548 039a FFF7FEFF 		bl	cs_trigger_disable
 5549              	.LVL617:
1892:bluetooth_rxtx.c **** 
 5550              		.loc 1 1892 0
 5551 039e 13B0     		add	sp, sp, #76
 5552              		.cfi_def_cfa_offset 36
 5553              		@ sp needed
 5554 03a0 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 5555              	.L631:
 5556              		.align	2
 5557              	.L630:
 5558 03a4 00000000 		.word	.LANCHOR1
 5559 03a8 00000000 		.word	.LANCHOR0
 5560 03ac 80E100E0 		.word	-536813184
 5561              		.cfi_endproc
 5562              	.LFE23:
 5564              		.section	.text.bt_follow_le,"ax",%progbits
 5565              		.align	1
 5566              		.global	bt_follow_le
 5567              		.thumb
 5568              		.thumb_func
 5570              	bt_follow_le:
 5571              	.LFB26:
2057:bluetooth_rxtx.c **** 		}
2058:bluetooth_rxtx.c **** 	}
2059:bluetooth_rxtx.c **** }
2060:bluetooth_rxtx.c **** 
2061:bluetooth_rxtx.c **** void le_phy_main(void);
2062:bluetooth_rxtx.c **** void bt_follow_le() {
 5572              		.loc 1 2062 0
 5573              		.cfi_startproc
 5574              		@ args = 0, pretend = 0, frame = 0
 5575              		@ frame_needed = 0, uses_anonymous_args = 0
 5576              		@ link register save eliminated.
2063:bluetooth_rxtx.c **** 	le_phy_main();
 5577              		.loc 1 2063 0
 5578 0000 FFF7FEBF 		b	le_phy_main
 5579              	.LVL618:
 5580              		.cfi_endproc
 5581              	.LFE26:
 5583              		.section	.text.le_promisc_state,"ax",%progbits
 5584              		.align	1
 5585              		.global	le_promisc_state
 5586              		.thumb
 5587              		.thumb_func
 5589              	le_promisc_state:
 5590              	.LFB27:
2064:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccDKg7Fp.s 			page 153


2065:bluetooth_rxtx.c **** 	/* old method
2066:bluetooth_rxtx.c **** 	reset_le();
2067:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
2068:bluetooth_rxtx.c **** 	bt_le_sync(MODE_BT_FOLLOW_LE);
2069:bluetooth_rxtx.c **** 	*/
2070:bluetooth_rxtx.c **** }
2071:bluetooth_rxtx.c **** 
2072:bluetooth_rxtx.c **** // issue state change message
2073:bluetooth_rxtx.c **** void le_promisc_state(u8 type, void *data, unsigned len) {
 5591              		.loc 1 2073 0
 5592              		.cfi_startproc
 5593              		@ args = 0, pretend = 0, frame = 56
 5594              		@ frame_needed = 0, uses_anonymous_args = 0
 5595              	.LVL619:
 5596 0000 70B5     		push	{r4, r5, r6, lr}
 5597              		.cfi_def_cfa_offset 16
 5598              		.cfi_offset 4, -16
 5599              		.cfi_offset 5, -12
 5600              		.cfi_offset 6, -8
 5601              		.cfi_offset 14, -4
 5602 0002 8EB0     		sub	sp, sp, #56
 5603              		.cfi_def_cfa_offset 72
 5604              		.loc 1 2073 0
 5605 0004 1446     		mov	r4, r2
 5606 0006 0D46     		mov	r5, r1
 5607 0008 0646     		mov	r6, r0
2074:bluetooth_rxtx.c **** 	u8 buf[50] = { 0, };
 5608              		.loc 1 2074 0
 5609 000a 0021     		movs	r1, #0
 5610              	.LVL620:
 5611 000c 01A8     		add	r0, sp, #4
 5612              	.LVL621:
 5613 000e 3222     		movs	r2, #50
 5614              	.LVL622:
 5615 0010 FFF7FEFF 		bl	memset
 5616              	.LVL623:
2075:bluetooth_rxtx.c **** 	if (len > 49)
2076:bluetooth_rxtx.c **** 		len = 49;
2077:bluetooth_rxtx.c **** 
2078:bluetooth_rxtx.c **** 	buf[0] = type;
2079:bluetooth_rxtx.c **** 	memcpy(&buf[1], data, len);
 5617              		.loc 1 2079 0
 5618 0014 312C     		cmp	r4, #49
 5619 0016 2246     		mov	r2, r4
 5620 0018 2946     		mov	r1, r5
 5621 001a 28BF     		it	cs
 5622 001c 3122     		movcs	r2, #49
 5623 001e 0DF10500 		add	r0, sp, #5
2078:bluetooth_rxtx.c **** 	memcpy(&buf[1], data, len);
 5624              		.loc 1 2078 0
 5625 0022 8DF80460 		strb	r6, [sp, #4]
 5626              		.loc 1 2079 0
 5627 0026 FFF7FEFF 		bl	memcpy
 5628              	.LVL624:
2080:bluetooth_rxtx.c **** 	enqueue(LE_PROMISC, (uint8_t*)buf);
 5629              		.loc 1 2080 0
 5630 002a 01A9     		add	r1, sp, #4
ARM GAS  /tmp/ccDKg7Fp.s 			page 154


 5631 002c 0520     		movs	r0, #5
 5632 002e FFF7FEFF 		bl	enqueue
 5633              	.LVL625:
2081:bluetooth_rxtx.c **** }
 5634              		.loc 1 2081 0
 5635 0032 0EB0     		add	sp, sp, #56
 5636              		.cfi_def_cfa_offset 16
 5637              		@ sp needed
 5638 0034 70BD     		pop	{r4, r5, r6, pc}
 5639              		.cfi_endproc
 5640              	.LFE27:
 5642              		.section	.text.promisc_recover_hop_increment,"ax",%progbits
 5643              		.align	1
 5644              		.global	promisc_recover_hop_increment
 5645              		.thumb
 5646              		.thumb_func
 5648              	promisc_recover_hop_increment:
 5649              	.LFB28:
2082:bluetooth_rxtx.c **** 
2083:bluetooth_rxtx.c **** // divide, rounding to the nearest integer: round up at 0.5.
2084:bluetooth_rxtx.c **** #define DIVIDE_ROUND(N, D) ((N) + (D)/2) / (D)
2085:bluetooth_rxtx.c **** 
2086:bluetooth_rxtx.c **** void promisc_recover_hop_increment(u8 *packet) {
 5650              		.loc 1 2086 0
 5651              		.cfi_startproc
 5652              		@ args = 0, pretend = 0, frame = 0
 5653              		@ frame_needed = 0, uses_anonymous_args = 0
 5654              	.LVL626:
 5655 0000 38B5     		push	{r3, r4, r5, lr}
 5656              		.cfi_def_cfa_offset 16
 5657              		.cfi_offset 3, -16
 5658              		.cfi_offset 4, -12
 5659              		.cfi_offset 5, -8
 5660              		.cfi_offset 14, -4
2087:bluetooth_rxtx.c **** 	static u32 first_ts = 0;
2088:bluetooth_rxtx.c **** 	if (channel == 2404) {
 5661              		.loc 1 2088 0
 5662 0002 40F66412 		movw	r2, #2404
 5663 0006 3148     		ldr	r0, .L645
 5664              	.LVL627:
 5665 0008 314C     		ldr	r4, .L645+4
 5666 000a 0388     		ldrh	r3, [r0]
 5667 000c 9BB2     		uxth	r3, r3
 5668 000e 9342     		cmp	r3, r2
 5669 0010 0DD1     		bne	.L635
2089:bluetooth_rxtx.c **** 		first_ts = CLK100NS;
 5670              		.loc 1 2089 0
 5671 0012 40F63541 		movw	r1, #3125
 5672 0016 2F4B     		ldr	r3, .L645+8
 5673 0018 1A68     		ldr	r2, [r3]
 5674 001a 2F4B     		ldr	r3, .L645+12
 5675 001c C2F31302 		ubfx	r2, r2, #0, #20
 5676 0020 1B68     		ldr	r3, [r3]
 5677 0022 01FB0233 		mla	r3, r1, r2, r3
 5678 0026 6363     		str	r3, [r4, #52]
2090:bluetooth_rxtx.c **** 		hop_direct_channel = 2406;
 5679              		.loc 1 2090 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 155


 5680 0028 40F66613 		movw	r3, #2406
 5681 002c 48E0     		b	.L644
 5682              	.L635:
2091:bluetooth_rxtx.c **** 		do_hop = 1;
2092:bluetooth_rxtx.c **** 	} else if (channel == 2406) {
 5683              		.loc 1 2092 0
 5684 002e 40F66611 		movw	r1, #2406
 5685 0032 0388     		ldrh	r3, [r0]
 5686 0034 9BB2     		uxth	r3, r3
 5687 0036 8B42     		cmp	r3, r1
 5688 0038 44D1     		bne	.L637
 5689              	.LVL628:
 5690              	.LBB61:
 5691              	.LBB62:
 5692              	.LBB63:
2093:bluetooth_rxtx.c **** 		u32 second_ts = CLK100NS;
 5693              		.loc 1 2093 0
 5694 003a 40F63541 		movw	r1, #3125
 5695 003e 254B     		ldr	r3, .L645+8
2094:bluetooth_rxtx.c **** 		if (second_ts < first_ts)
2095:bluetooth_rxtx.c **** 			second_ts += 3276800000; // handle rollover
2096:bluetooth_rxtx.c **** 		// Number of channels hopped between previous and current timestamp.
2097:bluetooth_rxtx.c **** 		u32 channels_hopped = DIVIDE_ROUND(second_ts - first_ts,
 5696              		.loc 1 2097 0
 5697 0040 408C     		ldrh	r0, [r0, #34]
2093:bluetooth_rxtx.c **** 		u32 second_ts = CLK100NS;
 5698              		.loc 1 2093 0
 5699 0042 1A68     		ldr	r2, [r3]
 5700 0044 244B     		ldr	r3, .L645+12
 5701 0046 C2F31302 		ubfx	r2, r2, #0, #20
 5702 004a 1B68     		ldr	r3, [r3]
 5703 004c 01FB0233 		mla	r3, r1, r2, r3
 5704              	.LVL629:
2094:bluetooth_rxtx.c **** 		if (second_ts < first_ts)
 5705              		.loc 1 2094 0
 5706 0050 626B     		ldr	r2, [r4, #52]
 5707              		.loc 1 2097 0
 5708 0052 1E49     		ldr	r1, .L645
2094:bluetooth_rxtx.c **** 		if (second_ts < first_ts)
 5709              		.loc 1 2094 0
 5710 0054 9342     		cmp	r3, r2
2095:bluetooth_rxtx.c **** 		// Number of channels hopped between previous and current timestamp.
 5711              		.loc 1 2095 0
 5712 0056 3CBF     		itt	cc
 5713 0058 03F14343 		addcc	r3, r3, #-1023410176
 5714              	.LVL630:
 5715 005c 03F5A003 		addcc	r3, r3, #5242880
 5716              	.LVL631:
 5717 0060 9B1A     		subs	r3, r3, r2
 5718              	.LVL632:
 5719              		.loc 1 2097 0
 5720 0062 41F66A02 		movw	r2, #6250
 5721 0066 02FB0033 		mla	r3, r2, r0, r3
 5722 006a 43F2D402 		movw	r2, #12500
 5723 006e 4243     		muls	r2, r0, r2
 5724 0070 B3FBF2F3 		udiv	r3, r3, r2
 5725              	.LVL633:
ARM GAS  /tmp/ccDKg7Fp.s 			page 156


2098:bluetooth_rxtx.c **** 										   le.conn_interval * LE_BASECLK);
2099:bluetooth_rxtx.c **** 		if (channels_hopped < 37) {
 5726              		.loc 1 2099 0
 5727 0074 242B     		cmp	r3, #36
 5728 0076 21D8     		bhi	.L639
2100:bluetooth_rxtx.c **** 			// Get the hop increment based on the number of channels hopped.
2101:bluetooth_rxtx.c **** 			le.channel_increment = hop_interval_lut[channels_hopped];
 5729              		.loc 1 2101 0
 5730 0078 184A     		ldr	r2, .L645+16
2102:bluetooth_rxtx.c **** 			le.interval_timer = le.conn_interval / 2;
 5731              		.loc 1 2102 0
 5732 007a 4008     		lsrs	r0, r0, #1
2101:bluetooth_rxtx.c **** 			le.interval_timer = le.conn_interval / 2;
 5733              		.loc 1 2101 0
 5734 007c 1344     		add	r3, r3, r2
 5735              	.LVL634:
 5736 007e 93F87038 		ldrb	r3, [r3, #2160]	@ zero_extendqisi2
 5737              	.LVL635:
2103:bluetooth_rxtx.c **** 			le.conn_count = 0;
2104:bluetooth_rxtx.c **** 			le.conn_epoch = 0;
2105:bluetooth_rxtx.c **** 			do_hop = 0;
2106:bluetooth_rxtx.c **** 			// Move on to regular connection following.
2107:bluetooth_rxtx.c **** 			le.channel_idx = (1 + le.channel_increment) % 37;
 5738              		.loc 1 2107 0
 5739 0082 2525     		movs	r5, #37
2101:bluetooth_rxtx.c **** 			le.interval_timer = le.conn_interval / 2;
 5740              		.loc 1 2101 0
 5741 0084 8B76     		strb	r3, [r1, #26]
 5742              		.loc 1 2107 0
 5743 0086 0133     		adds	r3, r3, #1
2102:bluetooth_rxtx.c **** 			le.conn_count = 0;
 5744              		.loc 1 2102 0
 5745 0088 0884     		strh	r0, [r1, #32]	@ movhi
 5746              		.loc 1 2107 0
 5747 008a 93FBF5F0 		sdiv	r0, r3, r5
 5748 008e 05FB1033 		mls	r3, r5, r0, r3
2103:bluetooth_rxtx.c **** 			le.conn_count = 0;
 5749              		.loc 1 2103 0
 5750 0092 0022     		movs	r2, #0
 5751              		.loc 1 2107 0
 5752 0094 4B76     		strb	r3, [r1, #25]
2108:bluetooth_rxtx.c **** 			le.link_state = LINK_CONNECTED;
 5753              		.loc 1 2108 0
 5754 0096 0320     		movs	r0, #3
2109:bluetooth_rxtx.c **** 			le.crc_verify = 0;
2110:bluetooth_rxtx.c **** 			hop_mode = HOP_BTLE;
2111:bluetooth_rxtx.c **** 			packet_cb = connection_follow_cb;
 5755              		.loc 1 2111 0
 5756 0098 114B     		ldr	r3, .L645+20
2103:bluetooth_rxtx.c **** 			le.conn_epoch = 0;
 5757              		.loc 1 2103 0
 5758 009a 8A84     		strh	r2, [r1, #36]	@ movhi
2104:bluetooth_rxtx.c **** 			do_hop = 0;
 5759              		.loc 1 2104 0
 5760 009c CA61     		str	r2, [r1, #28]
2105:bluetooth_rxtx.c **** 			// Move on to regular connection following.
 5761              		.loc 1 2105 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 157


 5762 009e E272     		strb	r2, [r4, #11]
2109:bluetooth_rxtx.c **** 			hop_mode = HOP_BTLE;
 5763              		.loc 1 2109 0
 5764 00a0 4A61     		str	r2, [r1, #20]
2108:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 5765              		.loc 1 2108 0
 5766 00a2 0876     		strb	r0, [r1, #24]
2112:bluetooth_rxtx.c **** 			le_promisc_state(3, &le.channel_increment, 1);
 5767              		.loc 1 2112 0
 5768 00a4 0122     		movs	r2, #1
 5769 00a6 1A31     		adds	r1, r1, #26
2111:bluetooth_rxtx.c **** 			le_promisc_state(3, &le.channel_increment, 1);
 5770              		.loc 1 2111 0
 5771 00a8 A361     		str	r3, [r4, #24]
2110:bluetooth_rxtx.c **** 			packet_cb = connection_follow_cb;
 5772              		.loc 1 2110 0
 5773 00aa A072     		strb	r0, [r4, #10]
 5774              		.loc 1 2112 0
 5775 00ac FFF7FEFF 		bl	le_promisc_state
 5776              	.LVL636:
2113:bluetooth_rxtx.c **** 
2114:bluetooth_rxtx.c **** 			if (jam_mode != JAM_NONE)
 5777              		.loc 1 2114 0
 5778 00b0 E37C     		ldrb	r3, [r4, #19]	@ zero_extendqisi2
 5779 00b2 53B1     		cbz	r3, .L634
2115:bluetooth_rxtx.c **** 				le_jam_count = JAM_COUNT_DEFAULT;
 5780              		.loc 1 2115 0
 5781 00b4 064B     		ldr	r3, .L645+4
 5782 00b6 2822     		movs	r2, #40
 5783 00b8 DA61     		str	r2, [r3, #28]
 5784 00ba 38BD     		pop	{r3, r4, r5, pc}
 5785              	.LVL637:
 5786              	.L639:
2116:bluetooth_rxtx.c **** 
2117:bluetooth_rxtx.c **** 			return;
2118:bluetooth_rxtx.c **** 		}
2119:bluetooth_rxtx.c **** 		hop_direct_channel = 2404;
 5787              		.loc 1 2119 0
 5788 00bc 40F66413 		movw	r3, #2404
 5789              	.LVL638:
 5790              	.L644:
 5791 00c0 A381     		strh	r3, [r4, #12]	@ movhi
 5792 00c2 00E0     		b	.L643
 5793              	.L637:
 5794              	.LBE63:
 5795              	.LBE62:
 5796              	.LBE61:
2120:bluetooth_rxtx.c **** 		do_hop = 1;
2121:bluetooth_rxtx.c **** 	}
2122:bluetooth_rxtx.c **** 	else {
2123:bluetooth_rxtx.c **** 		hop_direct_channel = 2404;
 5797              		.loc 1 2123 0
 5798 00c4 A281     		strh	r2, [r4, #12]	@ movhi
 5799              	.L643:
2124:bluetooth_rxtx.c **** 		do_hop = 1;
 5800              		.loc 1 2124 0
 5801 00c6 0123     		movs	r3, #1
ARM GAS  /tmp/ccDKg7Fp.s 			page 158


 5802 00c8 E372     		strb	r3, [r4, #11]
 5803              	.L634:
 5804 00ca 38BD     		pop	{r3, r4, r5, pc}
 5805              	.L646:
 5806              		.align	2
 5807              	.L645:
 5808 00cc 00000000 		.word	.LANCHOR1
 5809 00d0 00000000 		.word	.LANCHOR0
 5810 00d4 00000000 		.word	clkn
 5811 00d8 08400040 		.word	1073758216
 5812 00dc 00000000 		.word	.LANCHOR2
 5813 00e0 00000000 		.word	connection_follow_cb
 5814              		.cfi_endproc
 5815              	.LFE28:
 5817              		.section	.text.promisc_recover_hop_interval,"ax",%progbits
 5818              		.align	1
 5819              		.global	promisc_recover_hop_interval
 5820              		.thumb
 5821              		.thumb_func
 5823              	promisc_recover_hop_interval:
 5824              	.LFB29:
2125:bluetooth_rxtx.c **** 	}
2126:bluetooth_rxtx.c **** }
2127:bluetooth_rxtx.c **** 
2128:bluetooth_rxtx.c **** void promisc_recover_hop_interval(u8 *packet) {
 5825              		.loc 1 2128 0
 5826              		.cfi_startproc
 5827              		@ args = 0, pretend = 0, frame = 0
 5828              		@ frame_needed = 0, uses_anonymous_args = 0
 5829              	.LVL639:
 5830 0000 38B5     		push	{r3, r4, r5, lr}
 5831              		.cfi_def_cfa_offset 16
 5832              		.cfi_offset 3, -16
 5833              		.cfi_offset 4, -12
 5834              		.cfi_offset 5, -8
 5835              		.cfi_offset 14, -4
2129:bluetooth_rxtx.c **** 	static u32 prev_clk = 0;
2130:bluetooth_rxtx.c **** 
2131:bluetooth_rxtx.c **** 	u32 cur_clk = CLK100NS;
 5836              		.loc 1 2131 0
 5837 0002 40F63544 		movw	r4, #3125
 5838 0006 244B     		ldr	r3, .L653
 5839 0008 244A     		ldr	r2, .L653+4
 5840 000a 1B68     		ldr	r3, [r3]
 5841 000c 1268     		ldr	r2, [r2]
 5842 000e C3F31303 		ubfx	r3, r3, #0, #20
 5843 0012 04FB0324 		mla	r4, r4, r3, r2
 5844              	.LVL640:
2132:bluetooth_rxtx.c **** 	if (cur_clk < prev_clk)
2133:bluetooth_rxtx.c **** 		cur_clk += 3267800000; // handle rollover
2134:bluetooth_rxtx.c **** 	u32 clk_diff = cur_clk - prev_clk;
2135:bluetooth_rxtx.c **** 	u16 obsv_hop_interval; // observed hop interval
2136:bluetooth_rxtx.c **** 
2137:bluetooth_rxtx.c **** 	// probably consecutive data packets on the same channel
2138:bluetooth_rxtx.c **** 	if (clk_diff < 2 * LE_BASECLK)
 5845              		.loc 1 2138 0
 5846 0016 46F2A712 		movw	r2, #24999
ARM GAS  /tmp/ccDKg7Fp.s 			page 159


2132:bluetooth_rxtx.c **** 	if (cur_clk < prev_clk)
 5847              		.loc 1 2132 0
 5848 001a 214D     		ldr	r5, .L653+8
 5849 001c AB6B     		ldr	r3, [r5, #56]
 5850 001e 9C42     		cmp	r4, r3
2133:bluetooth_rxtx.c **** 	u32 clk_diff = cur_clk - prev_clk;
 5851              		.loc 1 2133 0
 5852 0020 3EBF     		ittt	cc
 5853 0022 04F14344 		addcc	r4, r4, #-1023410176
 5854              	.LVL641:
 5855 0026 A4F56514 		subcc	r4, r4, #3751936
 5856 002a A4F5A254 		subcc	r4, r4, #5184
 5857              	.LVL642:
2134:bluetooth_rxtx.c **** 	u16 obsv_hop_interval; // observed hop interval
 5858              		.loc 1 2134 0
 5859 002e E31A     		subs	r3, r4, r3
 5860              	.LVL643:
 5861              		.loc 1 2138 0
 5862 0030 9342     		cmp	r3, r2
 5863 0032 30D9     		bls	.L647
2139:bluetooth_rxtx.c **** 		return;
2140:bluetooth_rxtx.c **** 
2141:bluetooth_rxtx.c **** 	if (clk_diff < le_promisc.smallest_hop_interval)
 5864              		.loc 1 2141 0
 5865 0034 1B4A     		ldr	r2, .L653+12
2142:bluetooth_rxtx.c **** 		le_promisc.smallest_hop_interval = clk_diff;
2143:bluetooth_rxtx.c **** 
2144:bluetooth_rxtx.c **** 	obsv_hop_interval = DIVIDE_ROUND(le_promisc.smallest_hop_interval, 37 * LE_BASECLK);
 5866              		.loc 1 2144 0
 5867 0036 1B48     		ldr	r0, .L653+12
 5868              	.LVL644:
2141:bluetooth_rxtx.c **** 		le_promisc.smallest_hop_interval = clk_diff;
 5869              		.loc 1 2141 0
 5870 0038 D2F80011 		ldr	r1, [r2, #256]
 5871 003c 8B42     		cmp	r3, r1
2142:bluetooth_rxtx.c **** 		le_promisc.smallest_hop_interval = clk_diff;
 5872              		.loc 1 2142 0
 5873 003e 38BF     		it	cc
 5874 0040 C2F80031 		strcc	r3, [r2, #256]
 5875              		.loc 1 2144 0
 5876 0044 D2F80031 		ldr	r3, [r2, #256]
 5877              	.LVL645:
 5878 0048 174A     		ldr	r2, .L653+16
 5879 004a 03F56133 		add	r3, r3, #230400
 5880 004e 03F25233 		addw	r3, r3, #850
 5881 0052 B3FBF2F3 		udiv	r3, r3, r2
2145:bluetooth_rxtx.c **** 
2146:bluetooth_rxtx.c **** 	if (le.conn_interval == obsv_hop_interval) {
 5882              		.loc 1 2146 0
 5883 0056 1549     		ldr	r1, .L653+20
2144:bluetooth_rxtx.c **** 
 5884              		.loc 1 2144 0
 5885 0058 9BB2     		uxth	r3, r3
 5886              	.LVL646:
 5887              		.loc 1 2146 0
 5888 005a 4A8C     		ldrh	r2, [r1, #34]
 5889 005c 9A42     		cmp	r2, r3
ARM GAS  /tmp/ccDKg7Fp.s 			page 160


 5890 005e 15D1     		bne	.L651
2147:bluetooth_rxtx.c **** 		// 5 consecutive hop intervals: consider it legit and move on
2148:bluetooth_rxtx.c **** 		++le_promisc.consec_intervals;
 5891              		.loc 1 2148 0
 5892 0060 D0F80431 		ldr	r3, [r0, #260]
 5893              	.LVL647:
 5894 0064 0133     		adds	r3, r3, #1
2149:bluetooth_rxtx.c **** 		if (le_promisc.consec_intervals == 5) {
 5895              		.loc 1 2149 0
 5896 0066 052B     		cmp	r3, #5
2148:bluetooth_rxtx.c **** 		if (le_promisc.consec_intervals == 5) {
 5897              		.loc 1 2148 0
 5898 0068 C0F80431 		str	r3, [r0, #260]
 5899              		.loc 1 2149 0
 5900 006c 12D1     		bne	.L652
2150:bluetooth_rxtx.c **** 			packet_cb = promisc_recover_hop_increment;
 5901              		.loc 1 2150 0
 5902 006e 104B     		ldr	r3, .L653+24
2151:bluetooth_rxtx.c **** 			hop_direct_channel = 2404;
2152:bluetooth_rxtx.c **** 			hop_mode = HOP_DIRECT;
2153:bluetooth_rxtx.c **** 			do_hop = 1;
2154:bluetooth_rxtx.c **** 			le_promisc_state(2, &le.conn_interval, 2);
 5903              		.loc 1 2154 0
 5904 0070 0220     		movs	r0, #2
2150:bluetooth_rxtx.c **** 			packet_cb = promisc_recover_hop_increment;
 5905              		.loc 1 2150 0
 5906 0072 AB61     		str	r3, [r5, #24]
2151:bluetooth_rxtx.c **** 			hop_direct_channel = 2404;
 5907              		.loc 1 2151 0
 5908 0074 40F66413 		movw	r3, #2404
 5909 0078 AB81     		strh	r3, [r5, #12]	@ movhi
2152:bluetooth_rxtx.c **** 			do_hop = 1;
 5910              		.loc 1 2152 0
 5911 007a 0423     		movs	r3, #4
 5912 007c AB72     		strb	r3, [r5, #10]
 5913              		.loc 1 2154 0
 5914 007e 2231     		adds	r1, r1, #34
2153:bluetooth_rxtx.c **** 			le_promisc_state(2, &le.conn_interval, 2);
 5915              		.loc 1 2153 0
 5916 0080 0123     		movs	r3, #1
 5917              		.loc 1 2154 0
 5918 0082 0246     		mov	r2, r0
2153:bluetooth_rxtx.c **** 			le_promisc_state(2, &le.conn_interval, 2);
 5919              		.loc 1 2153 0
 5920 0084 EB72     		strb	r3, [r5, #11]
 5921              		.loc 1 2154 0
 5922 0086 FFF7FEFF 		bl	le_promisc_state
 5923              	.LVL648:
 5924 008a 03E0     		b	.L652
 5925              	.LVL649:
 5926              	.L651:
2155:bluetooth_rxtx.c **** 		}
2156:bluetooth_rxtx.c **** 	} else {
2157:bluetooth_rxtx.c **** 		le.conn_interval = obsv_hop_interval;
 5927              		.loc 1 2157 0
 5928 008c 4B84     		strh	r3, [r1, #34]	@ movhi
2158:bluetooth_rxtx.c **** 		le_promisc.consec_intervals = 0;
ARM GAS  /tmp/ccDKg7Fp.s 			page 161


 5929              		.loc 1 2158 0
 5930 008e 0023     		movs	r3, #0
 5931              	.LVL650:
 5932 0090 C0F80431 		str	r3, [r0, #260]
 5933              	.LVL651:
 5934              	.L652:
2159:bluetooth_rxtx.c **** 	}
2160:bluetooth_rxtx.c **** 
2161:bluetooth_rxtx.c **** 	prev_clk = cur_clk;
 5935              		.loc 1 2161 0
 5936 0094 AC63     		str	r4, [r5, #56]
 5937              	.L647:
 5938 0096 38BD     		pop	{r3, r4, r5, pc}
 5939              	.LVL652:
 5940              	.L654:
 5941              		.align	2
 5942              	.L653:
 5943 0098 00000000 		.word	clkn
 5944 009c 08400040 		.word	1073758216
 5945 00a0 00000000 		.word	.LANCHOR0
 5946 00a4 00000000 		.word	le_promisc
 5947 00a8 A40E0700 		.word	462500
 5948 00ac 00000000 		.word	.LANCHOR1
 5949 00b0 00000000 		.word	promisc_recover_hop_increment
 5950              		.cfi_endproc
 5951              	.LFE29:
 5953              		.section	.text.promisc_follow_cb,"ax",%progbits
 5954              		.align	1
 5955              		.global	promisc_follow_cb
 5956              		.thumb
 5957              		.thumb_func
 5959              	promisc_follow_cb:
 5960              	.LFB30:
2162:bluetooth_rxtx.c **** }
2163:bluetooth_rxtx.c **** 
2164:bluetooth_rxtx.c **** void promisc_follow_cb(u8 *packet) {
 5961              		.loc 1 2164 0
 5962              		.cfi_startproc
 5963              		@ args = 0, pretend = 0, frame = 0
 5964              		@ frame_needed = 0, uses_anonymous_args = 0
 5965              	.LVL653:
 5966 0000 38B5     		push	{r3, r4, r5, lr}
 5967              		.cfi_def_cfa_offset 16
 5968              		.cfi_offset 3, -16
 5969              		.cfi_offset 4, -12
 5970              		.cfi_offset 5, -8
 5971              		.cfi_offset 14, -4
2165:bluetooth_rxtx.c **** 	int i;
2166:bluetooth_rxtx.c **** 
2167:bluetooth_rxtx.c **** 	// get the CRCInit
2168:bluetooth_rxtx.c **** 	if (!le.crc_verify && packet[4] == 0x01 && packet[5] == 0x00) {
 5972              		.loc 1 2168 0
 5973 0002 184D     		ldr	r5, .L659
2164:bluetooth_rxtx.c **** 	int i;
 5974              		.loc 1 2164 0
 5975 0004 0146     		mov	r1, r0
 5976              		.loc 1 2168 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 162


 5977 0006 6B69     		ldr	r3, [r5, #20]
 5978 0008 53BB     		cbnz	r3, .L655
 5979              		.loc 1 2168 0 is_stmt 0 discriminator 1
 5980 000a 0379     		ldrb	r3, [r0, #4]	@ zero_extendqisi2
 5981 000c 012B     		cmp	r3, #1
 5982 000e 27D1     		bne	.L655
 5983              		.loc 1 2168 0 discriminator 2
 5984 0010 4479     		ldrb	r4, [r0, #5]	@ zero_extendqisi2
 5985 0012 2CBB     		cbnz	r4, .L655
 5986              	.LVL654:
 5987              	.LBB67:
 5988              	.LBB68:
 5989              	.LBB69:
2169:bluetooth_rxtx.c **** 		u32 crc = (packet[8] << 16) | (packet[7] << 8) | packet[6];
 5990              		.loc 1 2169 0 is_stmt 1
 5991 0014 CB79     		ldrb	r3, [r1, #7]	@ zero_extendqisi2
 5992 0016 007A     		ldrb	r0, [r0, #8]	@ zero_extendqisi2
 5993              	.LVL655:
 5994 0018 1B02     		lsls	r3, r3, #8
 5995 001a 43EA0043 		orr	r3, r3, r0, lsl #16
 5996 001e 8879     		ldrb	r0, [r1, #6]	@ zero_extendqisi2
2170:bluetooth_rxtx.c **** 
2171:bluetooth_rxtx.c **** 		le.crc_init = btle_reverse_crc(crc, packet + 4, 2);
 5997              		.loc 1 2171 0
 5998 0020 0222     		movs	r2, #2
 5999 0022 1843     		orrs	r0, r0, r3
 6000 0024 0431     		adds	r1, r1, #4
 6001              	.LVL656:
 6002 0026 FFF7FEFF 		bl	btle_reverse_crc
 6003              	.LVL657:
 6004 002a 2346     		mov	r3, r4
2172:bluetooth_rxtx.c **** 		le.crc_init_reversed = 0;
2173:bluetooth_rxtx.c **** 		for (i = 0; i < 24; ++i)
 6005              		.loc 1 2173 0
 6006 002c 2246     		mov	r2, r4
2171:bluetooth_rxtx.c **** 		le.crc_init_reversed = 0;
 6007              		.loc 1 2171 0
 6008 002e E860     		str	r0, [r5, #12]
 6009              	.LVL658:
 6010              	.L657:
2174:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 6011              		.loc 1 2174 0
 6012 0030 20FA02F1 		lsr	r1, r0, r2
 6013 0034 C2F11704 		rsb	r4, r2, #23
 6014 0038 01F00101 		and	r1, r1, #1
2173:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 6015              		.loc 1 2173 0
 6016 003c 0132     		adds	r2, r2, #1
 6017              	.LVL659:
 6018              		.loc 1 2174 0
 6019 003e A140     		lsls	r1, r1, r4
2173:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 6020              		.loc 1 2173 0
 6021 0040 182A     		cmp	r2, #24
 6022              		.loc 1 2174 0
 6023 0042 43EA0103 		orr	r3, r3, r1
2173:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
ARM GAS  /tmp/ccDKg7Fp.s 			page 163


 6024              		.loc 1 2173 0
 6025 0046 F3D1     		bne	.L657
 6026 0048 2B61     		str	r3, [r5, #16]
2175:bluetooth_rxtx.c **** 
2176:bluetooth_rxtx.c **** 		le.crc_verify = 1;
2177:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 6027              		.loc 1 2177 0
 6028 004a 074A     		ldr	r2, .L659+4
 6029              	.LVL660:
 6030 004c 074B     		ldr	r3, .L659+8
2176:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 6031              		.loc 1 2176 0
 6032 004e 0120     		movs	r0, #1
 6033              		.loc 1 2177 0
 6034 0050 9A61     		str	r2, [r3, #24]
2176:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 6035              		.loc 1 2176 0
 6036 0052 6861     		str	r0, [r5, #20]
2178:bluetooth_rxtx.c **** 		le_promisc_state(1, &le.crc_init, 3);
 6037              		.loc 1 2178 0
 6038 0054 0649     		ldr	r1, .L659+12
 6039 0056 0322     		movs	r2, #3
 6040              	.LBE69:
 6041              	.LBE68:
 6042              	.LBE67:
2179:bluetooth_rxtx.c **** 	}
2180:bluetooth_rxtx.c **** }
 6043              		.loc 1 2180 0
 6044 0058 BDE83840 		pop	{r3, r4, r5, lr}
 6045              		.cfi_remember_state
 6046              		.cfi_restore 14
 6047              		.cfi_restore 5
 6048              		.cfi_restore 4
 6049              		.cfi_restore 3
 6050              		.cfi_def_cfa_offset 0
 6051              	.LBB72:
 6052              	.LBB71:
 6053              	.LBB70:
2178:bluetooth_rxtx.c **** 		le_promisc_state(1, &le.crc_init, 3);
 6054              		.loc 1 2178 0
 6055 005c FFF7FEBF 		b	le_promisc_state
 6056              	.LVL661:
 6057              	.L655:
 6058              		.cfi_restore_state
 6059 0060 38BD     		pop	{r3, r4, r5, pc}
 6060              	.L660:
 6061 0062 00BF     		.align	2
 6062              	.L659:
 6063 0064 00000000 		.word	.LANCHOR1
 6064 0068 00000000 		.word	promisc_recover_hop_interval
 6065 006c 00000000 		.word	.LANCHOR0
 6066 0070 0C000000 		.word	.LANCHOR1+12
 6067              	.LBE70:
 6068              	.LBE71:
 6069              	.LBE72:
 6070              		.cfi_endproc
 6071              	.LFE30:
ARM GAS  /tmp/ccDKg7Fp.s 			page 164


 6073              		.section	.text.see_aa,"ax",%progbits
 6074              		.align	1
 6075              		.global	see_aa
 6076              		.thumb
 6077              		.thumb_func
 6079              	see_aa:
 6080              	.LFB31:
2181:bluetooth_rxtx.c **** 
2182:bluetooth_rxtx.c **** // called when we see an AA, add it to the list
2183:bluetooth_rxtx.c **** void see_aa(u32 aa) {
 6081              		.loc 1 2183 0
 6082              		.cfi_startproc
 6083              		@ args = 0, pretend = 0, frame = 0
 6084              		@ frame_needed = 0, uses_anonymous_args = 0
 6085              	.LVL662:
 6086 0000 30B5     		push	{r4, r5, lr}
 6087              		.cfi_def_cfa_offset 12
 6088              		.cfi_offset 4, -12
 6089              		.cfi_offset 5, -8
 6090              		.cfi_offset 14, -4
 6091              	.LVL663:
2184:bluetooth_rxtx.c **** 	int i, max = -1, killme = -1;
2185:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i)
 6092              		.loc 1 2185 0
 6093 0002 0022     		movs	r2, #0
 6094              	.LVL664:
 6095              	.L664:
2186:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].aa == aa) {
 6096              		.loc 1 2186 0
 6097 0004 124B     		ldr	r3, .L670
 6098 0006 53F83240 		ldr	r4, [r3, r2, lsl #3]
 6099 000a 03EBC201 		add	r1, r3, r2, lsl #3
 6100 000e 8442     		cmp	r4, r0
 6101 0010 03D1     		bne	.L662
2187:bluetooth_rxtx.c **** 			++le_promisc.active_aa[i].count;
 6102              		.loc 1 2187 0
 6103 0012 4B68     		ldr	r3, [r1, #4]
 6104 0014 0133     		adds	r3, r3, #1
 6105 0016 4B60     		str	r3, [r1, #4]
2188:bluetooth_rxtx.c **** 			return;
 6106              		.loc 1 2188 0
 6107 0018 30BD     		pop	{r4, r5, pc}
 6108              	.L662:
2185:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].aa == aa) {
 6109              		.loc 1 2185 0 discriminator 2
 6110 001a 0132     		adds	r2, r2, #1
 6111              	.LVL665:
 6112 001c 202A     		cmp	r2, #32
 6113 001e F1D1     		bne	.L664
 6114 0020 4FF0FF31 		mov	r1, #-1
 6115 0024 0C46     		mov	r4, r1
 6116 0026 0022     		movs	r2, #0
 6117              	.LVL666:
 6118              	.L666:
 6119 0028 03EBC205 		add	r5, r3, r2, lsl #3
 6120              	.LBB75:
 6121              	.LBB76:
ARM GAS  /tmp/ccDKg7Fp.s 			page 165


2189:bluetooth_rxtx.c **** 		}
2190:bluetooth_rxtx.c **** 
2191:bluetooth_rxtx.c **** 	// evict someone
2192:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i)
2193:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count < max || max < 0) {
 6122              		.loc 1 2193 0
 6123 002c 6D68     		ldr	r5, [r5, #4]
 6124 002e A542     		cmp	r5, r4
 6125 0030 01DB     		blt	.L667
 6126 0032 002C     		cmp	r4, #0
 6127 0034 01DA     		bge	.L665
 6128              	.L667:
 6129 0036 1146     		mov	r1, r2
 6130 0038 2C46     		mov	r4, r5
 6131              	.LVL667:
 6132              	.L665:
2192:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count < max || max < 0) {
 6133              		.loc 1 2192 0
 6134 003a 0132     		adds	r2, r2, #1
 6135              	.LVL668:
 6136 003c 202A     		cmp	r2, #32
 6137 003e F3D1     		bne	.L666
2194:bluetooth_rxtx.c **** 			killme = i;
2195:bluetooth_rxtx.c **** 			max = le_promisc.active_aa[i].count;
2196:bluetooth_rxtx.c **** 		}
2197:bluetooth_rxtx.c **** 
2198:bluetooth_rxtx.c **** 	le_promisc.active_aa[killme].aa = aa;
 6138              		.loc 1 2198 0
 6139 0040 43F83100 		str	r0, [r3, r1, lsl #3]
2199:bluetooth_rxtx.c **** 	le_promisc.active_aa[killme].count = 1;
 6140              		.loc 1 2199 0
 6141 0044 0122     		movs	r2, #1
 6142              	.LVL669:
 6143 0046 03EBC103 		add	r3, r3, r1, lsl #3
 6144 004a 5A60     		str	r2, [r3, #4]
 6145 004c 30BD     		pop	{r4, r5, pc}
 6146              	.LVL670:
 6147              	.L671:
 6148 004e 00BF     		.align	2
 6149              	.L670:
 6150 0050 00000000 		.word	le_promisc
 6151              	.LBE76:
 6152              	.LBE75:
 6153              		.cfi_endproc
 6154              	.LFE31:
 6156              		.section	.text.cb_le_promisc,"ax",%progbits
 6157              		.align	1
 6158              		.global	cb_le_promisc
 6159              		.thumb
 6160              		.thumb_func
 6162              	cb_le_promisc:
 6163              	.LFB32:
2200:bluetooth_rxtx.c **** }
2201:bluetooth_rxtx.c **** 
2202:bluetooth_rxtx.c **** /* le promiscuous mode */
2203:bluetooth_rxtx.c **** int cb_le_promisc(char *unpacked) {
 6164              		.loc 1 2203 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 166


 6165              		.cfi_startproc
 6166              		@ args = 0, pretend = 0, frame = 80
 6167              		@ frame_needed = 0, uses_anonymous_args = 0
 6168              	.LVL671:
 6169 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 6170              		.cfi_def_cfa_offset 24
 6171              		.cfi_offset 4, -24
 6172              		.cfi_offset 5, -20
 6173              		.cfi_offset 6, -16
 6174              		.cfi_offset 7, -12
 6175              		.cfi_offset 8, -8
 6176              		.cfi_offset 14, -4
 6177 0004 94B0     		sub	sp, sp, #80
 6178              		.cfi_def_cfa_offset 104
2204:bluetooth_rxtx.c **** 	int i, j, k;
2205:bluetooth_rxtx.c **** 	int idx;
2206:bluetooth_rxtx.c **** 
2207:bluetooth_rxtx.c **** 	// empty data PDU: 01 00
2208:bluetooth_rxtx.c **** 	char desired[4][16] = {
 6179              		.loc 1 2208 0
 6180 0006 0021     		movs	r1, #0
2203:bluetooth_rxtx.c **** 	int i, j, k;
 6181              		.loc 1 2203 0
 6182 0008 0446     		mov	r4, r0
 6183              		.loc 1 2208 0
 6184 000a 4022     		movs	r2, #64
 6185 000c 04A8     		add	r0, sp, #16
 6186              	.LVL672:
 6187 000e FFF7FEFF 		bl	memset
 6188              	.LVL673:
 6189 0012 0123     		movs	r3, #1
 6190 0014 8DF81030 		strb	r3, [sp, #16]
 6191 0018 8DF82030 		strb	r3, [sp, #32]
 6192 001c 8DF82330 		strb	r3, [sp, #35]
 6193 0020 8DF83030 		strb	r3, [sp, #48]
 6194 0024 8DF83230 		strb	r3, [sp, #50]
 6195 0028 8DF84030 		strb	r3, [sp, #64]
 6196 002c 8DF84230 		strb	r3, [sp, #66]
 6197 0030 8DF84330 		strb	r3, [sp, #67]
 6198              	.LVL674:
 6199 0034 0027     		movs	r7, #0
 6200              	.LVL675:
 6201              	.L674:
2209:bluetooth_rxtx.c **** 		{ 1, 0, 0, 0, 0, 0, 0, 0,
2210:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2211:bluetooth_rxtx.c **** 		{ 1, 0, 0, 1, 0, 0, 0, 0,
2212:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2213:bluetooth_rxtx.c **** 		{ 1, 0, 1, 0, 0, 0, 0, 0,
2214:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2215:bluetooth_rxtx.c **** 		{ 1, 0, 1, 1, 0, 0, 0, 0,
2216:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2217:bluetooth_rxtx.c **** 	};
2218:bluetooth_rxtx.c **** 
2219:bluetooth_rxtx.c **** 	for (i = 0; i < 4; ++i) {
2220:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel)];
 6202              		.loc 1 2220 0
 6203 0036 584D     		ldr	r5, .L701
ARM GAS  /tmp/ccDKg7Fp.s 			page 167


 6204 0038 584E     		ldr	r6, .L701+4
 6205 003a 2888     		ldrh	r0, [r5]
 6206 003c 80B2     		uxth	r0, r0
 6207 003e FFF7FEFF 		bl	btle_channel_index
 6208              	.LVL676:
 6209 0042 335C     		ldrb	r3, [r6, r0]	@ zero_extendqisi2
 6210              	.LVL677:
2221:bluetooth_rxtx.c **** 
2222:bluetooth_rxtx.c **** 		// whiten the desired data
2223:bluetooth_rxtx.c **** 		for (j = 0; j < (int)sizeof(desired[i]); ++j) {
 6211              		.loc 1 2223 0
 6212 0044 0021     		movs	r1, #0
 6213              	.LVL678:
 6214              	.L673:
2224:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6215              		.loc 1 2224 0 discriminator 3
 6216 0046 04AA     		add	r2, sp, #16
 6217 0048 3A44     		add	r2, r2, r7
 6218 004a F018     		adds	r0, r6, r3
 6219 004c 12F801E0 		ldrb	lr, [r2, r1]	@ zero_extendqisi2
 6220 0050 90F82800 		ldrb	r0, [r0, #40]	@ zero_extendqisi2
2225:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 6221              		.loc 1 2225 0 discriminator 3
 6222 0054 0133     		adds	r3, r3, #1
 6223              	.LVL679:
2224:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6224              		.loc 1 2224 0 discriminator 3
 6225 0056 8EEA0000 		eor	r0, lr, r0
 6226 005a 5054     		strb	r0, [r2, r1]
 6227              		.loc 1 2225 0 discriminator 3
 6228 005c 7F22     		movs	r2, #127
 6229 005e B3FBF2F2 		udiv	r2, r3, r2
2223:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6230              		.loc 1 2223 0 discriminator 3
 6231 0062 0131     		adds	r1, r1, #1
 6232              	.LVL680:
 6233              		.loc 1 2225 0 discriminator 3
 6234 0064 C2EBC212 		rsb	r2, r2, r2, lsl #7
2223:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6235              		.loc 1 2223 0 discriminator 3
 6236 0068 1029     		cmp	r1, #16
 6237              		.loc 1 2225 0 discriminator 3
 6238 006a A3EB0203 		sub	r3, r3, r2
 6239              	.LVL681:
2223:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6240              		.loc 1 2223 0 discriminator 3
 6241 006e EAD1     		bne	.L673
 6242 0070 1037     		adds	r7, r7, #16
2219:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel)];
 6243              		.loc 1 2219 0 discriminator 2
 6244 0072 402F     		cmp	r7, #64
 6245 0074 DFD1     		bne	.L674
 6246 0076 2027     		movs	r7, #32
 6247              	.LVL682:
 6248              	.L687:
 6249              	.LBB77:
2226:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/ccDKg7Fp.s 			page 168


2227:bluetooth_rxtx.c **** 	}
2228:bluetooth_rxtx.c **** 
2229:bluetooth_rxtx.c **** 	// then look for that bitsream in our receive buffer
2230:bluetooth_rxtx.c **** 	for (i = 32; i < (DMA_SIZE*8*2 - 32 - 16); i++) {
2231:bluetooth_rxtx.c **** 		int ok[4] = { 1, 1, 1, 1 };
 6250              		.loc 1 2231 0
 6251 0078 EE46     		mov	lr, sp
 6252 007a 494B     		ldr	r3, .L701+8
 6253 007c 0FCB     		ldmia	r3, {r0, r1, r2, r3}
 6254 007e 8DE80F00 		stmia	sp, {r0, r1, r2, r3}
 6255              	.LVL683:
2232:bluetooth_rxtx.c **** 		int matching = -1;
2233:bluetooth_rxtx.c **** 
2234:bluetooth_rxtx.c **** 		for (j = 0; j < 4; ++j) {
 6256              		.loc 1 2234 0
 6257 0082 0022     		movs	r2, #0
 6258              	.LVL684:
 6259              	.L675:
 6260 0084 04AB     		add	r3, sp, #16
 6261 0086 03EB0211 		add	r1, r3, r2, lsl #4
 6262              	.LBE77:
 6263 008a 0023     		movs	r3, #0
 6264              	.LVL685:
 6265              	.L678:
 6266 008c E019     		adds	r0, r4, r7
 6267              	.LBB82:
2235:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
2236:bluetooth_rxtx.c **** 				if (unpacked[i+k] != desired[j][k]) {
 6268              		.loc 1 2236 0
 6269 008e 10F803C0 		ldrb	ip, [r0, r3]	@ zero_extendqisi2
 6270 0092 C85C     		ldrb	r0, [r1, r3]	@ zero_extendqisi2
 6271 0094 8445     		cmp	ip, r0
 6272 0096 03D0     		beq	.L676
2237:bluetooth_rxtx.c **** 					ok[j] = 0;
 6273              		.loc 1 2237 0
 6274 0098 0023     		movs	r3, #0
 6275              	.LVL686:
 6276 009a 4EF82230 		str	r3, [lr, r2, lsl #2]
2238:bluetooth_rxtx.c **** 					break;
 6277              		.loc 1 2238 0
 6278 009e 02E0     		b	.L677
 6279              	.LVL687:
 6280              	.L676:
2235:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
 6281              		.loc 1 2235 0 discriminator 2
 6282 00a0 0133     		adds	r3, r3, #1
 6283              	.LVL688:
 6284 00a2 102B     		cmp	r3, #16
 6285 00a4 F2D1     		bne	.L678
 6286              	.LVL689:
 6287              	.L677:
2234:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
 6288              		.loc 1 2234 0 discriminator 2
 6289 00a6 0132     		adds	r2, r2, #1
 6290              	.LVL690:
 6291 00a8 042A     		cmp	r2, #4
 6292 00aa EBD1     		bne	.L675
ARM GAS  /tmp/ccDKg7Fp.s 			page 169


2234:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
 6293              		.loc 1 2234 0 is_stmt 0
 6294 00ac 0023     		movs	r3, #0
 6295              	.LVL691:
 6296              	.L681:
2239:bluetooth_rxtx.c **** 				}
2240:bluetooth_rxtx.c **** 			}
2241:bluetooth_rxtx.c **** 		}
2242:bluetooth_rxtx.c **** 
2243:bluetooth_rxtx.c **** 		// see if any match
2244:bluetooth_rxtx.c **** 		for (j = 0; j < 4; ++j) {
2245:bluetooth_rxtx.c **** 			if (ok[j]) {
 6297              		.loc 1 2245 0 is_stmt 1
 6298 00ae 5EF82320 		ldr	r2, [lr, r3, lsl #2]
 6299 00b2 1AB9     		cbnz	r2, .L680
2244:bluetooth_rxtx.c **** 			if (ok[j]) {
 6300              		.loc 1 2244 0 discriminator 2
 6301 00b4 0133     		adds	r3, r3, #1
 6302              	.LVL692:
 6303 00b6 042B     		cmp	r3, #4
 6304 00b8 F9D1     		bne	.L681
 6305 00ba 49E0     		b	.L691
 6306              	.L680:
 6307              	.LVL693:
2246:bluetooth_rxtx.c **** 				matching = j;
2247:bluetooth_rxtx.c **** 				break;
2248:bluetooth_rxtx.c **** 			}
2249:bluetooth_rxtx.c **** 		}
2250:bluetooth_rxtx.c **** 
2251:bluetooth_rxtx.c **** 		// skip if no match
2252:bluetooth_rxtx.c **** 		if (matching < 0)
2253:bluetooth_rxtx.c **** 			continue;
2254:bluetooth_rxtx.c **** 
2255:bluetooth_rxtx.c **** 		// found a match! unwhiten it and send it home
2256:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel)];
 6308              		.loc 1 2256 0
 6309 00bc 2888     		ldrh	r0, [r5]
 6310 00be 80B2     		uxth	r0, r0
 6311 00c0 FFF7FEFF 		bl	btle_channel_index
 6312              	.LVL694:
 6313 00c4 315C     		ldrb	r1, [r6, r0]	@ zero_extendqisi2
 6314              	.LVL695:
2257:bluetooth_rxtx.c **** 		for (j = 0; j < 4+3+3; ++j) {
 6315              		.loc 1 2257 0
 6316 00c6 0022     		movs	r2, #0
 6317              	.LVL696:
 6318              	.L692:
2234:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
 6319              		.loc 1 2234 0
 6320 00c8 4FF0000C 		mov	ip, #0
 6321 00cc E646     		mov	lr, ip
 6322 00ce 07EBC208 		add	r8, r7, r2, lsl #3
 6323              	.LVL697:
 6324              	.L685:
 6325 00d2 0EEB0803 		add	r3, lr, r8
 6326 00d6 2344     		add	r3, r3, r4
 6327              	.LBB78:
ARM GAS  /tmp/ccDKg7Fp.s 			page 170


 6328              	.LBB79:
2258:bluetooth_rxtx.c **** 			u8 byte = 0;
2259:bluetooth_rxtx.c **** 			for (k = 0; k < 8; k++) {
2260:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
2261:bluetooth_rxtx.c **** 				if (offset >= DMA_SIZE*8*2) break;
2262:bluetooth_rxtx.c **** 				int bit = unpacked[offset];
2263:bluetooth_rxtx.c **** 				if (j >= 4) { // unwhiten data bytes
 6329              		.loc 1 2263 0
 6330 00d8 032A     		cmp	r2, #3
2262:bluetooth_rxtx.c **** 				if (j >= 4) { // unwhiten data bytes
 6331              		.loc 1 2262 0
 6332 00da 13F8203C 		ldrb	r3, [r3, #-32]	@ zero_extendqisi2
 6333              	.LVL698:
 6334              		.loc 1 2263 0
 6335 00de 0ADD     		ble	.L684
2264:bluetooth_rxtx.c **** 					bit ^= whitening[idx];
 6336              		.loc 1 2264 0
 6337 00e0 7018     		adds	r0, r6, r1
 6338 00e2 90F82800 		ldrb	r0, [r0, #40]	@ zero_extendqisi2
2265:bluetooth_rxtx.c **** 					idx = (idx + 1) % sizeof(whitening);
 6339              		.loc 1 2265 0
 6340 00e6 0131     		adds	r1, r1, #1
 6341              	.LVL699:
2264:bluetooth_rxtx.c **** 					bit ^= whitening[idx];
 6342              		.loc 1 2264 0
 6343 00e8 4340     		eors	r3, r3, r0
 6344              	.LVL700:
 6345              		.loc 1 2265 0
 6346 00ea 7F20     		movs	r0, #127
 6347 00ec B1FBF0F0 		udiv	r0, r1, r0
 6348 00f0 C0EBC010 		rsb	r0, r0, r0, lsl #7
 6349 00f4 091A     		subs	r1, r1, r0
 6350              	.LVL701:
 6351              	.L684:
2266:bluetooth_rxtx.c **** 				}
2267:bluetooth_rxtx.c **** 				byte |= bit << k;
 6352              		.loc 1 2267 0 discriminator 2
 6353 00f6 03FA0EF3 		lsl	r3, r3, lr
 6354              	.LVL702:
 6355              	.LBE79:
2259:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 6356              		.loc 1 2259 0 discriminator 2
 6357 00fa 0EF1010E 		add	lr, lr, #1
 6358              	.LVL703:
 6359              	.LBB80:
 6360              		.loc 1 2267 0 discriminator 2
 6361 00fe 43EA0C03 		orr	r3, r3, ip
 6362              	.LBE80:
2259:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 6363              		.loc 1 2259 0 discriminator 2
 6364 0102 BEF1080F 		cmp	lr, #8
 6365              	.LBB81:
 6366              		.loc 1 2267 0 discriminator 2
 6367 0106 5FFA83FC 		uxtb	ip, r3
 6368              	.LVL704:
 6369              	.LBE81:
2259:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
ARM GAS  /tmp/ccDKg7Fp.s 			page 171


 6370              		.loc 1 2259 0 discriminator 2
 6371 010a E2D1     		bne	.L685
2268:bluetooth_rxtx.c **** 			}
2269:bluetooth_rxtx.c **** 			idle_rxbuf[j] = byte;
 6372              		.loc 1 2269 0
 6373 010c DFF8A880 		ldr	r8, .L701+32
 6374 0110 D8F80030 		ldr	r3, [r8]
 6375 0114 03F802C0 		strb	ip, [r3, r2]
 6376              	.LBE78:
2257:bluetooth_rxtx.c **** 			u8 byte = 0;
 6377              		.loc 1 2257 0
 6378 0118 0132     		adds	r2, r2, #1
 6379              	.LVL705:
 6380 011a 0A2A     		cmp	r2, #10
 6381 011c D4D1     		bne	.L692
2270:bluetooth_rxtx.c **** 		}
2271:bluetooth_rxtx.c **** 
2272:bluetooth_rxtx.c **** 		u32 aa = (idle_rxbuf[3] << 24) |
 6382              		.loc 1 2272 0
 6383 011e D8F80030 		ldr	r3, [r8]
 6384 0122 DB78     		ldrb	r3, [r3, #3]	@ zero_extendqisi2
2273:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 6385              		.loc 1 2273 0
 6386 0124 D8F80020 		ldr	r2, [r8]
 6387              	.LVL706:
 6388 0128 9278     		ldrb	r2, [r2, #2]	@ zero_extendqisi2
2274:bluetooth_rxtx.c **** 				 (idle_rxbuf[1] <<  8) |
 6389              		.loc 1 2274 0
 6390 012a D8F80010 		ldr	r1, [r8]
 6391              	.LVL707:
2273:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 6392              		.loc 1 2273 0
 6393 012e 1204     		lsls	r2, r2, #16
 6394              		.loc 1 2274 0
 6395 0130 4878     		ldrb	r0, [r1, #1]	@ zero_extendqisi2
2275:bluetooth_rxtx.c **** 				 (idle_rxbuf[0]);
 6396              		.loc 1 2275 0
 6397 0132 D8F80010 		ldr	r1, [r8]
2272:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 6398              		.loc 1 2272 0
 6399 0136 42EA0363 		orr	r3, r2, r3, lsl #24
 6400              		.loc 1 2275 0
 6401 013a 0978     		ldrb	r1, [r1]	@ zero_extendqisi2
 6402              	.LVL708:
 6403 013c 0B43     		orrs	r3, r3, r1
2276:bluetooth_rxtx.c **** 		see_aa(aa);
 6404              		.loc 1 2276 0
 6405 013e 43EA0020 		orr	r0, r3, r0, lsl #8
 6406 0142 FFF7FEFF 		bl	see_aa
 6407              	.LVL709:
2277:bluetooth_rxtx.c **** 
2278:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t*)idle_rxbuf);
 6408              		.loc 1 2278 0
 6409 0146 D8F80010 		ldr	r1, [r8]
 6410 014a 0120     		movs	r0, #1
 6411 014c FFF7FEFF 		bl	enqueue
 6412              	.LVL710:
ARM GAS  /tmp/ccDKg7Fp.s 			page 172


 6413              	.L691:
 6414              	.LBE82:
2230:bluetooth_rxtx.c **** 		int ok[4] = { 1, 1, 1, 1 };
 6415              		.loc 1 2230 0 discriminator 2
 6416 0150 0137     		adds	r7, r7, #1
 6417              	.LVL711:
 6418 0152 B7F53C7F 		cmp	r7, #752
 6419 0156 8FD1     		bne	.L687
 6420 0158 0023     		movs	r3, #0
 6421              	.LVL712:
 6422              	.L690:
 6423 015a 124A     		ldr	r2, .L701+12
 6424 015c 02EBC301 		add	r1, r2, r3, lsl #3
2279:bluetooth_rxtx.c **** 
2280:bluetooth_rxtx.c **** 	}
2281:bluetooth_rxtx.c **** 
2282:bluetooth_rxtx.c **** 	// once we see an AA 5 times, start following it
2283:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i) {
2284:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count > 3) {
 6425              		.loc 1 2284 0
 6426 0160 4968     		ldr	r1, [r1, #4]
 6427 0162 0329     		cmp	r1, #3
 6428 0164 11DD     		ble	.L688
2285:bluetooth_rxtx.c **** 			le_set_access_address(le_promisc.active_aa[i].aa);
 6429              		.loc 1 2285 0
 6430 0166 52F83300 		ldr	r0, [r2, r3, lsl #3]
 6431 016a FFF7FEFF 		bl	le_set_access_address
 6432              	.LVL713:
2286:bluetooth_rxtx.c **** 			data_cb = cb_follow_le;
 6433              		.loc 1 2286 0
 6434 016e 0E4B     		ldr	r3, .L701+16
 6435 0170 0E4A     		ldr	r2, .L701+20
2287:bluetooth_rxtx.c **** 			packet_cb = promisc_follow_cb;
2288:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 6436              		.loc 1 2288 0
 6437 0172 0024     		movs	r4, #0
 6438              	.LVL714:
2286:bluetooth_rxtx.c **** 			data_cb = cb_follow_le;
 6439              		.loc 1 2286 0
 6440 0174 DA62     		str	r2, [r3, #44]
2287:bluetooth_rxtx.c **** 			packet_cb = promisc_follow_cb;
 6441              		.loc 1 2287 0
 6442 0176 0E4A     		ldr	r2, .L701+24
2289:bluetooth_rxtx.c **** 			le_promisc_state(0, &le.access_address, 4);
 6443              		.loc 1 2289 0
 6444 0178 2046     		mov	r0, r4
2287:bluetooth_rxtx.c **** 			packet_cb = promisc_follow_cb;
 6445              		.loc 1 2287 0
 6446 017a 9A61     		str	r2, [r3, #24]
 6447              		.loc 1 2289 0
 6448 017c 0D49     		ldr	r1, .L701+28
 6449 017e 0422     		movs	r2, #4
2288:bluetooth_rxtx.c **** 			le_promisc_state(0, &le.access_address, 4);
 6450              		.loc 1 2288 0
 6451 0180 6C61     		str	r4, [r5, #20]
 6452              		.loc 1 2289 0
 6453 0182 FFF7FEFF 		bl	le_promisc_state
ARM GAS  /tmp/ccDKg7Fp.s 			page 173


 6454              	.LVL715:
2290:bluetooth_rxtx.c **** 			// quit using the old stuff and switch to sync mode
2291:bluetooth_rxtx.c **** 			return 0;
 6455              		.loc 1 2291 0
 6456 0186 2046     		mov	r0, r4
 6457 0188 03E0     		b	.L700
 6458              	.LVL716:
 6459              	.L688:
2283:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count > 3) {
 6460              		.loc 1 2283 0 discriminator 2
 6461 018a 0133     		adds	r3, r3, #1
 6462              	.LVL717:
 6463 018c 202B     		cmp	r3, #32
 6464 018e E4D1     		bne	.L690
2292:bluetooth_rxtx.c **** 		}
2293:bluetooth_rxtx.c **** 	}
2294:bluetooth_rxtx.c **** 
2295:bluetooth_rxtx.c **** 	return 1;
 6465              		.loc 1 2295 0
 6466 0190 0120     		movs	r0, #1
 6467              	.LVL718:
 6468              	.L700:
2296:bluetooth_rxtx.c **** }
 6469              		.loc 1 2296 0
 6470 0192 14B0     		add	sp, sp, #80
 6471              		.cfi_def_cfa_offset 24
 6472              		@ sp needed
 6473 0194 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 6474              	.L702:
 6475              		.align	2
 6476              	.L701:
 6477 0198 00000000 		.word	.LANCHOR1
 6478 019c 00000000 		.word	.LANCHOR2
 6479 01a0 98080000 		.word	.LANCHOR2+2200
 6480 01a4 00000000 		.word	le_promisc
 6481 01a8 00000000 		.word	.LANCHOR0
 6482 01ac 00000000 		.word	cb_follow_le
 6483 01b0 00000000 		.word	promisc_follow_cb
 6484 01b4 04000000 		.word	.LANCHOR1+4
 6485 01b8 00000000 		.word	idle_rxbuf
 6486              		.cfi_endproc
 6487              	.LFE32:
 6489              		.section	.text.bt_promisc_le,"ax",%progbits
 6490              		.align	1
 6491              		.global	bt_promisc_le
 6492              		.thumb
 6493              		.thumb_func
 6495              	bt_promisc_le:
 6496              	.LFB33:
2297:bluetooth_rxtx.c **** 
2298:bluetooth_rxtx.c **** void bt_promisc_le() {
 6497              		.loc 1 2298 0
 6498              		.cfi_startproc
 6499              		@ args = 0, pretend = 0, frame = 0
 6500              		@ frame_needed = 0, uses_anonymous_args = 0
 6501 0000 38B5     		push	{r3, r4, r5, lr}
 6502              		.cfi_def_cfa_offset 16
ARM GAS  /tmp/ccDKg7Fp.s 			page 174


 6503              		.cfi_offset 3, -16
 6504              		.cfi_offset 4, -12
 6505              		.cfi_offset 5, -8
 6506              		.cfi_offset 14, -4
 6507              	.L704:
2299:bluetooth_rxtx.c **** 	while (requested_mode == MODE_BT_PROMISC_LE) {
 6508              		.loc 1 2299 0
 6509 0002 164C     		ldr	r4, .L713
 6510 0004 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 6511 0006 0A2B     		cmp	r3, #10
 6512 0008 26D1     		bne	.L703
2300:bluetooth_rxtx.c **** 		reset_le_promisc();
2301:bluetooth_rxtx.c **** 
2302:bluetooth_rxtx.c **** 		// jump to a random data channel and turn up the squelch
2303:bluetooth_rxtx.c **** 		if ((channel & 1) == 1)
 6513              		.loc 1 2303 0
 6514 000a 154D     		ldr	r5, .L713+4
2300:bluetooth_rxtx.c **** 		reset_le_promisc();
 6515              		.loc 1 2300 0
 6516 000c FFF7FEFF 		bl	reset_le_promisc
 6517              	.LVL719:
 6518              		.loc 1 2303 0
 6519 0010 2B88     		ldrh	r3, [r5]
 6520 0012 DB07     		lsls	r3, r3, #31
2304:bluetooth_rxtx.c **** 			channel = 2440;
 6521              		.loc 1 2304 0
 6522 0014 44BF     		itt	mi
 6523 0016 40F68813 		movwmi	r3, #2440
 6524 001a 2B80     		strhmi	r3, [r5]	@ movhi
2305:bluetooth_rxtx.c **** 
2306:bluetooth_rxtx.c **** 		// if the PC hasn't given us AA, determine by listening
2307:bluetooth_rxtx.c **** 		if (!le.target_set) {
 6525              		.loc 1 2307 0
 6526 001c AB6C     		ldr	r3, [r5, #72]
 6527 001e 4BB9     		cbnz	r3, .L706
2308:bluetooth_rxtx.c **** 			// cs_threshold_req = -80;
2309:bluetooth_rxtx.c **** 			cs_threshold_calc_and_set(channel);
 6528              		.loc 1 2309 0
 6529 0020 0F4B     		ldr	r3, .L713+4
 6530 0022 1888     		ldrh	r0, [r3]
 6531 0024 80B2     		uxth	r0, r0
 6532 0026 FFF7FEFF 		bl	cs_threshold_calc_and_set
 6533              	.LVL720:
2310:bluetooth_rxtx.c **** 			data_cb = cb_le_promisc;
 6534              		.loc 1 2310 0
 6535 002a 0E4B     		ldr	r3, .L713+8
2311:bluetooth_rxtx.c **** 			bt_generic_le(MODE_BT_PROMISC_LE);
 6536              		.loc 1 2311 0
 6537 002c 0A20     		movs	r0, #10
2310:bluetooth_rxtx.c **** 			data_cb = cb_le_promisc;
 6538              		.loc 1 2310 0
 6539 002e E362     		str	r3, [r4, #44]
 6540              		.loc 1 2311 0
 6541 0030 FFF7FEFF 		bl	bt_generic_le
 6542              	.LVL721:
 6543              	.L706:
2312:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/ccDKg7Fp.s 			page 175


2313:bluetooth_rxtx.c **** 
2314:bluetooth_rxtx.c **** 		// could have got mode change in middle of above
2315:bluetooth_rxtx.c **** 		if (requested_mode != MODE_BT_PROMISC_LE)
 6544              		.loc 1 2315 0
 6545 0034 A47C     		ldrb	r4, [r4, #18]	@ zero_extendqisi2
 6546 0036 E4B2     		uxtb	r4, r4
 6547 0038 0A2C     		cmp	r4, #10
 6548 003a 0DD1     		bne	.L703
2316:bluetooth_rxtx.c **** 			break;
2317:bluetooth_rxtx.c **** 
2318:bluetooth_rxtx.c **** 		le_promisc_state(0, &le.access_address, 4);
 6549              		.loc 1 2318 0
 6550 003c 0020     		movs	r0, #0
 6551 003e 0A49     		ldr	r1, .L713+12
 6552 0040 0422     		movs	r2, #4
 6553 0042 FFF7FEFF 		bl	le_promisc_state
 6554              	.LVL722:
2319:bluetooth_rxtx.c **** 		packet_cb = promisc_follow_cb;
 6555              		.loc 1 2319 0
 6556 0046 094A     		ldr	r2, .L713+16
 6557 0048 044B     		ldr	r3, .L713
2320:bluetooth_rxtx.c **** 		le.crc_verify = 0;
2321:bluetooth_rxtx.c **** 		bt_le_sync(MODE_BT_PROMISC_LE);
 6558              		.loc 1 2321 0
 6559 004a 2046     		mov	r0, r4
2319:bluetooth_rxtx.c **** 		packet_cb = promisc_follow_cb;
 6560              		.loc 1 2319 0
 6561 004c 9A61     		str	r2, [r3, #24]
2320:bluetooth_rxtx.c **** 		le.crc_verify = 0;
 6562              		.loc 1 2320 0
 6563 004e 0023     		movs	r3, #0
 6564 0050 6B61     		str	r3, [r5, #20]
 6565              		.loc 1 2321 0
 6566 0052 FFF7FEFF 		bl	bt_le_sync
 6567              	.LVL723:
 6568 0056 D4E7     		b	.L704
 6569              	.L703:
 6570 0058 38BD     		pop	{r3, r4, r5, pc}
 6571              	.L714:
 6572 005a 00BF     		.align	2
 6573              	.L713:
 6574 005c 00000000 		.word	.LANCHOR0
 6575 0060 00000000 		.word	.LANCHOR1
 6576 0064 00000000 		.word	cb_le_promisc
 6577 0068 04000000 		.word	.LANCHOR1+4
 6578 006c 00000000 		.word	promisc_follow_cb
 6579              		.cfi_endproc
 6580              	.LFE33:
 6582              		.section	.text.bt_slave_le,"ax",%progbits
 6583              		.align	1
 6584              		.global	bt_slave_le
 6585              		.thumb
 6586              		.thumb_func
 6588              	bt_slave_le:
 6589              	.LFB34:
2322:bluetooth_rxtx.c **** 	}
2323:bluetooth_rxtx.c **** }
ARM GAS  /tmp/ccDKg7Fp.s 			page 176


2324:bluetooth_rxtx.c **** 
2325:bluetooth_rxtx.c **** void bt_slave_le() {
 6590              		.loc 1 2325 0
 6591              		.cfi_startproc
 6592              		@ args = 0, pretend = 0, frame = 16
 6593              		@ frame_needed = 0, uses_anonymous_args = 0
 6594 0000 7FB5     		push	{r0, r1, r2, r3, r4, r5, r6, lr}
 6595              		.cfi_def_cfa_offset 32
 6596              		.cfi_offset 4, -16
 6597              		.cfi_offset 5, -12
 6598              		.cfi_offset 6, -8
 6599              		.cfi_offset 14, -4
2326:bluetooth_rxtx.c **** 	u32 calc_crc;
2327:bluetooth_rxtx.c **** 	int i;
2328:bluetooth_rxtx.c **** 
2329:bluetooth_rxtx.c **** 	u8 adv_ind[] = {
 6600              		.loc 1 2329 0
 6601 0002 6A46     		mov	r2, sp
 6602 0004 6C46     		mov	r4, sp
 6603 0006 244B     		ldr	r3, .L725
 6604 0008 03F10806 		add	r6, r3, #8
 6605              	.L716:
 6606 000c 1546     		mov	r5, r2
 6607 000e 1868     		ldr	r0, [r3]	@ unaligned
 6608 0010 5968     		ldr	r1, [r3, #4]	@ unaligned
 6609 0012 0833     		adds	r3, r3, #8
 6610 0014 03C5     		stmia	r5!, {r0, r1}
 6611 0016 B342     		cmp	r3, r6
 6612 0018 2A46     		mov	r2, r5
 6613 001a F7D1     		bne	.L716
 6614 001c 1868     		ldr	r0, [r3]	@ unaligned
 6615 001e 9B88     		ldrh	r3, [r3, #4]	@ unaligned
 6616 0020 2860     		str	r0, [r5]	@ unaligned
 6617 0022 AB80     		strh	r3, [r5, #4]	@ unaligned
 6618              	.LVL724:
 6619 0024 0DF10102 		add	r2, sp, #1
 6620 0028 0523     		movs	r3, #5
 6621              	.LVL725:
 6622              	.L717:
2330:bluetooth_rxtx.c **** 		// LL header
2331:bluetooth_rxtx.c **** 		0x00, 0x09,
2332:bluetooth_rxtx.c **** 
2333:bluetooth_rxtx.c **** 		// advertising address
2334:bluetooth_rxtx.c **** 		0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
2335:bluetooth_rxtx.c **** 
2336:bluetooth_rxtx.c **** 		// advertising data
2337:bluetooth_rxtx.c **** 		0x02, 0x01, 0x05,
2338:bluetooth_rxtx.c **** 
2339:bluetooth_rxtx.c **** 		// CRC (calc)
2340:bluetooth_rxtx.c **** 		0xff, 0xff, 0xff,
2341:bluetooth_rxtx.c **** 	};
2342:bluetooth_rxtx.c **** 
2343:bluetooth_rxtx.c **** 	u8 adv_ind_len = sizeof(adv_ind) - 3;
2344:bluetooth_rxtx.c **** 
2345:bluetooth_rxtx.c **** 	// copy the user-specified mac address
2346:bluetooth_rxtx.c **** 	for (i = 0; i < 6; ++i)
2347:bluetooth_rxtx.c **** 		adv_ind[i+2] = slave_mac_address[5-i];
ARM GAS  /tmp/ccDKg7Fp.s 			page 177


 6623              		.loc 1 2347 0 discriminator 3
 6624 002a 1C49     		ldr	r1, .L725+4
 6625 002c 595C     		ldrb	r1, [r3, r1]	@ zero_extendqisi2
2346:bluetooth_rxtx.c **** 		adv_ind[i+2] = slave_mac_address[5-i];
 6626              		.loc 1 2346 0 discriminator 3
 6627 002e 13F1FF33 		adds	r3, r3, #-1
 6628              		.loc 1 2347 0 discriminator 3
 6629 0032 02F8011F 		strb	r1, [r2, #1]!
 6630              	.LVL726:
2346:bluetooth_rxtx.c **** 		adv_ind[i+2] = slave_mac_address[5-i];
 6631              		.loc 1 2346 0 discriminator 3
 6632 0036 F8D2     		bcs	.L717
2348:bluetooth_rxtx.c **** 
2349:bluetooth_rxtx.c **** 	calc_crc = btle_calc_crc(le.crc_init_reversed, adv_ind, adv_ind_len);
 6633              		.loc 1 2349 0
 6634 0038 194B     		ldr	r3, .L725+8
 6635 003a 2146     		mov	r1, r4
 6636 003c 1869     		ldr	r0, [r3, #16]
 6637 003e 0B22     		movs	r2, #11
 6638              	.LVL727:
 6639 0040 FFF7FEFF 		bl	btle_calc_crc
 6640              	.LVL728:
2350:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+0] = (calc_crc >>  0) & 0xff;
2351:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+1] = (calc_crc >>  8) & 0xff;
 6641              		.loc 1 2351 0
 6642 0044 030A     		lsrs	r3, r0, #8
2350:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+0] = (calc_crc >>  0) & 0xff;
 6643              		.loc 1 2350 0
 6644 0046 8DF80B00 		strb	r0, [sp, #11]
2352:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+2] = (calc_crc >> 16) & 0xff;
 6645              		.loc 1 2352 0
 6646 004a 000C     		lsrs	r0, r0, #16
 6647              	.LVL729:
2351:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+2] = (calc_crc >> 16) & 0xff;
 6648              		.loc 1 2351 0
 6649 004c 8DF80C30 		strb	r3, [sp, #12]
 6650              		.loc 1 2352 0
 6651 0050 8DF80D00 		strb	r0, [sp, #13]
2353:bluetooth_rxtx.c **** 
2354:bluetooth_rxtx.c **** 	clkn_start();
 6652              		.loc 1 2354 0
 6653 0054 FFF7FEFF 		bl	clkn_start
 6654              	.LVL730:
 6655              	.L718:
2355:bluetooth_rxtx.c **** 
2356:bluetooth_rxtx.c **** 	// spam advertising packets
2357:bluetooth_rxtx.c **** 	while (requested_mode == MODE_BT_SLAVE_LE) {
 6656              		.loc 1 2357 0
 6657 0058 124B     		ldr	r3, .L725+12
 6658 005a 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 6659 005c 0C2B     		cmp	r3, #12
 6660 005e 19D1     		bne	.L724
2358:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
 6661              		.loc 1 2358 0
 6662 0060 114B     		ldr	r3, .L725+16
 6663 0062 4FF08076 		mov	r6, #16777216
2359:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_DMA;
ARM GAS  /tmp/ccDKg7Fp.s 			page 178


 6664              		.loc 1 2359 0
 6665 0066 4FF08065 		mov	r5, #67108864
2358:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
 6666              		.loc 1 2358 0
 6667 006a 1E60     		str	r6, [r3]
2360:bluetooth_rxtx.c **** 		le_transmit(0x8e89bed6, adv_ind_len+3, adv_ind);
 6668              		.loc 1 2360 0
 6669 006c 2246     		mov	r2, r4
2359:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_DMA;
 6670              		.loc 1 2359 0
 6671 006e 1D60     		str	r5, [r3]
 6672              		.loc 1 2360 0
 6673 0070 0E48     		ldr	r0, .L725+20
 6674 0072 0E21     		movs	r1, #14
 6675 0074 FFF7FEFF 		bl	le_transmit
 6676              	.LVL731:
2361:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
 6677              		.loc 1 2361 0
 6678 0078 0D4B     		ldr	r3, .L725+24
 6679              	.LBB85:
 6680              	.LBB86:
 809:bluetooth_rxtx.c **** 	uint32_t stop_at = now + millis * 10000 / 3125; // millis -> clkn ticks
 6681              		.loc 1 809 0
 6682 007a 0E4A     		ldr	r2, .L725+28
 6683              	.LBE86:
 6684              	.LBE85:
 6685              		.loc 1 2361 0
 6686 007c 1E60     		str	r6, [r3]
2362:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_DMA;
 6687              		.loc 1 2362 0
 6688 007e 1D60     		str	r5, [r3]
 6689              	.LVL732:
 6690              	.LBB88:
 6691              	.LBB87:
 809:bluetooth_rxtx.c **** 	uint32_t stop_at = now + millis * 10000 / 3125; // millis -> clkn ticks
 6692              		.loc 1 809 0
 6693 0080 1368     		ldr	r3, [r2]
 6694              	.LVL733:
 6695 0082 23F07F43 		bic	r3, r3, #-16777216
 6696              	.LVL734:
 810:bluetooth_rxtx.c **** 
 6697              		.loc 1 810 0
 6698 0086 2033     		adds	r3, r3, #32
 6699              	.LVL735:
 6700              	.L719:
 817:bluetooth_rxtx.c **** 	}
 6701              		.loc 1 817 0
 6702 0088 1168     		ldr	r1, [r2]
 6703 008a 21F07F41 		bic	r1, r1, #-16777216
 6704 008e 9942     		cmp	r1, r3
 6705 0090 FAD3     		bcc	.L719
 6706 0092 E1E7     		b	.L718
 6707              	.LVL736:
 6708              	.L724:
 6709              	.LBE87:
 6710              	.LBE88:
2363:bluetooth_rxtx.c **** 		msleep(10);// sleep in miliseconds
ARM GAS  /tmp/ccDKg7Fp.s 			page 179


2364:bluetooth_rxtx.c **** 	}
2365:bluetooth_rxtx.c **** }
 6711              		.loc 1 2365 0
 6712 0094 04B0     		add	sp, sp, #16
 6713              		.cfi_def_cfa_offset 16
 6714              		@ sp needed
 6715 0096 70BD     		pop	{r4, r5, r6, pc}
 6716              	.L726:
 6717              		.align	2
 6718              	.L725:
 6719 0098 A8080000 		.word	.LANCHOR2+2216
 6720 009c 20000000 		.word	.LANCHOR0+32
 6721 00a0 00000000 		.word	.LANCHOR1
 6722 00a4 00000000 		.word	.LANCHOR0
 6723 00a8 80E100E0 		.word	-536813184
 6724 00ac D6BE898E 		.word	-1903575338
 6725 00b0 00E100E0 		.word	-536813312
 6726 00b4 00000000 		.word	clkn
 6727              		.cfi_endproc
 6728              	.LFE34:
 6730              		.section	.text.rx_generic_sync,"ax",%progbits
 6731              		.align	1
 6732              		.global	rx_generic_sync
 6733              		.thumb
 6734              		.thumb_func
 6736              	rx_generic_sync:
 6737              	.LFB35:
2366:bluetooth_rxtx.c **** 
2367:bluetooth_rxtx.c **** void rx_generic_sync(void) {
 6738              		.loc 1 2367 0
 6739              		.cfi_startproc
 6740              		@ args = 0, pretend = 0, frame = 40
 6741              		@ frame_needed = 0, uses_anonymous_args = 0
 6742 0000 10B5     		push	{r4, lr}
 6743              		.cfi_def_cfa_offset 8
 6744              		.cfi_offset 4, -8
 6745              		.cfi_offset 14, -4
 6746 0002 8AB0     		sub	sp, sp, #40
 6747              		.cfi_def_cfa_offset 48
 6748              	.LVL737:
2368:bluetooth_rxtx.c **** 	u8 len = 32;
2369:bluetooth_rxtx.c **** 	u8 buf[len+4];
2370:bluetooth_rxtx.c **** 	u16 reg_val;
2371:bluetooth_rxtx.c **** 
2372:bluetooth_rxtx.c **** 	/* Put syncword at start of buffer
2373:bluetooth_rxtx.c **** 	 * DGS: fix this later, we don't know number of syncword bytes, etc
2374:bluetooth_rxtx.c **** 	 */
2375:bluetooth_rxtx.c **** 	reg_val = cc2400_get(SYNCH);
 6749              		.loc 1 2375 0
 6750 0004 2D20     		movs	r0, #45
 6751 0006 FFF7FEFF 		bl	cc2400_get
 6752              	.LVL738:
2376:bluetooth_rxtx.c **** 	buf[0] = (reg_val >> 8) & 0xFF;
 6753              		.loc 1 2376 0
 6754 000a 030A     		lsrs	r3, r0, #8
2377:bluetooth_rxtx.c **** 	buf[1] = reg_val & 0xFF;
 6755              		.loc 1 2377 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 180


 6756 000c 8DF80500 		strb	r0, [sp, #5]
2378:bluetooth_rxtx.c **** 	reg_val = cc2400_get(SYNCL);
 6757              		.loc 1 2378 0
 6758 0010 2C20     		movs	r0, #44
 6759              	.LVL739:
2376:bluetooth_rxtx.c **** 	buf[0] = (reg_val >> 8) & 0xFF;
 6760              		.loc 1 2376 0
 6761 0012 8DF80430 		strb	r3, [sp, #4]
 6762              		.loc 1 2378 0
 6763 0016 FFF7FEFF 		bl	cc2400_get
 6764              	.LVL740:
2379:bluetooth_rxtx.c **** 	buf[2] = (reg_val >> 8) & 0xFF;
 6765              		.loc 1 2379 0
 6766 001a 030A     		lsrs	r3, r0, #8
 6767 001c 8DF80630 		strb	r3, [sp, #6]
2380:bluetooth_rxtx.c **** 	buf[3] = reg_val & 0xFF;
 6768              		.loc 1 2380 0
 6769 0020 8DF80700 		strb	r0, [sp, #7]
2381:bluetooth_rxtx.c **** 
2382:bluetooth_rxtx.c **** 	usb_queue_init();
 6770              		.loc 1 2382 0
 6771 0024 FFF7FEFF 		bl	usb_queue_init
 6772              	.LVL741:
2383:bluetooth_rxtx.c **** 	clkn_start();
 6773              		.loc 1 2383 0
 6774 0028 FFF7FEFF 		bl	clkn_start
 6775              	.LVL742:
 6776              	.L728:
2384:bluetooth_rxtx.c **** 
2385:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 6777              		.loc 1 2385 0 discriminator 1
 6778 002c FFF7FEFF 		bl	cc2400_status
 6779              	.LVL743:
 6780 0030 4106     		lsls	r1, r0, #25
 6781 0032 FBD5     		bpl	.L728
2386:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 6782              		.loc 1 2386 0
 6783 0034 6120     		movs	r0, #97
 6784 0036 FFF7FEFF 		bl	cc2400_strobe
 6785              	.LVL744:
 6786              	.L729:
2387:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 6787              		.loc 1 2387 0 discriminator 1
 6788 003a FFF7FEFF 		bl	cc2400_status
 6789              	.LVL745:
 6790 003e 4207     		lsls	r2, r0, #29
 6791 0040 FBD5     		bpl	.L729
2388:bluetooth_rxtx.c **** 	RXLED_SET;
 6792              		.loc 1 2388 0
 6793 0042 154B     		ldr	r3, .L740
 6794 0044 1022     		movs	r2, #16
 6795 0046 1C46     		mov	r4, r3
 6796 0048 1A60     		str	r2, [r3]
2389:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2390:bluetooth_rxtx.c **** 		PAEN_SET;
 6797              		.loc 1 2390 0
 6798 004a 144A     		ldr	r2, .L740+4
ARM GAS  /tmp/ccDKg7Fp.s 			page 181


 6799 004c 8021     		movs	r1, #128
 6800 004e 1160     		str	r1, [r2]
2391:bluetooth_rxtx.c **** 		HGM_SET;
 6801              		.loc 1 2391 0
 6802 0050 4FF48071 		mov	r1, #256
 6803 0054 1160     		str	r1, [r2]
 6804              	.L730:
2392:bluetooth_rxtx.c **** #endif
2393:bluetooth_rxtx.c **** 	while (1) {
2394:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 6805              		.loc 1 2394 0 discriminator 1
 6806 0056 0E20     		movs	r0, #14
 6807 0058 FFF7FEFF 		bl	cc2400_get
 6808              	.LVL746:
 6809 005c 00F01F00 		and	r0, r0, #31
 6810 0060 0F28     		cmp	r0, #15
 6811 0062 F8D1     		bne	.L730
2395:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
 6812              		.loc 1 2395 0
 6813 0064 6220     		movs	r0, #98
 6814 0066 FFF7FEFF 		bl	cc2400_strobe
 6815              	.LVL747:
2396:bluetooth_rxtx.c **** 		USRLED_CLR;
 6816              		.loc 1 2396 0
 6817 006a 0D4B     		ldr	r3, .L740+8
 6818 006c 0222     		movs	r2, #2
 6819 006e 1A60     		str	r2, [r3]
 6820              	.L731:
2397:bluetooth_rxtx.c **** 		while (!(cc2400_status() & SYNC_RECEIVED));
 6821              		.loc 1 2397 0 discriminator 1
 6822 0070 FFF7FEFF 		bl	cc2400_status
 6823              	.LVL748:
 6824 0074 C306     		lsls	r3, r0, #27
 6825 0076 FBD5     		bpl	.L731
2398:bluetooth_rxtx.c **** 		USRLED_SET;
 6826              		.loc 1 2398 0
 6827 0078 0223     		movs	r3, #2
 6828 007a 2360     		str	r3, [r4]
2399:bluetooth_rxtx.c **** 
2400:bluetooth_rxtx.c **** 		cc2400_fifo_read(len, buf+4);
 6829              		.loc 1 2400 0
 6830 007c 02A9     		add	r1, sp, #8
 6831 007e 2020     		movs	r0, #32
 6832 0080 FFF7FEFF 		bl	cc2400_fifo_read
 6833              	.LVL749:
2401:bluetooth_rxtx.c **** 		enqueue(BR_PACKET, buf);
 6834              		.loc 1 2401 0
 6835 0084 01A9     		add	r1, sp, #4
 6836              	.LVL750:
 6837 0086 0020     		movs	r0, #0
 6838 0088 FFF7FEFF 		bl	enqueue
 6839              	.LVL751:
2402:bluetooth_rxtx.c **** 		handle_usb(clkn);
 6840              		.loc 1 2402 0
 6841 008c 054B     		ldr	r3, .L740+12
 6842 008e 1868     		ldr	r0, [r3]
 6843 0090 FFF7FEFF 		bl	handle_usb
ARM GAS  /tmp/ccDKg7Fp.s 			page 182


 6844              	.LVL752:
2403:bluetooth_rxtx.c **** 	}
 6845              		.loc 1 2403 0
 6846 0094 DFE7     		b	.L730
 6847              	.L741:
 6848 0096 00BF     		.align	2
 6849              	.L740:
 6850 0098 38C00920 		.word	537509944
 6851 009c 58C00920 		.word	537509976
 6852 00a0 3CC00920 		.word	537509948
 6853 00a4 00000000 		.word	clkn
 6854              		.cfi_endproc
 6855              	.LFE35:
 6857              		.section	.text.rx_generic,"ax",%progbits
 6858              		.align	1
 6859              		.global	rx_generic
 6860              		.thumb
 6861              		.thumb_func
 6863              	rx_generic:
 6864              	.LFB36:
2404:bluetooth_rxtx.c **** }
2405:bluetooth_rxtx.c **** 
2406:bluetooth_rxtx.c **** void rx_generic(void) {
 6865              		.loc 1 2406 0
 6866              		.cfi_startproc
 6867              		@ args = 0, pretend = 0, frame = 0
 6868              		@ frame_needed = 0, uses_anonymous_args = 0
 6869 0000 08B5     		push	{r3, lr}
 6870              		.cfi_def_cfa_offset 8
 6871              		.cfi_offset 3, -8
 6872              		.cfi_offset 14, -4
2407:bluetooth_rxtx.c **** 	// Check for packet mode
2408:bluetooth_rxtx.c **** 	if(cc2400_get(GRMDM) && 0x0400) {
 6873              		.loc 1 2408 0
 6874 0002 2020     		movs	r0, #32
 6875 0004 FFF7FEFF 		bl	cc2400_get
 6876              	.LVL753:
 6877 0008 08B1     		cbz	r0, .L743
2409:bluetooth_rxtx.c **** 		rx_generic_sync();
 6878              		.loc 1 2409 0
 6879 000a FFF7FEFF 		bl	rx_generic_sync
 6880              	.LVL754:
 6881              	.L743:
2410:bluetooth_rxtx.c **** 	} else {
2411:bluetooth_rxtx.c **** 		modulation = MOD_NONE;
 6882              		.loc 1 2411 0
 6883 000e 034B     		ldr	r3, .L744
 6884 0010 0322     		movs	r2, #3
 6885 0012 1A70     		strb	r2, [r3]
2412:bluetooth_rxtx.c **** 		bt_stream_rx();
2413:bluetooth_rxtx.c **** 	}
2414:bluetooth_rxtx.c **** }
 6886              		.loc 1 2414 0
 6887 0014 BDE80840 		pop	{r3, lr}
 6888              		.cfi_restore 14
 6889              		.cfi_restore 3
 6890              		.cfi_def_cfa_offset 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 183


2412:bluetooth_rxtx.c **** 		bt_stream_rx();
 6891              		.loc 1 2412 0
 6892 0018 FFF7FEBF 		b	bt_stream_rx
 6893              	.LVL755:
 6894              	.L745:
 6895              		.align	2
 6896              	.L744:
 6897 001c 00000000 		.word	.LANCHOR0
 6898              		.cfi_endproc
 6899              	.LFE36:
 6901              		.section	.text.tx_generic,"ax",%progbits
 6902              		.align	1
 6903              		.global	tx_generic
 6904              		.thumb
 6905              		.thumb_func
 6907              	tx_generic:
 6908              	.LFB37:
2415:bluetooth_rxtx.c **** 
2416:bluetooth_rxtx.c **** void tx_generic(void) {
 6909              		.loc 1 2416 0
 6910              		.cfi_startproc
 6911              		@ args = 0, pretend = 0, frame = 0
 6912              		@ frame_needed = 0, uses_anonymous_args = 0
 6913 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 6914              		.cfi_def_cfa_offset 24
 6915              		.cfi_offset 4, -24
 6916              		.cfi_offset 5, -20
 6917              		.cfi_offset 6, -16
 6918              		.cfi_offset 7, -12
 6919              		.cfi_offset 8, -8
 6920              		.cfi_offset 14, -4
2417:bluetooth_rxtx.c **** 	u16 synch, syncl;
2418:bluetooth_rxtx.c **** 	u8 prev_mode = mode;
 6921              		.loc 1 2418 0
 6922 0004 354D     		ldr	r5, .L759
2419:bluetooth_rxtx.c **** 
2420:bluetooth_rxtx.c **** 	mode = MODE_TX_GENERIC;
 6923              		.loc 1 2420 0
 6924 0006 1023     		movs	r3, #16
2421:bluetooth_rxtx.c **** 
2422:bluetooth_rxtx.c **** 	// Save existing syncword
2423:bluetooth_rxtx.c **** 	synch = cc2400_get(SYNCH);
 6925              		.loc 1 2423 0
 6926 0008 2D20     		movs	r0, #45
2418:bluetooth_rxtx.c **** 
 6927              		.loc 1 2418 0
 6928 000a 6E7C     		ldrb	r6, [r5, #17]	@ zero_extendqisi2
2420:bluetooth_rxtx.c **** 
 6929              		.loc 1 2420 0
 6930 000c 6B74     		strb	r3, [r5, #17]
 6931              		.loc 1 2423 0
 6932 000e FFF7FEFF 		bl	cc2400_get
 6933              	.LVL756:
 6934 0012 8046     		mov	r8, r0
2424:bluetooth_rxtx.c **** 	syncl = cc2400_get(SYNCL);
 6935              		.loc 1 2424 0
 6936 0014 2C20     		movs	r0, #44
ARM GAS  /tmp/ccDKg7Fp.s 			page 184


 6937 0016 FFF7FEFF 		bl	cc2400_get
 6938              	.LVL757:
2425:bluetooth_rxtx.c **** 
2426:bluetooth_rxtx.c **** 	cc2400_set(SYNCH, tx_pkt.synch);
 6939              		.loc 1 2426 0
 6940 001a 314C     		ldr	r4, .L759+4
2424:bluetooth_rxtx.c **** 	syncl = cc2400_get(SYNCL);
 6941              		.loc 1 2424 0
 6942 001c 0746     		mov	r7, r0
 6943              		.loc 1 2426 0
 6944 001e 2188     		ldrh	r1, [r4]
 6945 0020 2D20     		movs	r0, #45
 6946 0022 FFF7FEFF 		bl	cc2400_set
 6947              	.LVL758:
2427:bluetooth_rxtx.c **** 	cc2400_set(SYNCL, tx_pkt.syncl);
 6948              		.loc 1 2427 0
 6949 0026 2C20     		movs	r0, #44
 6950 0028 6188     		ldrh	r1, [r4, #2]
 6951 002a FFF7FEFF 		bl	cc2400_set
 6952              	.LVL759:
2428:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0057);
 6953              		.loc 1 2428 0
 6954 002e 0320     		movs	r0, #3
 6955 0030 5721     		movs	r1, #87
 6956 0032 FFF7FEFF 		bl	cc2400_set
 6957              	.LVL760:
2429:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);
 6958              		.loc 1 2429 0
 6959 0036 1420     		movs	r0, #20
 6960 0038 41F24B31 		movw	r1, #4939
 6961 003c FFF7FEFF 		bl	cc2400_set
 6962              	.LVL761:
2430:bluetooth_rxtx.c **** 	cc2400_set(GRMDM, 0x0f61);
 6963              		.loc 1 2430 0
 6964 0040 2020     		movs	r0, #32
 6965 0042 40F66171 		movw	r1, #3937
 6966 0046 FFF7FEFF 		bl	cc2400_set
 6967              	.LVL762:
2431:bluetooth_rxtx.c **** 	cc2400_set(FSDIV, tx_pkt.channel);
 6968              		.loc 1 2431 0
 6969 004a 0220     		movs	r0, #2
 6970 004c A188     		ldrh	r1, [r4, #4]
 6971 004e FFF7FEFF 		bl	cc2400_set
 6972              	.LVL763:
2432:bluetooth_rxtx.c **** 	cc2400_set(FREND, tx_pkt.pa_level);
 6973              		.loc 1 2432 0
 6974 0052 0520     		movs	r0, #5
 6975 0054 E179     		ldrb	r1, [r4, #7]	@ zero_extendqisi2
2418:bluetooth_rxtx.c **** 
 6976              		.loc 1 2418 0
 6977 0056 F6B2     		uxtb	r6, r6
 6978              	.LVL764:
 6979              		.loc 1 2432 0
 6980 0058 FFF7FEFF 		bl	cc2400_set
 6981              	.LVL765:
 6982              	.L747:
2433:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccDKg7Fp.s 			page 185


2434:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 6983              		.loc 1 2434 0 discriminator 1
 6984 005c FFF7FEFF 		bl	cc2400_status
 6985              	.LVL766:
 6986 0060 4106     		lsls	r1, r0, #25
 6987 0062 FBD5     		bpl	.L747
2435:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 6988              		.loc 1 2435 0
 6989 0064 6120     		movs	r0, #97
 6990 0066 FFF7FEFF 		bl	cc2400_strobe
 6991              	.LVL767:
 6992              	.L748:
2436:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 6993              		.loc 1 2436 0 discriminator 1
 6994 006a FFF7FEFF 		bl	cc2400_status
 6995              	.LVL768:
 6996 006e 4207     		lsls	r2, r0, #29
 6997 0070 FBD5     		bpl	.L748
2437:bluetooth_rxtx.c **** 	TXLED_SET;
 6998              		.loc 1 2437 0
 6999 0072 1C4B     		ldr	r3, .L759+8
 7000 0074 4FF48072 		mov	r2, #256
 7001 0078 1A60     		str	r2, [r3]
2438:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2439:bluetooth_rxtx.c **** 		PAEN_SET;
 7002              		.loc 1 2439 0
 7003 007a 8022     		movs	r2, #128
 7004 007c 1A62     		str	r2, [r3, #32]
 7005              	.L749:
2440:bluetooth_rxtx.c **** #endif
2441:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 7006              		.loc 1 2441 0 discriminator 1
 7007 007e 0E20     		movs	r0, #14
 7008 0080 FFF7FEFF 		bl	cc2400_get
 7009              	.LVL769:
 7010 0084 00F01F00 		and	r0, r0, #31
 7011 0088 0F28     		cmp	r0, #15
 7012 008a F8D1     		bne	.L749
2442:bluetooth_rxtx.c **** 
2443:bluetooth_rxtx.c **** 	cc2400_fifo_write(tx_pkt.length, tx_pkt.data);
 7013              		.loc 1 2443 0
 7014 008c A079     		ldrb	r0, [r4, #6]	@ zero_extendqisi2
 7015 008e 1649     		ldr	r1, .L759+12
 7016 0090 FFF7FEFF 		bl	cc2400_fifo_write
 7017              	.LVL770:
2444:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 7018              		.loc 1 2444 0
 7019 0094 6320     		movs	r0, #99
 7020 0096 FFF7FEFF 		bl	cc2400_strobe
 7021              	.LVL771:
 7022              	.L750:
2445:bluetooth_rxtx.c **** 
2446:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 7023              		.loc 1 2446 0 discriminator 1
 7024 009a 0E20     		movs	r0, #14
 7025 009c FFF7FEFF 		bl	cc2400_get
 7026              	.LVL772:
ARM GAS  /tmp/ccDKg7Fp.s 			page 186


 7027 00a0 00F01F00 		and	r0, r0, #31
 7028 00a4 0F28     		cmp	r0, #15
 7029 00a6 F8D1     		bne	.L750
2447:bluetooth_rxtx.c **** 	TXLED_CLR;
 7030              		.loc 1 2447 0
 7031 00a8 104B     		ldr	r3, .L759+16
 7032 00aa 4FF48072 		mov	r2, #256
 7033 00ae 1A60     		str	r2, [r3]
2448:bluetooth_rxtx.c **** 
2449:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 7034              		.loc 1 2449 0
 7035 00b0 6420     		movs	r0, #100
 7036 00b2 FFF7FEFF 		bl	cc2400_strobe
 7037              	.LVL773:
 7038              	.L751:
2450:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 7039              		.loc 1 2450 0 discriminator 1
 7040 00b6 FFF7FEFF 		bl	cc2400_status
 7041              	.LVL774:
 7042 00ba 4307     		lsls	r3, r0, #29
 7043 00bc FBD4     		bmi	.L751
2451:bluetooth_rxtx.c **** 
2452:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2453:bluetooth_rxtx.c **** 	PAEN_CLR;
 7044              		.loc 1 2453 0
 7045 00be 0C4B     		ldr	r3, .L759+20
 7046 00c0 8022     		movs	r2, #128
 7047 00c2 1A60     		str	r2, [r3]
2454:bluetooth_rxtx.c **** #endif
2455:bluetooth_rxtx.c **** 
2456:bluetooth_rxtx.c **** 	// Restore state
2457:bluetooth_rxtx.c **** 	cc2400_set(SYNCH, synch);
 7048              		.loc 1 2457 0
 7049 00c4 2D20     		movs	r0, #45
 7050 00c6 4146     		mov	r1, r8
 7051 00c8 FFF7FEFF 		bl	cc2400_set
 7052              	.LVL775:
2458:bluetooth_rxtx.c **** 	cc2400_set(SYNCL, syncl);
 7053              		.loc 1 2458 0
 7054 00cc 2C20     		movs	r0, #44
 7055 00ce 3946     		mov	r1, r7
 7056 00d0 FFF7FEFF 		bl	cc2400_set
 7057              	.LVL776:
2459:bluetooth_rxtx.c **** 	requested_mode = prev_mode;
 7058              		.loc 1 2459 0
 7059 00d4 AE74     		strb	r6, [r5, #18]
 7060 00d6 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 7061              	.LVL777:
 7062              	.L760:
 7063 00da 00BF     		.align	2
 7064              	.L759:
 7065 00dc 00000000 		.word	.LANCHOR0
 7066 00e0 00000000 		.word	tx_pkt
 7067 00e4 38C00920 		.word	537509944
 7068 00e8 08000000 		.word	tx_pkt+8
 7069 00ec 3CC00920 		.word	537509948
 7070 00f0 5CC00920 		.word	537509980
ARM GAS  /tmp/ccDKg7Fp.s 			page 187


 7071              		.cfi_endproc
 7072              	.LFE37:
 7074              		.section	.text.specan,"ax",%progbits
 7075              		.align	1
 7076              		.global	specan
 7077              		.thumb
 7078              		.thumb_func
 7080              	specan:
 7081              	.LFB38:
2460:bluetooth_rxtx.c **** }
2461:bluetooth_rxtx.c **** 
2462:bluetooth_rxtx.c **** /* spectrum analysis */
2463:bluetooth_rxtx.c **** void specan()
2464:bluetooth_rxtx.c **** {
 7082              		.loc 1 2464 0
 7083              		.cfi_startproc
 7084              		@ args = 0, pretend = 0, frame = 56
 7085              		@ frame_needed = 0, uses_anonymous_args = 0
 7086 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 7087              		.cfi_def_cfa_offset 24
 7088              		.cfi_offset 4, -24
 7089              		.cfi_offset 5, -20
 7090              		.cfi_offset 6, -16
 7091              		.cfi_offset 7, -12
 7092              		.cfi_offset 8, -8
 7093              		.cfi_offset 14, -4
 7094 0004 8EB0     		sub	sp, sp, #56
 7095              		.cfi_def_cfa_offset 80
 7096              	.LVL778:
2465:bluetooth_rxtx.c **** 	u16 f;
2466:bluetooth_rxtx.c **** 	u8 i = 0;
2467:bluetooth_rxtx.c **** 	u8 buf[DMA_SIZE];
2468:bluetooth_rxtx.c **** 
2469:bluetooth_rxtx.c **** 	RXLED_SET;
 7097              		.loc 1 2469 0
 7098 0006 3D4B     		ldr	r3, .L781
 7099 0008 1022     		movs	r2, #16
 7100 000a 1A60     		str	r2, [r3]
2470:bluetooth_rxtx.c **** 
2471:bluetooth_rxtx.c **** 	usb_queue_init();
 7101              		.loc 1 2471 0
 7102 000c FFF7FEFF 		bl	usb_queue_init
 7103              	.LVL779:
2472:bluetooth_rxtx.c **** 	clkn_start();
 7104              		.loc 1 2472 0
 7105 0010 FFF7FEFF 		bl	clkn_start
 7106              	.LVL780:
2473:bluetooth_rxtx.c **** 
2474:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2475:bluetooth_rxtx.c **** 	PAEN_SET;
 7107              		.loc 1 2475 0
 7108 0014 3A4B     		ldr	r3, .L781+4
 7109 0016 8022     		movs	r2, #128
 7110 0018 1A60     		str	r2, [r3]
2476:bluetooth_rxtx.c **** 	//HGM_SET;
2477:bluetooth_rxtx.c **** #endif
2478:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
ARM GAS  /tmp/ccDKg7Fp.s 			page 188


 7111              		.loc 1 2478 0
 7112 001a 1220     		movs	r0, #18
 7113 001c 42F62231 		movw	r1, #11042
 7114 0020 FFF7FEFF 		bl	cc2400_set
 7115              	.LVL781:
2479:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b); // without PRNG
 7116              		.loc 1 2479 0
 7117 0024 1420     		movs	r0, #20
 7118 0026 41F24B31 		movw	r1, #4939
 7119 002a FFF7FEFF 		bl	cc2400_set
 7120              	.LVL782:
2480:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 7121              		.loc 1 2480 0
 7122 002e 2020     		movs	r0, #32
 7123 0030 40F20111 		movw	r1, #257
 7124 0034 FFF7FEFF 		bl	cc2400_set
 7125              	.LVL783:
2481:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0029); // 160 kHz frequency deviation
 7126              		.loc 1 2481 0
 7127 0038 0320     		movs	r0, #3
 7128 003a 2921     		movs	r1, #41
 7129 003c FFF7FEFF 		bl	cc2400_set
 7130              	.LVL784:
 7131              	.L762:
2482:bluetooth_rxtx.c **** 	//FIXME maybe set RSSI.RSSI_FILT
2483:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 7132              		.loc 1 2483 0 discriminator 1
 7133 0040 FFF7FEFF 		bl	cc2400_status
 7134              	.LVL785:
 7135 0044 4106     		lsls	r1, r0, #25
 7136 0046 FBD5     		bpl	.L762
 7137              	.L774:
2484:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 7138              		.loc 1 2484 0 discriminator 1
 7139 0048 FFF7FEFF 		bl	cc2400_status
 7140              	.LVL786:
 7141 004c 00F00400 		and	r0, r0, #4
 7142 0050 00F0FF04 		and	r4, r0, #255
 7143 0054 0028     		cmp	r0, #0
 7144 0056 F7D1     		bne	.L774
 7145              	.LVL787:
 7146              	.L764:
2485:bluetooth_rxtx.c **** 
2486:bluetooth_rxtx.c **** 	while (requested_mode == MODE_SPECAN) {
 7147              		.loc 1 2486 0
 7148 0058 2A4B     		ldr	r3, .L781+8
 7149 005a 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 7150 005c 042B     		cmp	r3, #4
 7151 005e 47D1     		bne	.L780
2487:bluetooth_rxtx.c **** 		for (f = low_freq; f < high_freq + 1; f++) {
 7152              		.loc 1 2487 0
 7153 0060 294B     		ldr	r3, .L781+12
 7154 0062 9846     		mov	r8, r3
 7155 0064 B3F85450 		ldrh	r5, [r3, #84]
 7156 0068 ADB2     		uxth	r5, r5
 7157              	.LVL788:
 7158              	.L765:
ARM GAS  /tmp/ccDKg7Fp.s 			page 189


 7159              		.loc 1 2487 0 is_stmt 0 discriminator 1
 7160 006a B8F85630 		ldrh	r3, [r8, #86]
 7161 006e 9BB2     		uxth	r3, r3
 7162 0070 AB42     		cmp	r3, r5
 7163 0072 F1DB     		blt	.L764
 7164 0074 691E     		subs	r1, r5, #1
 7165              	.LBB89:
2488:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, f - 1);
 7166              		.loc 1 2488 0 is_stmt 1
 7167 0076 0220     		movs	r0, #2
 7168 0078 89B2     		uxth	r1, r1
 7169 007a FFF7FEFF 		bl	cc2400_set
 7170              	.LVL789:
2489:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
 7171              		.loc 1 2489 0
 7172 007e 6120     		movs	r0, #97
 7173 0080 FFF7FEFF 		bl	cc2400_strobe
 7174              	.LVL790:
 7175              	.L766:
2490:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 7176              		.loc 1 2490 0 discriminator 1
 7177 0084 FFF7FEFF 		bl	cc2400_status
 7178              	.LVL791:
 7179 0088 4207     		lsls	r2, r0, #29
 7180 008a FBD5     		bpl	.L766
2491:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
 7181              		.loc 1 2491 0
 7182 008c 6220     		movs	r0, #98
 7183 008e FFF7FEFF 		bl	cc2400_strobe
 7184              	.LVL792:
2492:bluetooth_rxtx.c **** 
2493:bluetooth_rxtx.c **** 			/* give the CC2400 time to acquire RSSI reading */
2494:bluetooth_rxtx.c **** 			volatile u32 j = 500; while (--j); //FIXME crude delay
 7185              		.loc 1 2494 0
 7186 0092 4FF4FA73 		mov	r3, #500
 7187 0096 0093     		str	r3, [sp]
 7188              	.L767:
 7189              		.loc 1 2494 0 is_stmt 0 discriminator 2
 7190 0098 009E     		ldr	r6, [sp]
 7191 009a 013E     		subs	r6, r6, #1
 7192 009c 0096     		str	r6, [sp]
 7193 009e 002E     		cmp	r6, #0
 7194 00a0 FAD1     		bne	.L767
2495:bluetooth_rxtx.c **** 			buf[3 * i] = (f >> 8) & 0xFF;
 7195              		.loc 1 2495 0 is_stmt 1
 7196 00a2 04EB4407 		add	r7, r4, r4, lsl #1
 7197 00a6 0EAB     		add	r3, sp, #56
 7198 00a8 1F44     		add	r7, r7, r3
2496:bluetooth_rxtx.c **** 			buf[(3 * i) + 1] = f  & 0xFF;
2497:bluetooth_rxtx.c **** 			buf[(3 * i) + 2] = cc2400_get(RSSI) >> 8;
 7199              		.loc 1 2497 0
 7200 00aa 0620     		movs	r0, #6
2495:bluetooth_rxtx.c **** 			buf[3 * i] = (f >> 8) & 0xFF;
 7201              		.loc 1 2495 0
 7202 00ac 2B0A     		lsrs	r3, r5, #8
 7203 00ae 07F8343C 		strb	r3, [r7, #-52]
2496:bluetooth_rxtx.c **** 			buf[(3 * i) + 1] = f  & 0xFF;
ARM GAS  /tmp/ccDKg7Fp.s 			page 190


 7204              		.loc 1 2496 0
 7205 00b2 07F8335C 		strb	r5, [r7, #-51]
 7206              		.loc 1 2497 0
 7207 00b6 FFF7FEFF 		bl	cc2400_get
 7208              	.LVL793:
2498:bluetooth_rxtx.c **** 			i++;
 7209              		.loc 1 2498 0
 7210 00ba 0134     		adds	r4, r4, #1
 7211              	.LVL794:
 7212 00bc E4B2     		uxtb	r4, r4
 7213              	.LVL795:
2497:bluetooth_rxtx.c **** 			i++;
 7214              		.loc 1 2497 0
 7215 00be 000A     		lsrs	r0, r0, #8
2499:bluetooth_rxtx.c **** 			if (i == 16) {
 7216              		.loc 1 2499 0
 7217 00c0 102C     		cmp	r4, #16
2497:bluetooth_rxtx.c **** 			i++;
 7218              		.loc 1 2497 0
 7219 00c2 07F8320C 		strb	r0, [r7, #-50]
 7220              		.loc 1 2499 0
 7221 00c6 09D1     		bne	.L768
2500:bluetooth_rxtx.c **** 				enqueue(SPECAN, buf);
 7222              		.loc 1 2500 0
 7223 00c8 0420     		movs	r0, #4
 7224 00ca 0DEB0001 		add	r1, sp, r0
 7225 00ce FFF7FEFF 		bl	enqueue
 7226              	.LVL796:
2501:bluetooth_rxtx.c **** 				i = 0;
2502:bluetooth_rxtx.c **** 
2503:bluetooth_rxtx.c **** 				handle_usb(clkn);
 7227              		.loc 1 2503 0
 7228 00d2 0E4B     		ldr	r3, .L781+16
2501:bluetooth_rxtx.c **** 				i = 0;
 7229              		.loc 1 2501 0
 7230 00d4 3446     		mov	r4, r6
 7231              		.loc 1 2503 0
 7232 00d6 1868     		ldr	r0, [r3]
 7233 00d8 FFF7FEFF 		bl	handle_usb
 7234              	.LVL797:
 7235              	.L768:
2504:bluetooth_rxtx.c **** 			}
2505:bluetooth_rxtx.c **** 
2506:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 7236              		.loc 1 2506 0
 7237 00dc 6420     		movs	r0, #100
 7238 00de FFF7FEFF 		bl	cc2400_strobe
 7239              	.LVL798:
 7240              	.L769:
2507:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 7241              		.loc 1 2507 0 discriminator 1
 7242 00e2 FFF7FEFF 		bl	cc2400_status
 7243              	.LVL799:
 7244 00e6 4307     		lsls	r3, r0, #29
 7245 00e8 FBD4     		bmi	.L769
 7246              	.LBE89:
2487:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, f - 1);
ARM GAS  /tmp/ccDKg7Fp.s 			page 191


 7247              		.loc 1 2487 0 discriminator 2
 7248 00ea 0135     		adds	r5, r5, #1
 7249              	.LVL800:
 7250 00ec ADB2     		uxth	r5, r5
 7251              	.LVL801:
 7252 00ee BCE7     		b	.L765
 7253              	.LVL802:
 7254              	.L780:
2508:bluetooth_rxtx.c **** 		}
2509:bluetooth_rxtx.c **** 	}
2510:bluetooth_rxtx.c **** 	RXLED_CLR;
 7255              		.loc 1 2510 0
 7256 00f0 074B     		ldr	r3, .L781+20
 7257 00f2 1022     		movs	r2, #16
 7258 00f4 1A60     		str	r2, [r3]
2511:bluetooth_rxtx.c **** }
 7259              		.loc 1 2511 0
 7260 00f6 0EB0     		add	sp, sp, #56
 7261              		.cfi_def_cfa_offset 24
 7262              		@ sp needed
 7263 00f8 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 7264              	.LVL803:
 7265              	.L782:
 7266              		.align	2
 7267              	.L781:
 7268 00fc 38C00920 		.word	537509944
 7269 0100 58C00920 		.word	537509976
 7270 0104 00000000 		.word	.LANCHOR0
 7271 0108 00000000 		.word	.LANCHOR1
 7272 010c 00000000 		.word	clkn
 7273 0110 3CC00920 		.word	537509948
 7274              		.cfi_endproc
 7275              	.LFE38:
 7277              		.section	.text.led_specan,"ax",%progbits
 7278              		.align	1
 7279              		.global	led_specan
 7280              		.thumb
 7281              		.thumb_func
 7283              	led_specan:
 7284              	.LFB39:
2512:bluetooth_rxtx.c **** 
2513:bluetooth_rxtx.c **** /* LED based spectrum analysis */
2514:bluetooth_rxtx.c **** void led_specan()
2515:bluetooth_rxtx.c **** {
 7285              		.loc 1 2515 0
 7286              		.cfi_startproc
 7287              		@ args = 0, pretend = 0, frame = 16
 7288              		@ frame_needed = 0, uses_anonymous_args = 0
 7289 0000 1FB5     		push	{r0, r1, r2, r3, r4, lr}
 7290              		.cfi_def_cfa_offset 24
 7291              		.cfi_offset 4, -8
 7292              		.cfi_offset 14, -4
 7293              	.LVL804:
2516:bluetooth_rxtx.c **** 	int8_t lvl;
2517:bluetooth_rxtx.c **** 	u8 i = 0;
2518:bluetooth_rxtx.c **** 	u16 channels[3] = {2412, 2437, 2462};
 7294              		.loc 1 2518 0
ARM GAS  /tmp/ccDKg7Fp.s 			page 192


 7295 0002 444B     		ldr	r3, .L812
2519:bluetooth_rxtx.c **** 	//void (*set[3]) = {TXLED_SET, RXLED_SET, USRLED_SET};
2520:bluetooth_rxtx.c **** 	//void (*clr[3]) = {TXLED_CLR, RXLED_CLR, USRLED_CLR};
2521:bluetooth_rxtx.c **** 
2522:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2523:bluetooth_rxtx.c **** 	PAEN_SET;
 7296              		.loc 1 2523 0
 7297 0004 8022     		movs	r2, #128
2518:bluetooth_rxtx.c **** 	//void (*set[3]) = {TXLED_SET, RXLED_SET, USRLED_SET};
 7298              		.loc 1 2518 0
 7299 0006 1868     		ldr	r0, [r3]	@ unaligned
 7300 0008 9B88     		ldrh	r3, [r3, #4]	@ unaligned
 7301 000a 0290     		str	r0, [sp, #8]	@ unaligned
 7302 000c ADF80C30 		strh	r3, [sp, #12]	@ unaligned
 7303              		.loc 1 2523 0
 7304 0010 414B     		ldr	r3, .L812+4
2524:bluetooth_rxtx.c **** 	//HGM_SET;
2525:bluetooth_rxtx.c **** #endif
2526:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 7305              		.loc 1 2526 0
 7306 0012 1220     		movs	r0, #18
2523:bluetooth_rxtx.c **** 	//HGM_SET;
 7307              		.loc 1 2523 0
 7308 0014 1A60     		str	r2, [r3]
 7309              		.loc 1 2526 0
 7310 0016 42F62231 		movw	r1, #11042
 7311 001a FFF7FEFF 		bl	cc2400_set
 7312              	.LVL805:
2527:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b); // without PRNG
 7313              		.loc 1 2527 0
 7314 001e 1420     		movs	r0, #20
 7315 0020 41F24B31 		movw	r1, #4939
 7316 0024 FFF7FEFF 		bl	cc2400_set
 7317              	.LVL806:
2528:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 7318              		.loc 1 2528 0
 7319 0028 2020     		movs	r0, #32
 7320 002a 40F20111 		movw	r1, #257
 7321 002e FFF7FEFF 		bl	cc2400_set
 7322              	.LVL807:
2529:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0029); // 160 kHz frequency deviation
 7323              		.loc 1 2529 0
 7324 0032 0320     		movs	r0, #3
 7325 0034 2921     		movs	r1, #41
 7326 0036 FFF7FEFF 		bl	cc2400_set
 7327              	.LVL808:
2530:bluetooth_rxtx.c **** 	cc2400_set(RSSI,    0x00F1); // RSSI Sample over 2 symbols
 7328              		.loc 1 2530 0
 7329 003a 0620     		movs	r0, #6
 7330 003c F121     		movs	r1, #241
 7331 003e FFF7FEFF 		bl	cc2400_set
 7332              	.LVL809:
 7333              	.L784:
2531:bluetooth_rxtx.c **** 
2532:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 7334              		.loc 1 2532 0 discriminator 1
 7335 0042 FFF7FEFF 		bl	cc2400_status
ARM GAS  /tmp/ccDKg7Fp.s 			page 193


 7336              	.LVL810:
 7337 0046 4106     		lsls	r1, r0, #25
 7338 0048 FBD5     		bpl	.L784
 7339              	.L801:
2533:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 7340              		.loc 1 2533 0 discriminator 1
 7341 004a FFF7FEFF 		bl	cc2400_status
 7342              	.LVL811:
 7343 004e 00F00400 		and	r0, r0, #4
 7344 0052 00F0FF04 		and	r4, r0, #255
 7345 0056 0028     		cmp	r0, #0
 7346 0058 F7D1     		bne	.L801
 7347              	.LVL812:
 7348              	.L786:
2534:bluetooth_rxtx.c **** 
2535:bluetooth_rxtx.c **** 	while (requested_mode == MODE_LED_SPECAN) {
 7349              		.loc 1 2535 0
 7350 005a 304B     		ldr	r3, .L812+8
 7351 005c 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 7352 005e 072B     		cmp	r3, #7
 7353 0060 56D1     		bne	.L811
 7354              	.LBB90:
2536:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channels[i] - 1);
 7355              		.loc 1 2536 0
 7356 0062 04AB     		add	r3, sp, #16
 7357 0064 03EB4403 		add	r3, r3, r4, lsl #1
 7358 0068 33F8081C 		ldrh	r1, [r3, #-8]
 7359 006c 0220     		movs	r0, #2
 7360 006e 0139     		subs	r1, r1, #1
 7361 0070 89B2     		uxth	r1, r1
 7362 0072 FFF7FEFF 		bl	cc2400_set
 7363              	.LVL813:
2537:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 7364              		.loc 1 2537 0
 7365 0076 6120     		movs	r0, #97
 7366 0078 FFF7FEFF 		bl	cc2400_strobe
 7367              	.LVL814:
 7368              	.L787:
2538:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
 7369              		.loc 1 2538 0 discriminator 1
 7370 007c FFF7FEFF 		bl	cc2400_status
 7371              	.LVL815:
 7372 0080 4207     		lsls	r2, r0, #29
 7373 0082 FBD5     		bpl	.L787
2539:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
 7374              		.loc 1 2539 0
 7375 0084 6220     		movs	r0, #98
 7376 0086 FFF7FEFF 		bl	cc2400_strobe
 7377              	.LVL816:
2540:bluetooth_rxtx.c **** 
2541:bluetooth_rxtx.c **** 		/* give the CC2400 time to acquire RSSI reading */
2542:bluetooth_rxtx.c **** 		volatile u32 j = 500; while (--j); //FIXME crude delay
 7378              		.loc 1 2542 0
 7379 008a 4FF4FA73 		mov	r3, #500
 7380 008e 0193     		str	r3, [sp, #4]
 7381              	.L788:
 7382              		.loc 1 2542 0 is_stmt 0 discriminator 2
ARM GAS  /tmp/ccDKg7Fp.s 			page 194


 7383 0090 019B     		ldr	r3, [sp, #4]
 7384 0092 013B     		subs	r3, r3, #1
 7385 0094 0193     		str	r3, [sp, #4]
 7386 0096 002B     		cmp	r3, #0
 7387 0098 FAD1     		bne	.L788
2543:bluetooth_rxtx.c **** 		lvl = (int8_t)((cc2400_get(RSSI) >> 8) & 0xff);
 7388              		.loc 1 2543 0 is_stmt 1
 7389 009a 0620     		movs	r0, #6
 7390 009c FFF7FEFF 		bl	cc2400_get
 7391              	.LVL817:
2544:bluetooth_rxtx.c **** 		if (lvl > rssi_threshold) {
 7392              		.loc 1 2544 0
 7393 00a0 1F4B     		ldr	r3, .L812+12
 7394 00a2 40F30720 		sbfx	r0, r0, #8, #8
 7395              	.LVL818:
 7396 00a6 93F85830 		ldrb	r3, [r3, #88]	@ zero_extendqisi2
 7397 00aa 5BB2     		sxtb	r3, r3
 7398 00ac 9842     		cmp	r0, r3
 7399 00ae 0CDD     		ble	.L789
2545:bluetooth_rxtx.c **** 			switch (i) {
 7400              		.loc 1 2545 0
 7401 00b0 012C     		cmp	r4, #1
 7402 00b2 07D0     		beq	.L791
 7403 00b4 03D3     		bcc	.L792
 7404 00b6 022C     		cmp	r4, #2
 7405 00b8 16D1     		bne	.L790
2546:bluetooth_rxtx.c **** 				case 0:
2547:bluetooth_rxtx.c **** 					TXLED_SET;
2548:bluetooth_rxtx.c **** 					break;
2549:bluetooth_rxtx.c **** 				case 1:
2550:bluetooth_rxtx.c **** 					RXLED_SET;
2551:bluetooth_rxtx.c **** 					break;
2552:bluetooth_rxtx.c **** 				case 2:
2553:bluetooth_rxtx.c **** 					USRLED_SET;
 7406              		.loc 1 2553 0
 7407 00ba 1A4B     		ldr	r3, .L812+16
 7408 00bc 13E0     		b	.L807
 7409              	.L792:
2547:bluetooth_rxtx.c **** 					break;
 7410              		.loc 1 2547 0
 7411 00be 4FF48072 		mov	r2, #256
 7412 00c2 00E0     		b	.L810
 7413              	.L791:
2550:bluetooth_rxtx.c **** 					break;
 7414              		.loc 1 2550 0
 7415 00c4 1022     		movs	r2, #16
 7416              	.L810:
 7417 00c6 174B     		ldr	r3, .L812+16
 7418 00c8 0BE0     		b	.L809
 7419              	.L789:
2554:bluetooth_rxtx.c **** 					break;
2555:bluetooth_rxtx.c **** 			}
2556:bluetooth_rxtx.c **** 		}
2557:bluetooth_rxtx.c **** 		else {
2558:bluetooth_rxtx.c **** 			switch (i) {
 7420              		.loc 1 2558 0
 7421 00ca 012C     		cmp	r4, #1
ARM GAS  /tmp/ccDKg7Fp.s 			page 195


 7422 00cc 07D0     		beq	.L794
 7423 00ce 03D3     		bcc	.L795
 7424 00d0 022C     		cmp	r4, #2
 7425 00d2 09D1     		bne	.L790
2559:bluetooth_rxtx.c **** 				case 0:
2560:bluetooth_rxtx.c **** 					TXLED_CLR;
2561:bluetooth_rxtx.c **** 					break;
2562:bluetooth_rxtx.c **** 				case 1:
2563:bluetooth_rxtx.c **** 					RXLED_CLR;
2564:bluetooth_rxtx.c **** 					break;
2565:bluetooth_rxtx.c **** 				case 2:
2566:bluetooth_rxtx.c **** 					USRLED_CLR;
 7426              		.loc 1 2566 0
 7427 00d4 144B     		ldr	r3, .L812+20
 7428 00d6 06E0     		b	.L807
 7429              	.L795:
2560:bluetooth_rxtx.c **** 					break;
 7430              		.loc 1 2560 0
 7431 00d8 4FF48072 		mov	r2, #256
 7432 00dc 00E0     		b	.L808
 7433              	.L794:
2563:bluetooth_rxtx.c **** 					break;
 7434              		.loc 1 2563 0
 7435 00de 1022     		movs	r2, #16
 7436              	.L808:
 7437 00e0 114B     		ldr	r3, .L812+20
 7438              	.L809:
 7439 00e2 1A60     		str	r2, [r3]
2564:bluetooth_rxtx.c **** 				case 2:
 7440              		.loc 1 2564 0
 7441 00e4 00E0     		b	.L790
 7442              	.L807:
 7443              		.loc 1 2566 0
 7444 00e6 1C60     		str	r4, [r3]
 7445              	.L790:
2567:bluetooth_rxtx.c **** 					break;
2568:bluetooth_rxtx.c **** 			}
2569:bluetooth_rxtx.c **** 		}
2570:bluetooth_rxtx.c **** 
2571:bluetooth_rxtx.c **** 		i = (i+1) % 3;
 7446              		.loc 1 2571 0
 7447 00e8 0134     		adds	r4, r4, #1
 7448              	.LVL819:
 7449 00ea 0323     		movs	r3, #3
 7450 00ec 94FBF3F3 		sdiv	r3, r4, r3
 7451 00f0 03EB4303 		add	r3, r3, r3, lsl #1
 7452 00f4 E41A     		subs	r4, r4, r3
2572:bluetooth_rxtx.c **** 
2573:bluetooth_rxtx.c **** 		handle_usb(clkn);
 7453              		.loc 1 2573 0
 7454 00f6 0D4B     		ldr	r3, .L812+24
2571:bluetooth_rxtx.c **** 
 7455              		.loc 1 2571 0
 7456 00f8 E4B2     		uxtb	r4, r4
 7457              	.LVL820:
 7458              		.loc 1 2573 0
 7459 00fa 1868     		ldr	r0, [r3]
ARM GAS  /tmp/ccDKg7Fp.s 			page 196


 7460 00fc FFF7FEFF 		bl	handle_usb
 7461              	.LVL821:
2574:bluetooth_rxtx.c **** 
2575:bluetooth_rxtx.c **** 		cc2400_strobe(SRFOFF);
 7462              		.loc 1 2575 0
 7463 0100 6420     		movs	r0, #100
 7464 0102 FFF7FEFF 		bl	cc2400_strobe
 7465              	.LVL822:
 7466              	.L797:
2576:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
 7467              		.loc 1 2576 0 discriminator 1
 7468 0106 FFF7FEFF 		bl	cc2400_status
 7469              	.LVL823:
 7470 010a 4307     		lsls	r3, r0, #29
 7471 010c FBD4     		bmi	.L797
 7472 010e A4E7     		b	.L786
 7473              	.L811:
 7474              	.LBE90:
2577:bluetooth_rxtx.c **** 	}
2578:bluetooth_rxtx.c **** }
 7475              		.loc 1 2578 0
 7476 0110 04B0     		add	sp, sp, #16
 7477              		.cfi_def_cfa_offset 8
 7478              		@ sp needed
 7479 0112 10BD     		pop	{r4, pc}
 7480              	.LVL824:
 7481              	.L813:
 7482              		.align	2
 7483              	.L812:
 7484 0114 B6080000 		.word	.LANCHOR2+2230
 7485 0118 58C00920 		.word	537509976
 7486 011c 00000000 		.word	.LANCHOR0
 7487 0120 00000000 		.word	.LANCHOR1
 7488 0124 38C00920 		.word	537509944
 7489 0128 3CC00920 		.word	537509948
 7490 012c 00000000 		.word	clkn
 7491              		.cfi_endproc
 7492              	.LFE39:
 7494              		.section	.text.startup.main,"ax",%progbits
 7495              		.align	1
 7496              		.global	main
 7497              		.thumb
 7498              		.thumb_func
 7500              	main:
 7501              	.LFB40:
2579:bluetooth_rxtx.c **** 
2580:bluetooth_rxtx.c **** int main()
2581:bluetooth_rxtx.c **** {
 7502              		.loc 1 2581 0
 7503              		.cfi_startproc
 7504              		@ Volatile: function does not return.
 7505              		@ args = 0, pretend = 0, frame = 0
 7506              		@ frame_needed = 0, uses_anonymous_args = 0
 7507 0000 08B5     		push	{r3, lr}
 7508              		.cfi_def_cfa_offset 8
 7509              		.cfi_offset 3, -8
 7510              		.cfi_offset 14, -4
ARM GAS  /tmp/ccDKg7Fp.s 			page 197


2582:bluetooth_rxtx.c **** 	ubertooth_init();
 7511              		.loc 1 2582 0
 7512 0002 FFF7FEFF 		bl	ubertooth_init
 7513              	.LVL825:
2583:bluetooth_rxtx.c **** 	clkn_init();
 7514              		.loc 1 2583 0
 7515 0006 FFF7FEFF 		bl	clkn_init
 7516              	.LVL826:
2584:bluetooth_rxtx.c **** 	ubertooth_usb_init(vendor_request_handler);
 7517              		.loc 1 2584 0
 7518 000a 3848     		ldr	r0, .L836
 7519 000c FFF7FEFF 		bl	ubertooth_usb_init
 7520              	.LVL827:
2585:bluetooth_rxtx.c **** 	cc2400_idle();
 7521              		.loc 1 2585 0
 7522 0010 FFF7FEFF 		bl	cc2400_idle
 7523              	.LVL828:
2586:bluetooth_rxtx.c **** 	dma_poweron();
 7524              		.loc 1 2586 0
 7525 0014 FFF7FEFF 		bl	dma_poweron
 7526              	.LVL829:
2587:bluetooth_rxtx.c **** 
2588:bluetooth_rxtx.c **** 	debug_uart_init(0);
 7527              		.loc 1 2588 0
 7528 0018 0020     		movs	r0, #0
 7529 001a FFF7FEFF 		bl	debug_uart_init
 7530              	.LVL830:
2589:bluetooth_rxtx.c **** 	debug_printf("\n\n****UBERTOOTH BOOT****\n%s\n", compile_info);
 7531              		.loc 1 2589 0
 7532 001e 3448     		ldr	r0, .L836+4
 7533 0020 3449     		ldr	r1, .L836+8
 7534 0022 FFF7FEFF 		bl	debug_printf
 7535              	.LVL831:
 7536              	.L815:
2590:bluetooth_rxtx.c **** 
2591:bluetooth_rxtx.c **** 	while (1) {
2592:bluetooth_rxtx.c **** 		handle_usb(clkn);
 7537              		.loc 1 2592 0
 7538 0026 344B     		ldr	r3, .L836+12
2593:bluetooth_rxtx.c **** 		if(requested_mode != mode) {
 7539              		.loc 1 2593 0
 7540 0028 344C     		ldr	r4, .L836+16
2592:bluetooth_rxtx.c **** 		if(requested_mode != mode) {
 7541              		.loc 1 2592 0
 7542 002a 1868     		ldr	r0, [r3]
 7543 002c FFF7FEFF 		bl	handle_usb
 7544              	.LVL832:
 7545              		.loc 1 2593 0
 7546 0030 A27C     		ldrb	r2, [r4, #18]	@ zero_extendqisi2
 7547 0032 637C     		ldrb	r3, [r4, #17]	@ zero_extendqisi2
 7548 0034 9A42     		cmp	r2, r3
 7549 0036 F6D0     		beq	.L815
2594:bluetooth_rxtx.c **** 			switch (requested_mode) {
 7550              		.loc 1 2594 0
 7551 0038 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 7552 003a 102B     		cmp	r3, #16
 7553 003c F3D8     		bhi	.L815
ARM GAS  /tmp/ccDKg7Fp.s 			page 198


 7554 003e DFE803F0 		tbb	[pc, r3]
 7555              	.L818:
 7556 0042 51       		.byte	(.L817-.L818)/2
 7557 0043 11       		.byte	(.L819-.L818)/2
 7558 0044 16       		.byte	(.L820-.L818)/2
 7559 0045 28       		.byte	(.L821-.L818)/2
 7560 0046 3D       		.byte	(.L822-.L818)/2
 7561 0047 2F       		.byte	(.L823-.L818)/2
 7562 0048 37       		.byte	(.L824-.L818)/2
 7563 0049 40       		.byte	(.L825-.L818)/2
 7564 004a 1B       		.byte	(.L826-.L818)/2
 7565 004b 1D       		.byte	(.L827-.L818)/2
 7566 004c 22       		.byte	(.L828-.L818)/2
 7567 004d 09       		.byte	(.L829-.L818)/2
 7568 004e 25       		.byte	(.L830-.L818)/2
 7569 004f 43       		.byte	(.L831-.L818)/2
 7570 0050 0F       		.byte	(.L832-.L818)/2
 7571 0051 49       		.byte	(.L833-.L818)/2
 7572 0052 4E       		.byte	(.L834-.L818)/2
 7573 0053 00       		.p2align 1
 7574              	.L829:
2595:bluetooth_rxtx.c **** 				case MODE_RESET:
2596:bluetooth_rxtx.c **** 					/* Allow time for the USB command to return correctly */
2597:bluetooth_rxtx.c **** 					wait(1);
 7575              		.loc 1 2597 0
 7576 0054 0120     		movs	r0, #1
 7577 0056 FFF7FEFF 		bl	wait
 7578              	.LVL833:
2598:bluetooth_rxtx.c **** 					reset();
 7579              		.loc 1 2598 0
 7580 005a FFF7FEFF 		bl	reset
 7581              	.LVL834:
2599:bluetooth_rxtx.c **** 					break;
 7582              		.loc 1 2599 0
 7583 005e E2E7     		b	.L815
 7584              	.L832:
2600:bluetooth_rxtx.c **** 				case MODE_AFH:
2601:bluetooth_rxtx.c **** 					mode = MODE_AFH;
 7585              		.loc 1 2601 0
 7586 0060 0E23     		movs	r3, #14
 7587 0062 00E0     		b	.L835
 7588              	.L819:
2602:bluetooth_rxtx.c **** 					bt_stream_rx();
2603:bluetooth_rxtx.c **** 					break;
2604:bluetooth_rxtx.c **** 				case MODE_RX_SYMBOLS:
2605:bluetooth_rxtx.c **** 					mode = MODE_RX_SYMBOLS;
 7589              		.loc 1 2605 0
 7590 0064 0123     		movs	r3, #1
 7591              	.L835:
 7592 0066 6374     		strb	r3, [r4, #17]
2606:bluetooth_rxtx.c **** 					bt_stream_rx();
 7593              		.loc 1 2606 0
 7594 0068 FFF7FEFF 		bl	bt_stream_rx
 7595              	.LVL835:
2607:bluetooth_rxtx.c **** 					break;
 7596              		.loc 1 2607 0
 7597 006c DBE7     		b	.L815
ARM GAS  /tmp/ccDKg7Fp.s 			page 199


 7598              	.L820:
2608:bluetooth_rxtx.c **** 				case MODE_TX_SYMBOLS:
2609:bluetooth_rxtx.c **** 					mode = MODE_TX_SYMBOLS;
 7599              		.loc 1 2609 0
 7600 006e 0223     		movs	r3, #2
 7601 0070 6374     		strb	r3, [r4, #17]
2610:bluetooth_rxtx.c **** 					br_transmit();
 7602              		.loc 1 2610 0
 7603 0072 FFF7FEFF 		bl	br_transmit
 7604              	.LVL836:
2611:bluetooth_rxtx.c **** 					break;
 7605              		.loc 1 2611 0
 7606 0076 D6E7     		b	.L815
 7607              	.L826:
2612:bluetooth_rxtx.c **** 				case MODE_BT_FOLLOW:
2613:bluetooth_rxtx.c **** 					mode = MODE_BT_FOLLOW;
 7608              		.loc 1 2613 0
 7609 0078 0823     		movs	r3, #8
 7610 007a F4E7     		b	.L835
 7611              	.L827:
2614:bluetooth_rxtx.c **** 					bt_stream_rx();
2615:bluetooth_rxtx.c **** 					break;
2616:bluetooth_rxtx.c **** 				case MODE_BT_FOLLOW_LE:
2617:bluetooth_rxtx.c **** 					mode = MODE_BT_FOLLOW_LE;
 7612              		.loc 1 2617 0
 7613 007c 0923     		movs	r3, #9
 7614 007e 6374     		strb	r3, [r4, #17]
 7615              	.LBB91:
 7616              	.LBB92:
2063:bluetooth_rxtx.c **** 
 7617              		.loc 1 2063 0
 7618 0080 FFF7FEFF 		bl	le_phy_main
 7619              	.LVL837:
 7620 0084 CFE7     		b	.L815
 7621              	.L828:
 7622              	.LBE92:
 7623              	.LBE91:
2618:bluetooth_rxtx.c **** 					bt_follow_le();
2619:bluetooth_rxtx.c **** 					break;
2620:bluetooth_rxtx.c **** 				case MODE_BT_PROMISC_LE:
2621:bluetooth_rxtx.c **** 					bt_promisc_le();
 7624              		.loc 1 2621 0
 7625 0086 FFF7FEFF 		bl	bt_promisc_le
 7626              	.LVL838:
2622:bluetooth_rxtx.c **** 					break;
 7627              		.loc 1 2622 0
 7628 008a CCE7     		b	.L815
 7629              	.L830:
2623:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE:
2624:bluetooth_rxtx.c **** 					bt_slave_le();
 7630              		.loc 1 2624 0
 7631 008c FFF7FEFF 		bl	bt_slave_le
 7632              	.LVL839:
2625:bluetooth_rxtx.c **** 					break;
 7633              		.loc 1 2625 0
 7634 0090 C9E7     		b	.L815
 7635              	.L821:
ARM GAS  /tmp/ccDKg7Fp.s 			page 200


2626:bluetooth_rxtx.c **** 				case MODE_TX_TEST:
2627:bluetooth_rxtx.c **** 					mode = MODE_TX_TEST;
 7636              		.loc 1 2627 0
 7637 0092 0323     		movs	r3, #3
2628:bluetooth_rxtx.c **** 					cc2400_txtest(&modulation, &channel);
 7638              		.loc 1 2628 0
 7639 0094 1948     		ldr	r0, .L836+16
 7640 0096 1A49     		ldr	r1, .L836+20
2627:bluetooth_rxtx.c **** 					cc2400_txtest(&modulation, &channel);
 7641              		.loc 1 2627 0
 7642 0098 6374     		strb	r3, [r4, #17]
 7643              		.loc 1 2628 0
 7644 009a FFF7FEFF 		bl	cc2400_txtest
 7645              	.LVL840:
2629:bluetooth_rxtx.c **** 					break;
 7646              		.loc 1 2629 0
 7647 009e C2E7     		b	.L815
 7648              	.L823:
2630:bluetooth_rxtx.c **** 				case MODE_RANGE_TEST:
2631:bluetooth_rxtx.c **** 					mode = MODE_RANGE_TEST;
 7649              		.loc 1 2631 0
 7650 00a0 0523     		movs	r3, #5
2632:bluetooth_rxtx.c **** 					cc2400_rangetest(&channel);
 7651              		.loc 1 2632 0
 7652 00a2 1748     		ldr	r0, .L836+20
2631:bluetooth_rxtx.c **** 					cc2400_rangetest(&channel);
 7653              		.loc 1 2631 0
 7654 00a4 6374     		strb	r3, [r4, #17]
 7655              		.loc 1 2632 0
 7656 00a6 FFF7FEFF 		bl	cc2400_rangetest
 7657              	.LVL841:
2633:bluetooth_rxtx.c **** 					requested_mode = MODE_IDLE;
 7658              		.loc 1 2633 0
 7659 00aa 0023     		movs	r3, #0
 7660 00ac A374     		strb	r3, [r4, #18]
2634:bluetooth_rxtx.c **** 					break;
 7661              		.loc 1 2634 0
 7662 00ae BAE7     		b	.L815
 7663              	.L824:
2635:bluetooth_rxtx.c **** 				case MODE_REPEATER:
2636:bluetooth_rxtx.c **** 					mode = MODE_REPEATER;
 7664              		.loc 1 2636 0
 7665 00b0 0623     		movs	r3, #6
2637:bluetooth_rxtx.c **** 					cc2400_repeater(&channel);
 7666              		.loc 1 2637 0
 7667 00b2 1348     		ldr	r0, .L836+20
2636:bluetooth_rxtx.c **** 					cc2400_repeater(&channel);
 7668              		.loc 1 2636 0
 7669 00b4 6374     		strb	r3, [r4, #17]
 7670              		.loc 1 2637 0
 7671 00b6 FFF7FEFF 		bl	cc2400_repeater
 7672              	.LVL842:
2638:bluetooth_rxtx.c **** 					break;
 7673              		.loc 1 2638 0
 7674 00ba B4E7     		b	.L815
 7675              	.L822:
2639:bluetooth_rxtx.c **** 				case MODE_SPECAN:
ARM GAS  /tmp/ccDKg7Fp.s 			page 201


2640:bluetooth_rxtx.c **** 					specan();
 7676              		.loc 1 2640 0
 7677 00bc FFF7FEFF 		bl	specan
 7678              	.LVL843:
2641:bluetooth_rxtx.c **** 					break;
 7679              		.loc 1 2641 0
 7680 00c0 B1E7     		b	.L815
 7681              	.L825:
2642:bluetooth_rxtx.c **** 				case MODE_LED_SPECAN:
2643:bluetooth_rxtx.c **** 					led_specan();
 7682              		.loc 1 2643 0
 7683 00c2 FFF7FEFF 		bl	led_specan
 7684              	.LVL844:
2644:bluetooth_rxtx.c **** 					break;
 7685              		.loc 1 2644 0
 7686 00c6 AEE7     		b	.L815
 7687              	.L831:
2645:bluetooth_rxtx.c **** 				case MODE_EGO:
2646:bluetooth_rxtx.c **** 					mode = MODE_EGO;
 7688              		.loc 1 2646 0
 7689 00c8 0D23     		movs	r3, #13
 7690 00ca 6374     		strb	r3, [r4, #17]
2647:bluetooth_rxtx.c **** 					ego_main(ego_mode);
 7691              		.loc 1 2647 0
 7692 00cc 207D     		ldrb	r0, [r4, #20]	@ zero_extendqisi2
 7693 00ce FFF7FEFF 		bl	ego_main
 7694              	.LVL845:
2648:bluetooth_rxtx.c **** 					break;
 7695              		.loc 1 2648 0
 7696 00d2 A8E7     		b	.L815
 7697              	.L833:
2649:bluetooth_rxtx.c **** 				case MODE_RX_GENERIC:
2650:bluetooth_rxtx.c **** 					mode = MODE_RX_GENERIC;
 7698              		.loc 1 2650 0
 7699 00d4 0F23     		movs	r3, #15
 7700 00d6 6374     		strb	r3, [r4, #17]
2651:bluetooth_rxtx.c **** 					rx_generic();
 7701              		.loc 1 2651 0
 7702 00d8 FFF7FEFF 		bl	rx_generic
 7703              	.LVL846:
2652:bluetooth_rxtx.c **** 					break;
 7704              		.loc 1 2652 0
 7705 00dc A3E7     		b	.L815
 7706              	.L834:
2653:bluetooth_rxtx.c **** 				case MODE_TX_GENERIC:
2654:bluetooth_rxtx.c **** 					tx_generic();
 7707              		.loc 1 2654 0
 7708 00de FFF7FEFF 		bl	tx_generic
 7709              	.LVL847:
2655:bluetooth_rxtx.c **** 					break;
 7710              		.loc 1 2655 0
 7711 00e2 A0E7     		b	.L815
 7712              	.L817:
2656:bluetooth_rxtx.c **** 				case MODE_IDLE:
2657:bluetooth_rxtx.c **** 					cc2400_idle();
 7713              		.loc 1 2657 0
 7714 00e4 FFF7FEFF 		bl	cc2400_idle
ARM GAS  /tmp/ccDKg7Fp.s 			page 202


 7715              	.LVL848:
2658:bluetooth_rxtx.c **** 					break;
 7716              		.loc 1 2658 0
 7717 00e8 9DE7     		b	.L815
 7718              	.L837:
 7719 00ea 00BF     		.align	2
 7720              	.L836:
 7721 00ec 00000000 		.word	vendor_request_handler
 7722 00f0 0B000000 		.word	.LC4
 7723 00f4 A7000000 		.word	.LANCHOR2+167
 7724 00f8 00000000 		.word	clkn
 7725 00fc 00000000 		.word	.LANCHOR0
 7726 0100 00000000 		.word	.LANCHOR1
 7727              		.cfi_endproc
 7728              	.LFE40:
 7730              		.comm	unpacked,800,1
 7731              		.global	packet_cb
 7732              		.global	data_cb
 7733              		.global	le_jam_count
 7734              		.comm	le_promisc,264,4
 7735              		.global	le
 7736              		.global	slave_mac_address
 7737              		.comm	tx_pkt,58,2
 7738              		.global	rssi_threshold
 7739              		.global	high_freq
 7740              		.global	low_freq
 7741              		.global	modulation
 7742              		.global	ego_mode
 7743              		.global	jam_mode
 7744              		.global	requested_mode
 7745              		.global	mode
 7746              		.global	status
 7747              		.global	dma_discard
 7748              		.global	idle_buf_channel
 7749              		.global	idle_buf_clk100ns
 7750              		.global	idle_buf_clkn_high
 7751              		.global	cancel_follow
 7752              		.global	le_adv_channel
 7753              		.global	requested_channel
 7754              		.global	hop_timeout
 7755              		.global	hop_direct_channel
 7756              		.global	channel
 7757              		.global	do_hop
 7758              		.global	hop_mode
 7759              		.global	compile_info
 7760              		.comm	rr,5,1
 7761              		.comm	used_channels,1,1
 7762              		.comm	afh_map,10,1
 7763              		.comm	afh_enabled,1,1
 7764              		.comm	syncword,8,8
 7765              		.comm	target,16,8
 7766              		.comm	clkn_next_drift_fix,4,4
 7767              		.comm	clkn_last_drift_fix,4,4
 7768              		.comm	clk_drift_correction,2,2
 7769              		.comm	clk_drift_ppm,2,2
 7770              		.comm	clk100ns_offset,2,2
 7771              		.comm	clkn_offset,4,4
ARM GAS  /tmp/ccDKg7Fp.s 			page 203


 7772              		.comm	last_hop,4,4
 7773              		.comm	clkn,4,4
 7774              		.comm	rx_err,4,4
 7775              		.comm	rx_tc,4,4
 7776              		.comm	idle_rxbuf,4,4
 7777              		.comm	active_rxbuf,4,4
 7778              		.comm	rxbuf2,50,1
 7779              		.comm	rxbuf1,50,1
 7780              		.comm	cs_trigger,1,1
 7781              		.comm	cs_threshold_cur,1,1
 7782              		.comm	cs_threshold_req,1,1
 7783              		.comm	cs_no_squelch,1,1
 7784              		.comm	rssi_count,1,1
 7785              		.comm	rssi_min,1,1
 7786              		.comm	rssi_max,1,1
 7787              		.section	.rodata
 7788              		.align	2
 7789              		.set	.LANCHOR2,. + 0
 7792              	whitening_index:
 7793 0000 46       		.byte	70
 7794 0001 3E       		.byte	62
 7795 0002 78       		.byte	120
 7796 0003 6F       		.byte	111
 7797 0004 4D       		.byte	77
 7798 0005 2E       		.byte	46
 7799 0006 0F       		.byte	15
 7800 0007 65       		.byte	101
 7801 0008 42       		.byte	66
 7802 0009 27       		.byte	39
 7803 000a 1F       		.byte	31
 7804 000b 1A       		.byte	26
 7805 000c 50       		.byte	80
 7806 000d 53       		.byte	83
 7807 000e 7D       		.byte	125
 7808 000f 59       		.byte	89
 7809 0010 0A       		.byte	10
 7810 0011 23       		.byte	35
 7811 0012 08       		.byte	8
 7812 0013 36       		.byte	54
 7813 0014 7A       		.byte	122
 7814 0015 11       		.byte	17
 7815 0016 21       		.byte	33
 7816 0017 00       		.byte	0
 7817 0018 3A       		.byte	58
 7818 0019 73       		.byte	115
 7819 001a 06       		.byte	6
 7820 001b 5E       		.byte	94
 7821 001c 56       		.byte	86
 7822 001d 31       		.byte	49
 7823 001e 34       		.byte	52
 7824 001f 14       		.byte	20
 7825 0020 28       		.byte	40
 7826 0021 1B       		.byte	27
 7827 0022 54       		.byte	84
 7828 0023 5A       		.byte	90
 7829 0024 3F       		.byte	63
 7830 0025 70       		.byte	112
ARM GAS  /tmp/ccDKg7Fp.s 			page 204


 7831 0026 2F       		.byte	47
 7832 0027 66       		.byte	102
 7835              	whitening:
 7836 0028 01       		.byte	1
 7837 0029 01       		.byte	1
 7838 002a 01       		.byte	1
 7839 002b 01       		.byte	1
 7840 002c 00       		.byte	0
 7841 002d 01       		.byte	1
 7842 002e 00       		.byte	0
 7843 002f 01       		.byte	1
 7844 0030 00       		.byte	0
 7845 0031 01       		.byte	1
 7846 0032 00       		.byte	0
 7847 0033 00       		.byte	0
 7848 0034 00       		.byte	0
 7849 0035 00       		.byte	0
 7850 0036 01       		.byte	1
 7851 0037 00       		.byte	0
 7852 0038 01       		.byte	1
 7853 0039 01       		.byte	1
 7854 003a 00       		.byte	0
 7855 003b 01       		.byte	1
 7856 003c 01       		.byte	1
 7857 003d 01       		.byte	1
 7858 003e 01       		.byte	1
 7859 003f 00       		.byte	0
 7860 0040 00       		.byte	0
 7861 0041 01       		.byte	1
 7862 0042 01       		.byte	1
 7863 0043 01       		.byte	1
 7864 0044 00       		.byte	0
 7865 0045 00       		.byte	0
 7866 0046 01       		.byte	1
 7867 0047 00       		.byte	0
 7868 0048 01       		.byte	1
 7869 0049 00       		.byte	0
 7870 004a 01       		.byte	1
 7871 004b 01       		.byte	1
 7872 004c 00       		.byte	0
 7873 004d 00       		.byte	0
 7874 004e 01       		.byte	1
 7875 004f 01       		.byte	1
 7876 0050 00       		.byte	0
 7877 0051 00       		.byte	0
 7878 0052 00       		.byte	0
 7879 0053 00       		.byte	0
 7880 0054 00       		.byte	0
 7881 0055 01       		.byte	1
 7882 0056 01       		.byte	1
 7883 0057 00       		.byte	0
 7884 0058 01       		.byte	1
 7885 0059 01       		.byte	1
 7886 005a 00       		.byte	0
 7887 005b 01       		.byte	1
 7888 005c 00       		.byte	0
 7889 005d 01       		.byte	1
ARM GAS  /tmp/ccDKg7Fp.s 			page 205


 7890 005e 01       		.byte	1
 7891 005f 01       		.byte	1
 7892 0060 00       		.byte	0
 7893 0061 01       		.byte	1
 7894 0062 00       		.byte	0
 7895 0063 00       		.byte	0
 7896 0064 00       		.byte	0
 7897 0065 01       		.byte	1
 7898 0066 01       		.byte	1
 7899 0067 00       		.byte	0
 7900 0068 00       		.byte	0
 7901 0069 01       		.byte	1
 7902 006a 00       		.byte	0
 7903 006b 00       		.byte	0
 7904 006c 00       		.byte	0
 7905 006d 01       		.byte	1
 7906 006e 00       		.byte	0
 7907 006f 00       		.byte	0
 7908 0070 00       		.byte	0
 7909 0071 00       		.byte	0
 7910 0072 00       		.byte	0
 7911 0073 00       		.byte	0
 7912 0074 01       		.byte	1
 7913 0075 00       		.byte	0
 7914 0076 00       		.byte	0
 7915 0077 01       		.byte	1
 7916 0078 00       		.byte	0
 7917 0079 00       		.byte	0
 7918 007a 01       		.byte	1
 7919 007b 01       		.byte	1
 7920 007c 00       		.byte	0
 7921 007d 01       		.byte	1
 7922 007e 00       		.byte	0
 7923 007f 00       		.byte	0
 7924 0080 01       		.byte	1
 7925 0081 01       		.byte	1
 7926 0082 01       		.byte	1
 7927 0083 01       		.byte	1
 7928 0084 00       		.byte	0
 7929 0085 01       		.byte	1
 7930 0086 01       		.byte	1
 7931 0087 01       		.byte	1
 7932 0088 00       		.byte	0
 7933 0089 00       		.byte	0
 7934 008a 00       		.byte	0
 7935 008b 00       		.byte	0
 7936 008c 01       		.byte	1
 7937 008d 01       		.byte	1
 7938 008e 01       		.byte	1
 7939 008f 01       		.byte	1
 7940 0090 01       		.byte	1
 7941 0091 01       		.byte	1
 7942 0092 01       		.byte	1
 7943 0093 00       		.byte	0
 7944 0094 00       		.byte	0
 7945 0095 00       		.byte	0
 7946 0096 01       		.byte	1
ARM GAS  /tmp/ccDKg7Fp.s 			page 206


 7947 0097 01       		.byte	1
 7948 0098 01       		.byte	1
 7949 0099 00       		.byte	0
 7950 009a 01       		.byte	1
 7951 009b 01       		.byte	1
 7952 009c 00       		.byte	0
 7953 009d 00       		.byte	0
 7954 009e 00       		.byte	0
 7955 009f 01       		.byte	1
 7956 00a0 00       		.byte	0
 7957 00a1 01       		.byte	1
 7958 00a2 00       		.byte	0
 7959 00a3 00       		.byte	0
 7960 00a4 01       		.byte	1
 7961 00a5 00       		.byte	0
 7962 00a6 01       		.byte	1
 7965              	compile_info:
 7966 00a7 75626572 		.ascii	"ubertooth 2018-08-R1 (niko@niko-X550LB) Do 25. Okt "
 7966      746F6F74 
 7966      68203230 
 7966      31382D30 
 7966      382D5231 
 7967 00da 31353A34 		.ascii	"15:43:48 CEST 2018\000"
 7967      333A3438 
 7967      20434553 
 7967      54203230 
 7967      313800
 7968 00ed 000000   		.space	3
 7971              	whitening_word:
 7972 00f0 40B2BCC3 		.word	-1011043776
 7973 00f4 1F374A5F 		.word	1598699295
 7974 00f8 85F69C9A 		.word	-1700989307
 7975 00fc C1D6C544 		.word	1153816257
 7976 0100 2059DEE1 		.word	-505521888
 7977 0104 8F1BA5AF 		.word	-1348134001
 7978 0108 427B4ECD 		.word	-850494654
 7979 010c 60EB6222 		.word	576908128
 7980 0110 902CEFF0 		.word	-252760944
 7981 0114 C78DD257 		.word	1473416647
 7982 0118 A13DA766 		.word	1722236321
 7983 011c B0753111 		.word	288454064
 7984 0120 8940B2BC 		.word	-1129168759
 7985 0124 C31F374A 		.word	1245126595
 7986 0128 5F85F69C 		.word	-1661565601
 7987 012c 9AC1D6C5 		.word	-975781478
 7988 0130 442059DE 		.word	-564584380
 7989 0134 E18F1BA5 		.word	-1524920351
 7990 0138 AF427B4E 		.word	1316700847
 7991 013c CD60EB62 		.word	1659592909
 7992 0140 22902CEF 		.word	-282292190
 7993 0144 F0C78DD2 		.word	-762460176
 7994 0148 57A13DA7 		.word	-1489133225
 7995 014c 66B07531 		.word	829796454
 7996 0150 D257A13D 		.word	1033983954
 7997 0154 A766B075 		.word	1974494887
 7998 0158 31114896 		.word	-1773661903
 7999 015c 77F8E346 		.word	1189345399
ARM GAS  /tmp/ccDKg7Fp.s 			page 207


 8000 0160 E9ABD09E 		.word	-1630491671
 8001 0164 5333D8BA 		.word	-1160236205
 8002 0168 980824CB 		.word	-886830952
 8003 016c 3BFC71A3 		.word	-1552810949
 8004 0170 F45568CF 		.word	-815245836
 8005 0174 A9196C5D 		.word	1567365545
 8006 0178 4C0492E5 		.word	-443415476
 8007 017c 1DFEB851 		.word	1371078173
 8008 0180 1BA5AF42 		.word	1118807323
 8009 0184 7B4ECD60 		.word	1624067707
 8010 0188 EB622290 		.word	-1876794645
 8011 018c 2CEFF0C7 		.word	-940511444
 8012 0190 8DD257A1 		.word	-1588079987
 8013 0194 3DA766B0 		.word	-1335449795
 8014 0198 75311148 		.word	1209086325
 8015 019c 9677F8E3 		.word	-470255722
 8016 01a0 46E9ABD0 		.word	-794039994
 8017 01a4 9E5333D8 		.word	-667724898
 8018 01a8 BA980824 		.word	604543162
 8019 01ac CB3BFC71 		.word	1912355787
 8020 01b0 6479873F 		.word	1065843044
 8021 01b4 6E94BE0A 		.word	180261998
 8022 01b8 ED393583 		.word	-2093663763
 8023 01bc AD8B8940 		.word	1082756013
 8024 01c0 B2BCC31F 		.word	532921522
 8025 01c4 374A5F85 		.word	-2057352649
 8026 01c8 F69C9AC1 		.word	-1046831882
 8027 01cc D6C54420 		.word	541378006
 8028 01d0 59DEE18F 		.word	-1881022887
 8029 01d4 1BA5AF42 		.word	1118807323
 8030 01d8 7B4ECD60 		.word	1624067707
 8031 01dc EB622290 		.word	-1876794645
 8032 01e0 AD8B8940 		.word	1082756013
 8033 01e4 B2BCC31F 		.word	532921522
 8034 01e8 374A5F85 		.word	-2057352649
 8035 01ec F69C9AC1 		.word	-1046831882
 8036 01f0 D6C54420 		.word	541378006
 8037 01f4 59DEE18F 		.word	-1881022887
 8038 01f8 1BA5AF42 		.word	1118807323
 8039 01fc 7B4ECD60 		.word	1624067707
 8040 0200 EB622290 		.word	-1876794645
 8041 0204 2CEFF0C7 		.word	-940511444
 8042 0208 8DD257A1 		.word	-1588079987
 8043 020c 3DA766B0 		.word	-1335449795
 8044 0210 F69C9AC1 		.word	-1046831882
 8045 0214 D6C54420 		.word	541378006
 8046 0218 59DEE18F 		.word	-1881022887
 8047 021c 1BA5AF42 		.word	1118807323
 8048 0220 7B4ECD60 		.word	1624067707
 8049 0224 EB622290 		.word	-1876794645
 8050 0228 2CEFF0C7 		.word	-940511444
 8051 022c 8DD257A1 		.word	-1588079987
 8052 0230 3DA766B0 		.word	-1335449795
 8053 0234 75311148 		.word	1209086325
 8054 0238 9677F8E3 		.word	-470255722
 8055 023c 46E9ABD0 		.word	-794039994
 8056 0240 3F6E94BE 		.word	-1097568705
ARM GAS  /tmp/ccDKg7Fp.s 			page 208


 8057 0244 0AED3935 		.word	892988682
 8058 0248 83AD8B89 		.word	-1987334781
 8059 024c 40B2BCC3 		.word	-1011043776
 8060 0250 1F374A5F 		.word	1598699295
 8061 0254 85F69C9A 		.word	-1700989307
 8062 0258 C1D6C544 		.word	1153816257
 8063 025c 2059DEE1 		.word	-505521888
 8064 0260 8F1BA5AF 		.word	-1348134001
 8065 0264 427B4ECD 		.word	-850494654
 8066 0268 60EB6222 		.word	576908128
 8067 026c 902CEFF0 		.word	-252760944
 8068 0270 0824CB3B 		.word	1003168776
 8069 0274 FC71A3F4 		.word	-190615044
 8070 0278 5568CFA9 		.word	-1446025131
 8071 027c 196C5D4C 		.word	1281190937
 8072 0280 0492E51D 		.word	501584388
 8073 0284 FEB851FA 		.word	-95307522
 8074 0288 2AB4E7D4 		.word	-723012566
 8075 028c 0CB62E26 		.word	640595468
 8076 0290 02C9F20E 		.word	250792194
 8077 0294 7FDC287D 		.word	2099829887
 8078 0298 15DA736A 		.word	1785977365
 8079 029c 065B1713 		.word	320297734
 8080 02a0 C1D6C544 		.word	1153816257
 8081 02a4 2059DEE1 		.word	-505521888
 8082 02a8 8F1BA5AF 		.word	-1348134001
 8083 02ac 427B4ECD 		.word	-850494654
 8084 02b0 60EB6222 		.word	576908128
 8085 02b4 902CEFF0 		.word	-252760944
 8086 02b8 C78DD257 		.word	1473416647
 8087 02bc A13DA766 		.word	1722236321
 8088 02c0 B0753111 		.word	288454064
 8089 02c4 489677F8 		.word	-126380472
 8090 02c8 E346E9AB 		.word	-1410775325
 8091 02cc D09E5333 		.word	861118160
 8092 02d0 9AC1D6C5 		.word	-975781478
 8093 02d4 442059DE 		.word	-564584380
 8094 02d8 E18F1BA5 		.word	-1524920351
 8095 02dc AF427B4E 		.word	1316700847
 8096 02e0 CD60EB62 		.word	1659592909
 8097 02e4 22902CEF 		.word	-282292190
 8098 02e8 F0C78DD2 		.word	-762460176
 8099 02ec 57A13DA7 		.word	-1489133225
 8100 02f0 66B07531 		.word	829796454
 8101 02f4 11489677 		.word	2006337553
 8102 02f8 F8E346E9 		.word	-381230088
 8103 02fc ABD09E53 		.word	1402917035
 8104 0300 5333D8BA 		.word	-1160236205
 8105 0304 980824CB 		.word	-886830952
 8106 0308 3BFC71A3 		.word	-1552810949
 8107 030c F45568CF 		.word	-815245836
 8108 0310 A9196C5D 		.word	1567365545
 8109 0314 4C0492E5 		.word	-443415476
 8110 0318 1DFEB851 		.word	1371078173
 8111 031c FA2AB4E7 		.word	-407622918
 8112 0320 D40CB62E 		.word	783682772
 8113 0324 2602C9F2 		.word	-221707738
ARM GAS  /tmp/ccDKg7Fp.s 			page 209


 8114 0328 0E7FDC28 		.word	685539086
 8115 032c 7D15DA73 		.word	1943672189
 8116 0330 2CEFF0C7 		.word	-940511444
 8117 0334 8DD257A1 		.word	-1588079987
 8118 0338 3DA766B0 		.word	-1335449795
 8119 033c 75311148 		.word	1209086325
 8120 0340 9677F8E3 		.word	-470255722
 8121 0344 46E9ABD0 		.word	-794039994
 8122 0348 9E5333D8 		.word	-667724898
 8123 034c BA980824 		.word	604543162
 8124 0350 CB3BFC71 		.word	1912355787
 8125 0354 A3F45568 		.word	1750463651
 8126 0358 CFA9196C 		.word	1813621199
 8127 035c 5D4C0492 		.word	-1845212067
 8128 0360 E51DFEB8 		.word	-1191305755
 8129 0364 51FA2AB4 		.word	-1272251823
 8130 0368 E7D40CB6 		.word	-1240673049
 8131 036c 2E2602C9 		.word	-922606034
 8132 0370 F20E7FDC 		.word	-595652878
 8133 0374 287D15DA 		.word	-636125912
 8134 0378 736A065B 		.word	1527147123
 8135 037c 17138164 		.word	1686180631
 8136 0380 79873F6E 		.word	1849657209
 8137 0384 94BE0AED 		.word	-318062956
 8138 0388 393583AD 		.word	-1383910087
 8139 038c 8B8940B2 		.word	-1304393333
 8140 0390 BE0AED39 		.word	971836094
 8141 0394 3583AD8B 		.word	-1951562955
 8142 0398 8940B2BC 		.word	-1129168759
 8143 039c C31F374A 		.word	1245126595
 8144 03a0 5F85F69C 		.word	-1661565601
 8145 03a4 9AC1D6C5 		.word	-975781478
 8146 03a8 442059DE 		.word	-564584380
 8147 03ac E18F1BA5 		.word	-1524920351
 8148 03b0 AF427B4E 		.word	1316700847
 8149 03b4 CD60EB62 		.word	1659592909
 8150 03b8 22902CEF 		.word	-282292190
 8151 03bc F0C78DD2 		.word	-762460176
 8152 03c0 77F8E346 		.word	1189345399
 8153 03c4 E9ABD09E 		.word	-1630491671
 8154 03c8 5333D8BA 		.word	-1160236205
 8155 03cc 980824CB 		.word	-886830952
 8156 03d0 3BFC71A3 		.word	-1552810949
 8157 03d4 F45568CF 		.word	-815245836
 8158 03d8 A9196C5D 		.word	1567365545
 8159 03dc 4C0492E5 		.word	-443415476
 8160 03e0 1DFEB851 		.word	1371078173
 8161 03e4 FA2AB4E7 		.word	-407622918
 8162 03e8 D40CB62E 		.word	783682772
 8163 03ec 2602C9F2 		.word	-221707738
 8164 03f0 D09E5333 		.word	861118160
 8165 03f4 D8BA9808 		.word	144227032
 8166 03f8 24CB3BFC 		.word	-63190236
 8167 03fc 71A3F455 		.word	1442095985
 8168 0400 68CFA919 		.word	430559080
 8169 0404 6C5D4C04 		.word	72113516
 8170 0408 92E51DFE 		.word	-31595118
ARM GAS  /tmp/ccDKg7Fp.s 			page 210


 8171 040c B851FA2A 		.word	721047992
 8172 0410 B4E7D40C 		.word	215279540
 8173 0414 B62E2602 		.word	36056758
 8174 0418 C9F20E7F 		.word	2131686089
 8175 041c DC287D15 		.word	360523996
 8176 0420 196C5D4C 		.word	1281190937
 8177 0424 0492E51D 		.word	501584388
 8178 0428 FEB851FA 		.word	-95307522
 8179 042c 2AB4E7D4 		.word	-723012566
 8180 0430 0CB62E26 		.word	640595468
 8181 0434 02C9F20E 		.word	250792194
 8182 0438 7FDC287D 		.word	2099829887
 8183 043c 15DA736A 		.word	1785977365
 8184 0440 065B1713 		.word	320297734
 8185 0444 81647987 		.word	-2022087551
 8186 0448 3F6E94BE 		.word	-1097568705
 8187 044c 0AED3935 		.word	892988682
 8188 0450 427B4ECD 		.word	-850494654
 8189 0454 60EB6222 		.word	576908128
 8190 0458 902CEFF0 		.word	-252760944
 8191 045c C78DD257 		.word	1473416647
 8192 0460 A13DA766 		.word	1722236321
 8193 0464 B0753111 		.word	288454064
 8194 0468 489677F8 		.word	-126380472
 8195 046c E346E9AB 		.word	-1410775325
 8196 0470 D09E5333 		.word	861118160
 8197 0474 D8BA9808 		.word	144227032
 8198 0478 24CB3BFC 		.word	-63190236
 8199 047c 71A3F455 		.word	1442095985
 8200 0480 8B8940B2 		.word	-1304393333
 8201 0484 BCC31F37 		.word	924828604
 8202 0488 4A5F85F6 		.word	-159031478
 8203 048c 9C9AC1D6 		.word	-691955044
 8204 0490 C5442059 		.word	1495286981
 8205 0494 DEE18F1B 		.word	462414302
 8206 0498 A5AF427B 		.word	2067967909
 8207 049c 4ECD60EB 		.word	-345977522
 8208 04a0 6222902C 		.word	747643490
 8209 04a4 EFF0C78D 		.word	-1916276497
 8210 04a8 D257A13D 		.word	1033983954
 8211 04ac A766B075 		.word	1974494887
 8212 04b0 F45568CF 		.word	-815245836
 8213 04b4 A9196C5D 		.word	1567365545
 8214 04b8 4C0492E5 		.word	-443415476
 8215 04bc 1DFEB851 		.word	1371078173
 8216 04c0 FA2AB4E7 		.word	-407622918
 8217 04c4 D40CB62E 		.word	783682772
 8218 04c8 2602C9F2 		.word	-221707738
 8219 04cc 0E7FDC28 		.word	685539086
 8220 04d0 7D15DA73 		.word	1943672189
 8221 04d4 6A065B17 		.word	391841386
 8222 04d8 13816479 		.word	2036629779
 8223 04dc 873F6E94 		.word	-1804714105
 8224 04e0 3DA766B0 		.word	-1335449795
 8225 04e4 75311148 		.word	1209086325
 8226 04e8 9677F8E3 		.word	-470255722
 8227 04ec 46E9ABD0 		.word	-794039994
ARM GAS  /tmp/ccDKg7Fp.s 			page 211


 8228 04f0 9E5333D8 		.word	-667724898
 8229 04f4 BA980824 		.word	604543162
 8230 04f8 CB3BFC71 		.word	1912355787
 8231 04fc A3F45568 		.word	1750463651
 8232 0500 CFA9196C 		.word	1813621199
 8233 0504 5D4C0492 		.word	-1845212067
 8234 0508 E51DFEB8 		.word	-1191305755
 8235 050c 51FA2AB4 		.word	-1272251823
 8236 0510 66B07531 		.word	829796454
 8237 0514 11489677 		.word	2006337553
 8238 0518 F8E346E9 		.word	-381230088
 8239 051c ABD09E53 		.word	1402917035
 8240 0520 33D8BA98 		.word	-1732585421
 8241 0524 0824CB3B 		.word	1003168776
 8242 0528 FC71A3F4 		.word	-190615044
 8243 052c 5568CFA9 		.word	-1446025131
 8244 0530 196C5D4C 		.word	1281190937
 8245 0534 0492E51D 		.word	501584388
 8246 0538 FEB851FA 		.word	-95307522
 8247 053c 2AB4E7D4 		.word	-723012566
 8248 0540 AF427B4E 		.word	1316700847
 8249 0544 CD60EB62 		.word	1659592909
 8250 0548 22902CEF 		.word	-282292190
 8251 054c F0C78DD2 		.word	-762460176
 8252 0550 57A13DA7 		.word	-1489133225
 8253 0554 66B07531 		.word	829796454
 8254 0558 11489677 		.word	2006337553
 8255 055c F8E346E9 		.word	-381230088
 8256 0560 ABD09E53 		.word	1402917035
 8257 0564 33D8BA98 		.word	-1732585421
 8258 0568 0824CB3B 		.word	1003168776
 8259 056c FC71A3F4 		.word	-190615044
 8260 0570 980824CB 		.word	-886830952
 8261 0574 3BFC71A3 		.word	-1552810949
 8262 0578 F45568CF 		.word	-815245836
 8263 057c A9196C5D 		.word	1567365545
 8264 0580 4C0492E5 		.word	-443415476
 8265 0584 1DFEB851 		.word	1371078173
 8266 0588 FA2AB4E7 		.word	-407622918
 8267 058c D40CB62E 		.word	783682772
 8268 0590 2602C9F2 		.word	-221707738
 8269 0594 0E7FDC28 		.word	685539086
 8270 0598 7D15DA73 		.word	1943672189
 8271 059c 6A065B17 		.word	391841386
 8272 05a0 51FA2AB4 		.word	-1272251823
 8273 05a4 E7D40CB6 		.word	-1240673049
 8274 05a8 2E2602C9 		.word	-922606034
 8275 05ac F20E7FDC 		.word	-595652878
 8276 05b0 287D15DA 		.word	-636125912
 8277 05b4 736A065B 		.word	1527147123
 8278 05b8 17138164 		.word	1686180631
 8279 05bc 79873F6E 		.word	1849657209
 8280 05c0 94BE0AED 		.word	-318062956
 8281 05c4 393583AD 		.word	-1383910087
 8282 05c8 8B8940B2 		.word	-1304393333
 8283 05cc BCC31F37 		.word	924828604
 8284 05d0 0AED3935 		.word	892988682
ARM GAS  /tmp/ccDKg7Fp.s 			page 212


 8285 05d4 83AD8B89 		.word	-1987334781
 8286 05d8 40B2BCC3 		.word	-1011043776
 8287 05dc 1F374A5F 		.word	1598699295
 8288 05e0 85F69C9A 		.word	-1700989307
 8289 05e4 C1D6C544 		.word	1153816257
 8290 05e8 2059DEE1 		.word	-505521888
 8291 05ec 8F1BA5AF 		.word	-1348134001
 8292 05f0 427B4ECD 		.word	-850494654
 8293 05f4 60EB6222 		.word	576908128
 8294 05f8 902CEFF0 		.word	-252760944
 8295 05fc C78DD257 		.word	1473416647
 8296 0600 C31F374A 		.word	1245126595
 8297 0604 5F85F69C 		.word	-1661565601
 8298 0608 9AC1D6C5 		.word	-975781478
 8299 060c 442059DE 		.word	-564584380
 8300 0610 E18F1BA5 		.word	-1524920351
 8301 0614 AF427B4E 		.word	1316700847
 8302 0618 CD60EB62 		.word	1659592909
 8303 061c 22902CEF 		.word	-282292190
 8304 0620 F0C78DD2 		.word	-762460176
 8305 0624 57A13DA7 		.word	-1489133225
 8306 0628 66B07531 		.word	829796454
 8307 062c 11489677 		.word	2006337553
 8308 0630 BCC31F37 		.word	924828604
 8309 0634 4A5F85F6 		.word	-159031478
 8310 0638 9C9AC1D6 		.word	-691955044
 8311 063c C5442059 		.word	1495286981
 8312 0640 DEE18F1B 		.word	462414302
 8313 0644 A5AF427B 		.word	2067967909
 8314 0648 4ECD60EB 		.word	-345977522
 8315 064c 6222902C 		.word	747643490
 8316 0650 EFF0C78D 		.word	-1916276497
 8317 0654 D257A13D 		.word	1033983954
 8318 0658 A766B075 		.word	1974494887
 8319 065c 31114896 		.word	-1773661903
 8320 0660 75311148 		.word	1209086325
 8321 0664 9677F8E3 		.word	-470255722
 8322 0668 46E9ABD0 		.word	-794039994
 8323 066c 9E5333D8 		.word	-667724898
 8324 0670 BA980824 		.word	604543162
 8325 0674 CB3BFC71 		.word	1912355787
 8326 0678 A3F45568 		.word	1750463651
 8327 067c CFA9196C 		.word	1813621199
 8328 0680 5D4C0492 		.word	-1845212067
 8329 0684 E51DFEB8 		.word	-1191305755
 8330 0688 51FA2AB4 		.word	-1272251823
 8331 068c E7D40CB6 		.word	-1240673049
 8332 0690 2E2602C9 		.word	-922606034
 8333 0694 F20E7FDC 		.word	-595652878
 8334 0698 287D15DA 		.word	-636125912
 8335 069c 736A065B 		.word	1527147123
 8336 06a0 17138164 		.word	1686180631
 8337 06a4 79873F6E 		.word	1849657209
 8338 06a8 94BE0AED 		.word	-318062956
 8339 06ac 393583AD 		.word	-1383910087
 8340 06b0 8B8940B2 		.word	-1304393333
 8341 06b4 BCC31F37 		.word	924828604
ARM GAS  /tmp/ccDKg7Fp.s 			page 213


 8342 06b8 4A5F85F6 		.word	-159031478
 8343 06bc 9C9AC1D6 		.word	-691955044
 8344 06c0 E7D40CB6 		.word	-1240673049
 8345 06c4 2E2602C9 		.word	-922606034
 8346 06c8 F20E7FDC 		.word	-595652878
 8347 06cc 287D15DA 		.word	-636125912
 8348 06d0 736A065B 		.word	1527147123
 8349 06d4 17138164 		.word	1686180631
 8350 06d8 79873F6E 		.word	1849657209
 8351 06dc 94BE0AED 		.word	-318062956
 8352 06e0 393583AD 		.word	-1383910087
 8353 06e4 8B8940B2 		.word	-1304393333
 8354 06e8 BCC31F37 		.word	924828604
 8355 06ec 4A5F85F6 		.word	-159031478
 8356 06f0 60EB6222 		.word	576908128
 8357 06f4 902CEFF0 		.word	-252760944
 8358 06f8 C78DD257 		.word	1473416647
 8359 06fc A13DA766 		.word	1722236321
 8360 0700 B0753111 		.word	288454064
 8361 0704 489677F8 		.word	-126380472
 8362 0708 E346E9AB 		.word	-1410775325
 8363 070c D09E5333 		.word	861118160
 8364 0710 D8BA9808 		.word	144227032
 8365 0714 24CB3BFC 		.word	-63190236
 8366 0718 71A3F455 		.word	1442095985
 8367 071c 68CFA919 		.word	430559080
 8368 0720 A9196C5D 		.word	1567365545
 8369 0724 4C0492E5 		.word	-443415476
 8370 0728 1DFEB851 		.word	1371078173
 8371 072c FA2AB4E7 		.word	-407622918
 8372 0730 D40CB62E 		.word	783682772
 8373 0734 2602C9F2 		.word	-221707738
 8374 0738 0E7FDC28 		.word	685539086
 8375 073c 7D15DA73 		.word	1943672189
 8376 0740 6A065B17 		.word	391841386
 8377 0744 13816479 		.word	2036629779
 8378 0748 873F6E94 		.word	-1804714105
 8379 074c BE0AED39 		.word	971836094
 8380 0750 F20E7FDC 		.word	-595652878
 8381 0754 287D15DA 		.word	-636125912
 8382 0758 736A065B 		.word	1527147123
 8383 075c 17138164 		.word	1686180631
 8384 0760 79873F6E 		.word	1849657209
 8385 0764 94BE0AED 		.word	-318062956
 8386 0768 393583AD 		.word	-1383910087
 8387 076c 8B8940B2 		.word	-1304393333
 8388 0770 BCC31F37 		.word	924828604
 8389 0774 4A5F85F6 		.word	-159031478
 8390 0778 9C9AC1D6 		.word	-691955044
 8391 077c C5442059 		.word	1495286981
 8392 0780 3BFC71A3 		.word	-1552810949
 8393 0784 F45568CF 		.word	-815245836
 8394 0788 A9196C5D 		.word	1567365545
 8395 078c 4C0492E5 		.word	-443415476
 8396 0790 1DFEB851 		.word	1371078173
 8397 0794 FA2AB4E7 		.word	-407622918
 8398 0798 D40CB62E 		.word	783682772
ARM GAS  /tmp/ccDKg7Fp.s 			page 214


 8399 079c 2602C9F2 		.word	-221707738
 8400 07a0 0E7FDC28 		.word	685539086
 8401 07a4 7D15DA73 		.word	1943672189
 8402 07a8 6A065B17 		.word	391841386
 8403 07ac 13816479 		.word	2036629779
 8404 07b0 442059DE 		.word	-564584380
 8405 07b4 E18F1BA5 		.word	-1524920351
 8406 07b8 AF427B4E 		.word	1316700847
 8407 07bc CD60EB62 		.word	1659592909
 8408 07c0 22902CEF 		.word	-282292190
 8409 07c4 F0C78DD2 		.word	-762460176
 8410 07c8 57A13DA7 		.word	-1489133225
 8411 07cc 66B07531 		.word	829796454
 8412 07d0 11489677 		.word	2006337553
 8413 07d4 F8E346E9 		.word	-381230088
 8414 07d8 ABD09E53 		.word	1402917035
 8415 07dc 33D8BA98 		.word	-1732585421
 8416 07e0 8DD257A1 		.word	-1588079987
 8417 07e4 3DA766B0 		.word	-1335449795
 8418 07e8 75311148 		.word	1209086325
 8419 07ec 9677F8E3 		.word	-470255722
 8420 07f0 46E9ABD0 		.word	-794039994
 8421 07f4 9E5333D8 		.word	-667724898
 8422 07f8 BA980824 		.word	604543162
 8423 07fc CB3BFC71 		.word	1912355787
 8424 0800 A3F45568 		.word	1750463651
 8425 0804 CFA9196C 		.word	1813621199
 8426 0808 5D4C0492 		.word	-1845212067
 8427 080c E51DFEB8 		.word	-1191305755
 8428 0810 D6C54420 		.word	541378006
 8429 0814 59DEE18F 		.word	-1881022887
 8430 0818 1BA5AF42 		.word	1118807323
 8431 081c 7B4ECD60 		.word	1624067707
 8432 0820 EB622290 		.word	-1876794645
 8433 0824 2CEFF0C7 		.word	-940511444
 8434 0828 8DD257A1 		.word	-1588079987
 8435 082c 3DA766B0 		.word	-1335449795
 8436 0830 75311148 		.word	1209086325
 8437 0834 9677F8E3 		.word	-470255722
 8438 0838 46E9ABD0 		.word	-794039994
 8439 083c 9E5333D8 		.word	-667724898
 8440 0840 1F374A5F 		.word	1598699295
 8441 0844 85F69C9A 		.word	-1700989307
 8442 0848 C1D6C544 		.word	1153816257
 8443 084c 2059DEE1 		.word	-505521888
 8444 0850 8F1BA5AF 		.word	-1348134001
 8445 0854 427B4ECD 		.word	-850494654
 8446 0858 60EB6222 		.word	576908128
 8447 085c 902CEFF0 		.word	-252760944
 8448 0860 C78DD257 		.word	1473416647
 8449 0864 A13DA766 		.word	1722236321
 8450 0868 B0753111 		.word	288454064
 8451 086c 489677F8 		.word	-126380472
 8454              	hop_interval_lut:
 8455 0870 00       		.byte	0
 8456 0871 01       		.byte	1
 8457 0872 13       		.byte	19
ARM GAS  /tmp/ccDKg7Fp.s 			page 215


 8458 0873 19       		.byte	25
 8459 0874 1C       		.byte	28
 8460 0875 0F       		.byte	15
 8461 0876 1F       		.byte	31
 8462 0877 10       		.byte	16
 8463 0878 0E       		.byte	14
 8464 0879 21       		.byte	33
 8465 087a 1A       		.byte	26
 8466 087b 1B       		.byte	27
 8467 087c 22       		.byte	34
 8468 087d 14       		.byte	20
 8469 087e 08       		.byte	8
 8470 087f 05       		.byte	5
 8471 0880 07       		.byte	7
 8472 0881 18       		.byte	24
 8473 0882 23       		.byte	35
 8474 0883 02       		.byte	2
 8475 0884 0D       		.byte	13
 8476 0885 1E       		.byte	30
 8477 0886 20       		.byte	32
 8478 0887 1D       		.byte	29
 8479 0888 11       		.byte	17
 8480 0889 03       		.byte	3
 8481 088a 0A       		.byte	10
 8482 088b 0B       		.byte	11
 8483 088c 04       		.byte	4
 8484 088d 17       		.byte	23
 8485 088e 15       		.byte	21
 8486 088f 06       		.byte	6
 8487 0890 16       		.byte	22
 8488 0891 09       		.byte	9
 8489 0892 0C       		.byte	12
 8490 0893 12       		.byte	18
 8491 0894 24       		.byte	36
 8492 0895 000000   		.space	3
 8493              	.LC0:
 8494 0898 01000000 		.word	1
 8495 089c 01000000 		.word	1
 8496 08a0 01000000 		.word	1
 8497 08a4 01000000 		.word	1
 8498              	.LC1:
 8499 08a8 00       		.byte	0
 8500 08a9 09       		.byte	9
 8501 08aa FF       		.byte	-1
 8502 08ab FF       		.byte	-1
 8503 08ac FF       		.byte	-1
 8504 08ad FF       		.byte	-1
 8505 08ae FF       		.byte	-1
 8506 08af FF       		.byte	-1
 8507 08b0 02       		.byte	2
 8508 08b1 01       		.byte	1
 8509 08b2 05       		.byte	5
 8510 08b3 FF       		.byte	-1
 8511 08b4 FF       		.byte	-1
 8512 08b5 FF       		.byte	-1
 8513              	.LC2:
 8514 08b6 6C09     		.short	2412
ARM GAS  /tmp/ccDKg7Fp.s 			page 216


 8515 08b8 8509     		.short	2437
 8516 08ba 9E09     		.short	2462
 8517              		.section	.rodata.str1.1,"aMS",%progbits,1
 8518              	.LC3:
 8519 0000 32303138 		.ascii	"2018-08-R1\000"
 8519      2D30382D 
 8519      523100
 8520              	.LC4:
 8521 000b 0A0A2A2A 		.ascii	"\012\012****UBERTOOTH BOOT****\012%s\012\000"
 8521      2A2A5542 
 8521      4552544F 
 8521      4F544820 
 8521      424F4F54 
 8522              		.data
 8523              		.align	2
 8524              		.set	.LANCHOR1,. + 0
 8527              	channel:
 8528 0000 8909     		.short	2441
 8529 0002 0000     		.space	2
 8532              	le:
 8533 0004 D6BE898E 		.word	-1903575338
 8534 0008 7D6B     		.short	27517
 8535 000a 7191     		.short	-28303
 8536 000c 55555500 		.word	5592405
 8537 0010 AAAAAA00 		.word	11184810
 8538 0014 00000000 		.word	0
 8539 0018 00       		.byte	0
 8540 0019 000000   		.space	3
 8541 001c 00000000 		.word	0
 8542 0020 00000000 		.space	24
 8542      00000000 
 8542      00000000 
 8542      00000000 
 8542      00000000 
 8543 0038 01000000 		.word	1
 8544 003c 00000000 		.space	12
 8544      00000000 
 8544      00000000 
 8545 0048 00000000 		.word	0
 8546 004c 00000000 		.word	0
 8549              	hop_timeout:
 8550 0050 9E00     		.short	158
 8553              	le_adv_channel:
 8554 0052 6209     		.short	2402
 8557              	low_freq:
 8558 0054 6009     		.short	2400
 8561              	high_freq:
 8562 0056 B309     		.short	2483
 8565              	rssi_threshold:
 8566 0058 E2       		.byte	-30
 8567              		.bss
 8568              		.align	2
 8569              		.set	.LANCHOR0,. + 0
 8572              	modulation:
 8573 0000 00       		.space	1
 8576              	status:
 8577 0001 00       		.space	1
ARM GAS  /tmp/ccDKg7Fp.s 			page 217


 8580              	idle_buf_clkn_high:
 8581 0002 00       		.space	1
 8582 0003 00       		.space	1
 8585              	idle_buf_clk100ns:
 8586 0004 00000000 		.space	4
 8589              	idle_buf_channel:
 8590 0008 0000     		.space	2
 8593              	hop_mode:
 8594 000a 00       		.space	1
 8597              	do_hop:
 8598 000b 00       		.space	1
 8601              	hop_direct_channel:
 8602 000c 0000     		.space	2
 8605              	requested_channel:
 8606 000e 0000     		.space	2
 8609              	dma_discard:
 8610 0010 00       		.space	1
 8613              	mode:
 8614 0011 00       		.space	1
 8617              	requested_mode:
 8618 0012 00       		.space	1
 8621              	jam_mode:
 8622 0013 00       		.space	1
 8625              	ego_mode:
 8626 0014 00       		.space	1
 8627 0015 000000   		.space	3
 8630              	packet_cb:
 8631 0018 00000000 		.space	4
 8634              	le_jam_count:
 8635 001c 00000000 		.space	4
 8638              	slave_mac_address:
 8639 0020 00000000 		.space	6
 8639      0000
 8640 0026 0000     		.space	2
 8643              	cancel_follow:
 8644 0028 00000000 		.space	4
 8647              	data_cb:
 8648 002c 00000000 		.space	4
 8651              	restart_jamming.4818:
 8652 0030 00000000 		.space	4
 8655              	first_ts.4917:
 8656 0034 00000000 		.space	4
 8659              	prev_clk.4923:
 8660 0038 00000000 		.space	4
 8661              		.text
 8662              	.Letext0:
 8663              		.file 2 "/usr/lib/gcc/arm-none-eabi/4.9.3/include/stddef.h"
 8664              		.file 3 "/usr/lib/gcc/arm-none-eabi/4.9.3/include/stdint-gcc.h"
 8665              		.file 4 "../../host/libubertooth/src/ubertooth_interface.h"
 8666              		.file 5 "../common/ubertooth.h"
 8667              		.file 6 "ubertooth_usb.h"
 8668              		.file 7 "bluetooth_le.h"
 8669              		.file 8 "ego.h"
 8670              		.file 9 "ubertooth_rssi.h"
 8671              		.file 10 "ubertooth_cs.h"
 8672              		.file 11 "ubertooth_dma.h"
 8673              		.file 12 "ubertooth_clock.h"
ARM GAS  /tmp/ccDKg7Fp.s 			page 218


 8674              		.file 13 "bluetooth.h"
 8675              		.file 14 "debug_uart.h"
 8676              		.file 15 "cc2400_rangetest.h"
 8677              		.file 16 "/usr/include/newlib/string.h"
ARM GAS  /tmp/ccDKg7Fp.s 			page 219


DEFINED SYMBOLS
                            *ABS*:0000000000000000 bluetooth_rxtx.c
     /tmp/ccDKg7Fp.s:19     .text.reverse8:0000000000000000 $t
     /tmp/ccDKg7Fp.s:23     .text.reverse8:0000000000000000 reverse8
     /tmp/ccDKg7Fp.s:72     .text.cc2400_rx:0000000000000000 $t
     /tmp/ccDKg7Fp.s:76     .text.cc2400_rx:0000000000000000 cc2400_rx
     /tmp/ccDKg7Fp.s:188    .text.cc2400_rx:0000000000000098 $d
     /tmp/ccDKg7Fp.s:195    .text.cc2400_rx_sync:0000000000000000 $t
     /tmp/ccDKg7Fp.s:199    .text.cc2400_rx_sync:0000000000000000 cc2400_rx_sync
     /tmp/ccDKg7Fp.s:323    .text.cc2400_rx_sync:00000000000000a0 $d
     /tmp/ccDKg7Fp.s:330    .text.enqueue:0000000000000000 $t
     /tmp/ccDKg7Fp.s:334    .text.enqueue:0000000000000000 enqueue
     /tmp/ccDKg7Fp.s:442    .text.enqueue:0000000000000080 $d
                            *COM*:0000000000000004 clkn
                            *COM*:0000000000000001 rssi_min
                            *COM*:0000000000000001 rssi_max
                            *COM*:0000000000000001 rssi_count
     /tmp/ccDKg7Fp.s:452    .text.le_set_access_address:0000000000000000 $t
     /tmp/ccDKg7Fp.s:456    .text.le_set_access_address:0000000000000000 le_set_access_address
     /tmp/ccDKg7Fp.s:483    .text.le_set_access_address:0000000000000014 $d
     /tmp/ccDKg7Fp.s:488    .text.cc2400_idle:0000000000000000 $t
     /tmp/ccDKg7Fp.s:492    .text.cc2400_idle:0000000000000000 cc2400_idle
     /tmp/ccDKg7Fp.s:606    .text.cc2400_idle:00000000000000a0 $d
                            *COM*:0000000000000010 target
     /tmp/ccDKg7Fp.s:614    .text.cb_follow_le:0000000000000000 $t
     /tmp/ccDKg7Fp.s:619    .text.cb_follow_le:0000000000000000 cb_follow_le
     /tmp/ccDKg7Fp.s:826    .text.cb_follow_le:00000000000000ec $d
                            *COM*:0000000000000320 unpacked
                            *COM*:0000000000000004 idle_rxbuf
     /tmp/ccDKg7Fp.s:836    .text.connection_follow_cb:0000000000000000 $t
     /tmp/ccDKg7Fp.s:841    .text.connection_follow_cb:0000000000000000 connection_follow_cb
     /tmp/ccDKg7Fp.s:1116   .text.connection_follow_cb:0000000000000168 $d
     /tmp/ccDKg7Fp.s:1126   .text.vendor_request_handler:0000000000000000 $t
     /tmp/ccDKg7Fp.s:1130   .text.vendor_request_handler:0000000000000000 vendor_request_handler
     /tmp/ccDKg7Fp.s:1156   .text.vendor_request_handler:0000000000000012 $d
     /tmp/ccDKg7Fp.s:1227   .text.vendor_request_handler:00000000000000a0 $t
     /tmp/ccDKg7Fp.s:1745   .text.vendor_request_handler:0000000000000314 $d
                            *COM*:0000000000000005 rr
                            *COM*:0000000000000001 cs_threshold_req
     /tmp/ccDKg7Fp.s:1763   .text.vendor_request_handler:0000000000000350 $t
     /tmp/ccDKg7Fp.s:2326   .text.vendor_request_handler:00000000000005e0 $d
                            *COM*:0000000000000004 clkn_offset
                            *COM*:0000000000000002 clk100ns_offset
                            *COM*:000000000000000a afh_map
                            *COM*:0000000000000001 used_channels
                            *COM*:0000000000000001 afh_enabled
                            *COM*:0000000000000002 clk_drift_ppm
                            *COM*:0000000000000004 clkn_next_drift_fix
                            *COM*:0000000000000002 clk_drift_correction
                            *COM*:0000000000000004 clkn_last_drift_fix
                            *COM*:000000000000003a tx_pkt
     /tmp/ccDKg7Fp.s:2342   .text.vendor_request_handler:0000000000000618 $t
     /tmp/ccDKg7Fp.s:2486   .text.vendor_request_handler:00000000000006b0 $d
     /tmp/ccDKg7Fp.s:2495   .text.enqueue_with_ts:0000000000000000 $t
     /tmp/ccDKg7Fp.s:2500   .text.enqueue_with_ts:0000000000000000 enqueue_with_ts
     /tmp/ccDKg7Fp.s:2575   .text.enqueue_with_ts:000000000000004c $d
     /tmp/ccDKg7Fp.s:2581   .text.TIMER0_IRQHandler:0000000000000000 $t
ARM GAS  /tmp/ccDKg7Fp.s 			page 220


     /tmp/ccDKg7Fp.s:2586   .text.TIMER0_IRQHandler:0000000000000000 TIMER0_IRQHandler
     /tmp/ccDKg7Fp.s:2782   .text.TIMER0_IRQHandler:000000000000010c $d
                            *COM*:0000000000000004 last_hop
     /tmp/ccDKg7Fp.s:2799   .text.EINT3_IRQHandler:0000000000000000 $t
     /tmp/ccDKg7Fp.s:2804   .text.EINT3_IRQHandler:0000000000000000 EINT3_IRQHandler
     /tmp/ccDKg7Fp.s:2835   .text.EINT3_IRQHandler:0000000000000024 $d
                            *COM*:0000000000000001 cs_trigger
     /tmp/ccDKg7Fp.s:2843   .text.legacy_DMA_IRQHandler:0000000000000000 $t
     /tmp/ccDKg7Fp.s:2848   .text.legacy_DMA_IRQHandler:0000000000000000 legacy_DMA_IRQHandler
     /tmp/ccDKg7Fp.s:2973   .text.legacy_DMA_IRQHandler:00000000000000a4 $d
                            *COM*:0000000000000004 active_rxbuf
                            *COM*:0000000000000004 rx_tc
                            *COM*:0000000000000004 rx_err
     /tmp/ccDKg7Fp.s:2992   .text.DMA_IRQHandler:0000000000000000 $t
     /tmp/ccDKg7Fp.s:2997   .text.DMA_IRQHandler:0000000000000000 DMA_IRQHandler
     /tmp/ccDKg7Fp.s:3061   .text.DMA_IRQHandler:000000000000004c $d
     /tmp/ccDKg7Fp.s:3073   .text.le_transmit:0000000000000000 $t
     /tmp/ccDKg7Fp.s:3078   .text.le_transmit:0000000000000000 le_transmit
     /tmp/ccDKg7Fp.s:3377   .text.le_transmit:00000000000001a0 $d
     /tmp/ccDKg7Fp.s:3387   .text.le_jam:0000000000000000 $t
     /tmp/ccDKg7Fp.s:3392   .text.le_jam:0000000000000000 le_jam
     /tmp/ccDKg7Fp.s:3476   .text.le_jam:0000000000000074 $d
     /tmp/ccDKg7Fp.s:3481   .text.hop:0000000000000000 $t
     /tmp/ccDKg7Fp.s:3486   .text.hop:0000000000000000 hop
     /tmp/ccDKg7Fp.s:3729   .text.hop:0000000000000178 $d
     /tmp/ccDKg7Fp.s:3741   .text.bt_stream_rx:0000000000000000 $t
     /tmp/ccDKg7Fp.s:3746   .text.bt_stream_rx:0000000000000000 bt_stream_rx
     /tmp/ccDKg7Fp.s:3973   .text.bt_stream_rx:0000000000000130 $d
                            *COM*:0000000000000001 cs_threshold_cur
                            *COM*:0000000000000001 cs_no_squelch
     /tmp/ccDKg7Fp.s:3989   .text.br_transmit:0000000000000000 $t
     /tmp/ccDKg7Fp.s:3994   .text.br_transmit:0000000000000000 br_transmit
     /tmp/ccDKg7Fp.s:4413   .text.br_transmit:0000000000000254 $d
     /tmp/ccDKg7Fp.s:4426   .text.reset_le:0000000000000000 $t
     /tmp/ccDKg7Fp.s:4431   .text.reset_le:0000000000000000 reset_le
     /tmp/ccDKg7Fp.s:4493   .text.reset_le:0000000000000040 $d
     /tmp/ccDKg7Fp.s:4502   .text.reset_le_promisc:0000000000000000 $t
     /tmp/ccDKg7Fp.s:4507   .text.reset_le_promisc:0000000000000000 reset_le_promisc
     /tmp/ccDKg7Fp.s:4531   .text.reset_le_promisc:000000000000001c $d
                            *COM*:0000000000000108 le_promisc
     /tmp/ccDKg7Fp.s:4536   .text.bt_generic_le:0000000000000000 $t
     /tmp/ccDKg7Fp.s:4541   .text.bt_generic_le:0000000000000000 bt_generic_le
     /tmp/ccDKg7Fp.s:4889   .text.bt_generic_le:00000000000001b0 $d
     /tmp/ccDKg7Fp.s:4907   .text.bt_le_sync:0000000000000000 $t
     /tmp/ccDKg7Fp.s:4912   .text.bt_le_sync:0000000000000000 bt_le_sync
     /tmp/ccDKg7Fp.s:5410   .text.bt_le_sync:00000000000002a4 $d
                            *COM*:0000000000000032 rxbuf1
     /tmp/ccDKg7Fp.s:5432   .text.bt_le_sync:00000000000002f4 $t
     /tmp/ccDKg7Fp.s:5558   .text.bt_le_sync:00000000000003a4 $d
     /tmp/ccDKg7Fp.s:5565   .text.bt_follow_le:0000000000000000 $t
     /tmp/ccDKg7Fp.s:5570   .text.bt_follow_le:0000000000000000 bt_follow_le
     /tmp/ccDKg7Fp.s:5584   .text.le_promisc_state:0000000000000000 $t
     /tmp/ccDKg7Fp.s:5589   .text.le_promisc_state:0000000000000000 le_promisc_state
     /tmp/ccDKg7Fp.s:5643   .text.promisc_recover_hop_increment:0000000000000000 $t
     /tmp/ccDKg7Fp.s:5648   .text.promisc_recover_hop_increment:0000000000000000 promisc_recover_hop_increment
     /tmp/ccDKg7Fp.s:5808   .text.promisc_recover_hop_increment:00000000000000cc $d
     /tmp/ccDKg7Fp.s:5818   .text.promisc_recover_hop_interval:0000000000000000 $t
ARM GAS  /tmp/ccDKg7Fp.s 			page 221


     /tmp/ccDKg7Fp.s:5823   .text.promisc_recover_hop_interval:0000000000000000 promisc_recover_hop_interval
     /tmp/ccDKg7Fp.s:5943   .text.promisc_recover_hop_interval:0000000000000098 $d
     /tmp/ccDKg7Fp.s:5954   .text.promisc_follow_cb:0000000000000000 $t
     /tmp/ccDKg7Fp.s:5959   .text.promisc_follow_cb:0000000000000000 promisc_follow_cb
     /tmp/ccDKg7Fp.s:6063   .text.promisc_follow_cb:0000000000000064 $d
     /tmp/ccDKg7Fp.s:6074   .text.see_aa:0000000000000000 $t
     /tmp/ccDKg7Fp.s:6079   .text.see_aa:0000000000000000 see_aa
     /tmp/ccDKg7Fp.s:6150   .text.see_aa:0000000000000050 $d
     /tmp/ccDKg7Fp.s:6157   .text.cb_le_promisc:0000000000000000 $t
     /tmp/ccDKg7Fp.s:6162   .text.cb_le_promisc:0000000000000000 cb_le_promisc
     /tmp/ccDKg7Fp.s:6477   .text.cb_le_promisc:0000000000000198 $d
     /tmp/ccDKg7Fp.s:6490   .text.bt_promisc_le:0000000000000000 $t
     /tmp/ccDKg7Fp.s:6495   .text.bt_promisc_le:0000000000000000 bt_promisc_le
     /tmp/ccDKg7Fp.s:6574   .text.bt_promisc_le:000000000000005c $d
     /tmp/ccDKg7Fp.s:6583   .text.bt_slave_le:0000000000000000 $t
     /tmp/ccDKg7Fp.s:6588   .text.bt_slave_le:0000000000000000 bt_slave_le
     /tmp/ccDKg7Fp.s:6719   .text.bt_slave_le:0000000000000098 $d
     /tmp/ccDKg7Fp.s:6731   .text.rx_generic_sync:0000000000000000 $t
     /tmp/ccDKg7Fp.s:6736   .text.rx_generic_sync:0000000000000000 rx_generic_sync
     /tmp/ccDKg7Fp.s:6850   .text.rx_generic_sync:0000000000000098 $d
     /tmp/ccDKg7Fp.s:6858   .text.rx_generic:0000000000000000 $t
     /tmp/ccDKg7Fp.s:6863   .text.rx_generic:0000000000000000 rx_generic
     /tmp/ccDKg7Fp.s:6897   .text.rx_generic:000000000000001c $d
     /tmp/ccDKg7Fp.s:6902   .text.tx_generic:0000000000000000 $t
     /tmp/ccDKg7Fp.s:6907   .text.tx_generic:0000000000000000 tx_generic
     /tmp/ccDKg7Fp.s:7065   .text.tx_generic:00000000000000dc $d
     /tmp/ccDKg7Fp.s:7075   .text.specan:0000000000000000 $t
     /tmp/ccDKg7Fp.s:7080   .text.specan:0000000000000000 specan
     /tmp/ccDKg7Fp.s:7268   .text.specan:00000000000000fc $d
     /tmp/ccDKg7Fp.s:7278   .text.led_specan:0000000000000000 $t
     /tmp/ccDKg7Fp.s:7283   .text.led_specan:0000000000000000 led_specan
     /tmp/ccDKg7Fp.s:7484   .text.led_specan:0000000000000114 $d
     /tmp/ccDKg7Fp.s:7495   .text.startup.main:0000000000000000 $t
     /tmp/ccDKg7Fp.s:7500   .text.startup.main:0000000000000000 main
     /tmp/ccDKg7Fp.s:7556   .text.startup.main:0000000000000042 $d
     /tmp/ccDKg7Fp.s:7721   .text.startup.main:00000000000000ec $d
     /tmp/ccDKg7Fp.s:8630   .bss:0000000000000018 packet_cb
     /tmp/ccDKg7Fp.s:8647   .bss:000000000000002c data_cb
     /tmp/ccDKg7Fp.s:8634   .bss:000000000000001c le_jam_count
     /tmp/ccDKg7Fp.s:8532   .data:0000000000000004 le
     /tmp/ccDKg7Fp.s:8638   .bss:0000000000000020 slave_mac_address
     /tmp/ccDKg7Fp.s:8565   .data:0000000000000058 rssi_threshold
     /tmp/ccDKg7Fp.s:8561   .data:0000000000000056 high_freq
     /tmp/ccDKg7Fp.s:8557   .data:0000000000000054 low_freq
     /tmp/ccDKg7Fp.s:8572   .bss:0000000000000000 modulation
     /tmp/ccDKg7Fp.s:8625   .bss:0000000000000014 ego_mode
     /tmp/ccDKg7Fp.s:8621   .bss:0000000000000013 jam_mode
     /tmp/ccDKg7Fp.s:8617   .bss:0000000000000012 requested_mode
     /tmp/ccDKg7Fp.s:8613   .bss:0000000000000011 mode
     /tmp/ccDKg7Fp.s:8576   .bss:0000000000000001 status
     /tmp/ccDKg7Fp.s:8609   .bss:0000000000000010 dma_discard
     /tmp/ccDKg7Fp.s:8589   .bss:0000000000000008 idle_buf_channel
     /tmp/ccDKg7Fp.s:8585   .bss:0000000000000004 idle_buf_clk100ns
     /tmp/ccDKg7Fp.s:8580   .bss:0000000000000002 idle_buf_clkn_high
     /tmp/ccDKg7Fp.s:8643   .bss:0000000000000028 cancel_follow
     /tmp/ccDKg7Fp.s:8553   .data:0000000000000052 le_adv_channel
     /tmp/ccDKg7Fp.s:8605   .bss:000000000000000e requested_channel
ARM GAS  /tmp/ccDKg7Fp.s 			page 222


     /tmp/ccDKg7Fp.s:8549   .data:0000000000000050 hop_timeout
     /tmp/ccDKg7Fp.s:8601   .bss:000000000000000c hop_direct_channel
     /tmp/ccDKg7Fp.s:8527   .data:0000000000000000 channel
     /tmp/ccDKg7Fp.s:8597   .bss:000000000000000b do_hop
     /tmp/ccDKg7Fp.s:8593   .bss:000000000000000a hop_mode
     /tmp/ccDKg7Fp.s:7965   .rodata:00000000000000a7 compile_info
                            *COM*:0000000000000008 syncword
                            *COM*:0000000000000032 rxbuf2
     /tmp/ccDKg7Fp.s:7788   .rodata:0000000000000000 $d
     /tmp/ccDKg7Fp.s:7792   .rodata:0000000000000000 whitening_index
     /tmp/ccDKg7Fp.s:7835   .rodata:0000000000000028 whitening
     /tmp/ccDKg7Fp.s:7971   .rodata:00000000000000f0 whitening_word
     /tmp/ccDKg7Fp.s:8454   .rodata:0000000000000870 hop_interval_lut
     /tmp/ccDKg7Fp.s:8523   .data:0000000000000000 $d
     /tmp/ccDKg7Fp.s:8568   .bss:0000000000000000 $d
     /tmp/ccDKg7Fp.s:8651   .bss:0000000000000030 restart_jamming.4818
     /tmp/ccDKg7Fp.s:8655   .bss:0000000000000034 first_ts.4917
     /tmp/ccDKg7Fp.s:8659   .bss:0000000000000038 prev_clk.4923
                     .debug_frame:0000000000000010 $d
     /tmp/ccDKg7Fp.s:7573   .text.startup.main:0000000000000053 $d
     /tmp/ccDKg7Fp.s:7573   .text.startup.main:0000000000000054 $t

UNDEFINED SYMBOLS
cc2400_set
cs_threshold_calc_and_set
clkn_start
cc2400_status
cc2400_strobe
usb_enqueue
rssi_get_avg
memcpy
rbit
clkn_stop
dio_ssp_stop
cs_reset
rssi_reset
btle_channel_index
btle_crcgen_lut
memcmp
__aeabi_llsl
get_part_num
get_device_serial
cc2400_get
set_isp
strlen
precalc
bootloader_ctrl
usb_queue_init
dequeue
memset
le_DMA_IRQHandler
debug_dma_active
cc2400_fifo_write
next_hop
btle_next_hop
dio_ssp_init
dma_init_rx_symbols
ARM GAS  /tmp/ccDKg7Fp.s 			page 223


dio_ssp_start
cs_trigger_enable
rssi_add
handle_usb
rssi_iir_update
cs_trigger_disable
dma_init_le
le_phy_main
btle_reverse_crc
btle_calc_crc
cc2400_fifo_read
ubertooth_init
clkn_init
ubertooth_usb_init
dma_poweron
debug_uart_init
debug_printf
wait
reset
cc2400_txtest
cc2400_rangetest
cc2400_repeater
ego_main
